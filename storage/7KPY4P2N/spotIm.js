var __assign=this&&this.__assign||function(){return __assign=Object.assign||function(t){for(var e,o=1,n=arguments.length;o<n;o++)for(var i in e=arguments[o])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},__assign.apply(this,arguments)},__spreadArray=this&&this.__spreadArray||function(t,e,o){if(o||2===arguments.length)for(var n,i=0,a=e.length;i<a;i++)!n&&i in e||(n||(n=Array.prototype.slice.call(e,0,i)),n[i]=e[i]);return t.concat(n||Array.prototype.slice.call(e))};!function(){var t="navigate",e="scroll-lock",o="scroll-release",n="spotim_error",i="spotim_event",a="sso_api_ready",s="sso_code_a",r="sso_login_error",c="sso_login_success",d="storage_update",p="spot-im-share-type",m="spot-im-conversation-failed",l="spot-im-conversation-loaded",u="ow-error-event",h="spot-im-launcher-failed",g="ow-performance-event",v="spot-im-recirculation-item-clicked",f="spot-im-recirculation-viewed",w="spot-im-recirculation-left-clicked",_="spot-im-recirculation-right-clicked",I="spot-im-show-more-replies-clicked",S="spot-im-show-more-comments-clicked",C="spot-im-sort-by-select",y="spot-im-user-down-vote-click",O="spot-im-user-up-vote-click",b="spot-im-clicked-settings",E="spot-im-login-start",A="spot-im-clicked-mute-user",k="spot-im-user-clicked-reply",T="spot-im-clicked-privacy",N="spot-im-clicked-flag",P="spot-im-current-user-sent-message-clicked",M="logout",J="startSafeframeSso",R="completeSSOCallback",x="modal",L="deeplink",D="conversation",B="pitc",j=function(){function j(t){var e,o,n;if(this.CONVERSATIONS_POSITION_NAME="OpenWebWidget",this.PITC_POSITION_NAME="OpenWebPitcWidget",this.CONVERSATIONS_NODE_ID="spotIm-conversations-module-wrapper",this.PITC_ROOT_NODE_ID="spotIm-pitc-module-root-wrapper",this.UPDATE_STORAGE_THROTTLE_MS=500,this.SPOT_IM_QUERY_PREFIXES=["openweb_","ow_","spot_im","spot_reset_password","spot_ticket","spotim_","tenant_config"],this.NAVIGATE_ALLOWED_LIST=["https://www.yahoo.com","https://api-2-0.spot.im","mailto:"],this.isDebug=!1,this.isStaging=!1,this.devJACVersion="",this.modalJacPositionsMap={},t){this.spotImConfiguration=t,void 0===this.spotImConfiguration.conversationEnabled&&(this.spotImConfiguration.conversationEnabled=!0),this.pageContext=__assign(__assign({},null===(e=window.YAHOO)||void 0===e?void 0:e.context),null===(n=null===(o=window.vzm)||void 0===o?void 0:o.getPageContext)||void 0===n?void 0:n.call(o));try{this.isDebug="1"===localStorage.getItem("SPOTIM_JAC_DEBUG");var i=/[?&]ref=spot-im-pitc-jac-stage(&.*)?$/gi.test(document.location.search),a="1"===localStorage.getItem("SPOTIM_JAC_STAGE");(i||a)&&(this.isStaging=!0);var s=localStorage.getItem("SPOTIM_JAC_VERSION")||"";s&&/^(\d+)\.(\d+)\.(\d+)$/.test(s)&&(this.devJACVersion=s)}catch(t){}this.updateStorageThrottled=window.wafer.utils.throttle(this.updateStorage,this.UPDATE_STORAGE_THROTTLE_MS,this);try{this.initialize()}catch(t){console.error(t),this.sendBeacon("spotIm-init-error",{message:t.message})}}else console.error("SpotImJAC: invalid configuration")}return j.prototype.getIsOpenWebParam=function(){var t=this;return window.location.search.slice(1).split("&").some((function(e){return t.SPOT_IM_QUERY_PREFIXES.some((function(t){return 0===e.split("=")[0].indexOf(t)}))}))},j.prototype.injectJAC=function(){var t=this,e=this.spotImConfiguration.jacUrl;return new Promise((function(o,n){var i=document.createElement("script");i.async=!0,i.src=e,t.devJACVersion&&(i.src="https://jac.yahoosandbox.com/".concat(t.devJACVersion,"/jac.js")),i.onerror=function(e){console.error(e),t.sendBeacon("spotIm-jac-inject-fail",{message:e}),n(e)};window.JAC_CONFIG={client:{positions:{},onReady:function(){o(),window.JAC.on("AD_MESSAGE",(function(e){var o=e.meta;try{var n=o.message,i=void 0===n?"":n,a=o.positionName,s=JSON.parse(i),r=s.type,c=s.messages,d=void 0===c?[]:c;if("spotim"!==String(r).toLowerCase())return;d.forEach((function(e){return t.onMessageFromJAC(a,e)}))}catch(e){console.error(e),t.sendBeacon("spotIm-on-ad-message-fail")}}))}}},document.body.appendChild(i)}))},j.prototype.initialize=function(){var t=this,e=this.spotImConfiguration,o=e.useCase,n=e.jacDomain,i=e.device,a=void 0===i?"":i,s=this.pageContext.device,r="smartphone"===(void 0===s?a:s);switch(window.JAC_BASE_URL=n,o){case L:this.injectJAC().then((function(){r?t.initForDeeplinkMobile():t.initForDeeplink()}));break;case x:this.initForModal(r);break;default:throw new Error("Unknown useCase '".concat(o,"' given"))}},j.prototype.initForDeeplink=function(){var t=this.spotImConfiguration,e=t.conversationEnabled;if(t.pitcEnabled||e){e&&this.scrollToCommentsIfNeeded();var o=e?D:B,n=document.getElementById(this.CONVERSATIONS_NODE_ID),i=this.getJACPositionConfig({spotImConfig:this.spotImConfiguration,spotImType:o,targetElement:n,useCase:L});window.JAC.createPosition(this.CONVERSATIONS_POSITION_NAME,{client:i,service:{}}),window.JAC.render([this.CONVERSATIONS_POSITION_NAME])}},j.prototype.initForDeeplinkMobile=function(){var t=this.spotImConfiguration,e=t.conversationEnabled,o=t.pitcEnabled;if(e&&(this.openMobileModalIfNeeded(),this.initForLightbox(this.spotImConfiguration)),o){var n=document.getElementById(this.PITC_ROOT_NODE_ID),i=this.getJACPositionConfig({spotImConfig:this.spotImConfiguration,spotImType:B,targetElement:n,useCase:L});window.JAC.createPosition(this.PITC_POSITION_NAME,{client:i,service:{}}),window.JAC.render([this.PITC_POSITION_NAME])}},j.prototype.initForModal=function(t){var e=this,o=this.spotImConfiguration,n=o.conversationEnabled,i=o.showSuspendedCommentsMessage,a=this.injectJAC(),s=function(){for(var t=Object.keys(e.modalJacPositionsMap);t.length;){var o=t.pop();window.JAC.destroyPosition(o)}e.modalJacPositionsMap={}};window.addEventListener("initSpotImComments",(function(o){var s=o.detail,r=s.elem,c=s.config,d=s.isMain;if(n&&a.then((function(){return e.initCommentsInModal(r,c,d,t)})),!t&&i){var p=document.getElementById("suspended-commenting-message-template");p&&(r.innerText=p.content.textContent,r.className=p.className)}})),window.addEventListener("initSpotImPitc",(function(t){var o=t.detail,n=o.elem,i=o.config;a.then((function(){return e.initPitcInModal(n,i)}))})),window.addEventListener("viewerContentChanged",s),window.addEventListener("viewerClosed",s)},j.prototype.initForLightbox=function(t,e){var o=this;void 0===e&&(e=L);var n=t||this.spotImConfiguration;window.wafer.on("lightbox:open",(function(){var t=document.getElementById(o.CONVERSATIONS_NODE_ID);if(t){var i=o.getJACPositionConfig({spotImConfig:n,spotImType:D,targetElement:t,useCase:e});window.JAC.createPosition(o.CONVERSATIONS_POSITION_NAME,{client:i,service:{}}),window.JAC.render([o.CONVERSATIONS_POSITION_NAME])}})),window.wafer.on("lightbox:close",(function(){document.getElementById(o.CONVERSATIONS_NODE_ID)&&window.JAC.destroyPosition(o.CONVERSATIONS_POSITION_NAME)}));var i=document.getElementById("view-comments-wrapper"),a=document.getElementById("spot-im-wafer-lightbox");i&&a&&i.addEventListener("click",(function(){a.click()}))},j.prototype.initCommentsInModal=function(t,e,o,n){var i=o?this.CONVERSATIONS_POSITION_NAME:"".concat(this.CONVERSATIONS_POSITION_NAME,"-").concat(e.uuid);if(n)this.initForLightbox(e,x),this.openMobileModalIfNeeded();else{var a=this.getJACPositionConfig({spotImConfig:e,spotImType:D,targetElement:t,useCase:x});window.JAC.createPosition(i,{client:a,service:{}}),window.JAC.render([i])}this.modalJacPositionsMap[i]=e},j.prototype.initPitcInModal=function(t,e){var o=this.PITC_POSITION_NAME,n=this.getJACPositionConfig({spotImConfig:e,spotImType:B,targetElement:t,useCase:x});window.JAC.createPosition(o,{client:n,service:{}}),window.JAC.render([o]),this.modalJacPositionsMap[o]=e},j.prototype.getJACPositionConfig=function(t){var e,o,n,i,a=this,s=t.spotImConfig,r=t.targetElement,c=t.spotImType,d=t.useCase;if(["spotImConfig","targetElement","spotImType","useCase"].forEach((function(e){if(!t[e])throw new Error("getJACPositionConfig: param '".concat(e,"' is missed"))})),!r.id)throw new Error("getJACPositionConfig: targetElement doesn't have required DOM id attribute");var p=s.device,m=void 0===p?"":p,l=s.launcherUrl,u=s.leftRailWidth,h=void 0===u?"":u,g=s.messages_cnt,v=s.passiveReactionEnabled,f=s.pitcAdEnabled,w=s.pitcEnabled,_=s.stageSpotId,I=s.url,S=s.uuid,C=s.spotId;this.isStaging&&_&&(C=_);var y,O=l+C,b=this.pageContext,E=b.device,A=void 0===E?m:E,k=b.contentSite,T=void 0===k?"":k,N=b.site,P=void 0===N?"":N,M=b.lang,J=void 0===M?"":M,R=b.meta,x=void 0===R?{}:R,j=x.contentType,V=void 0===j?"story":j,F=x.siteAttribute,U=void 0===F?"":F,W="smartphone"===A,G=d===L&&W,H=W&&c===D?window.innerWidth:r.offsetWidth,Y=W?window.innerHeight-57:330,q=h||(null===(e=document.querySelector("#Masterwrap .caas-share-section, #content-articles-wrapper .caas-share-section"))||void 0===e?void 0:e.clientWidth)||0,z=(null===(o=document.querySelector(".caas-content-wrapper"))||void 0===o?void 0:o.clientWidth)||0,Q=w?"spot-im-pitc-jac":"spot-im-jac",X="".concat(I,"?ref=").concat(Q),$=__spreadArray([],/rs="lmsid:([\w]+);?/gi.exec(U)||[],!0)[1],K=void 0===$?"yahoo":$,Z="";try{Z=localStorage.getItem("OW_STORAGE")||""}catch(t){console.error("SpotIm(JAC) OW_STORAGE LS read error: ",t),this.sendBeacon("spotIm-ow-storage-LS-read-error")}var tt=window.location.search.slice(1).split("&").filter((function(t){return a.SPOT_IM_QUERY_PREFIXES.some((function(e){var o=t.split("="),n=o[0],i=o[1];return"ref"===n&&0===(void 0===i?"":i).indexOf("spot-im")||0===n.indexOf(e)}))})).join("&"),et=window.location.href.split("?")[0]+(tt?"?".concat(tt):""),ot=null===(i=null===(n=window.YAHOO)||void 0===n?void 0:n.subscriptions)||void 0===i?void 0:i.adLite,nt=f&&!window.dpDarlaProxyExclusive&&!ot,it="fp"===P?T:P,at=v?"data-labels-section=".concat(it):"",st="news"===it||"fp"===it?'data-categories="news, sports, entertainment, finance, lifestyle, money"':"data-categories=".concat(it);switch(c){case D:y="\n                        ".concat(nt?"":'<meta name="spotim-ads" content="disable-all" />',"\n                        <style>\n                            #fc_align {\n                                width: 100%;\n                                ").concat(W?"overflow-y: auto; height: 100%;":"","\n                            }\n                            #spotIm-in-jac-conversations.deeplink-desktop {\n                                width: calc(85% - 300px);\n                                margin-left: ").concat(q,"px;\n                            }\n                            #spotIm-in-jac-conversations.deeplink-desktop.news-en-US {\n                                width: 85%;\n                                position: relative;\n                                left: 9%;\n                                margin-left: ").concat(q,"px;\n                            }\n                            #spotIm-in-jac-conversations.deeplink-smartphone {\n                                width: calc(100% - 20px);\n                                margin: 0 auto;\n                            }\n                            #spotIm-in-jac-conversations.modal-desktop {\n                                width: ").concat(z,"px;\n                                margin-left: ").concat(q,'px;\n                                padding-right: 10%;\n                            }\n                        </style>\n                        <div id="spotIm-in-jac-conversations" class="').concat(d,"-").concat(A," ").concat(it,"-").concat(J,'">\n                            <script\n                                async\n                                type="text/javascript"\n                                src="').concat(O,'"\n                                data-safeframe-height="').concat(Y,'"\n                                data-safeframe-width="').concat(H,'"\n                                data-spotim-module="spotim-launcher"\n                                data-spot-id="').concat(C,'"\n                                data-post-id="').concat(S,'"\n                                data-post-url="').concat(X,'"\n                                data-article-tags="').concat(it,'"\n                                data-is-full-screen="').concat(W,'"\n                                data-messages-count="').concat(g,'"\n                                data-custom-partner-id="').concat(K,'"\n                                data-custom-page-type="').concat(V,'"\n                                data-custom-product-id="yahoo_').concat(it,'"\n                                ').concat(at,"\n                            >\n                            <\/script>\n                        </div>\n                        ").concat(w&&!G?'<div data-spotim-module="pitc" '.concat(st,"></div>"):"","\n                    ");break;case B:y="\n                        ".concat(nt?"":'<meta name="spotim-ads" content="disable-all" />','\n                        <style>\n                            #fc_align {\n                                width: 100%;\n                            }\n                        </style>\n                        <div>\n                            <script\n                                async\n                                type="text/javascript"\n                                src="').concat(O,'"\n                                data-post-id="').concat(S,'"\n                                data-safeframe-height="').concat(Y,'"\n                                data-safeframe-width="').concat(H,'"\n                                data-spotim-module="spotim-launcher"\n                                data-custom-partner-id="').concat(K,'"\n                                data-custom-page-type="').concat(V,'"\n                                data-custom-product-id="yahoo_').concat(it,'"\n                                data-article-tags="').concat(it,'"\n                                data-spotim-autorun="false"\n                            >\n                            <\/script>\n                            <div data-spotim-module="pitc"  ').concat(st,"></div>\n                        </div>\n                    ");break;default:throw new Error("Unexpected spotImType: ".concat(c))}return{safeFrame:{enabled:!0,features:{resize:{enabled:!0}}},meta:{OpenWeb:{hostUrl:et,localStorage:Z}},content:{markup:y,size:{width:H,height:Y}},targetElement:r.id}},j.prototype.onMessageFromJAC=function(p,m){var l=m.action,u=m.args;this.debugLog("onMessageFromJAC",{action:l,args:u,positionName:p});var h=p===this.CONVERSATIONS_POSITION_NAME,g=this.modalJacPositionsMap[p]||this.spotImConfiguration;if(h)switch(l){case a:this.onSSOReady();break;case s:this.startSSOFlow(u.code_a,g);break;case r:this.sendBeacon("spotIm-sso-fail");break;case c:this.sendBeacon("spotIm-sso-success")}switch(l){case i:var v=u.params,f=u.type;this.onSpotImEvent(f,v,g);break;case d:var w=u.storage;this.updateStorageThrottled(w);break;case t:var _=u.url;this.openLinkFromSpotIm(_);break;case n:var I=u.type,S=u.error;this.sendBeacon("spotIm-inner-error",{type:I,error:S});break;case e:window.document.body.classList.add("ow-modal-opened");break;case o:window.document.body.classList.remove("ow-modal-opened")}},j.prototype.onSpotImEvent=function(t,e,o){var n=this;this.debugLog("onSpotImEvent",{eventName:t,params:e});var i=function(t){n.sendRapid(t,o)},a=e||{},s=a.message_id,r=void 0===s?"":s,c=a.parent_id,d=void 0===c?"":c,M=a.message_type,J=void 0===M?"":M;switch(t){case E:this.goToAuth();break;case A:i({slk:"mute",elm:"cmmt_mute",outcm:"close"});break;case p:var R=e.type;i({slk:void 0===R?"":R,elm:J?"cmmt_share_"+J:"cmmt_share",msg_id:r,outcm:"open",parent_id:d});break;case C:var x=e.sortedBy;i({slk:void 0===x?"":x,elm:"cmmt_sort_btn",outcm:"sort"});break;case P:i({slk:J,elm:"cmmt_post",msg_id:d,outcm:"post"});break;case k:i({slk:"reply",elm:"cmmt_reply"});break;case I:i({slk:"open reply",elm:"cmmt_more",elmt:"showreply",outcm:"show",parent_id:d,msg_id:r,sec:"cmmts"});break;case N:i({slk:"abuse",elm:"cmmt_abuse",outcm:"open",msg_id:r,parent_id:d});break;case T:i({slk:"privacy",elm:"cmmt_username",sec:"cmmt_his"});break;case b:i({slk:"your settings",elm:"cmmt_username",sec:"cmmt_his"});break;case O:i({slk:"vote thumb_up",elm:"cmmt_vote",parent_id:d,msg_id:r,outcm:"rate"});break;case y:i({slk:"vote thumb_down",elm:"cmmt_vote",parent_id:d,msg_id:r,outcm:"rate"});break;case S:this.updateUser(o),i({slk:"load more",elm:"cmmt_more",outcm:"more"});break;case v:var L=e.title,D=void 0===L?"":L,B=e.url,j=new URL(void 0===B?"https://www.yahoo.com":B);i({sec:"pitc",slk:D,tar:j.origin,tar_uri:j.pathname,elm:"hdln",outcm:"clicked",itc:0});break;case f:i({sec:"pitc",slk:"deeplink",elm:"hdln",outcm:"",itc:0,eventType:"view"});break;case w:i({sec:"pitc",slk:"prev",elm:"arrow",noContent:!0,outcm:"clicked"});break;case _:i({sec:"pitc",slk:"next",elm:"arrow",noContent:!0,outcm:"clicked"});break;case m:case h:this.sendBeacon("spotIm-inner-fail:".concat(t));break;case l:window.rapidInstance.beaconEvent("openweb_module_view",{sec:"cmmts",subsec:"openweb",etrg:"show",outcm:"openweb_module_view"}),this.getCommentCount();break;case g:this.reportPerformance(e);break;case u:this.reportError(e)}},j.prototype.goToAuth=function(){var t=this.pageContext,e=t.lang,o=void 0===e?"en-US":e,n=t.site,i="fp"===n?"homepage":n,a=window.YAHOO.i13n&&window.YAHOO.i13n.SPACEID||2023538075,s=window.location.href+(window.location.search?"&":"?")+"a20_comeback_from_auth=1",r="https://login.yahoo.com/?.lang=".concat(o,"&src=").concat(i,"&pspid=").concat(a,"&activity=comments&.done=").concat(encodeURIComponent(s));window.location.href=r},j.prototype.onSSOReady=function(){var t=this.pageContext,e=t.authed,o=void 0===e?"0":e,n=t.guid;"1"===o?this.sendMessageToJAC({action:J,args:{userId:n}}):this.sendMessageToJAC({action:M})},j.prototype.sendMessageToJAC=function(t){var e=Math.random().toString(36).substring(2,15)+Date.now();this.debugLog("sendMessageToJAC",t),window.JAC.updateMeta([this.CONVERSATIONS_POSITION_NAME],"openWeb",JSON.stringify(__assign({type:"SPOTIM",id:e},t)))},j.prototype.startSSOFlow=function(t,e){var o=this;this.debugLog("startSSOFlow",{codeA:t});var n=e.xhrPathPrefix,i=e.useStageToken,a=void 0!==i&&i,s="".concat(n,"?m_id=spotIm&ctrl=SpotImSSO&m_mode=json");fetch(s,{body:JSON.stringify({m_id:"spotIm",ctrl:"SpotImSSO",m_mode:"json",code_a:t,useStageToken:Boolean(a||this.isStaging)}),headers:{"Content-Type":"application/json"},method:"POST"}).then((function(t){if(200!==t.status)throw new Error("Request error");return t.json()})).then((function(t){var e=t.html;if(!e)throw new Error("SpotIm: codeB getting error");o.sendMessageToJAC({action:R,args:e})})).catch((function(t){o.sendBeacon("spotIm-sso-fail")}))},j.prototype.updateStorage=function(t){try{localStorage.setItem("OW_STORAGE",JSON.stringify(t))}catch(t){this.sendBeacon("spotIm-storage-update-fail")}},j.prototype.openLinkFromSpotIm=function(t){void 0===t&&(t=""),this.NAVIGATE_ALLOWED_LIST.some((function(e){return 0===t.indexOf(e)}))&&(window.location.href=t)},j.prototype.getCommentCount=function(){var t=this.spotImConfiguration,e=t.spotId,o=t.uuid,n=t.showCommentCount,i=document.getElementsByClassName("reactions-count")[0];n&&e&&o&&i&&window.SPOTIM.getMessagesCount({spotId:e,postId:o}).then((function(t){t&&(i.innerHTML=t,i.setAttribute("style","display:block"))}))},j.prototype.sendBeacon=function(t,e){var o,n,i,a,s;void 0===e&&(e={});var r=this.pageContext,c=["browserName","device","lang","region","rid","site"].reduce((function(t,e){return"".concat(t,"&").concat(e,"=").concat(r[e]||"")}),""),d=Object.keys(e).reduce((function(t,o){return"".concat(t,"&").concat(o,"=").concat(e[o])}),""),p=(null===(n=null===(o=window.YAHOO)||void 0===o?void 0:o.errBeaconConfig)||void 0===n?void 0:n.beaconPath)||"_td_api/beacon/error";null===(s=null===(a=null===(i=window.wafer)||void 0===i?void 0:i.utils)||void 0===a?void 0:a.fireBeacon)||void 0===s||s.call(a,"/".concat(p,"?beaconName=").concat(t).concat(d).concat(c))},j.prototype.sendRapid=function(t,e){var o=t.elm,n=void 0===o?"":o,i=t.elmt,a=void 0===i?"":i,s=t.eventType,r=void 0===s?"click":s,c=t.itc,d=void 0===c?1:c,p=t.msg_id,m=void 0===p?"":p,l=t.parent_id,u=void 0===l?"":l,h=t.noContent,g=void 0!==h&&h,v=t.outcm,f=void 0===v?"":v,w=t.pos,_=void 0===w?0:w,I=t.sec,S=void 0===I?"cmmts":I,C=t.slk,y=void 0===C?"":C,O=t.subsec,b=void 0===O?"openweb":O,E=t.tar,A=void 0===E?"":E,k=t.tar_uri,T=void 0===k?"":k,N=e.uuid;if(window.rapidInstance){var P={elm:n,elmt:a,g:"",itc:d,outcm:f,subsec:b,tar:A,tar_uri:T,msg_id:m,parent_id:u};P.g=g?"":N,"view"===r?window.rapidInstance.beaconLinkViews([{sec:S,_links:[{slk:y,elm:n,itc:d}]}]):"click"===r&&window.rapidInstance.beaconClick(S,y,_,P)}},j.prototype.scrollToCommentsIfNeeded=function(){var t=document.getElementById(this.CONVERSATIONS_NODE_ID);if(t){var e=this.getIsOpenWebParam(),o=function(){var e=function(){return t.scrollIntoView({behavior:"smooth",block:"center"})};e(),setTimeout(e,1e3)};e&&o();var n=document.querySelector(".caas-share-buttons .caas-comment");n&&n.addEventListener("click",(function(t){t.preventDefault(),t.stopPropagation(),o()}))}},j.prototype.openMobileModalIfNeeded=function(){var t=document.getElementById("spot-im-wafer-lightbox");if(t){var e=this.getIsOpenWebParam(),o=/(\?|&)a20_comeback_from_auth=1/gi.test(window.location.search);(e||o)&&t.click()}},j.prototype.updateUser=function(t){var e=this,o=this.pageContext.authed;if("1"===(void 0===o?"0":o)){this.debugLog("updateUser",t);var n=t.xhrPathPrefix,i=t.useStageToken,a=void 0!==i&&i,s="".concat(n,"?m_id=spotIm&ctrl=SpotImSSO&m_mode=json");fetch(s,{body:JSON.stringify({action:"update",m_id:"spotIm",ctrl:"SpotImSSO",m_mode:"json",useStageToken:Boolean(a||this.isStaging)}),headers:{"Content-Type":"application/json"},method:"POST"}).then((function(t){if(200!==t.status)throw new Error("Request error")})).catch((function(t){e.debugLog("SpotIm updateUser fetch error",{error:t}),e.sendBeacon("spotIm-update-user-failure")}))}},j.prototype.debugLog=function(t,e){this.isDebug&&console.warn("[SpotIm-JAC-Debug]: ",t,e)},j.prototype.reportPerformance=function(t){var e=t.source,o=t.time,n=t.type;this.sendBeacon("spotIm-perf",{source:e,time:o,type:n})},j.prototype.reportError=function(t){var e=t.source,o=t.type;this.sendBeacon("spotIm-ow-error",{source:e,type:o})},j}();"undefined"!=typeof process&&(window.__SpotImJAC=j),window.wafer&&window.wafer.ready((function(){var t=document.getElementById("spotim-config"),e=window.wafer.base.state.spotIm||t&&window.wafer.utils.getConfigFromJSONScriptNode(t).config;new j(e)}),window)}();