(()=>{"use strict";var e,n,t,i,a=new Map,r=function(e,n){return{name:e,value:void 0===n?-1:n,delta:0,entries:[],id:"v2-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12)}},o=function(e,n){try{if(PerformanceObserver.supportedEntryTypes.includes(e)){if("first-input"===e&&!("PerformanceEventTiming"in self))return;var t=new PerformanceObserver((function(e){return e.getEntries().map(n)}));return t.observe({type:e,buffered:!0}),t}}catch(e){}},c=function(e,n){var t=function t(i){"pagehide"!==i.type&&"hidden"!==document.visibilityState||(e(i),n&&(removeEventListener("visibilitychange",t,!0),removeEventListener("pagehide",t,!0)))};addEventListener("visibilitychange",t,!0),addEventListener("pagehide",t,!0)},u=function(e){addEventListener("pageshow",(function(n){n.persisted&&e(n)}),!0)},s=function(e,n,t){var i;return function(a){n.value>=0&&(a||t)&&(n.delta=n.value-(i||0),(n.delta||void 0===i)&&(i=n.value,e(n)))}},l=-1,f=function(){return"hidden"===document.visibilityState?0:1/0},d=function(){c((function(e){var n=e.timeStamp;l=n}),!0)},v=function(){return l<0&&(l=f(),d(),u((function(){setTimeout((function(){l=f(),d()}),0)}))),{get firstHiddenTime(){return l}}},m=function(e,n){var t,i=v(),a=r("FCP"),c=function(e){"first-contentful-paint"===e.name&&(f&&f.disconnect(),e.startTime<i.firstHiddenTime&&(a.value=e.startTime,a.entries.push(e),t(!0)))},l=window.performance&&performance.getEntriesByName&&performance.getEntriesByName("first-contentful-paint")[0],f=l?null:o("paint",c);(l||f)&&(t=s(e,a,n),l&&c(l),u((function(i){a=r("FCP"),t=s(e,a,n),requestAnimationFrame((function(){requestAnimationFrame((function(){a.value=performance.now()-i.timeStamp,t(!0)}))}))})))},p=!1,w=-1,g={passive:!0,capture:!0},h=new Date,b=function(i,a){e||(e=a,n=i,t=new Date,k(removeEventListener),y())},y=function(){if(n>=0&&n<t-h){var a={entryType:"first-input",name:e.type,target:e.target,cancelable:e.cancelable,startTime:e.timeStamp,processingStart:e.timeStamp+n};i.forEach((function(e){e(a)})),i=[]}},E=function(e){if(e.cancelable){var n=(e.timeStamp>1e12?new Date:performance.now())-e.timeStamp;"pointerdown"==e.type?function(e,n){var t=function(){b(e,n),a()},i=function(){a()},a=function(){removeEventListener("pointerup",t,g),removeEventListener("pointercancel",i,g)};addEventListener("pointerup",t,g),addEventListener("pointercancel",i,g)}(n,e):b(n,e)}},k=function(e){["mousedown","keydown","touchstart","pointerdown"].forEach((function(n){return e(n,E,g)}))},T={};function S(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function F(e,n){for(var t=0;t<n.length;t++){var i=n[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function C(e,n,t){return n&&F(e.prototype,n),t&&F(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}var I,L,P,D,M=function(e,n,t,i,a){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof n?e!==n||!a:!n.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?a.call(e,t):a?a.value=t:n.set(e,t),t},V=function(e,n,t,i){if("a"===t&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof n?e!==n||!i:!n.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===t?i:"a"===t?i.call(e):i?i.value:n.get(e)},O=function(){function e(n){S(this,e),I.set(this,void 0);try{var t=(new Date).toString();n.setItem(t,t);var i=n.getItem(t)==t;n.removeItem(t),i&&M(this,I,n,"f")}catch(e){}}return C(e,[{key:"isAvailable",value:function(){return Boolean(V(this,I,"f"))}},{key:"get",value:function(e){try{var n,t,i=JSON.parse(null!==(n=null===(t=V(this,I,"f"))||void 0===t?void 0:t.getItem(e))&&void 0!==n?n:""),a=i.value,r=i.expires;return r&&new Date>new Date(r)?(this.remove(e),null):a}catch(e){return null}}},{key:"set",value:function(e,n,t){var i;return null===(i=V(this,I,"f"))||void 0===i?void 0:i.setItem(e,JSON.stringify({value:n,expires:t}))}},{key:"remove",value:function(e){var n;return null===(n=V(this,I,"f"))||void 0===n?void 0:n.removeItem(e)}},{key:"clear",value:function(){var e;return null===(e=V(this,I,"f"))||void 0===e?void 0:e.clear()}},{key:"getRaw",value:function(e){var n,t;return null!==(n=null===(t=V(this,I,"f"))||void 0===t?void 0:t.getItem(e))&&void 0!==n?n:null}},{key:"setRaw",value:function(e,n){var t;return null===(t=V(this,I,"f"))||void 0===t?void 0:t.setItem(e,n)}}]),e}();I=new WeakMap;var W,B,N=new(D=function(){function e(){S(this,e),L.set(this,void 0),P.set(this,void 0)}return C(e,[{key:"local",get:function(){return M(this,L,V(this,L,"f")||new O(localStorage),"f")}},{key:"session",get:function(){return M(this,P,V(this,P,"f")||new O(sessionStorage),"f")}}]),e}(),L=new WeakMap,P=new WeakMap,D),R="gu.logger",j={common:{background:"#052962",font:"#ffffff"},commercial:{background:"#77EEAA",font:"#004400"},cmp:{background:"#FF6BB5",font:"#2F0404"},dotcom:{background:"#000000",font:"#ff7300"},design:{background:"#185E36",font:"#FFF4F2"},tx:{background:"#2F4F4F",font:"#FFFFFF"}},A=function(e){var n=j[e],t=n.background,i=n.font;return"background: ".concat(t,"; color: ").concat(i,"; padding: 2px 3px; border-radius:3px")},q=function(e){var n;if((N.local.get(R)||"").includes(e)){for(var t=[A("common"),"",A(e),""],i=arguments.length,a=new Array(i>1?i-1:0),r=1;r<i;r++)a[r-1]=arguments[r];(n=console).log.apply(n,["%c@guardian%c %c".concat(e,"%c")].concat(t,a))}};"undefined"!=typeof window&&(window.guardian||(window.guardian={}),(W=window.guardian).logger||(W.logger={subscribeTo:function(e){var n=N.local.get(R)?N.local.get(R).split(","):[];n.includes(e)||n.push(e),N.local.set(R,n.join(",")),q(e,"ðŸ”” Subscribed, hello!")},unsubscribeFrom:function(e){q(e,"ðŸ”• Unsubscribed, good-bye!");var n=N.local.get(R).split(",").filter((function(n){return n!==e}));N.local.set(R,n.join(","))},teams:function(){return Object.keys(j)}})),function(e){e.PROD="https://performance-events.guardianapis.com/core-web-vitals",e.CODE="https://performance-events.code.dev-guardianapis.com/core-web-vitals"}(B||(B={}));var x,_,J,H={browser_id:null,page_view_id:null,fid:null,cls:null,lcp:null,fcp:null,ttfb:null},z=new Set,U=!1,G=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6,t=Math.pow(10,n);return Math.round(e*t)/t},K=!1,Q=function(){K||null!==H.fcp&&(K=navigator.sendBeacon(x,JSON.stringify(H)),z.size>0&&z.forEach((function(e){q(e,K?"Core Web Vitals payload successfully queued for transfer":"Failed to queue Core Web Vitals payload for transfer")})))},X=function(e){switch(e.name){case"FCP":H.fcp=G(e.value);break;case"CLS":H.cls=G(e.value);break;case"LCP":H.lcp=G(e.value);break;case"FID":H.fid=G(e.value);break;case"TTFB":H.ttfb=G(e.value)}},Y=function(e){switch(e.type){case"visibilitychange":return void("hidden"===document.visibilityState&&Q());case"pagehide":return void Q()}},Z=function(){!function(e,n){p||(m((function(e){w=e.value})),p=!0);var t,i=function(n){w>-1&&e(n)},a=r("CLS",0),l=0,f=[],d=function(e){if(!e.hadRecentInput){var n=f[0],i=f[f.length-1];l&&e.startTime-i.startTime<1e3&&e.startTime-n.startTime<5e3?(l+=e.value,f.push(e)):(l=e.value,f=[e]),l>a.value&&(a.value=l,a.entries=f,t())}},v=o("layout-shift",d);v&&(t=s(i,a,false),c((function(){v.takeRecords().map(d),t(!0)})),u((function(){l=0,w=-1,a=r("CLS",0),t=s(i,a,false)})))}(X),function(t,a){var l,f=v(),d=r("FID"),m=function(e){e.startTime<f.firstHiddenTime&&(d.value=e.processingStart-e.startTime,d.entries.push(e),l(!0))},p=o("first-input",m);l=s(t,d,a),p&&c((function(){p.takeRecords().map(m),p.disconnect()}),!0),p&&u((function(){var o;d=r("FID"),l=s(t,d,a),i=[],n=-1,e=null,k(addEventListener),o=m,i.push(o),y()}))}(X),function(e,n){var t,i=v(),a=r("LCP"),l=function(e){var n=e.startTime;n<i.firstHiddenTime&&(a.value=n,a.entries.push(e)),t()},f=o("largest-contentful-paint",l);if(f){t=s(e,a,n);var d=function(){T[a.id]||(f.takeRecords().map(l),f.disconnect(),T[a.id]=!0,t(!0))};["keydown","click"].forEach((function(e){addEventListener(e,d,{once:!0,capture:!0})})),c(d,!0),u((function(i){a=r("LCP"),t=s(e,a,n),requestAnimationFrame((function(){requestAnimationFrame((function(){a.value=performance.now()-i.timeStamp,T[a.id]=!0,t(!0)}))}))}))}}(X),m(X),function(e){var n,t=r("TTFB");n=function(){try{var n=performance.getEntriesByType("navigation")[0]||function(){var e=performance.timing,n={entryType:"navigation",startTime:0};for(var t in e)"navigationStart"!==t&&"toJSON"!==t&&(n[t]=Math.max(e[t]-e.navigationStart,0));return n}();if(t.value=t.delta=n.responseStart,t.value<0||t.value>performance.now())return;t.entries=[n],e(t)}catch(e){}},"complete"===document.readyState?setTimeout(n,0):addEventListener("pageshow",n)}(X),addEventListener("visibilitychange",Y),addEventListener("pagehide",Y)};_=function(){var e,n=function(e){var n,t=e.name,i=e.shouldMemoize,r=void 0!==i&&i;if(a.has(t))return null!==(n=a.get(t))&&void 0!==n?n:null;var o=function(e){var n="".concat(e,"=");return document.cookie.split(";").reduce((function(e,t){var i=t.trim();return i.startsWith(n)&&e.push(i.substring(n.length,i.length)),e}),[])}(t);return o.length>0?(r&&a.set(t,o[0]),o[0]):null}({name:"bwid",shouldMemoize:!0});return function(e){var n=e.browserId,t=void 0===n?null:n,i=e.pageViewId,a=void 0===i?null:i,r=e.sampling,o=void 0===r?.01:r,c=e.isDev,u=e.team;if(U)console.warn("initCoreWebVitals already initialised","use the bypassCoreWebVitalsSampling method instead");else{U=!0,u&&z.add(u),function(e){x=e?B.CODE:B.PROD}(c),H.browser_id=t,H.page_view_id=a,t&&a||console.warn("browserId or pageViewId missing from Core Web Vitals.","Resulting data cannot be joined to page view tables",{browserId:t,pageViewId:a}),(o<0||o>1)&&console.warn("Core Web Vitals sampling is outside the 0 to 1 range: ",o),0===o&&console.warn("Core Web Vitals are sampled at 0%"),1===o&&console.warn("Core Web Vitals are sampled at 100%");var s=Math.random()<o,l="#bypassCoreWebVitalsSampling"===window.location.hash;(s||l)&&Z()}}({browserId:n,pageViewId:window.guardian.config.ophan.pageViewId,isDev:"m.code.dev-theguardian.com"===window.location.hostname||"localhost"===window.location.hostname||"preview.gutools.co.uk"===window.location.hostname,sampling:.01,team:"dotcom"}),"localhost"===window.location.hostname&&(e="dotcom",U?(z.add(e),Z()):console.warn("initCoreWebVitals not yet initialised")),Promise.resolve()},J=function(){!function(e,n){var t=function(e){var n=window.performance,t="".concat(e,"-start"),i="".concat(e,"-end");return n&&n.getEntriesByName?{start:function(){n.mark(t)},end:function(){n.mark(i),n.measure(e,t,i),q("dotcom",JSON.stringify(n.getEntriesByName(e)));var a=n.getEntriesByName(e,"measure"),r=a&&a[0]&&a[0].duration||0;return Math.round(r)},clear:function(){n.clearMarks(t),n.clearMarks(i),n.clearMeasures(e)}}:{start:function(){},end:function(){return 0},clear:function(){}}}(e),i=t.start,a=t.end;i(),n().then((function(){a()})).catch((function(){a()}))}("coreVitals",_.bind(null,null))},window.guardian.mustardCut||window.guardian.polyfilled?J():window.guardian.queue.push(J)})();
//# sourceMappingURL=coreVitals.legacy.dcf3d5a67b6cd931a11f.js.map