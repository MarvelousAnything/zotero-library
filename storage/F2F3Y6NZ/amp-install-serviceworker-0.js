;
(self.AMP=self.AMP||[]).push({m:0,v:"2202230359001",n:"amp-install-serviceworker",ev:"0.1",l:!0,f:function(t,r){!function(){function r(t,n){return(r=Object.setPrototypeOf||function(t,r){return t.__proto__=r,t})(t,n)}function n(t){return(n=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,r){if(r&&("object"===e(r)||"function"==typeof r))return r;if(void 0!==r)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}Array.isArray;var o=Object.prototype;function u(t,r){void 0===r&&(r=t.hasAttribute("hidden")),r?t.removeAttribute("hidden"):t.setAttribute("hidden","")}o.hasOwnProperty,o.toString;var c=self.AMP_CONFIG||{},a=("string"==typeof c.thirdPartyFrameRegex?new RegExp(c.thirdPartyFrameRegex):c.thirdPartyFrameRegex)||/^d-\d+\.ampproject\.net$/,s=("string"==typeof c.cdnProxyRegex?new RegExp(c.cdnProxyRegex):c.cdnProxyRegex)||/^https:\/\/([a-zA-Z0-9_-]+\.)?cdn\.ampproject\.org$/;function f(t){if(!self.document||!self.document.head)return null;if(self.location&&s.test(self.location.origin))return null;var r=self.document.head.querySelector('meta[name="'.concat(t,'"]'));return r&&r.getAttribute("content")||null}var l={thirdParty:c.thirdPartyUrl||"https://3p.ampproject.net",thirdPartyFrameHost:c.thirdPartyFrameHost||"ampproject.net",thirdPartyFrameRegex:a,cdn:c.cdnUrl||f("runtime-host")||"https://cdn.ampproject.org",cdnProxyRegex:s,localhostRegex:/^https?:\/\/localhost(:\d+)?$/,errorReporting:c.errorReportingUrl||"https://us-central1-amp-error-reporting.cloudfunctions.net/r",betaErrorReporting:c.betaErrorReportingUrl||"https://us-central1-amp-error-reporting.cloudfunctions.net/r-beta",localDev:c.localDev||!1,trustedViewerHosts:[/(^|\.)google\.(com?|[a-z]{2}|com?\.[a-z]{2}|cat)$/,/(^|\.)gmail\.(com|dev)$/],geoApi:c.geoApiUrl||f("amp-geo-api")},h=/(?:^[#?]?|&)([^=&]+)(?:=([^&]*))?/g;function v(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";try{return decodeURIComponent(t)}catch(t){return r}}function p(t){var r=(t||self).location;return function(t){var r,n=Object.create(null);if(!t)return n;for(;r=h.exec(t);){var e=v(r[1],r[1]),i=r[2]?v(r[2].replace(/\+/g," "),r[2]):"";n[e]=i}return n}(r.originalHash||r.hash)}var d="";function m(t){var r;return d||(d=(null===(r=t.AMP_CONFIG)||void 0===r?void 0:r.v)||"01".concat("2202230359001")),d}function y(t,r){var n=r||p(t);return["1","actions","amp","amp4ads","amp4email"].includes(n.development)||!!t.AMP_DEV_MODE}self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};var b=self.__AMP_LOG;function g(t){return b.user||(b.user=w()),function(t,r){return r&&r.ownerDocument.defaultView!=t}(b.user.win,t)?b.userForEmbed||(b.userForEmbed=w()):b.user}function w(t){return function(t,r){throw new Error("failed to call initLogConstructor")}()}function k(t,r,n,e,i,o,u,c,a,s,f){return t}function R(t,r,n,e,i,o,u,c,a,s,f){return g().assert(t,r,n,e,i,o,u,c,a,s,f)}function S(t,r){return E(t=function(t){return t.__AMP_TOP||(t.__AMP_TOP=t)}(t),r)}function j(t){return t.nodeType?(n=t,r=(n.ownerDocument||n).defaultView,S(r,"ampdoc")).getAmpDoc(t):t;var r,n}function x(t){var r=j(t);return r.isSingleDoc()?r.win:r}function E(t,r){k(P(t,r));var n=function(t){var r=t.__AMP_SERVICES;return r||(r=t.__AMP_SERVICES={}),r}(t)[r];return n.obj||(k(n.ctor),k(n.context),n.obj=new n.ctor(n.context),k(n.obj),n.context=null,n.resolve&&n.resolve(n.obj)),n.obj}function P(t,r){var n=t.__AMP_SERVICES&&t.__AMP_SERVICES[r];return!(!n||!n.ctor)}var A,I=function(t){return"url",P(r=x(j(t)),"url")?E(r,"url"):null;var r};function O(t){var r=t.indexOf("#");return-1==r?t:t.substring(0,r)}new Set(["c","v","a","ad"]);var C="amp-install-serviceworker",D=function(t){!function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&r(t,n)}(a,t);var e,o,c=(e=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=n(e);if(o){var u=n(this).constructor;t=Reflect.construct(r,arguments,u)}else t=r.apply(this,arguments);return i(this,t)});function a(t){var r,n;return(r=c.call(this,t)).rR=null,r.iR=null,r.oR=(n=r.win,S(n,"platform")).isSafari(),r}var s=a.prototype;return s.buildCallback=function(){var t=this,r=this.win;if("serviceWorker"in r.navigator){var n=this.fO(),e=this.element.getAttribute("src");if(n.assertHttpsUrl(e,this.element),!n.isProxyOrigin(e)&&!n.isProxyOrigin(r.location.href)||this.oR)n.parse(r.location.href).origin==n.parse(e).origin?this.uR().then((function(){return function(t,r,n){var e={};return n.hasAttribute("data-scope")&&(e.scope=n.getAttribute("data-scope")),t.navigator.serviceWorker.register(r,e).then((function(r){(function(t){var r=self;return r.__AMP_MODE?r.__AMP_MODE:r.__AMP_MODE=function(t){return{localDev:!1,development:y(t,p(t)),esm:!1,test:!1,rtvVersion:m(t)}}(r)})().development&&g().info(C,"ServiceWorker registration successful with scope: ",r.scope);var e=r.installing;return e?e.addEventListener("statechange",(function(e){"activated"===e.target.state&&T(r,t,n)})):r.active&&T(r,t,n),r}),(function(t){g().error(C,"ServiceWorker registration failed:",t)}))}(t.win,e,t.element)})):this.user().error(C,"Did not install ServiceWorker because it does not match the current origin: "+e);else{var i=this.element.getAttribute("data-iframe-src");if(i){n.assertHttpsUrl(i,this.element);var o=n.parse(i).origin,u=function(t,r){return E(x(j(t)),"documentInfo")}(this.element).get(),c=n.parse(u.sourceUrl),a=n.parse(u.canonicalUrl);R(o==c.origin||o==a.origin,"data-iframe-src (%s) should be a URL on the same origin as the source (%s) or canonical URL (%s) of the AMP-document.",o,c.origin,a.origin),this.rR=i,this.uR().then((function(){return t.cR()}))}}(n.isProxyOrigin(e)||n.isProxyOrigin(r.location.href))&&this.oR&&this.user().error(C,"Did not install ServiceWorker because of safari double keyring caching as it will not have any effect")}else this.aR()},s.uR=function(){return Promise.all([this.loadPromise(this.win),this.getAmpDoc().whenFirstVisible()])},s.cR=function(){var t=this;return this.mutateElement((function(){u(t.element,!1);var r=t.win.document.createElement("iframe");r.setAttribute("sandbox","allow-same-origin allow-scripts"),r.src=t.rR,t.element.appendChild(r)}))},s.aR=function(){if(this.getAmpDoc().isSingleDoc()){var t=this.getAmpDoc(),r=this.win,n=this.fO(),e=n.parse(r.location.href),i=this.element.getAttribute("data-no-service-worker-fallback-url-match"),o=this.element.getAttribute("data-no-service-worker-fallback-shell-url");if(i||o){var u;R(i&&o,'Both, "%s" and "%s" must be specified for url-rewrite',"data-no-service-worker-fallback-url-match","data-no-service-worker-fallback-shell-url"),o=O(o);try{u=new RegExp(i)}catch(t){throw g().createError('Invalid "data-no-service-worker-fallback-url-match" expression',t)}R(n.getSourceOrigin(e)==n.parse(o).origin,'Shell source origin "%s" must be the same as source origin "%s"',o,e.href),this.iR=new F(t,u,o,this.element),n.isSecure(o)&&this.sR(o)}}},s.sR=function(t){var r=this;return this.uR().then((function(){r.mutateElement((function(){return r.fR(t)}))}))},s.fR=function(t){var r=this.win.document.createElement("iframe");r.id="i-amphtml-shell-preload",r.setAttribute("src",t+"#preload"),u(r,!1),r.setAttribute("sandbox","allow-scripts allow-same-origin"),this.loadPromise(r).then((function(){var t,n;null===(n=(t=r).parentElement)||void 0===n||n.removeChild(t)})),this.element.appendChild(r)},s.fO=function(){return I(this.element)},a}(t.BaseElement),F=function(){function t(t,r,n,e){this.win=t.win,this.lR=r,this.hR=n,this.vR=I(e),this.pR=this.vR.parse(n),function(t,r,n,e){!function(t,r,n,e){var i=t,o=n,u=function(){if(void 0!==A)return A;A=!1;try{var t={get capture(){return A=!0,!1}};self.addEventListener("test-options",null,t),self.removeEventListener("test-options",null,t)}catch(t){}return A}();i.addEventListener("click",(function(t){try{return o(t)}catch(t){var r,n;throw null===(r=(n=self).__AMP_REPORT_ERROR)||void 0===r||r.call(n,t),t}}),!!u&&e)}(t,0,n,void 0)}(t.getRootNode(),0,this.Gu.bind(this))}return t.prototype.Gu=function(t){if(!t.defaultPrevented){var r,n=(r=t.target).closest?r.closest("A"):function(t,r,n){var e;for(e=t;e&&void 0!==e;e=e.parentElement)if(r(e))return e;return null}(r,(function(t){return function(t,r){var n=t.matches||t.webkitMatchesSelector||t.mozMatchesSelector||t.msMatchesSelector||t.oMatchesSelector;return!!n&&n.call(t,"A")}(t)}));if(n&&n.href){var e=this.vR.parse(n.href);if(e.origin==this.pR.origin&&e.pathname!=this.pR.pathname&&this.lR.test(e.href)&&!n.getAttribute("i-amphtml-orig-href")){var i=this.win;O(e.href)!=O(i.location.href)&&(n.setAttribute("i-amphtml-orig-href",n.href),n.href=this.hR+"#href="+encodeURIComponent("".concat(e.pathname).concat(e.search).concat(e.hash)))}}}},t}();function T(t,r,n){!function(t,r){if("performance"in t){var n=t.performance.getEntriesByType("resource").filter((function(t){return"script"===t.initiatorType&&t.name.startsWith(l.cdn)})).map((function(t){return t.name})),e=r.active;e.postMessage&&e.postMessage(JSON.stringify({"type":"AMP__FIRST-VISIT-CACHING","payload":n}))}}(r,t),n.hasAttribute("data-prefetch")&&function(t,r){var n,e=r.document,i=[].map.call(e.querySelectorAll("a[data-rel=prefetch]"),(function(t){return t.href}));if((n=e.createElement("link")).relList&&n.relList.supports&&n.relList.supports("prefetch"))i.forEach((function(t){var r=e.createElement("link");r.setAttribute("rel","prefetch"),r.setAttribute("href",t),e.head.appendChild(r)}));else{var o=t.active;o.postMessage&&o.postMessage(JSON.stringify({"type":"AMP__LINK-PREFETCH","payload":i}))}}(t,r)}t.registerElement(C,D)}();
/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */}});
//# sourceMappingURL=amp-install-serviceworker-0.1.js.map