(()=>{"use strict";const e=new Map;var t,n,i,a,r,o,s,c,u=function(e,t){return{name:e,value:void 0===t?-1:t,delta:0,entries:[],id:"v2-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12)}},l=function(e,t){try{if(PerformanceObserver.supportedEntryTypes.includes(e)){if("first-input"===e&&!("PerformanceEventTiming"in self))return;var n=new PerformanceObserver((function(e){return e.getEntries().map(t)}));return n.observe({type:e,buffered:!0}),n}}catch(e){}},d=function(e,t){var n=function n(i){"pagehide"!==i.type&&"hidden"!==document.visibilityState||(e(i),t&&(removeEventListener("visibilitychange",n,!0),removeEventListener("pagehide",n,!0)))};addEventListener("visibilitychange",n,!0),addEventListener("pagehide",n,!0)},f=function(e){addEventListener("pageshow",(function(t){t.persisted&&e(t)}),!0)},m=function(e,t,n){var i;return function(a){t.value>=0&&(a||n)&&(t.delta=t.value-(i||0),(t.delta||void 0===i)&&(i=t.value,e(t)))}},v=-1,p=function(){return"hidden"===document.visibilityState?0:1/0},g=function(){d((function(e){var t=e.timeStamp;v=t}),!0)},w=function(){return v<0&&(v=p(),g(),f((function(){setTimeout((function(){v=p(),g()}),0)}))),{get firstHiddenTime(){return v}}},h=function(e,t){var n,i=w(),a=u("FCP"),r=function(e){"first-contentful-paint"===e.name&&(s&&s.disconnect(),e.startTime<i.firstHiddenTime&&(a.value=e.startTime,a.entries.push(e),n(!0)))},o=window.performance&&performance.getEntriesByName&&performance.getEntriesByName("first-contentful-paint")[0],s=o?null:l("paint",r);(o||s)&&(n=m(e,a,t),o&&r(o),f((function(i){a=u("FCP"),n=m(e,a,t),requestAnimationFrame((function(){requestAnimationFrame((function(){a.value=performance.now()-i.timeStamp,n(!0)}))}))})))},b=!1,y=-1,E={passive:!0,capture:!0},T=new Date,S=function(e,a){t||(t=a,n=e,i=new Date,C(removeEventListener),F())},F=function(){if(n>=0&&n<i-T){var e={entryType:"first-input",name:t.type,target:t.target,cancelable:t.cancelable,startTime:t.timeStamp,processingStart:t.timeStamp+n};a.forEach((function(t){t(e)})),a=[]}},k=function(e){if(e.cancelable){var t=(e.timeStamp>1e12?new Date:performance.now())-e.timeStamp;"pointerdown"==e.type?function(e,t){var n=function(){S(e,t),a()},i=function(){a()},a=function(){removeEventListener("pointerup",n,E),removeEventListener("pointercancel",i,E)};addEventListener("pointerup",n,E),addEventListener("pointercancel",i,E)}(t,e):S(t,e)}},C=function(e){["mousedown","keydown","touchstart","pointerdown"].forEach((function(t){return e(t,k,E)}))},I={},L=function(e,t,n,i,a){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?a.call(e,n):a?a.value=n:t.set(e,n),n},D=function(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)};class M{constructor(e){r.set(this,void 0);try{const t=(new Date).toString();e.setItem(t,t);const n=e.getItem(t)==t;e.removeItem(t),n&&L(this,r,e,"f")}catch(e){}}isAvailable(){return Boolean(D(this,r,"f"))}get(e){try{var t,n;const{value:i,expires:a}=JSON.parse(null!==(t=null===(n=D(this,r,"f"))||void 0===n?void 0:n.getItem(e))&&void 0!==t?t:"");return a&&new Date>new Date(a)?(this.remove(e),null):i}catch(e){return null}}set(e,t,n){var i;return null===(i=D(this,r,"f"))||void 0===i?void 0:i.setItem(e,JSON.stringify({value:t,expires:n}))}remove(e){var t;return null===(t=D(this,r,"f"))||void 0===t?void 0:t.removeItem(e)}clear(){var e;return null===(e=D(this,r,"f"))||void 0===e?void 0:e.clear()}getRaw(e){var t,n;return null!==(t=null===(n=D(this,r,"f"))||void 0===n?void 0:n.getItem(e))&&void 0!==t?t:null}setRaw(e,t){var n;return null===(n=D(this,r,"f"))||void 0===n?void 0:n.setItem(e,t)}}r=new WeakMap;const V=new(c=class{constructor(){o.set(this,void 0),s.set(this,void 0)}get local(){return L(this,o,D(this,o,"f")||new M(localStorage),"f")}get session(){return L(this,s,D(this,s,"f")||new M(sessionStorage),"f")}},o=new WeakMap,s=new WeakMap,c);var P;const W="gu.logger",B={common:{background:"#052962",font:"#ffffff"},commercial:{background:"#77EEAA",font:"#004400"},cmp:{background:"#FF6BB5",font:"#2F0404"},dotcom:{background:"#000000",font:"#ff7300"},design:{background:"#185E36",font:"#FFF4F2"},tx:{background:"#2F4F4F",font:"#FFFFFF"}},O=e=>{const{background:t,font:n}=B[e];return`background: ${t}; color: ${n}; padding: 2px 3px; border-radius:3px`},N=(e,...t)=>{if(!(V.local.get(W)||"").includes(e))return;const n=[O("common"),"",O(e),""];console.log(`%c@guardian%c %c${e}%c`,...n,...t)};var R;"undefined"!=typeof window&&(window.guardian||(window.guardian={}),(P=window.guardian).logger||(P.logger={subscribeTo:e=>{const t=V.local.get(W)?V.local.get(W).split(","):[];t.includes(e)||t.push(e),V.local.set(W,t.join(",")),N(e,"ðŸ”” Subscribed, hello!")},unsubscribeFrom:e=>{N(e,"ðŸ”• Unsubscribed, good-bye!");const t=V.local.get(W).split(",").filter((t=>t!==e));V.local.set(W,t.join(","))},teams:()=>Object.keys(B)})),function(e){e.PROD="https://performance-events.guardianapis.com/core-web-vitals",e.CODE="https://performance-events.code.dev-guardianapis.com/core-web-vitals"}(R||(R={}));const q={browser_id:null,page_view_id:null,fid:null,cls:null,lcp:null,fcp:null,ttfb:null},x=new Set;let A,j=!1;const $=(e,t=6)=>{const n=Math.pow(10,t);return Math.round(e*n)/n};let _=!1;const J=()=>{_||null!==q.fcp&&(_=navigator.sendBeacon(A,JSON.stringify(q)),x.size>0&&x.forEach((e=>{N(e,_?"Core Web Vitals payload successfully queued for transfer":"Failed to queue Core Web Vitals payload for transfer")})))},H=e=>{switch(e.name){case"FCP":q.fcp=$(e.value);break;case"CLS":q.cls=$(e.value);break;case"LCP":q.lcp=$(e.value);break;case"FID":q.fid=$(e.value);break;case"TTFB":q.ttfb=$(e.value)}},z=e=>{switch(e.type){case"visibilitychange":return void("hidden"===document.visibilityState&&J());case"pagehide":return void J()}},U=()=>{!function(e,t){b||(h((function(e){y=e.value})),b=!0);var n,i=function(t){y>-1&&e(t)},a=u("CLS",0),r=0,o=[],s=function(e){if(!e.hadRecentInput){var t=o[0],i=o[o.length-1];r&&e.startTime-i.startTime<1e3&&e.startTime-t.startTime<5e3?(r+=e.value,o.push(e)):(r=e.value,o=[e]),r>a.value&&(a.value=r,a.entries=o,n())}},c=l("layout-shift",s);c&&(n=m(i,a,false),d((function(){c.takeRecords().map(s),n(!0)})),f((function(){r=0,y=-1,a=u("CLS",0),n=m(i,a,false)})))}(H),function(e,i){var r,o=w(),s=u("FID"),c=function(e){e.startTime<o.firstHiddenTime&&(s.value=e.processingStart-e.startTime,s.entries.push(e),r(!0))},v=l("first-input",c);r=m(e,s,i),v&&d((function(){v.takeRecords().map(c),v.disconnect()}),!0),v&&f((function(){var o;s=u("FID"),r=m(e,s,i),a=[],n=-1,t=null,C(addEventListener),o=c,a.push(o),F()}))}(H),function(e,t){var n,i=w(),a=u("LCP"),r=function(e){var t=e.startTime;t<i.firstHiddenTime&&(a.value=t,a.entries.push(e)),n()},o=l("largest-contentful-paint",r);if(o){n=m(e,a,t);var s=function(){I[a.id]||(o.takeRecords().map(r),o.disconnect(),I[a.id]=!0,n(!0))};["keydown","click"].forEach((function(e){addEventListener(e,s,{once:!0,capture:!0})})),d(s,!0),f((function(i){a=u("LCP"),n=m(e,a,t),requestAnimationFrame((function(){requestAnimationFrame((function(){a.value=performance.now()-i.timeStamp,I[a.id]=!0,n(!0)}))}))}))}}(H),h(H),function(e){var t,n=u("TTFB");t=function(){try{var t=performance.getEntriesByType("navigation")[0]||function(){var e=performance.timing,t={entryType:"navigation",startTime:0};for(var n in e)"navigationStart"!==n&&"toJSON"!==n&&(t[n]=Math.max(e[n]-e.navigationStart,0));return t}();if(n.value=n.delta=t.responseStart,n.value<0||n.value>performance.now())return;n.entries=[t],e(n)}catch(e){}},"complete"===document.readyState?setTimeout(t,0):addEventListener("pageshow",t)}(H),addEventListener("visibilitychange",z),addEventListener("pagehide",z)};((e,t,n)=>{const i=()=>{((e,t)=>{const{start:n,end:i}=(e=>{const t=window.performance,n=`${e}-start`,i=`${e}-end`;return t&&t.getEntriesByName?{start:()=>{t.mark(n)},end:()=>{t.mark(i),t.measure(e,n,i),N("dotcom",JSON.stringify(t.getEntriesByName(e)));const a=t.getEntriesByName(e,"measure"),r=a&&a[0]&&a[0].duration||0;return Math.round(r)},clear:()=>{t.clearMarks(n),t.clearMarks(i),t.clearMeasures(e)}}:{start:()=>{},end:()=>0,clear:()=>{}}})(e);n(),t().then((()=>{i()})).catch((()=>{i()}))})("coreVitals",n.bind(null,null))};window.guardian.mustardCut||window.guardian.polyfilled?i():window.guardian.queue.push(i)})(0,0,(()=>{const t=(({name:t,shouldMemoize:n=!1})=>{var i;if(e.has(t))return null!==(i=e.get(t))&&void 0!==i?i:null;const a=(e=>{const t=`${e}=`;return document.cookie.split(";").reduce(((e,n)=>{const i=n.trim();return i.startsWith(t)&&e.push(i.substring(t.length,i.length)),e}),[])})(t);return a.length>0?(n&&e.set(t,a[0]),a[0]):null})({name:"bwid",shouldMemoize:!0}),{pageViewId:n}=window.guardian.config.ophan;var i;return(({browserId:e=null,pageViewId:t=null,sampling:n=.01,isDev:i,team:a})=>{if(j)return void console.warn("initCoreWebVitals already initialised","use the bypassCoreWebVitalsSampling method instead");j=!0,a&&x.add(a),(e=>{A=e?R.CODE:R.PROD})(i),q.browser_id=e,q.page_view_id=t,e&&t||console.warn("browserId or pageViewId missing from Core Web Vitals.","Resulting data cannot be joined to page view tables",{browserId:e,pageViewId:t}),(n<0||n>1)&&console.warn("Core Web Vitals sampling is outside the 0 to 1 range: ",n),0===n&&console.warn("Core Web Vitals are sampled at 0%"),1===n&&console.warn("Core Web Vitals are sampled at 100%");const r=Math.random()<n,o="#bypassCoreWebVitalsSampling"===window.location.hash;(r||o)&&U()})({browserId:t,pageViewId:n,isDev:"m.code.dev-theguardian.com"===window.location.hostname||"localhost"===window.location.hostname||"preview.gutools.co.uk"===window.location.hostname,sampling:.01,team:"dotcom"}),"localhost"===window.location.hostname&&(i="dotcom",j?(x.add(i),U()):console.warn("initCoreWebVitals not yet initialised")),Promise.resolve()}))})();
//# sourceMappingURL=coreVitals.aa2d8b19c87fd18336ca.js.map