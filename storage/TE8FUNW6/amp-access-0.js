;
(self.AMP=self.AMP||[]).push({m:1,v:"2202230359001",n:"amp-access",ev:"0.1",l:!0,f:function(t,i){(()=>{function i(t,i){(null==i||i>t.length)&&(i=t.length);for(var s=0,e=new Array(i);s<i;s++)e[s]=t[s];return e}function s(t,s){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(e)return(e=e.call(t)).next.bind(e);if(Array.isArray(t)||(e=function(t,s){if(t){if("string"==typeof t)return i(t,s);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?i(t,s):void 0}}(t))||s&&t&&"number"==typeof t.length){e&&(t=e);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var e;function n(){return e||(e=Promise.resolve(void 0))}var r=class{constructor(){this.promise=new Promise(((t,i)=>{this.resolve=t,this.reject=i}))}},{isArray:o}=Array;function h(t,i){const s=[];let e=0;for(let n=0;n<t.length;n++){const r=t[n];i(r,n,t)?s.push(r):(e<n&&(t[e]=r),e++)}return e<t.length&&(t.length=e),s}var{hasOwnProperty:c,toString:u}=Object.prototype;function a(t){return"[object Object]"===u.call(t)}function l(t){const i=Object.create(null);return t&&Object.assign(i,t),i}function f(t,i){return c.call(t,i)}function p(t,i){if("."==i)return t;let e=t;for(var n,r=s(i.split("."),!0);!(n=r()).done;){const t=n.value;if(!(t&&e&&void 0!==e[t]&&"object"==typeof e&&f(e,t))){e=void 0;break}e=e[t]}return e}function d(t){return 1==(null==(i=t)?void 0:i.nodeType)?(t=t).tagName.toLowerCase()+(t.id?`#${t.id}`:""):t;var i}function _(t,i,s,e,n,r,o,h,c,u,a){return t}function m(t){return JSON.parse(t)}function A(t,i){try{return m(t)}catch(t){return null==i||i(t),null}}function v(t){return CSS.escape(t)}var P=self.AMP_CONFIG||{},g=("string"==typeof P.thirdPartyFrameRegex?new RegExp(P.thirdPartyFrameRegex):P.thirdPartyFrameRegex)||/^d-\d+\.ampproject\.net$/,b=("string"==typeof P.cdnProxyRegex?new RegExp(P.cdnProxyRegex):P.cdnProxyRegex)||/^https:\/\/([a-zA-Z0-9_-]+\.)?cdn\.ampproject\.org$/;function E(t){if(!self.document||!self.document.head)return null;if(self.location&&b.test(self.location.origin))return null;const i=self.document.head.querySelector(`meta[name="${t}"]`);return i&&i.getAttribute("content")||null}var w={thirdParty:P.thirdPartyUrl||"https://3p.ampproject.net",thirdPartyFrameHost:P.thirdPartyFrameHost||"ampproject.net",thirdPartyFrameRegex:g,cdn:P.cdnUrl||E("runtime-host")||"https://cdn.ampproject.org",cdnProxyRegex:b,localhostRegex:/^https?:\/\/localhost(:\d+)?$/,errorReporting:P.errorReportingUrl||"https://us-central1-amp-error-reporting.cloudfunctions.net/r",betaErrorReporting:P.betaErrorReportingUrl||"https://us-central1-amp-error-reporting.cloudfunctions.net/r-beta",localDev:P.localDev||!1,trustedViewerHosts:[/(^|\.)google\.(com?|[a-z]{2}|com?\.[a-z]{2}|cat)$/,/(^|\.)gmail\.(com|dev)$/],geoApi:P.geoApiUrl||E("amp-geo-api")},R=/(?:^[#?]?|&)([^=&]+)(?:=([^&]*))?/g;function y(t,i=""){try{return decodeURIComponent(t)}catch(t){return i}}function T(t){const i=l();if(!t)return i;let s;for(;s=R.exec(t);){const t=y(s[1],s[1]),e=s[2]?y(s[2].replace(/\+/g," "),s[2]):"";i[t]=e}return i}self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};var I=self.__AMP_LOG;function M(t,i){throw new Error("failed to call initLogConstructor")}function V(t){return I.user||(I.user=S()),function(t,i){return i&&i.ownerDocument.defaultView!=t}(I.user.win,t)?I.userForEmbed||(I.userForEmbed=S()):I.user}function S(t){return M()}function k(){return I.dev||(I.dev=M())}function O(t,i,s,e,n,r,o,h,c,u,a){return t}function U(t,i,s,e,n,r,o,h,c,u,a){return V().assert(t,i,s,e,n,r,o,h,c,u,a)}function x(t,i){return F(t=N(t),i)}function j(t,i){return F(D($(t)),i)}function C(t,i){const s=D($(t));return K(s,i)?F(s,i):null}function z(t,i){return function(t,i){const s=G(t,i);if(s)return s;const e=J(t);return e[i]=function(){const t=new r,{promise:i,reject:s,resolve:e}=t;return i.catch((()=>{})),{obj:null,promise:i,resolve:e,reject:s,context:null,ctor:null}}(),e[i].promise}(D(t),i)}function L(t,i){return G(D(t),i)}function N(t){return t.__AMP_TOP||(t.__AMP_TOP=t)}function $(t){return t.nodeType?(i=t,s=(i.ownerDocument||i).defaultView,x(s,"ampdoc")).getAmpDoc(t):t;var i,s}function D(t){const i=$(t);return i.isSingleDoc()?i.win:i}function F(t,i){O(K(t,i));const s=J(t)[i];return s.obj||(O(s.ctor),O(s.context),s.obj=new s.ctor(s.context),O(s.obj),s.context=null,s.resolve&&s.resolve(s.obj)),s.obj}function G(t,i){const s=J(t)[i];return s?s.promise?s.promise:(F(t,i),s.promise=Promise.resolve(s.obj)):null}function J(t){let i=t.__AMP_SERVICES;return i||(i=t.__AMP_SERVICES={}),i}function K(t,i){const s=t.__AMP_SERVICES&&t.__AMP_SERVICES[i];return!(!s||!s.ctor)}var H,q=t=>x(t,"ampdoc"),Q=t=>function(t,i,s,e){const n=L(t,i);if(n)return n;const r=$(t);return r.whenExtensionsKnown().then((()=>{const t=r.getExtensionVersion(s);return t?x(r.win,"extensions").waitForExtension(s,t):null})).then((s=>s?e?L(t,i):z(t,i):null))}(t,"amp-analytics-instrumentation","amp-analytics"),W=t=>{return s="performance",K(i=N(i=t),s)?F(i,s):null;var i,s},B=t=>F(t,"timer"),Z=t=>j(t,"viewer"),X=t=>x(t,"vsync"),Y=t=>x(t,"xhr");function tt(t,i,s={},e=!0){Q(t).then((n=>{n&&n.triggerEventForTarget(t,i,s,e)}))}function it(t,i,s,e){let n=t,r=s,o=t=>{try{return r(t)}catch(t){var i,s;throw null===(i=(s=self).__AMP_REPORT_ERROR)||void 0===i||i.call(s,t),t}};const h=function(){if(void 0!==H)return H;H=!1;try{const t={get capture(){return H=!0,!1}};self.addEventListener("test-options",null,t),self.removeEventListener("test-options",null,t)}catch(t){}return H}(),c=!(null==e||!e.capture);return n.addEventListener(i,o,h?e:c),()=>{null==n||n.removeEventListener(i,o,h?e:c),r=null,n=null,o=null}}function st(t){return t.data}var et=function(){var t=function(t,i,s,e){for(s=s||{},e=t.length;e--;s[t[e]]=i);return s},i=[1,3],s=[1,4],e=[1,18],n=[1,19],r=[1,14],o=[1,15],h=[1,16],c=[1,17],u=[1,21],a=[1,22],l=[5,6,7,10],f=[5,6,7,10,15,16,17,18,19,20,21],p=[5,6,7,10,15,16,17,18,19,20,21,25,27],d={trace:function(){},yy:{},PS:{"error":2,"result":3,"search_condition":4,"EOF":5,"OR":6,"AND":7,"NOT":8,"(":9,")":10,"predicate":11,"comparison_predicate":12,"truthy_predicate":13,"scalar_exp":14,"EQ":15,"DEQ":16,"NEQ":17,"LT":18,"LTE":19,"GT":20,"GTE":21,"atom":22,"field_ref":23,"literal":24,"DOT":25,"field_name":26,"[":27,"string":28,"]":29,"NAME":30,"STRING":31,"NUMERIC":32,"TRUE":33,"FALSE":34,"NULL":35,"$accept":0,"$end":1},gS:{2:"error",5:"EOF",6:"OR",7:"AND",8:"NOT",9:"(",10:")",15:"EQ",16:"DEQ",17:"NEQ",18:"LT",19:"LTE",20:"GT",21:"GTE",25:"DOT",27:"[",29:"]",30:"NAME",31:"STRING",32:"NUMERIC",33:"TRUE",34:"FALSE",35:"NULL"},SS:[0,[3,2],[4,3],[4,3],[4,2],[4,3],[4,1],[11,1],[11,1],[12,3],[12,3],[12,3],[12,3],[12,3],[12,3],[12,3],[13,1],[14,1],[14,1],[22,1],[23,3],[23,4],[23,1],[26,1],[28,1],[24,1],[24,1],[24,1],[24,1],[24,1]],performAction:function(t,i,s,e,n,r,o){var h=r.length-1;switch(n){case 1:return r[h-1];case 2:this.$=r[h-2]||r[h];break;case 3:this.$=r[h-2]&&r[h];break;case 4:this.$=!r[h];break;case 5:this.$=r[h-1];break;case 6:case 7:case 8:case 17:case 18:case 19:this.$=r[h];break;case 9:this.$=r[h-2]===r[h];break;case 10:throw new Error('"==" is not allowed, use "="');case 11:this.$=r[h-2]!==r[h];break;case 12:this.$=typeof r[h-2]==typeof r[h]&&r[h-2]<r[h];break;case 13:this.$=typeof r[h-2]==typeof r[h]&&r[h-2]<=r[h];break;case 14:this.$=typeof r[h-2]==typeof r[h]&&r[h-2]>r[h];break;case 15:this.$=typeof r[h-2]==typeof r[h]&&r[h-2]>=r[h];break;case 16:this.$=void 0!==r[h]&&null!==r[h]&&""!==r[h]&&0!==r[h]&&!1!==r[h];break;case 20:this.$="[object Object]"==Object.prototype.toString.call(r[h-2])&&r[h-2].hasOwnProperty(r[h])?r[h-2][r[h]]:null;break;case 21:this.$="[object Object]"==Object.prototype.toString.call(r[h-3])&&r[h-3].hasOwnProperty(r[h-1])?r[h-3][r[h-1]]:null;break;case 22:this.$=void 0!==e[r[h]]?e[r[h]]:null;break;case 23:this.$=t;break;case 24:this.$=t.substring(1,t.length-1);break;case 26:this.$=Number(t);break;case 27:this.$=!0;break;case 28:this.$=!1;break;case 29:this.$=null}},table:[{3:1,4:2,8:i,9:s,11:5,12:6,13:7,14:8,22:9,23:10,24:11,26:12,28:13,30:e,31:n,32:r,33:o,34:h,35:c},{1:[3]},{5:[1,20],6:u,7:a},{4:23,8:i,9:s,11:5,12:6,13:7,14:8,22:9,23:10,24:11,26:12,28:13,30:e,31:n,32:r,33:o,34:h,35:c},{4:24,8:i,9:s,11:5,12:6,13:7,14:8,22:9,23:10,24:11,26:12,28:13,30:e,31:n,32:r,33:o,34:h,35:c},t(l,[2,6]),t(l,[2,7]),t(l,[2,8]),t(l,[2,16],{15:[1,25],16:[1,26],17:[1,27],18:[1,28],19:[1,29],20:[1,30],21:[1,31]}),t(f,[2,17]),t(f,[2,18],{25:[1,32],27:[1,33]}),t(f,[2,19]),t(p,[2,22]),t(f,[2,25]),t(f,[2,26]),t(f,[2,27]),t(f,[2,28]),t(f,[2,29]),t(p,[2,23]),t([5,6,7,10,15,16,17,18,19,20,21,29],[2,24]),{1:[2,1]},{4:34,8:i,9:s,11:5,12:6,13:7,14:8,22:9,23:10,24:11,26:12,28:13,30:e,31:n,32:r,33:o,34:h,35:c},{4:35,8:i,9:s,11:5,12:6,13:7,14:8,22:9,23:10,24:11,26:12,28:13,30:e,31:n,32:r,33:o,34:h,35:c},t(l,[2,4]),{6:u,7:a,10:[1,36]},{14:37,22:9,23:10,24:11,26:12,28:13,30:e,31:n,32:r,33:o,34:h,35:c},{14:38,22:9,23:10,24:11,26:12,28:13,30:e,31:n,32:r,33:o,34:h,35:c},{14:39,22:9,23:10,24:11,26:12,28:13,30:e,31:n,32:r,33:o,34:h,35:c},{14:40,22:9,23:10,24:11,26:12,28:13,30:e,31:n,32:r,33:o,34:h,35:c},{14:41,22:9,23:10,24:11,26:12,28:13,30:e,31:n,32:r,33:o,34:h,35:c},{14:42,22:9,23:10,24:11,26:12,28:13,30:e,31:n,32:r,33:o,34:h,35:c},{14:43,22:9,23:10,24:11,26:12,28:13,30:e,31:n,32:r,33:o,34:h,35:c},{26:44,30:e},{28:45,31:n},t([5,6,10],[2,2],{7:a}),t(l,[2,3]),t(l,[2,5]),t(l,[2,9]),t(l,[2,10]),t(l,[2,11]),t(l,[2,12]),t(l,[2,13]),t(l,[2,14]),t(l,[2,15]),t(p,[2,20]),{29:[1,46]},t(p,[2,21])],defaultActions:{20:[2,1]},parseError:function(t,i){if(!i.recoverable){var s=new Error(t);throw s.hash=i,s}this.trace(t)},parse:function(t){var i=this,s=[0],e=[null],n=[],r=this.table,o="",h=0,c=0,u=0,a=2,l=1,f=n.slice.call(arguments,1),p=Object.create(this.lexer),d={yy:{}};for(var _ in this.yy)Object.prototype.hasOwnProperty.call(this.yy,_)&&(d.yy[_]=this.yy[_]);p.setInput(t,d.yy),d.yy.lexer=p,d.yy.parser=this,void 0===p.yylloc&&(p.yylloc={});var m=p.yylloc;n.push(m);var A=p.options&&p.options.ranges;"function"==typeof d.yy.parseError?this.parseError=d.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var v,P,g,b,E,w,R,y,T,I=function(){var t;return"number"!=typeof(t=p.lex()||l)&&(t=i.PS[t]||t),t},M={};;){if(g=s[s.length-1],this.defaultActions[g]?b=this.defaultActions[g]:(null==v&&(v=I()),b=r[g]&&r[g][v]),void 0===b||!b.length||!b[0]){var V="";for(w in T=[],r[g])this.gS[w]&&w>a&&T.push("'"+this.gS[w]+"'");V=p.showPosition?"Parse error on line "+(h+1)+":\n"+p.showPosition()+"\nExpecting "+T.join(", ")+", got '"+(this.gS[v]||v)+"'":"Parse error on line "+(h+1)+": Unexpected "+(v==l?"end of input":"'"+(this.gS[v]||v)+"'"),this.parseError(V,{text:p.match,token:this.gS[v]||v,line:p.yylineno,loc:m,expected:T})}if(b[0]instanceof Array&&b.length>1)throw new Error("Parse Error: multiple actions possible at state: "+g+", token: "+v);switch(b[0]){case 1:s.push(v),e.push(p.yytext),n.push(p.yylloc),s.push(b[1]),v=null,P?(v=P,P=null):(c=p.yyleng,o=p.yytext,h=p.yylineno,m=p.yylloc,u>0&&u--);break;case 2:if(R=this.SS[b[1]][1],M.$=e[e.length-R],M._$={first_line:n[n.length-(R||1)].first_line,last_line:n[n.length-1].last_line,first_column:n[n.length-(R||1)].first_column,last_column:n[n.length-1].last_column},A&&(M._$.range=[n[n.length-(R||1)].range[0],n[n.length-1].range[1]]),void 0!==(E=this.performAction.apply(M,[o,c,h,d.yy,b[1],e,n].concat(f))))return E;R&&(s=s.slice(0,-1*R*2),e=e.slice(0,-1*R),n=n.slice(0,-1*R)),s.push(this.SS[b[1]][0]),e.push(M.$),n.push(M._$),y=r[s[s.length-2]][s[s.length-1]],s.push(y);break;case 3:return!0}}return!0}},_={EOF:1,parseError:function(t,i){if(!this.yy.parser)throw new Error(t);this.yy.parser.parseError(t,i)},setInput:function(t,i){return this.yy=i||this.yy||{},this._input=t,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var t=this._input[0];return this.yytext+=t,this.yyleng++,this.offset++,this.match+=t,this.matched+=t,t.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),t},unput:function(t){var i=t.length,s=t.split(/(?:\r\n?|\n)/g);this._input=t+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-i),this.offset-=i;var e=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),s.length-1&&(this.yylineno-=s.length-1);var n=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:s?(s.length===e.length?this.yylloc.first_column:0)+e[e.length-s.length].length-s[0].length:this.yylloc.first_column-i},this.options.ranges&&(this.yylloc.range=[n[0],n[0]+this.yyleng-i]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},less:function(t){this.unput(this.match.slice(t))},pastInput:function(){var t=this.matched.substr(0,this.matched.length-this.match.length);return(t.length>20?"...":"")+t.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var t=this.match;return t.length<20&&(t+=this._input.substr(0,20-t.length)),(t.substr(0,20)+(t.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var t=this.pastInput(),i=new Array(t.length+1).join("-");return t+this.upcomingInput()+"\n"+i+"^"},test_match:function(t,i){var s,e,n;if(this.options.backtrack_lexer&&(n={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(n.yylloc.range=this.yylloc.range.slice(0))),(e=t[0].match(/(?:\r\n?|\n).*/g))&&(this.yylineno+=e.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:e?e[e.length-1].length-e[e.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+t[0].length},this.yytext+=t[0],this.match+=t[0],this.matches=t,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(t[0].length),this.matched+=t[0],s=this.performAction.call(this,this.yy,this,i,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),s)return s;if(this._backtrack){for(var r in n)this[r]=n[r];return!1}return!1},next:function(){if(this.done)return this.EOF;var t,i,s,e;this._input||(this.done=!0),this._more||(this.yytext="",this.match="");for(var n=this._currentRules(),r=0;r<n.length;r++)if((s=this._input.match(this.rules[n[r]]))&&(!i||s[0].length>i[0].length)){if(i=s,e=r,this.options.backtrack_lexer){if(!1!==(t=this.test_match(s,n[r])))return t;if(this._backtrack){i=!1;continue}return!1}if(!this.options.flex)break}return i?!1!==(t=this.test_match(i,n[e]))&&t:""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){return this.next()||this.lex()},begin:function(t){this.conditionStack.push(t)},popState:function(){return this.conditionStack.length-1>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(t){return(t=this.conditionStack.length-1-Math.abs(t||0))>=0?this.conditionStack[t]:"INITIAL"},pushState:function(t){this.begin(t)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(t,i,s,e){switch(s){case 0:break;case 1:return 7;case 2:return 6;case 3:return 8;case 4:return 35;case 5:case 6:return 33;case 7:case 8:return 34;case 9:return 9;case 10:return 10;case 11:return 27;case 12:return 29;case 13:return"|";case 14:return 19;case 15:return 18;case 16:return 21;case 17:return 20;case 18:return 17;case 19:return 16;case 20:return 15;case 21:return 32;case 22:return 30;case 23:case 24:return 31;case 25:return 25;case 26:return"INVALID";case 27:return 5}},rules:[/^(?:\s+)/,/^(?:AND\b)/,/^(?:OR\b)/,/^(?:NOT\b)/,/^(?:NULL\b)/,/^(?:TRUE\b)/,/^(?:true\b)/,/^(?:FALSE\b)/,/^(?:false\b)/,/^(?:\()/,/^(?:\))/,/^(?:\[)/,/^(?:\])/,/^(?:\|)/,/^(?:<=)/,/^(?:<)/,/^(?:>=)/,/^(?:>)/,/^(?:!=)/,/^(?:==)/,/^(?:=)/,/^(?:-?[0-9]+(\.[0-9]+)?\b)/,/^(?:[a-zA-Z_][a-zA-Z0-9_]*)/,/^(?:'[^\']*')/,/^(?:"[^\"]*")/,/^(?:\.)/,/^(?:.)/,/^(?:$)/],conditions:{"INITIAL":{"rules":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27],"inclusive":!0}}};function m(){this.yy={}}return d.lexer=_,m.prototype=d,d.Parser=m,new m}(),nt=et;function rt(t,i,s){return i in t?Object.defineProperty(t,i,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[i]=s,t}function ot(t,i){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(t);i&&(e=e.filter((function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable}))),s.push.apply(s,e)}return s}function ht(t){for(var i=1;i<arguments.length;i++){var s=null!=arguments[i]?arguments[i]:{};i%2?ot(Object(s),!0).forEach((function(i){rt(t,i,s[i])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):ot(Object(s)).forEach((function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(s,i))}))}return t}var ct="__AMP__EXPERIMENT_TOGGLES";function ut(t,i){const e=function(t){var i,e,n,r,h;if(t[ct])return t[ct];t[ct]=l();const c=t[ct];_(c);const u=ht(ht({},null!==(i=t.AMP_CONFIG)&&void 0!==i?i:{}),null!==(e=t.AMP_EXP)&&void 0!==e?e:m((null===(n=t.__AMP_EXP)||void 0===n?void 0:n.textContent)||"{}"));for(const t in u){const i=u[t];"number"==typeof i&&i>=0&&i<=1&&(c[t]=Math.random()<i)}const a=null===(r=t.AMP_CONFIG)||void 0===r?void 0:r["allow-doc-opt-in"];if(o(a)&&a.length){const i=t.document.head.querySelector('meta[name="amp-experiments-opt-in"]');if(i)for(var f,p,d=s((null===(f=i.getAttribute("content"))||void 0===f?void 0:f.split(","))||[],!0);!(p=d()).done;){const t=p.value;a.includes(t)&&(c[t]=!0)}}Object.assign(c,function(t){var i;let e="";try{var n;"localStorage"in t&&(e=null!==(n=t.localStorage.getItem("amp-experiment-toggles"))&&void 0!==n?n:"")}catch(t){}const r=(null===(i=e)||void 0===i?void 0:i.split(/\s*,\s*/g))||[],o=l();for(var h,c=s(r,!0);!(h=c()).done;){const t=h.value;t&&("-"==t[0]?o[t.substr(1)]=!1:o[t]=!0)}return o}(t));const A=null===(h=t.AMP_CONFIG)||void 0===h?void 0:h["allow-url-opt-in"];if(o(A)&&A.length){const i=T(t.location.originalHash||t.location.hash);for(var v,P=s(A,!0);!(v=P()).done;){const t=v.value,s=i[`e-${t}`];"1"==s&&(c[t]=!0),"0"==s&&(c[t]=!1)}}return c}(t);return!!e[i]}var at,lt=new Set(["c","v","a","ad"]),ft=t=>"string"==typeof t?pt(t):t;function pt(t,i){return at||(at=self.document.createElement("a")),function(t,i,s){return t.href="",new URL(i,t.href)}(at,t)}function dt(t,i){return`${encodeURIComponent(t)}=${encodeURIComponent(i)}`}function _t(t,i,s="source"){var e;return U(null!=t,"%s %s must be available",i,s),U("https:"==(e=ft(e=t)).protocol||"localhost"==e.hostname||"127.0.0.1"==e.hostname||function(t,i){const s=t.length-i.length;return s>=0&&t.indexOf(i,s)==s}(e.hostname,".localhost")||/^\/\//.test(t),'%s %s must start with "https://" or "//" or be relative and served from either https or from localhost. Invalid value: %s',i,s,t),t}function mt(t){const i=t.indexOf("#");return-1==i?t:t.substring(0,i)}function At(t){return w.cdnProxyRegex.test(ft(t).origin)}function vt(t){return pt(function(t){if(!At(t=ft(t)))return t.href;const i=t.pathname.split("/"),s=i[1];U(lt.has(s),"Unknown path prefix in url %s",t.href);const e=i[2],n="s"==e?"https://"+decodeURIComponent(i[3]):"http://"+decodeURIComponent(e);return U(n.indexOf(".")>0,"Expected a . in origin %s",n),i.splice(1,"s"==e?3:2),n+i.join("/")+function(t,i){if(!t||"?"==t)return"";const s=new RegExp("[?&](amp_(js[^&=]*|gsa|r|kit)|usqp)\\b[^&]*","g"),e=t.replace(s,"").replace(/^[?&]/,"");return e?"?"+e:""}(t.search)+(t.hash||"")}(t)).origin}var Pt=class{constructor(t,i,s){this.ampdoc=t,this.Yt=s,this.$ft=U(i.authorization,'"authorization" URL must be specified'),_t(this.$ft,'"authorization"'),this.zft=!i.noPingback,this.Sft=i.pingback,this.zft&&(U(this.Sft,'"pingback" URL must be specified'),_t(this.Sft,'"pingback"')),this.jft=this.Nft(i),this.sR=Y(t.win),this.Tr=B(t.win)}Nft(t){if(!t.authorizationTimeout)return 3e3;let i=t.authorizationTimeout;return U("number"==typeof i,'"authorizationTimeout" must be a number'),i=Math.min(i,3e3),i}getConfig(){return{"authorizationUrl":this.$ft,"pingbackEnabled":this.zft,"pingbackUrl":this.Sft,"authorizationTimeout":this.jft}}getAuthorizationUrl(){return this.$ft}isAuthorizationEnabled(){return!0}getAuthorizationTimeout(){return this.jft}authorize(){return this.Yt.buildUrl(this.$ft,!1).then((t=>this.Tr.timeoutPromise(this.jft,this.sR.fetchJson(t,{credentials:"include"})).then((t=>t.json()))))}isPingbackEnabled(){return this.zft}pingback(){return this.Yt.buildUrl(O(this.Sft),!0).then((t=>this.sR.sendSignal(t,{method:"POST",credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:""})))}postAction(){}},gt="__AMP__",bt="amp-access-iframe",Et=["GET","POST"];function wt(t,i){const s=ht({},i);if((e=i.body)&&"function"==typeof e.getFormData){const t=i.body;s.headers["Content-Type"]="multipart/form-data;charset=utf-8",s.body=function(t){const i=[];for(let s=t.next();!s.done;s=t.next())i.push(s.value);return i}(t.entries())}var e;return{input:t,init:s}}function Rt(t,i,s){let e=function(t,i){const s=t||{},e=s.credentials;return _(void 0===e||"include"==e||"omit"==e),s.method=void 0===(n=s.method)?"GET":(n=n.toUpperCase(),_(Et.includes(n)),n),s.headers=s.headers||{},s.headers.Accept=i,_(null!==s.body),s;var n}(s,"text/html");e=function(t,i,s){s=s||{};const e=function(t){return t.origin||pt(t.location.href).origin}(t);return e==pt(i).origin&&(s.headers=s.headers||{},s.headers["AMP-Same-Origin"]="true"),s}(t,i,e),i=function(t,i,s){return _("string"==typeof i),!1!==s.ampCors&&(i=function(t,i){return function(t){U(!("__amp_source_origin"in T(pt(t).search)),"Source origin is not allowed in %s",t)}(i),function(t,i,s,e){return function(t,i,s){if(!i)return t;const e=t.split("#",2),n=e[0].split("?",2);let r=n[0]+(n[1]?`?${n[1]}&${i}`:`?${i}`);return r+=e[1]?`#${e[1]}`:"",r}(t,dt("__amp_source_origin",s))}(i,0,vt(t.location.href))}(t,i)),i}(t,i,e);const r=q(t),c=r.isSingleDoc()?r.getSingleDoc():null;return e.responseType="document",function(t,i,s,e){if(!i)return n();const r=e.prerenderSafe?n():i.whenFirstVisible(),c=Z(i),u=At(s),f=c.hasCapability("xhrInterceptor"),p=e.bypassInterceptorForDev&&!1;return u||!f||p?r:i.getRootNode().documentElement.hasAttribute("allow-xhr-interception")?r.then((()=>c.isTrustedViewer())).then((i=>{if(!i&&!ut(t,"untrusted-xhr-interception"))return;const n={"originalRequest":wt(s,e)};return c.sendMessageAwaitResponse("xhr",n).then((t=>function(t,i){if(function(t,i,s="Assertion failed",e){var n,r;if(i)return i;t&&-1==s.indexOf(t)&&(s+=t);let o=3;const c=s.split("%s");let u=c.shift();const a=[u];for(;c.length;){const t=arguments[o++],i=c.shift();u+=d(t)+i,a.push(t,i.trim())}const l=new Error(u);throw l.messageArray=h(a,(t=>""!==t)),null===(n=(r=self).__AMP_REPORT_ERROR)||void 0===n||n.call(r,l),l}("​​​",a(t),"Object expected: %s",t,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0),"document"!=i)return new Response(t.body,t.init);const s=l(),e={status:200,statusText:"OK",getResponseHeader:t=>s[String(t).toLowerCase()]||null};if(t.init){const i=t.init;o(i.headers)&&i.headers.forEach((t=>{const i=t[0],e=t[1];s[String(i).toLowerCase()]=String(e)})),i.status&&(e.status=parseInt(i.status,10)),i.statusText&&(e.statusText=String(i.statusText))}return new Response(t.body?String(t.body):"",e)}(t,e.responseType)))})):r}(t,c,i,e).then((t=>t?t.text().then((t=>(new DOMParser).parseFromString(t,"text/html"))):function(t,i){return new Promise(((s,e)=>{const n=new XMLHttpRequest;n.open(i.method||"GET",t,!0),n.withCredentials="include"==i.credentials,n.responseType="document";for(const t in i.headers)n.setRequestHeader(t,i.headers[t]);n.onreadystatechange=()=>{if(!(n.readyState<2)){if(n.status<100||n.status>599)return n.onreadystatechange=null,void e(V().createExpectedError(`Unknown HTTP status ${n.status}`));if(4==n.readyState){const i={status:n.status,statusText:n.statusText,headers:yt(n.getAllResponseHeaders())},e=(t=new Response("",i),new Promise((i=>{if(t.ok)return i(t);const{status:s}=t,e=V().createError(`HTTP error ${s}`);throw e.retriable=function(t){return 415==t||t>=500&&t<600}(s),e.response=t,e}))).then((t=>({response:t,xhr:n})));s(e)}}var t},n.onerror=()=>{e(V().createExpectedError("Request failure"))},n.onabort=()=>{e(V().createExpectedError("Request aborted"))},"POST"==i.method?n.send(i.body):n.send()}))}(i,e).then((t=>{const{xhr:i}=t;return i.responseXML}))))}function yt(t){const i={};return t.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(t){const s=t.split(":"),e=s.shift().trim();if(e){const t=s.join(":").trim();i[e]=t}})),i}function Tt(t){if("undefined"!=typeof TextDecoder)return new TextDecoder("utf-8").decode(t);const i=function(t){const i=new Array(t.length);for(let s=0;s<t.length;s++)i[s]=String.fromCharCode(t[s]);return i.join("")}(new Uint8Array(t.buffer||t));return decodeURIComponent(escape(i))}function It(t){const i=new Uint8Array(t.length);for(let s=0;s<t.length;s++){const e=t.charCodeAt(s);_(e<=255),i[s]=e}return i}var Mt={"-":"+","_":"/",".":"="};function Vt(t){return It(atob(t.replace(/[-_.]/g,(t=>Mt[t]))))}var St="ampproject.org",kt=class{constructor(t,i,s){this.ampdoc=t,this.Yt=s,this.t_t=new Pt(t,i,s),this.sR=Y(t.win),this.Tr=B(t.win),this.jc=X(t.win),this.i_t=t.getMetaByName("i-amphtml-access-state");const e=ut(t.win,"amp-access-server-jwt");this.bf=At(t.win.location)||e;const n=e?t.getParam("serverAccessService"):null;this.bw=n||mt(t.win.location.href),this.hw=i.publicKey||null,this.s_t=i.publicKeyUrl||null,U(this.hw||this.s_t,'"publicKey" or "publicKeyUrl" must be specified'),this.s_t&&_t(this.s_t,'"publicKeyUrl"'),this.hw&&this.s_t,this.e_t=new class{constructor(t){this.win=t,this.n_t=t.crypto&&(t.crypto.subtle||t.crypto.webkitSubtle)||null}decode(t){return this.r_t(t).payload}isVerificationSupported(){return!!this.n_t}decodeAndVerify(t,i){if(!this.n_t)throw new Error("Crypto is not supported on this platform");return new Promise((i=>i(this.r_t(t)))).then((t=>{const s=t.header.alg;if(!s||"RS256"!=s)throw new Error("Only alg=RS256 is supported");return this.o_t(i).then((i=>{const s=Vt(t.sig);return this.n_t.verify({name:"RSASSA-PKCS1-v1_5"},i,s,It(t.verifiable))})).then((i=>{if(i)return t.payload;throw new Error("Signature verification failed")}))}))}r_t(t){function i(){throw new Error(`Invalid token: "${t}"`)}const s=t.split(".");3!=s.length&&i();const e=Vt(s[0]),n=Vt(s[1]);return{header:A(Tt(e),i),payload:A(Tt(n),i),verifiable:`${s[0]}.${s[1]}`,sig:s[2]}}o_t(t){return t.then((t=>this.n_t.importKey("spki",function(t){const i=t.trim().replace(/^-+BEGIN[^-]*-+/,"").replace(/-+END[^-]*-+$/,"").replace(/[\r\n]/g,"").trim();return It(atob(i))}(t),{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"])))}}(t.win)}getConfig(){return{"client":this.t_t.getConfig(),"proxy":this.bf,"serverState":this.i_t,"publicKey":this.hw,"publicKeyUrl":this.s_t}}isAuthorizationEnabled(){return!0}authorize(){return this.bf&&this.i_t?this.h_t():this.c_t()}isPingbackEnabled(){return this.t_t.isPingbackEnabled()}pingback(){return this.t_t.pingback()}postAction(){}u_t(){let t=this.Yt.buildUrl(this.t_t.getAuthorizationUrl(),!1).then((t=>this.Tr.timeoutPromise(3e3,this.sR.fetchText(t,{credentials:"include"})))).then((t=>t.text())).then((t=>{const i=this.e_t.decode(t);return U(i.amp_authdata,'"amp_authdata" must be present in JWT'),{encoded:t,jwt:i}}));return this.a_t()&&(this.e_t.isVerificationSupported()&&(t=t.then((t=>this.e_t.decodeAndVerify(t.encoded,this.l_t()).then((()=>t))))),t=t.then((t=>(this.f_t(t.jwt),t)))),t.catch((t=>{throw V().createError("JWT fetch or validation failed: ",t)}))}l_t(){return this.hw?Promise.resolve(this.hw):this.sR.fetchText(this.s_t).then((t=>t.text()))}a_t(){return!1}f_t(t){const i=Date.now(),s=t.exp;U(s,'"exp" field must be specified'),U(1e3*parseFloat(s)>i,"token has expired: %s",s);const e=t.aud;U(e,'"aud" field must be specified');let n=!1;if(o(e)){for(let t=0;t<e.length;t++)if(e[t]==St){n=!0;break}}else n=e==St;U(n,'"aud" must be "%s": %s',St,e)}c_t(){return this.u_t().then((t=>t.jwt.amp_authdata))}h_t(){return this.u_t().then((t=>{const{encoded:i,jwt:s}=t,e=s.amp_authdata,n=function(t){const i=[];for(const e in t){let n=t[e];if(null!=n){n=o(s=n)?s:[s];for(let t=0;t<n.length;t++)i.push(dt(e,n[t]))}}var s;return i.join("&")}({"url":mt(this.ampdoc.win.location.href),"state":this.i_t,"jwt":i});return this.Tr.timeoutPromise(3e3,Rt(this.ampdoc.win,this.bw,{method:"POST",body:n,headers:{"Content-Type":"application/x-www-form-urlencoded"}})).then((t=>this.p_t(t))).then((()=>e))}))}p_t(t){const i=t.querySelectorAll("[i-amphtml-access-id]");return this.jc.mutatePromise((()=>{for(let t=0;t<i.length;t++){const s=i[t],e=s.getAttribute("i-amphtml-access-id"),n=this.ampdoc.getRootNode().querySelector(`[i-amphtml-access-id="${v(e)}"]`);n&&n.parentElement.replaceChild(this.ampdoc.win.document.importNode(s,!0),n)}}))}};function Ot(t,i,s,e){let n;try{n=t.open(i,s,e)}catch(t){k().error("DOM","Failed to open url on target: ",s,t)}var r,o;return!n&&"_top"!=s&&("number"!=typeof o&&(o=0),o+"noopener".length>(r=e||"").length||-1===r.indexOf("noopener",o))&&(n=t.open(i,"_top")),n}var Ut=new RegExp("RETURN_URL");function xt(t,i){const s=Z(t);return parseInt(t.getParam("dialog"),10)?new Ct(s,i):new zt(t.win,s,i)}function jt(t,i){return xt(t,i).open()}var Ct=class{constructor(t,i){this.viewer=t,this.urlOrPromise=i}getLoginUrl(){let t;return t="string"==typeof this.urlOrPromise?Promise.resolve(this.urlOrPromise):this.urlOrPromise,t.then((t=>Lt(t,"RETURN_URL")))}open(){return this.getLoginUrl().then((t=>this.viewer.sendMessageAwaitResponse("openDialog",{"url":t})))}},zt=class{constructor(t,i,s){this.win=t,this.viewer=i,this.urlOrPromise=s,this.Sn=null,this.Du=null,this.d_t=null,this.__t=null,this.m_t=null,this.A_t=null}open(){return U(!this.Sn,"Dialog already opened"),new Promise(((t,i)=>{this.Sn=t,this.Du=i,this.v_t()})).then((t=>(this.Qt(),t)),(t=>{throw this.Qt(),t}))}Qt(){if(this.Sn=null,this.Du=null,this.d_t){try{this.d_t.close()}catch(t){}this.d_t=null}this.m_t&&(this.win.clearInterval(this.m_t),this.m_t=null),this.A_t&&(this.A_t(),this.A_t=null)}getLoginUrl(){let t;return t="string"==typeof this.urlOrPromise?Promise.resolve(this.urlOrPromise):this.urlOrPromise,t.then((t=>Lt(t,this.P_t())))}v_t(){const{screen:t}=this.win,i=Math.floor(Math.min(700,.9*t.width)),s=Math.floor(Math.min(450,.9*t.height)),e=`height=${s},width=${i},left=${Math.floor((t.width-i)/2)},top=${Math.floor((t.height-s)/2)},resizable=yes,scrollbars=yes`,r=this.P_t();if(this.__t=null,"string"==typeof this.urlOrPromise){const t=Lt(this.urlOrPromise,r);this.d_t=Ot(this.win,t,"_blank",e),this.d_t&&(this.__t=n())}else this.d_t=Ot(this.win,"","_blank",e),this.d_t&&(this.__t=this.urlOrPromise.then((t=>{const i=Lt(t,r);this.d_t.location.replace(i)}),(t=>{throw new Error("failed to resolve url: "+t)})));this.__t?this.__t.then((()=>{this.g_t(r)}),(t=>{this.b_t(null,t)})):this.b_t(null,new Error("failed to open dialog"))}g_t(t){const i=pt(t).origin;this.m_t=this.win.setInterval((()=>{this.d_t.closed&&(this.win.clearInterval(this.m_t),this.m_t=null,this.win.setTimeout((()=>{this.b_t("")}),3e3))}),500),this.A_t=it(this.win,"message",(t=>{t.origin==i&&st(t)&&"amp"==st(t).sentinel&&"result"==st(t).type&&(this.d_t&&this.d_t.postMessage({"sentinel":"amp","type":"result-ack"},i),this.b_t(st(t).result))}),void 0)}b_t(t,i){this.Sn&&(i?this.Du(i):this.Sn(t),this.Qt())}P_t(){const t=this.viewer.getResolvedViewerUrl();let i;return i=`${w.cdn}/v0/amp-login-done-0.1.html`,i+"?url="+encodeURIComponent(t)}};function Lt(t,i){return Ut.test(t)?t.replace(Ut,encodeURIComponent(i)):t+(-1==t.indexOf("?")?"?":"&")+"return="+encodeURIComponent(i)}var Nt="amp-access",$t="client",Dt="server",Ft="vendor";function Gt(t,i,s){if(i[s])return i[s];const e=t.querySelector(`style[${s}], link[${s}]`);return e?(i[s]=e,e):null}function Jt(t,i){const s=t.styleSheets;for(let t=0;t<s.length;t++)if(s[t].ownerNode==i)return!0;return!1}var Kt=self.__AMP_ERRORS||[];self.__AMP_ERRORS=Kt;var Ht="amp-access",qt="__AMP_ACCESS__TEMPLATE";t.registerServiceForDoc("access",(function(t){return new class{constructor(t){this.ampdoc=t,function(t,i,s,e,n){const r=t.getHeadNode(),o=function(t,i,s,e){let n=t.__AMP_CSS_SM;n||(n=t.__AMP_CSS_SM=l());const r=`amp-extension=${e}`;if(r){const s=Gt(t,n,r);if(s)return"STYLE"==s.tagName&&s.textContent!==i&&(s.textContent=i),s}const o=(t.ownerDocument||t).createElement("style");o.textContent=i;let h=null;return o.setAttribute("amp-extension",e),h=Gt(t,n,"amp-runtime"),function(t,i,s=null){if(!s)return void function(t,i){t.insertBefore(i,t.firstChild)}(t,i);const e=s.nextSibling;t.insertBefore(i,e)}(t,o,h),r&&(n[r]=o),o}(r,function(t,i){const s=t.__AMP_CSS_TR;return s?s(i):i}(r,"\n/*# sourceURL=/extensions/amp-access/0.1/amp-access.css*/"),0,"amp-access");if(s){const i=t.getRootNode();if(Jt(i,o))return o;const s=setInterval((()=>{Jt(i,o)&&clearInterval(s)}),4)}}(t,0,(()=>{}));const i=t.getElementById("amp-access");if(this.E_t=!!i,!this.E_t)return;this.w_t=i,this.R_t=vt(t.win.location),this.Tr=B(t.win),this.jc=X(t.win),this.y_t=z(t,"cid"),this.Fr=Z(t),this.Io=(t=>j(t,"viewport"))(t),this.tM=(t=>j(t,"templates"))(t),this.eh=(t=>j(t,"mutator"))(t),this.C1=W(t.win),this.Kut=null,this.T_t=new class{constructor(){this.cache=null,this.I_t=null}evaluate(t,i){return this.I_t!==i&&(this.I_t=i,this.cache=l()),f(this.cache,t)||(this.cache[t]=function(t,i){try{return nt.yy=i,!!nt.parse(t)}finally{nt.yy=null}}(t,i)),this.cache[t]}},this.fT=this.M_t();const e=this.fT.map((t=>t.whenFirstAuthorized()));this.V_t=!1,this.S_t=Promise.all(e),this.k_t=null,this.O_t=new class{constructor(){this.Fn=null}add(t){return this.Fn||(this.Fn=[]),this.Fn.push(t),()=>{this.remove(t)}}remove(t){this.Fn&&function(t,i){const s=t.indexOf(i);-1!=s&&t.splice(s,1)}(this.Fn,t)}removeAll(){this.Fn&&(this.Fn.length=0)}fire(t){if(this.Fn)for(var i,e=s(this.Fn,!0);!(i=e()).done;)(0,i.value)(t)}getHandlerCount(){var t,i;return null!==(t=null===(i=this.Fn)||void 0===i?void 0:i.length)&&void 0!==t?t:0}},this.S_t.then((()=>{this.V_t=!0,this.x$("access-authorization-received"),this.C1&&(this.C1.tick("aaa"),this.C1.tickSinceVisible("aaav"),this.C1.flush())})),t.getRootNode().addEventListener("amp:dom-update",this.U_t.bind(this))}getAccessReaderId(){return this.E_t?this.x_t():null}x_t(){if(!this.Kut){const t=n();this.Kut=this.y_t.then((i=>i.get({scope:"amp-access",createCookieIfNotPresent:!0},t)))}return this.Kut}areFirstAuthorizationsCompleted(){return this.V_t}onApplyAuthorizations(t){this.O_t.add(t)}M_t(){var t,i;U("SCRIPT"==(t=this.w_t).tagName&&"APPLICATION/JSON"==(null===(i=t.getAttribute("type"))||void 0===i?void 0:i.toUpperCase()),`${Ht} config should be inside a <script> tag with type="application/json"`);const s=A(this.w_t.textContent,(t=>{throw V().createError('Failed to parse "amp-access" JSON: '+t)})),e={};if(o(s)){const t=s;for(let i=0;i<t.length;i++){const s=t[i].namespace;U(!!s,"Namespace required"),U(!e[s],"Namespace already used: "+s),e[s]=t[i]}}else e[s.namespace||""]=s;const h=this.x_t.bind(this),c=this.j_t.bind(this),u=this.C_t.bind(this);return Object.keys(e).map((t=>new class{constructor(t,i,s,e,n,o){this.ampdoc=t,this.x_t=s,this.j_t=e,this.C_t=n,this.w_t=o,this.z_t=ut(t.win,"amp-access-server"),this.L_t=ut(t.win,"amp-access-jwt"),this.AV=this.N_t(i),this.$_t=this.D_t(i),this.F_t=i.authorizationFallbackResponse,this.G_t=i.namespace||null,this.J_t=this.K_t(i),this.iP=(t=>C(t,"url-replace"))(o),this.H_t=jt.bind(null,t),this.Wut=null;const h=new r;this.q_t=h.promise,this.Q_t=h.resolve,this.W_t={},this.B_t=null,this.Z_t=0}getNamespace(){return this.G_t}getType(){return this.AV}getAdapter(){return this.J_t}getAuthResponse(){return this.Wut}K_t(t){const i={buildUrl:this.buildUrl.bind(this),collectUrlVars:this.collectUrlVars.bind(this)},s=this.L_t&&!0===t.jwt;switch(this.AV){case $t:return s?new kt(this.ampdoc,t,i):new Pt(this.ampdoc,t,i);case"iframe":return new class{constructor(t,i,s){var e,n;this.ampdoc=t,this.Yt=s,this.PN=i,this.Tr=B(t.win),this.vk=U(i.iframeSrc,'"iframeSrc" URL must be specified'),_t(this.vk,'"iframeSrc"'),this.X_t=i.iframeVars||null,this.X_t&&U(o(this.X_t),'"iframeVars" must be an array'),this.Y_t=U(i.defaultResponse,'"defaultResponse" must be specified'),this.Ov=pt(this.vk).origin,this.tAt=null,this.iAt=null,this.lv=t.win.document.createElement("iframe"),e=this.lv,void 0===(n=!1)&&(n=e.hasAttribute("hidden")),n?e.removeAttribute("hidden"):e.setAttribute("hidden",""),this.sAt=new class{constructor(t,i,s){this.i=t,this.eAt=i,this.Ov=s,this.o=null,this.nAt=null,this.rAt=this.yw.bind(this),this.oAt=0,this.hAt={}}connect(t){if(this.nAt)throw new Error("already connected");this.nAt=t,this.i.addEventListener("message",this.rAt)}disconnect(){this.nAt&&(this.nAt=null,this.i.removeEventListener("message",this.rAt))}isConnected(){return null!=this.Ov}getTarget(){const t=this.cAt();if(!t)throw new Error("not connected");return t}cAt(){return this.nAt&&!this.o&&("function"==typeof this.eAt?this.o=this.eAt():this.o=this.eAt),this.o}getTargetOrigin(){if(null==this.Ov)throw new Error("not connected");return this.Ov}sendCommand(t,i){this.dv(void 0,t,i)}sendCommandRsvp(t,i){const s=String(++this.oAt);let e=null;const n=new Promise((t=>{e=t}));return this.hAt[s]={promise:n,resolver:e},this.dv(s,t,i),n}dv(t,i,s){const e=this.getTarget(),n="connect"==i?null!=this.Ov?this.Ov:"*":this.getTargetOrigin();e.postMessage({"sentinel":gt,"_rsvp":t,"cmd":i,"payload":s||null},n)}yw(t){const i=t,{data:s}=i;if(!s||s.sentinel!=gt)return;const e=i.origin,n=s.cmd,r=s.payload||null;if(null==this.Ov&&"start"==n&&(this.Ov=e),null==this.Ov&&i.source&&this.cAt()==i.source&&(this.Ov=e),e!=this.Ov)return;const o=s._rsvp,h=!!o&&"rsvp"!=n,c=this.uAt(o,n,r);h&&Promise.resolve(c).then((t=>{this.dv(o,"rsvp",{"result":t})}),(t=>{this.dv(o,"rsvp",{"error":String(t)})}))}uAt(t,i,s){if("rsvp"!=i)return this.nAt(i,s);{const i=t&&this.hAt[t];i&&("error"in s?i.resolver(Promise.reject(new Error(s.error))):i.resolver(s.result),delete this.hAt[t])}}}(this.ampdoc.win,(()=>this.lv.contentWindow),this.Ov),this.$A=null}disconnect(){this.sAt.disconnect(),this.ampdoc.getBody().removeChild(this.lv)}getConfig(){return{"iframeSrc":this.vk,"iframeVars":this.X_t}}isAuthorizationEnabled(){return!0}authorize(){return Promise.race([this.aAt(),this.lAt()])}isPingbackEnabled(){return!0}pingback(){return this.connect().then((()=>this.sAt.sendCommandRsvp("pingback",{})))}postAction(){this.fAt(null)}connect(){if(!this.iAt){const t=new r;this.iAt=t.promise,this.tAt=t.resolve,this.$A=this.pAt(),this.sAt.connect(this.uAt.bind(this)),this.ampdoc.getBody().appendChild(this.lv),this.lv.src=this.vk}return this.iAt}pAt(){return new Promise((t=>{const i=m(JSON.stringify(this.PN));if(this.X_t){const s=this.X_t.join("&");t(this.Yt.collectUrlVars(s,!1).then((t=>(i.iframeVars=t,i))))}else t(i)}))}aAt(){return this.Tr.promise(3e3).then((()=>this.dAt()||this.Y_t))}lAt(){return this.connect().then((()=>this.sAt.sendCommandRsvp("authorize",{}))).then((t=>(t&&n().then((()=>this.fAt(t))),t)))}dAt(){const{win:t}=this.ampdoc,i=t.sessionStorage||t.localStorage;if(!i)return null;try{const t=i.getItem(bt);if(!t)return null;const s=m(t);return s.t+6048e5<this.ampdoc.win.Date.now()?null:s.d||null}catch(t){k().error(bt,"failed to restore access response: ",t);try{i.removeItem(bt)}catch(t){}return null}}fAt(t){const{win:i}=this.ampdoc,s=i.sessionStorage||i.localStorage;if(s)try{t?s.setItem(bt,JSON.stringify({"t":this.ampdoc.win.Date.now(),"d":t})):s.removeItem(bt)}catch(t){k().error(bt,"failed to store access response: ",t)}}uAt(t,i){"connect"!=t||this.$A.then((t=>{this.sAt.sendCommandRsvp("start",{"protocol":"amp-access","config":t}).then((()=>{this.tAt&&(this.tAt(),this.tAt=null)}))}))}}(this.ampdoc,t,i);case Dt:return s?new kt(this.ampdoc,t,i):new class{constructor(t,i,s){this.ampdoc=t,this.Yt=s,this.t_t=new Pt(t,i,s),this.sR=Y(t.win),this.Tr=B(t.win),this.jc=X(t.win),this.i_t=t.getMetaByName("i-amphtml-access-state");const e=ut(t.win,"amp-access-server");this.bf=At(t.win.location)||e;const n=e?t.getParam("serverAccessService"):null;this.bw=n||mt(t.win.location.href)}getConfig(){return{"client":this.t_t.getConfig(),"proxy":this.bf,"serverState":this.i_t}}isAuthorizationEnabled(){return!0}authorize(){return this.bf&&this.i_t?this.Yt.collectUrlVars(this.t_t.getAuthorizationUrl(),!1).then((t=>{const i={};for(const s in t)null!=t[s]&&(i[s]=String(t[s]));const s={"url":mt(this.ampdoc.win.location.href),"state":this.i_t,"vars":i};return this.Tr.timeoutPromise(this.t_t.getAuthorizationTimeout(),Rt(this.ampdoc.win,this.bw,{method:"POST",body:"request="+encodeURIComponent(JSON.stringify(s)),headers:{"Content-Type":"application/x-www-form-urlencoded"}}))})).then((t=>{const i=m(O(t.querySelector('script[id="amp-access-data"]')).textContent);return this.p_t(t).then((()=>i))})):this.t_t.authorize()}isPingbackEnabled(){return this.t_t.isPingbackEnabled()}pingback(){return this.t_t.pingback()}postAction(){}p_t(t){const i=t.querySelectorAll("[i-amphtml-access-id]");return this.jc.mutatePromise((()=>{for(let t=0;t<i.length;t++){const s=i[t],e=s.getAttribute("i-amphtml-access-id"),n=this.ampdoc.getRootNode().querySelector(`[i-amphtml-access-id="${v(e)}"]`);n&&n.parentElement.replaceChild(this.ampdoc.win.document.importNode(s,!0),n)}}))}}(this.ampdoc,t,i);case Ft:return new class{constructor(t,i){this.ampdoc=t,this._At=U(i.vendor,'"vendor" name must be specified'),this.mAt=i[this._At]||{},this.zft=!i.noPingback;const s=new r;this.AAt=s.promise,this.vAt=s.resolve}getVendorName(){return this._At}getConfig(){return this.mAt}registerVendor(t){U(this.vAt,"Vendor has already been registered"),this.vAt(t),this.vAt=null}isAuthorizationEnabled(){return!0}authorize(){return this.AAt.then((t=>t.authorize()))}isPingbackEnabled(){return this.zft}pingback(){return this.AAt.then((t=>t.pingback()))}postAction(){}}(this.ampdoc,t);case"other":return new class{constructor(t,i,s){this.ampdoc=t,this.Yt=s,this.PAt=i.authorizationFallbackResponse||null,this.bf=At(t.win.location)}getConfig(){return{"authorizationResponse":this.PAt}}isAuthorizationEnabled(){return!!this.PAt&&!this.bf}authorize(){O(!this.bf);const t=O(this.PAt);return Promise.resolve(t)}isPingbackEnabled(){return!1}pingback(){return n()}postAction(){}}(this.ampdoc,t,i)}throw k().createError("Unsupported access type: ",this.AV)}getAdapterConfig(){return this.J_t.getConfig()}whenFirstAuthorized(){return this.q_t}N_t(t){let{"type":i}=t;var s;return U(!i||"client"===(s=i)||"iframe"===s||"server"===s||"vendor"===s||"other"===s,`Unknown access type: ${i}`),i||(i=t.vendor?Ft:$t),i!=Dt||this.z_t||(i=$t),i==$t&&this.z_t&&(i=Dt),i}D_t(t){const i=t.login,s={};if(i)if("string"==typeof i)s[""]=i;else if(a(i))for(const t in i)s[t]=i[t];else U(!1,'"login" must be either a single URL or a map of URLs');for(const t in s)_t(s[t],this.w_t);return s}gAt(){const t=this.ampdoc.getRootNode();return t.documentElement||t.body||t}x$(t){tt(this.gAt(),t,void 0,!1)}start(){this.bAt()}buildUrl(t,i){return this.Yut(i).then((i=>this.iP.expandUrlAsync(t,i)))}collectUrlVars(t,i){return this.Yut(i).then((i=>this.iP.collectVars(t,i)))}Yut(t){return this.x_t().then((i=>{const s={"READER_ID":i,"ACCESS_READER_ID":i};return t&&(s.AUTHDATA=t=>{if(this.Wut)return p(this.Wut,t)}),s}))}runAuthorization(t){return this.J_t.isAuthorizationEnabled()?this.J_t.authorize().catch((i=>{if(this.x$("access-authorization-failed"),this.F_t&&!t)return V().error(Nt,"Authorization failed: ",i),this.F_t;throw i})).then((t=>(this.EAt(t),this.bAt(),t))).catch((t=>{throw V().error(Nt,"Authorization failed: ",t),this.Q_t(),t})):(this.Q_t(),n())}EAt(t){this.Wut=t,this.Q_t()}reportViewToServer(){return this.J_t.pingback().then((()=>{this.x$("access-pingback-sent")})).catch((t=>{throw this.x$("access-pingback-failed"),V().createError("Pingback failed: ",t)}))}getLoginUrl(t){return function(t,i){return xt(t,i).getLoginUrl()}(this.ampdoc,t)}loginWithType(t){U(this.$_t[t],"Login URL is not configured: %s",t);const i=U(this.W_t[t],"Login URL is not ready: %s",t);return this.wAt(i,t)}loginWithUrl(t,i=""){return this.wAt(t,i)}wAt(t,i){const s=Date.now();if(this.B_t&&s-this.Z_t<1e3)return this.B_t;this.RAt(i,"started");const e=this.H_t(t).then((t=>{this.B_t=null;const s=T(t).success,e="true"==s||"yes"==s||"1"==s;if(e?this.RAt(i,"success"):this.RAt(i,"rejected"),e||!s){this.J_t.postAction();const t=this.runAuthorization(!0);return this.C_t(t),t.then((()=>{this.j_t(0)}))}})).catch((t=>{throw this.RAt(i,"failed"),this.B_t==e&&(this.B_t=null),t}));return this.B_t=e,this.Z_t=s,this.B_t}RAt(t,i){this.x$(`access-login-${i}`),t&&this.x$(`access-login-${t}-${i}`)}bAt(){if(0==Object.keys(this.$_t).length)return null;const t=[];for(const i in this.$_t)t.push(this.buildUrl(this.$_t[i],!0).then((t=>(this.W_t[i]=t,{type:i,url:t}))));return Promise.all(t)}}(this.ampdoc,e[t],h,c,u,this.w_t)))}U_t(t){if(this.V_t){const i=t.target;return this.S_t.then((()=>{const t=this.combinedResponses();this.yAt(i,t)}))}}getVendorSource(t){for(let i=0;i<this.fT.length;i++){const s=this.fT[i];if(s.getType()==Ft&&s.getAdapter().getVendorName()==t)return s}throw U(!1,'Access vendor "%s" can only be used for "type=vendor", but none found',t),new Error}isEnabled(){return this.E_t}gAt(){const t=this.ampdoc.getRootNode();return t.documentElement||t.body||t}x$(t){tt(this.gAt(),t,void 0,!1)}Pu(){return this.E_t?(this.TAt(),this):this}TAt(){var t;(t=this.w_t,C(t,"action")).installActionHandler(this.w_t,this.hB.bind(this));for(let t=0;t<this.fT.length;t++)this.fT[t].start();this.IAt(),this.j_t(2e3),this.Tu()}Tu(){this.Fr.onBroadcast((t=>{"amp-access-reauthorize"==t.type&&t.origin==this.R_t&&this.IAt()}))}C_t(t){this.MAt(),t.then((()=>{this.V_t&&this.S_t.then((()=>{this.ampdoc.whenReady().then((()=>{const t=this.ampdoc.getRootNode(),i=this.combinedResponses();return this.yAt(t,i)}))}))}))}MAt(){this.Fr.broadcast({"type":"amp-access-reauthorize","origin":this.R_t})}IAt(t){this.VAt("amp-access-loading",!0);const i=this.ampdoc.whenFirstVisible().then((()=>Promise.all(this.fT.map((t=>this.SAt(t)))))).then((()=>(this.VAt("amp-access-loading",!1),this.ampdoc.whenReady().then((()=>{const t=this.ampdoc.getRootNode(),i=this.combinedResponses();return this.yAt(t,i)})))));return this.S_t=i,i}SAt(t){return t.runAuthorization().catch((()=>{this.VAt("amp-access-error",!0)}))}getAuthdataField(t){return this.E_t?this.S_t.then((()=>{const i=p(this.combinedResponses(),t);return void 0!==i?i:null})):null}yAt(t,i){const s=t.querySelectorAll("[amp-access]"),e=[];for(let t=0;t<s.length;t++)e.push(this.kAt(s[t],i));return Promise.all(e).then((()=>{this.O_t.fire()}))}kAt(t,i){const s=t.getAttribute("amp-access");let e=!1;try{e=this.T_t.evaluate(s,i)}catch(t){V().error(Ht,t)}if(e){const s=this.OAt(t,i);if(s)return s.then((()=>this.UAt(t,e)))}return this.UAt(t,e)}UAt(t,i){const s=!t.hasAttribute("amp-access-hide");return i==s?n():this.eh.mutateElement(t,(()=>{i?t.removeAttribute("amp-access-hide"):t.setAttribute("amp-access-hide","")}))}OAt(t,i){const s=[],e=t.querySelectorAll("[amp-access-template]");if(e.length>0)for(let n=0;n<e.length;n++){const r=this.I$(t,e[n],i).catch((i=>{k().error(Ht,"Template failed: ",i,e[n],t)}));s.push(r)}return s.length>0?Promise.all(s):null}I$(t,i,s){let e=i,n=null;return"TEMPLATE"!=e.tagName&&(n=e,e=n[qt]),e?this.tM.renderTemplate(e,s).then((t=>this.jc.mutatePromise((()=>{t.setAttribute("amp-access-template",""),t[qt]=e,e.parentElement?e.parentElement.replaceChild(t,e):n&&n.parentElement&&n.parentElement.replaceChild(t,n)})))):Promise.reject(new Error("template not found"))}j_t(t){this.fT.some((t=>t.getAdapter().isPingbackEnabled()))&&(this.k_t=null,this.ampdoc.whenReady().then((()=>{this.ampdoc.isVisible()&&this.xAt(t),this.ampdoc.onVisibilityChanged((()=>{this.ampdoc.isVisible()&&this.xAt(t)}))})))}xAt(t){return this.k_t||(this.k_t=this.jAt(t).then((()=>this.S_t)).then((()=>(this.x$("access-viewed"),this.CAt()))).catch((t=>{throw this.k_t=null,t})),this.k_t.then(this.MAt.bind(this))),this.k_t}jAt(t){if(0==t)return n();const i=[];return new Promise(((s,e)=>{i.push(this.ampdoc.onVisibilityChanged((()=>{this.ampdoc.isVisible()||e(new Error("CANCELLED"))})));const n=this.Tr.delay(s,t);i.push((()=>this.Tr.cancel(n))),i.push(this.Io.onScroll(s)),i.push(function(t,i,s,e){let n=s;const r=it(t,"click",(t=>{try{n(t)}finally{n=null,r()}}),void 0);return r}(this.ampdoc.getRootNode(),0,s))})).then((()=>{i.forEach((t=>t()))}),(t=>{throw i.forEach((t=>t())),t}))}CAt(){const t=[];for(let i=0;i<this.fT.length;i++)this.fT[i].getAdapter().isPingbackEnabled()&&t.push(this.fT[i].reportViewToServer());return Promise.all(t)}VAt(t,i){this.jc.mutate((()=>{this.gAt().classList.toggle(t,i)}))}hB(t){return t.satisfiesTrust(2)?("login"==t.method?(t.event&&t.event.preventDefault(),this.zAt("")):t.method.startsWith("login-")?(t.event&&t.event.preventDefault(),this.zAt(t.method.substring("login-".length))):"refresh"==t.method&&(t.event&&t.event.preventDefault(),this.IAt()),null):null}getSource(t){return U(t>=0&&t<this.fT.length,"Invalid index: %d",t),this.fT[t]}zAt(t){const i=t.indexOf("-"),s=1==this.fT.length,e=i>-1?t.substring(0,i):t,n=this.fT.filter((t=>t.getNamespace()==e));if(n.length){const s=i>-1?t.substring(i+1):"";return n[0].loginWithType(s)}return U(s,"Login must match namespace: %s",e),this.fT[0].loginWithType(t)}combinedResponses(){if(1==this.fT.length&&!this.fT[0].getNamespace())return this.fT[0].getAuthResponse()||{};const t={};return this.fT.forEach((i=>t[i.getNamespace()]=i.getAuthResponse())),t}}(t).Pu()}))})();
/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */}});
//# sourceMappingURL=amp-access-0.1.mjs.map