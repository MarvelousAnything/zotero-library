window.$jQ111=function(e){function t(t){for(var i,r,a=t[0],o=t[1],s=0,c=[];s<a.length;s++)r=a[s],Object.prototype.hasOwnProperty.call(n,r)&&n[r]&&c.push(n[r][0]),n[r]=0;for(i in o)Object.prototype.hasOwnProperty.call(o,i)&&(e[i]=o[i]);for(l&&l(t);c.length;)c.shift()()}var i={},n={1:0};function r(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.e=function(e){var t=[],i=n[e];if(0!==i)if(i)t.push(i[2]);else{var a=new Promise((function(t,r){i=n[e]=[t,r]}));t.push(i[2]=a);var o,s=document.createElement("script");s.charset="utf-8",s.timeout=120,r.nc&&s.setAttribute("nonce",r.nc),s.src=function(e){return r.p+"v3/js/"+({0:"liveEventController",2:"vendors~hls",3:"vendors~liveEventController"}[e]||e)+"."+{0:"6ed453f9c83ea4d5a9d8",2:"86c7ab173b594324e29e",3:"ff7ca23842bf587c9808"}[e]+".min.js"}(e);var l=new Error;o=function(t){s.onerror=s.onload=null,clearTimeout(c);var i=n[e];if(0!==i){if(i){var r=t&&("load"===t.type?"missing":t.type),a=t&&t.target&&t.target.src;l.message="Loading chunk "+e+" failed.\n("+r+": "+a+")",l.name="ChunkLoadError",l.type=r,l.request=a,i[1](l)}n[e]=void 0}};var c=setTimeout((function(){o({type:"timeout",target:s})}),12e4);s.onerror=s.onload=o,document.head.appendChild(s)}return Promise.all(t)},r.m=e,r.c=i,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="https://video-api.wsj.com/api-video/player/",r.oe=function(e){throw console.error(e),e};var a=window.webpackJsonp$jQ111=window.webpackJsonp$jQ111||[],o=a.push.bind(a);a.push=t,a=a.slice();for(var s=0;s<a.length;s++)t(a[s]);var l=o;return r(r.s=24)}([function(e,t,i){"use strict";i.d(t,"u",(function(){return n})),i.d(t,"F",(function(){return r})),i.d(t,"E",(function(){return a})),i.d(t,"s",(function(){return o})),i.d(t,"r",(function(){return s})),i.d(t,"A",(function(){return l})),i.d(t,"n",(function(){return c})),i.d(t,"D",(function(){return u})),i.d(t,"q",(function(){return h})),i.d(t,"h",(function(){return d})),i.d(t,"g",(function(){return p})),i.d(t,"U",(function(){return f})),i.d(t,"T",(function(){return g})),i.d(t,"V",(function(){return _})),i.d(t,"O",(function(){return m})),i.d(t,"S",(function(){return v})),i.d(t,"X",(function(){return y})),i.d(t,"Q",(function(){return b})),i.d(t,"R",(function(){return S})),i.d(t,"W",(function(){return E})),i.d(t,"P",(function(){return w})),i.d(t,"M",(function(){return T})),i.d(t,"N",(function(){return M})),i.d(t,"Y",(function(){return A})),i.d(t,"L",(function(){return C})),i.d(t,"t",(function(){return x})),i.d(t,"i",(function(){return I})),i.d(t,"z",(function(){return P})),i.d(t,"m",(function(){return L})),i.d(t,"f",(function(){return D})),i.d(t,"b",(function(){return R})),i.d(t,"e",(function(){return k})),i.d(t,"d",(function(){return O})),i.d(t,"c",(function(){return N})),i.d(t,"a",(function(){return F})),i.d(t,"x",(function(){return V})),i.d(t,"k",(function(){return B})),i.d(t,"B",(function(){return U})),i.d(t,"o",(function(){return H})),i.d(t,"K",(function(){return G})),i.d(t,"G",(function(){return j})),i.d(t,"H",(function(){return z})),i.d(t,"J",(function(){return W})),i.d(t,"I",(function(){return Y})),i.d(t,"v",(function(){return K})),i.d(t,"C",(function(){return q})),i.d(t,"p",(function(){return X})),i.d(t,"j",(function(){return Q})),i.d(t,"w",(function(){return Z})),i.d(t,"y",(function(){return J})),i.d(t,"l",(function(){return $}));const n="RESIZE",r="THUMBNAIL_SHOW",a="THUMBNAIL_HIDE",o="MORE_VIDEOS_SLIDE_SHOW",s="MORE_VIDEOS_SLIDE_HIDE",l="SHOW_ENDSCREEN",c="HIDE_ENDSCREEN",u="SHOW_SHARESCREEN",h="HIDE_SHARESCREEN",d="CONTROLS_SHOW",p="CONTROLS_HIDE",f="VIDEO_PLAY",g="VIDEO_PAUSE",_="VIDEO_PROGRESS",m="VIDEO_DURATION",v="VIDEO_MUTE",y="VIDEO_UNMUTE",b="VIDEO_ENTER_FULLSCREEN",S="VIDEO_EXIT_FULLSCREEN",E="VIDEO_START_PLAYBACK_INIT",w="VIDEO_END_PLAYBACK_INIT",T="VIDEO_BUFFERING",M="VIDEO_CAN_PLAY",A="VIDEO_VOLUME",C="UPDATE_VIDEO_DATA",x="REPLACE_PLAYLIST",I="DEQUEUE_PLAYLIST",P="SHOW_COUNTDOWN",L="HIDE_COUNTDOWN",D="AD_STARTED",R="AD_COMPLETE",k="AD_PROGRESS",O="AD_PLAY",N="AD_PAUSE",F="AD_BUFFERING",V="SHOW_CLICK_FOR_SOUND",B="HIDE_CLICK_FOR_SOUND",U="SHOW_LOADING_SPINNER",H="HIDE_LOADING_SPINNER",G="UPDATE_VIDEO_API_LOAD_STATE",j="UPDATE_AD_ERROR_STATE",z="UPDATE_AD_INIT_STATE",W="UPDATE_IMA_LOAD_STATE",Y="UPDATE_HLS_JS_LOAD_STATE",K="SET_FOCUS",q="SHOW_SAVED_MODAL",X="HIDE_SAVED_MODAL",Q="ENABLE_LOGGING",Z="SET_VOLUME_CONTROL_VISIBILITY",J="SHOW_CLOSED_CAPTIONS",$="HIDE_CLOSED_CAPTIONS"},function(e,t,i){"use strict";i.r(t),i.d(t,"render",(function(){return F})),i.d(t,"hydrate",(function(){return V})),i.d(t,"createElement",(function(){return g})),i.d(t,"h",(function(){return g})),i.d(t,"Fragment",(function(){return v})),i.d(t,"createRef",(function(){return m})),i.d(t,"isValidElement",(function(){return r})),i.d(t,"Component",(function(){return y})),i.d(t,"cloneElement",(function(){return B})),i.d(t,"createContext",(function(){return U})),i.d(t,"toChildArray",(function(){return M})),i.d(t,"__u",(function(){return O})),i.d(t,"options",(function(){return n}));var n,r,a,o,s,l,c,u={},h=[],d=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function p(e,t){for(var i in t)e[i]=t[i];return e}function f(e){var t=e.parentNode;t&&t.removeChild(e)}function g(e,t,i){var n,r=arguments,a={};for(n in t)"key"!==n&&"ref"!==n&&(a[n]=t[n]);if(arguments.length>3)for(i=[i],n=3;n<arguments.length;n++)i.push(r[n]);if(null!=i&&(a.children=i),"function"==typeof e&&null!=e.defaultProps)for(n in e.defaultProps)void 0===a[n]&&(a[n]=e.defaultProps[n]);return _(e,a,t&&t.key,t&&t.ref,null)}function _(e,t,i,r,a){var o={type:e,props:t,key:i,ref:r,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:a};return null==a&&(o.__v=o),n.vnode&&n.vnode(o),o}function m(){return{current:null}}function v(e){return e.children}function y(e,t){this.props=e,this.context=t}function b(e,t){if(null==t)return e.__?b(e.__,e.__.__k.indexOf(e)+1):null;for(var i;t<e.__k.length;t++)if(null!=(i=e.__k[t])&&null!=i.__e)return i.__e;return"function"==typeof e.type?b(e):null}function S(e){var t,i;if(null!=(e=e.__)&&null!=e.__c){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if(null!=(i=e.__k[t])&&null!=i.__e){e.__e=e.__c.base=i.__e;break}return S(e)}}function E(e){(!e.__d&&(e.__d=!0)&&a.push(e)&&!w.__r++||s!==n.debounceRendering)&&((s=n.debounceRendering)||o)(w)}function w(){for(var e;w.__r=a.length;)e=a.sort((function(e,t){return e.__v.__b-t.__v.__b})),a=[],e.some((function(e){var t,i,n,r,a,o,s;e.__d&&(o=(a=(t=e).__v).__e,(s=t.__P)&&(i=[],(n=p({},a)).__v=n,r=L(s,a,n,t.__n,void 0!==s.ownerSVGElement,null,i,null==o?b(a):o),D(i,a),r!=o&&S(a)))}))}function T(e,t,i,n,r,a,o,s,l,c){var d,p,g,m,y,S,E,w=n&&n.__k||h,T=w.length;for(l==u&&(l=null!=o?o[0]:T?b(n,0):null),i.__k=[],d=0;d<t.length;d++)if(null!=(m=i.__k[d]=null==(m=t[d])||"boolean"==typeof m?null:"string"==typeof m||"number"==typeof m?_(null,m,null,null,m):Array.isArray(m)?_(v,{children:m},null,null,null):null!=m.__e||null!=m.__c?_(m.type,m.props,m.key,null,m.__v):m)){if(m.__=i,m.__b=i.__b+1,null===(g=w[d])||g&&m.key==g.key&&m.type===g.type)w[d]=void 0;else for(p=0;p<T;p++){if((g=w[p])&&m.key==g.key&&m.type===g.type){w[p]=void 0;break}g=null}y=L(e,m,g=g||u,r,a,o,s,l,c),(p=m.ref)&&g.ref!=p&&(E||(E=[]),g.ref&&E.push(g.ref,null,m),E.push(p,m.__c||y,m)),null!=y?(null==S&&(S=y),l=A(e,m,g,w,o,y,l),"option"==i.type?e.value="":"function"==typeof i.type&&(i.__d=l)):l&&g.__e==l&&l.parentNode!=e&&(l=b(g))}if(i.__e=S,null!=o&&"function"!=typeof i.type)for(d=o.length;d--;)null!=o[d]&&f(o[d]);for(d=T;d--;)null!=w[d]&&O(w[d],w[d]);if(E)for(d=0;d<E.length;d++)k(E[d],E[++d],E[++d])}function M(e){return null==e||"boolean"==typeof e?[]:Array.isArray(e)?h.concat.apply([],e.map(M)):[e]}function A(e,t,i,n,r,a,o){var s,l,c;if(void 0!==t.__d)s=t.__d,t.__d=void 0;else if(r==i||a!=o||null==a.parentNode)e:if(null==o||o.parentNode!==e)e.appendChild(a),s=null;else{for(l=o,c=0;(l=l.nextSibling)&&c<n.length;c+=2)if(l==a)break e;e.insertBefore(a,o),s=o}return void 0!==s?s:a.nextSibling}function C(e,t,i){"-"===t[0]?e.setProperty(t,i):e[t]="number"==typeof i&&!1===d.test(t)?i+"px":null==i?"":i}function x(e,t,i,n,r){var a,o,s,l,c;if(r?"className"===t&&(t="class"):"class"===t&&(t="className"),"style"===t)if(a=e.style,"string"==typeof i)a.cssText=i;else{if("string"==typeof n&&(a.cssText="",n=null),n)for(l in n)i&&l in i||C(a,l,"");if(i)for(c in i)n&&i[c]===n[c]||C(a,c,i[c])}else"o"===t[0]&&"n"===t[1]?(o=t!==(t=t.replace(/Capture$/,"")),s=t.toLowerCase(),t=(s in e?s:t).slice(2),i?(n||e.addEventListener(t,I,o),(e.l||(e.l={}))[t]=i):e.removeEventListener(t,I,o)):"list"!==t&&"tagName"!==t&&"form"!==t&&"type"!==t&&"size"!==t&&!r&&t in e?e[t]=null==i?"":i:"function"!=typeof i&&"dangerouslySetInnerHTML"!==t&&(t!==(t=t.replace(/^xlink:?/,""))?null==i||!1===i?e.removeAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase()):e.setAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase(),i):null==i||!1===i&&!/^ar/.test(t)?e.removeAttribute(t):e.setAttribute(t,i))}function I(e){this.l[e.type](n.event?n.event(e):e)}function P(e,t,i){var n,r;for(n=0;n<e.__k.length;n++)(r=e.__k[n])&&(r.__=e,r.__e&&("function"==typeof r.type&&r.__k.length>1&&P(r,t,i),t=A(i,r,r,e.__k,null,r.__e,t),"function"==typeof e.type&&(e.__d=t)))}function L(e,t,i,r,a,o,s,l,c){var u,h,d,f,g,_,m,b,S,E,w,M=t.type;if(void 0!==t.constructor)return null;(u=n.__b)&&u(t);try{e:if("function"==typeof M){if(b=t.props,S=(u=M.contextType)&&r[u.__c],E=u?S?S.props.value:u.__:r,i.__c?m=(h=t.__c=i.__c).__=h.__E:("prototype"in M&&M.prototype.render?t.__c=h=new M(b,E):(t.__c=h=new y(b,E),h.constructor=M,h.render=N),S&&S.sub(h),h.props=b,h.state||(h.state={}),h.context=E,h.__n=r,d=h.__d=!0,h.__h=[]),null==h.__s&&(h.__s=h.state),null!=M.getDerivedStateFromProps&&(h.__s==h.state&&(h.__s=p({},h.__s)),p(h.__s,M.getDerivedStateFromProps(b,h.__s))),f=h.props,g=h.state,d)null==M.getDerivedStateFromProps&&null!=h.componentWillMount&&h.componentWillMount(),null!=h.componentDidMount&&h.__h.push(h.componentDidMount);else{if(null==M.getDerivedStateFromProps&&b!==f&&null!=h.componentWillReceiveProps&&h.componentWillReceiveProps(b,E),!h.__e&&null!=h.shouldComponentUpdate&&!1===h.shouldComponentUpdate(b,h.__s,E)||t.__v===i.__v){h.props=b,h.state=h.__s,t.__v!==i.__v&&(h.__d=!1),h.__v=t,t.__e=i.__e,t.__k=i.__k,h.__h.length&&s.push(h),P(t,l,e);break e}null!=h.componentWillUpdate&&h.componentWillUpdate(b,h.__s,E),null!=h.componentDidUpdate&&h.__h.push((function(){h.componentDidUpdate(f,g,_)}))}h.context=E,h.props=b,h.state=h.__s,(u=n.__r)&&u(t),h.__d=!1,h.__v=t,h.__P=e,u=h.render(h.props,h.state,h.context),h.state=h.__s,null!=h.getChildContext&&(r=p(p({},r),h.getChildContext())),d||null==h.getSnapshotBeforeUpdate||(_=h.getSnapshotBeforeUpdate(f,g)),w=null!=u&&u.type==v&&null==u.key?u.props.children:u,T(e,Array.isArray(w)?w:[w],t,i,r,a,o,s,l,c),h.base=t.__e,h.__h.length&&s.push(h),m&&(h.__E=h.__=null),h.__e=!1}else null==o&&t.__v===i.__v?(t.__k=i.__k,t.__e=i.__e):t.__e=R(i.__e,t,i,r,a,o,s,c);(u=n.diffed)&&u(t)}catch(e){t.__v=null,n.__e(e,t,i)}return t.__e}function D(e,t){n.__c&&n.__c(t,e),e.some((function(t){try{e=t.__h,t.__h=[],e.some((function(e){e.call(t)}))}catch(e){n.__e(e,t.__v)}}))}function R(e,t,i,n,r,a,o,s){var l,c,d,p,f,g=i.props,_=t.props;if(r="svg"===t.type||r,null!=a)for(l=0;l<a.length;l++)if(null!=(c=a[l])&&((null===t.type?3===c.nodeType:c.localName===t.type)||e==c)){e=c,a[l]=null;break}if(null==e){if(null===t.type)return document.createTextNode(_);e=r?document.createElementNS("http://www.w3.org/2000/svg",t.type):document.createElement(t.type,_.is&&{is:_.is}),a=null,s=!1}if(null===t.type)g!==_&&e.data!=_&&(e.data=_);else{if(null!=a&&(a=h.slice.call(e.childNodes)),d=(g=i.props||u).dangerouslySetInnerHTML,p=_.dangerouslySetInnerHTML,!s){if(null!=a)for(g={},f=0;f<e.attributes.length;f++)g[e.attributes[f].name]=e.attributes[f].value;(p||d)&&(p&&d&&p.__html==d.__html||(e.innerHTML=p&&p.__html||""))}(function(e,t,i,n,r){var a;for(a in i)"children"===a||"key"===a||a in t||x(e,a,null,i[a],n);for(a in t)r&&"function"!=typeof t[a]||"children"===a||"key"===a||"value"===a||"checked"===a||i[a]===t[a]||x(e,a,t[a],i[a],n)})(e,_,g,r,s),p?t.__k=[]:(l=t.props.children,T(e,Array.isArray(l)?l:[l],t,i,n,"foreignObject"!==t.type&&r,a,o,u,s)),s||("value"in _&&void 0!==(l=_.value)&&l!==e.value&&x(e,"value",l,g.value,!1),"checked"in _&&void 0!==(l=_.checked)&&l!==e.checked&&x(e,"checked",l,g.checked,!1))}return e}function k(e,t,i){try{"function"==typeof e?e(t):e.current=t}catch(e){n.__e(e,i)}}function O(e,t,i){var r,a,o;if(n.unmount&&n.unmount(e),(r=e.ref)&&(r.current&&r.current!==e.__e||k(r,null,t)),i||"function"==typeof e.type||(i=null!=(a=e.__e)),e.__e=e.__d=void 0,null!=(r=e.__c)){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(e){n.__e(e,t)}r.base=r.__P=null}if(r=e.__k)for(o=0;o<r.length;o++)r[o]&&O(r[o],t,i);null!=a&&f(a)}function N(e,t,i){return this.constructor(e,i)}function F(e,t,i){var r,a,o;n.__&&n.__(e,t),a=(r=i===l)?null:i&&i.__k||t.__k,e=g(v,null,[e]),o=[],L(t,(r?t:i||t).__k=e,a||u,u,void 0!==t.ownerSVGElement,i&&!r?[i]:a?null:t.childNodes.length?h.slice.call(t.childNodes):null,o,i||u,r),D(o,e)}function V(e,t){F(e,t,l)}function B(e,t){var i,n;for(n in t=p(p({},e.props),t),arguments.length>2&&(t.children=h.slice.call(arguments,2)),i={},t)"key"!==n&&"ref"!==n&&(i[n]=t[n]);return _(e.type,i,t.key||e.key,t.ref||e.ref,null)}function U(e){var t={},i={__c:"__cC"+c++,__:e,Consumer:function(e,t){return e.children(t)},Provider:function(e){var n,r=this;return this.getChildContext||(n=[],this.getChildContext=function(){return t[i.__c]=r,t},this.shouldComponentUpdate=function(e){r.props.value!==e.value&&n.some((function(t){t.context=e.value,E(t)}))},this.sub=function(e){n.push(e);var t=e.componentWillUnmount;e.componentWillUnmount=function(){n.splice(n.indexOf(e),1),t&&t.call(e)}}),e.children}};return i.Consumer.contextType=i,i.Provider.__=i,i}n={__e:function(e,t){for(var i,n;t=t.__;)if((i=t.__c)&&!i.__)try{if(i.constructor&&null!=i.constructor.getDerivedStateFromError&&(n=!0,i.setState(i.constructor.getDerivedStateFromError(e))),null!=i.componentDidCatch&&(n=!0,i.componentDidCatch(e)),n)return E(i.__E=i)}catch(t){e=t}throw e}},r=function(e){return null!=e&&void 0===e.constructor},y.prototype.setState=function(e,t){var i;i=this.__s!==this.state?this.__s:this.__s=p({},this.state),"function"==typeof e&&(e=e(i,this.props)),e&&p(i,e),null!=e&&this.__v&&(t&&this.__h.push(t),E(this))},y.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),E(this))},y.prototype.render=v,a=[],o="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,w.__r=0,l=u,c=0},function(e,t,i){"use strict";i.r(t),i.d(t,"Provider",(function(){return k})),i.d(t,"connectAdvanced",(function(){return q})),i.d(t,"ReactReduxContext",(function(){return I})),i.d(t,"connect",(function(){return he})),i.d(t,"batch",(function(){return C})),i.d(t,"useDispatch",(function(){return _e})),i.d(t,"createDispatchHook",(function(){return ge})),i.d(t,"useSelector",(function(){return ye})),i.d(t,"createSelectorHook",(function(){return ve})),i.d(t,"useStore",(function(){return fe})),i.d(t,"createStoreHook",(function(){return pe})),i.d(t,"shallowEqual",(function(){return Q}));var n=i(3),r=i(1);function a(e,t){for(var i in t)e[i]=t[i];return e}function o(e,t){for(var i in e)if("__source"!==i&&!(i in t))return!0;for(var n in t)if("__source"!==n&&e[n]!==t[n])return!0;return!1}var s=function(e){var t,i;function n(t){var i;return(i=e.call(this,t)||this).isPureReactComponent=!0,i}return i=e,(t=n).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i,n.prototype.shouldComponentUpdate=function(e,t){return o(this.props,e)||o(this.state,t)},n}(r.Component);var l=r.options.__b;r.options.__b=function(e){e.type&&e.type.t&&e.ref&&(e.props.ref=e.ref,e.ref=null),l&&l(e)};var c="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.forward_ref")||3911;var u=function(e,t){return e?Object(r.toChildArray)(e).reduce((function(e,i,n){return e.concat(t(i,n))}),[]):null},h={map:u,forEach:u,count:function(e){return e?Object(r.toChildArray)(e).length:0},only:function(e){if(1!==(e=Object(r.toChildArray)(e)).length)throw new Error("Children.only() expects only one child.");return e[0]},toArray:r.toChildArray},d=r.options.__e;function p(e){return e&&((e=a({},e)).__c=null,e.__k=e.__k&&e.__k.map(p)),e}function f(){this.__u=0,this.o=null,this.__b=null}function g(e){var t=e.__.__c;return t&&t.u&&t.u(e)}function _(){this.i=null,this.l=null}r.options.__e=function(e,t,i){if(e.then)for(var n,r=t;r=r.__;)if((n=r.__c)&&n.__c)return n.__c(e,t.__c);d(e,t,i)},(f.prototype=new r.Component).__c=function(e,t){var i=this;null==i.o&&(i.o=[]),i.o.push(t);var n=g(i.__v),r=!1,a=function(){r||(r=!0,n?n(o):o())};t.__c=t.componentWillUnmount,t.componentWillUnmount=function(){a(),t.__c&&t.__c()};var o=function(){var e;if(!--i.__u)for(i.__v.__k[0]=i.state.u,i.setState({u:i.__b=null});e=i.o.pop();)e.forceUpdate()};i.__u++||i.setState({u:i.__b=i.__v.__k[0]}),e.then(a,a)},f.prototype.render=function(e,t){return this.__b&&(this.__v.__k[0]=p(this.__b),this.__b=null),[Object(r.createElement)(r.Fragment,null,t.u?null:e.children),t.u&&e.fallback]};var m=function(e,t,i){if(++i[1]===i[0]&&e.l.delete(t),e.props.revealOrder&&("t"!==e.props.revealOrder[0]||!e.l.size))for(i=e.i;i;){for(;i.length>3;)i.pop()();if(i[1]<i[0])break;e.i=i=i[2]}};(_.prototype=new r.Component).u=function(e){var t=this,i=g(t.__v),n=t.l.get(e);return n[0]++,function(r){var a=function(){t.props.revealOrder?(n.push(r),m(t,e,n)):r()};i?i(a):a()}},_.prototype.render=function(e){this.i=null,this.l=new Map;var t=Object(r.toChildArray)(e.children);e.revealOrder&&"b"===e.revealOrder[0]&&t.reverse();for(var i=t.length;i--;)this.l.set(t[i],this.i=[1,0,this.i]);return e.children},_.prototype.componentDidUpdate=_.prototype.componentDidMount=function(){var e=this;e.l.forEach((function(t,i){m(e,i,t)}))};var v=function(){function e(){}var t=e.prototype;return t.getChildContext=function(){return this.props.context},t.render=function(e){return e.children},e}();function y(e){var t=this,i=e.container,n=Object(r.createElement)(v,{context:t.context},e.vnode);return t.s&&t.s!==i&&(t.v.parentNode&&t.s.removeChild(t.v),Object(r.__u)(t.h),t.p=!1),e.vnode?t.p?(i.__k=t.__k,Object(r.render)(n,i),t.__k=i.__k):(t.v=document.createTextNode(""),Object(r.hydrate)("",i),i.appendChild(t.v),t.p=!0,t.s=i,Object(r.render)(n,i,t.v),t.__k=t.v.__k):t.p&&(t.v.parentNode&&t.s.removeChild(t.v),Object(r.__u)(t.h)),t.h=n,t.componentWillUnmount=function(){t.v.parentNode&&t.s.removeChild(t.v),Object(r.__u)(t.h)},null}var b=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|fill|flood|font|glyph(?!R)|horiz|marker(?!H|W|U)|overline|paint|stop|strikethrough|stroke|text(?!L)|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/;r.Component.prototype.isReactComponent={};var S="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103;var E=r.options.event;function w(e,t){e["UNSAFE_"+t]&&!e[t]&&Object.defineProperty(e,t,{configurable:!1,get:function(){return this["UNSAFE_"+t]},set:function(e){this["UNSAFE_"+t]=e}})}r.options.event=function(e){E&&(e=E(e)),e.persist=function(){};var t=!1,i=!1,n=e.stopPropagation;e.stopPropagation=function(){n.call(e),t=!0};var r=e.preventDefault;return e.preventDefault=function(){r.call(e),i=!0},e.isPropagationStopped=function(){return t},e.isDefaultPrevented=function(){return i},e.nativeEvent=e};var T={configurable:!0,get:function(){return this.class}},M=r.options.vnode;r.options.vnode=function(e){e.$$typeof=S;var t=e.type,i=e.props;if(t){if(i.class!=i.className&&(T.enumerable="className"in i,null!=i.className&&(i.class=i.className),Object.defineProperty(i,"className",T)),"function"!=typeof t){var n,a,o;for(o in i.defaultValue&&void 0!==i.value&&(i.value||0===i.value||(i.value=i.defaultValue),delete i.defaultValue),Array.isArray(i.value)&&i.multiple&&"select"===t&&(Object(r.toChildArray)(i.children).forEach((function(e){-1!=i.value.indexOf(e.props.value)&&(e.props.selected=!0)})),delete i.value),null!=i.value&&"textarea"===t&&(i.children=i.value,delete i.value),i)if(n=b.test(o))break;if(n)for(o in a=e.props={},i)a[b.test(o)?o.replace(/[A-Z0-9]/,"-$&").toLowerCase():o]=i[o]}!function(t){var i=e.type,n=e.props;if(n&&"string"==typeof i){var r={};for(var a in n)/^on(Ani|Tra|Tou)/.test(a)&&(n[a.toLowerCase()]=n[a],delete n[a]),r[a.toLowerCase()]=a;if(r.ondoubleclick&&(n.ondblclick=n[r.ondoubleclick],delete n[r.ondoubleclick]),r.onbeforeinput&&(n.onbeforeinput=n[r.onbeforeinput],delete n[r.onbeforeinput]),r.onchange&&("textarea"===i||"input"===i.toLowerCase()&&!/^fil|che|ra/i.test(n.type))){var o=r.oninput||"oninput";n[o]||(n[o]=n[r.onchange],delete n[r.onchange])}}}(),"function"==typeof t&&!t.m&&t.prototype&&(w(t.prototype,"componentWillMount"),w(t.prototype,"componentWillReceiveProps"),w(t.prototype,"componentWillUpdate"),t.m=!0)}M&&M(e)};function A(e){return!!e&&e.$$typeof===S}var C=function(e,t){return e(t)},x=(r.Fragment,{useState:n.useState,useReducer:n.useReducer,useEffect:n.useEffect,useLayoutEffect:n.useLayoutEffect,useRef:n.useRef,useImperativeHandle:n.useImperativeHandle,useMemo:n.useMemo,useCallback:n.useCallback,useContext:n.useContext,useDebugValue:n.useDebugValue,version:"16.8.0",Children:h,render:function(e,t,i){if(null==t.__k)for(;t.firstChild;)t.removeChild(t.firstChild);return Object(r.render)(e,t),"function"==typeof i&&i(),e?e.__c:null},hydrate:function(e,t,i){return Object(r.hydrate)(e,t),"function"==typeof i&&i(),e?e.__c:null},unmountComponentAtNode:function(e){return!!e.__k&&(Object(r.render)(null,e),!0)},createPortal:function(e,t){return Object(r.createElement)(y,{vnode:e,container:t})},createElement:r.createElement,createContext:r.createContext,createFactory:function(e){return r.createElement.bind(null,e)},cloneElement:function(e){return A(e)?r.cloneElement.apply(null,arguments):e},createRef:r.createRef,Fragment:r.Fragment,isValidElement:A,findDOMNode:function(e){return e&&(e.base||1===e.nodeType&&e)||null},Component:r.Component,PureComponent:s,memo:function(e,t){function i(e){var i=this.props.ref,n=i==e.ref;return!n&&i&&(i.call?i(null):i.current=null),t?!t(this.props,e)||!n:o(this.props,e)}function n(t){return this.shouldComponentUpdate=i,Object(r.createElement)(e,t)}return n.prototype.isReactComponent=!0,n.displayName="Memo("+(e.displayName||e.name)+")",n.t=!0,n},forwardRef:function(e){function t(t,i){var n=a({},t);return delete n.ref,e(n,"object"!=typeof(i=t.ref||i)||"current"in i?i:null)}return t.$$typeof=c,t.render=t,t.prototype.isReactComponent=t.t=!0,t.displayName="ForwardRef("+(e.displayName||e.name)+")",t},unstable_batchedUpdates:C,StrictMode:r.Fragment,Suspense:f,SuspenseList:_,lazy:function(e){var t,i,n;function a(a){if(t||(t=e()).then((function(e){i=e.default||e}),(function(e){n=e})),n)throw n;if(!i)throw t;return Object(r.createElement)(i,a)}return a.displayName="Lazy",a.t=!0,a}}),I=(i(38),x.createContext(null));var P=function(e){e()},L={notify:function(){}};function D(){var e=P,t=null,i=null;return{clear:function(){t=null,i=null},notify:function(){e((function(){for(var e=t;e;)e.callback(),e=e.next}))},get:function(){for(var e=[],i=t;i;)e.push(i),i=i.next;return e},subscribe:function(e){var n=!0,r=i={callback:e,next:null,prev:i};return r.prev?r.prev.next=r:t=r,function(){n&&null!==t&&(n=!1,r.next?r.next.prev=r.prev:i=r.prev,r.prev?r.prev.next=r.next:t=r.next)}}}}var R=function(){function e(e,t){this.store=e,this.parentSub=t,this.unsubscribe=null,this.listeners=L,this.handleChangeWrapper=this.handleChangeWrapper.bind(this)}var t=e.prototype;return t.addNestedSub=function(e){return this.trySubscribe(),this.listeners.subscribe(e)},t.notifyNestedSubs=function(){this.listeners.notify()},t.handleChangeWrapper=function(){this.onStateChange&&this.onStateChange()},t.isSubscribed=function(){return Boolean(this.unsubscribe)},t.trySubscribe=function(){this.unsubscribe||(this.unsubscribe=this.parentSub?this.parentSub.addNestedSub(this.handleChangeWrapper):this.store.subscribe(this.handleChangeWrapper),this.listeners=D())},t.tryUnsubscribe=function(){this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=null,this.listeners.clear(),this.listeners=L)},e}();var k=function(e){var t=e.store,i=e.context,r=e.children,a=Object(n.useMemo)((function(){var e=new R(t);return e.onStateChange=e.notifyNestedSubs,{store:t,subscription:e}}),[t]),o=Object(n.useMemo)((function(){return t.getState()}),[t]);Object(n.useEffect)((function(){var e=a.subscription;return e.trySubscribe(),o!==t.getState()&&e.notifyNestedSubs(),function(){e.tryUnsubscribe(),e.onStateChange=null}}),[a,o]);var s=i||I;return x.createElement(s.Provider,{value:a},r)};function O(){return(O=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e}).apply(this,arguments)}function N(e,t){if(null==e)return{};var i,n,r={},a=Object.keys(e);for(n=0;n<a.length;n++)i=a[n],t.indexOf(i)>=0||(r[i]=e[i]);return r}var F=i(16),V=i.n(F),B=i(14),U="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement?n.useLayoutEffect:n.useEffect,H=[],G=[null,null];function j(e,t){var i=e[1];return[t.payload,i+1]}function z(e,t,i){U((function(){return e.apply(void 0,t)}),i)}function W(e,t,i,n,r,a,o){e.current=n,t.current=r,i.current=!1,a.current&&(a.current=null,o())}function Y(e,t,i,n,r,a,o,s,l,c){if(e){var u=!1,h=null,d=function(){if(!u){var e,i,d=t.getState();try{e=n(d,r.current)}catch(e){i=e,h=e}i||(h=null),e===a.current?o.current||l():(a.current=e,s.current=e,o.current=!0,c({type:"STORE_UPDATED",payload:{error:i}}))}};i.onStateChange=d,i.trySubscribe(),d();return function(){if(u=!0,i.tryUnsubscribe(),i.onStateChange=null,h)throw h}}}var K=function(){return[null,0]};function q(e,t){void 0===t&&(t={});var i=t,r=i.getDisplayName,a=void 0===r?function(e){return"ConnectAdvanced("+e+")"}:r,o=i.methodName,s=void 0===o?"connectAdvanced":o,l=i.renderCountProp,c=void 0===l?void 0:l,u=i.shouldHandleStateChanges,h=void 0===u||u,d=i.storeKey,p=void 0===d?"store":d,f=(i.withRef,i.forwardRef),g=void 0!==f&&f,_=i.context,m=void 0===_?I:_,v=N(i,["getDisplayName","methodName","renderCountProp","shouldHandleStateChanges","storeKey","withRef","forwardRef","context"]),y=m;return function(t){var i=t.displayName||t.name||"Component",r=a(i),o=O({},v,{getDisplayName:a,methodName:s,renderCountProp:c,shouldHandleStateChanges:h,storeKey:p,displayName:r,wrappedComponentName:i,WrappedComponent:t}),l=v.pure;var u=l?n.useMemo:function(e){return e()};function d(i){var r=Object(n.useMemo)((function(){var e=i.forwardedRef,t=N(i,["forwardedRef"]);return[i.context,e,t]}),[i]),a=r[0],s=r[1],l=r[2],c=Object(n.useMemo)((function(){return a&&a.Consumer&&Object(B.isContextConsumer)(x.createElement(a.Consumer,null))?a:y}),[a,y]),d=Object(n.useContext)(c),p=Boolean(i.store)&&Boolean(i.store.getState)&&Boolean(i.store.dispatch);Boolean(d)&&Boolean(d.store);var f=p?i.store:d.store,g=Object(n.useMemo)((function(){return function(t){return e(t.dispatch,o)}(f)}),[f]),_=Object(n.useMemo)((function(){if(!h)return G;var e=new R(f,p?null:d.subscription),t=e.notifyNestedSubs.bind(e);return[e,t]}),[f,p,d]),m=_[0],v=_[1],b=Object(n.useMemo)((function(){return p?d:O({},d,{subscription:m})}),[p,d,m]),S=Object(n.useReducer)(j,H,K),E=S[0][0],w=S[1];if(E&&E.error)throw E.error;var T=Object(n.useRef)(),M=Object(n.useRef)(l),A=Object(n.useRef)(),C=Object(n.useRef)(!1),I=u((function(){return A.current&&l===M.current?A.current:g(f.getState(),l)}),[f,E,l]);z(W,[M,T,C,l,I,A,v]),z(Y,[h,f,m,g,M,T,C,A,v,w],[f,m,g]);var P=Object(n.useMemo)((function(){return x.createElement(t,O({},I,{ref:s}))}),[s,t,I]);return Object(n.useMemo)((function(){return h?x.createElement(c.Provider,{value:b},P):P}),[c,P,b])}var f=l?x.memo(d):d;if(f.WrappedComponent=t,f.displayName=r,g){var _=x.forwardRef((function(e,t){return x.createElement(f,O({},e,{forwardedRef:t}))}));return _.displayName=r,_.WrappedComponent=t,V()(_,t)}return V()(f,t)}}function X(e,t){return e===t?0!==e||0!==t||1/e==1/t:e!=e&&t!=t}function Q(e,t){if(X(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var i=Object.keys(e),n=Object.keys(t);if(i.length!==n.length)return!1;for(var r=0;r<i.length;r++)if(!Object.prototype.hasOwnProperty.call(t,i[r])||!X(e[i[r]],t[i[r]]))return!1;return!0}var Z=i(4);function J(e){return function(t,i){var n=e(t,i);function r(){return n}return r.dependsOnOwnProps=!1,r}}function $(e){return null!==e.dependsOnOwnProps&&void 0!==e.dependsOnOwnProps?Boolean(e.dependsOnOwnProps):1!==e.length}function ee(e,t){return function(t,i){i.displayName;var n=function(e,t){return n.dependsOnOwnProps?n.mapToProps(e,t):n.mapToProps(e)};return n.dependsOnOwnProps=!0,n.mapToProps=function(t,i){n.mapToProps=e,n.dependsOnOwnProps=$(e);var r=n(t,i);return"function"==typeof r&&(n.mapToProps=r,n.dependsOnOwnProps=$(r),r=n(t,i)),r},n}}var te=[function(e){return"function"==typeof e?ee(e):void 0},function(e){return e?void 0:J((function(e){return{dispatch:e}}))},function(e){return e&&"object"==typeof e?J((function(t){return Object(Z.bindActionCreators)(e,t)})):void 0}];var ie=[function(e){return"function"==typeof e?ee(e):void 0},function(e){return e?void 0:J((function(){return{}}))}];function ne(e,t,i){return O({},i,{},e,{},t)}var re=[function(e){return"function"==typeof e?function(e){return function(t,i){i.displayName;var n,r=i.pure,a=i.areMergedPropsEqual,o=!1;return function(t,i,s){var l=e(t,i,s);return o?r&&a(l,n)||(n=l):(o=!0,n=l),n}}}(e):void 0},function(e){return e?void 0:function(){return ne}}];function ae(e,t,i,n){return function(r,a){return i(e(r,a),t(n,a),a)}}function oe(e,t,i,n,r){var a,o,s,l,c,u=r.areStatesEqual,h=r.areOwnPropsEqual,d=r.areStatePropsEqual,p=!1;function f(r,p){var f,g,_=!h(p,o),m=!u(r,a);return a=r,o=p,_&&m?(s=e(a,o),t.dependsOnOwnProps&&(l=t(n,o)),c=i(s,l,o)):_?(e.dependsOnOwnProps&&(s=e(a,o)),t.dependsOnOwnProps&&(l=t(n,o)),c=i(s,l,o)):m?(f=e(a,o),g=!d(f,s),s=f,g&&(c=i(s,l,o)),c):c}return function(r,u){return p?f(r,u):(s=e(a=r,o=u),l=t(n,o),c=i(s,l,o),p=!0,c)}}function se(e,t){var i=t.initMapStateToProps,n=t.initMapDispatchToProps,r=t.initMergeProps,a=N(t,["initMapStateToProps","initMapDispatchToProps","initMergeProps"]),o=i(e,a),s=n(e,a),l=r(e,a);return(a.pure?oe:ae)(o,s,l,e,a)}function le(e,t,i){for(var n=t.length-1;n>=0;n--){var r=t[n](e);if(r)return r}return function(t,n){throw new Error("Invalid value of type "+typeof e+" for "+i+" argument when connecting component "+n.wrappedComponentName+".")}}function ce(e,t){return e===t}function ue(e){var t=void 0===e?{}:e,i=t.connectHOC,n=void 0===i?q:i,r=t.mapStateToPropsFactories,a=void 0===r?ie:r,o=t.mapDispatchToPropsFactories,s=void 0===o?te:o,l=t.mergePropsFactories,c=void 0===l?re:l,u=t.selectorFactory,h=void 0===u?se:u;return function(e,t,i,r){void 0===r&&(r={});var o=r,l=o.pure,u=void 0===l||l,d=o.areStatesEqual,p=void 0===d?ce:d,f=o.areOwnPropsEqual,g=void 0===f?Q:f,_=o.areStatePropsEqual,m=void 0===_?Q:_,v=o.areMergedPropsEqual,y=void 0===v?Q:v,b=N(o,["pure","areStatesEqual","areOwnPropsEqual","areStatePropsEqual","areMergedPropsEqual"]),S=le(e,a,"mapStateToProps"),E=le(t,s,"mapDispatchToProps"),w=le(i,c,"mergeProps");return n(h,O({methodName:"connect",getDisplayName:function(e){return"Connect("+e+")"},shouldHandleStateChanges:Boolean(e),initMapStateToProps:S,initMapDispatchToProps:E,initMergeProps:w,pure:u,areStatesEqual:p,areOwnPropsEqual:g,areStatePropsEqual:m,areMergedPropsEqual:y},b))}}var he=ue();function de(){return Object(n.useContext)(I)}function pe(e){void 0===e&&(e=I);var t=e===I?de:function(){return Object(n.useContext)(e)};return function(){return t().store}}var fe=pe();function ge(e){void 0===e&&(e=I);var t=e===I?fe:pe(e);return function(){return t().dispatch}}var _e=ge(),me=function(e,t){return e===t};function ve(e){void 0===e&&(e=I);var t=e===I?de:function(){return Object(n.useContext)(e)};return function(e,i){void 0===i&&(i=me);var r=t();return function(e,t,i,r){var a,o=Object(n.useReducer)((function(e){return e+1}),0)[1],s=Object(n.useMemo)((function(){return new R(i,r)}),[i,r]),l=Object(n.useRef)(),c=Object(n.useRef)(),u=Object(n.useRef)();try{a=e!==c.current||l.current?e(i.getState()):u.current}catch(e){throw l.current&&(e.message+="\nThe error may be correlated with this previous error:\n"+l.current.stack+"\n\n"),e}return U((function(){c.current=e,u.current=a,l.current=void 0})),U((function(){function e(){try{var e=c.current(i.getState());if(t(e,u.current))return;u.current=e}catch(e){l.current=e}o({})}return s.onStateChange=e,s.trySubscribe(),e(),function(){return s.tryUnsubscribe()}}),[i,s]),a}(e,i,r.store,r.subscription)}}var ye=ve();P=C},function(e,t,i){"use strict";i.r(t),i.d(t,"useState",(function(){return f})),i.d(t,"useReducer",(function(){return g})),i.d(t,"useEffect",(function(){return _})),i.d(t,"useLayoutEffect",(function(){return m})),i.d(t,"useRef",(function(){return v})),i.d(t,"useImperativeHandle",(function(){return y})),i.d(t,"useMemo",(function(){return b})),i.d(t,"useCallback",(function(){return S})),i.d(t,"useContext",(function(){return E})),i.d(t,"useDebugValue",(function(){return w})),i.d(t,"useErrorBoundary",(function(){return T}));var n,r,a,o=i(1),s=0,l=[],c=o.options.__r,u=o.options.diffed,h=o.options.__c,d=o.options.unmount;function p(e,t){o.options.__h&&o.options.__h(r,e,s||t),s=0;var i=r.__H||(r.__H={__:[],__h:[]});return e>=i.__.length&&i.__.push({}),i.__[e]}function f(e){return s=1,g(P,e)}function g(e,t,i){var a=p(n++,2);return a.t=e,a.__c||(a.__c=r,a.__=[i?i(t):P(void 0,t),function(e){var t=a.t(a.__[0],e);a.__[0]!==t&&(a.__=[t,a.__[1]],a.__c.setState({}))}]),a.__}function _(e,t){var i=p(n++,3);!o.options.__s&&I(i.__H,t)&&(i.__=e,i.__H=t,r.__H.__h.push(i))}function m(e,t){var i=p(n++,4);!o.options.__s&&I(i.__H,t)&&(i.__=e,i.__H=t,r.__h.push(i))}function v(e){return s=5,b((function(){return{current:e}}),[])}function y(e,t,i){s=6,m((function(){"function"==typeof e?e(t()):e&&(e.current=t())}),null==i?i:i.concat(e))}function b(e,t){var i=p(n++,7);return I(i.__H,t)?(i.__H=t,i.__h=e,i.__=e()):i.__}function S(e,t){return s=8,b((function(){return e}),t)}function E(e){var t=r.context[e.__c],i=p(n++,9);return i.__c=e,t?(null==i.__&&(i.__=!0,t.sub(r)),t.props.value):e.__}function w(e,t){o.options.useDebugValue&&o.options.useDebugValue(t?t(e):e)}function T(e){var t=p(n++,10),i=f();return t.__=e,r.componentDidCatch||(r.componentDidCatch=function(e){t.__&&t.__(e),i[1](e)}),[i[0],function(){i[1](void 0)}]}function M(){l.some((function(e){if(e.__P)try{e.__H.__h.forEach(C),e.__H.__h.forEach(x),e.__H.__h=[]}catch(t){return e.__H.__h=[],o.options.__e(t,e.__v),!0}})),l=[]}o.options.__r=function(e){c&&c(e),n=0;var t=(r=e.__c).__H;t&&(t.__h.forEach(C),t.__h.forEach(x),t.__h=[])},o.options.diffed=function(e){u&&u(e);var t=e.__c;t&&t.__H&&t.__H.__h.length&&(1!==l.push(t)&&a===o.options.requestAnimationFrame||((a=o.options.requestAnimationFrame)||function(e){var t,i=function(){clearTimeout(n),A&&cancelAnimationFrame(t),setTimeout(e)},n=setTimeout(i,100);A&&(t=requestAnimationFrame(i))})(M))},o.options.__c=function(e,t){t.some((function(e){try{e.__h.forEach(C),e.__h=e.__h.filter((function(e){return!e.__||x(e)}))}catch(i){t.some((function(e){e.__h&&(e.__h=[])})),t=[],o.options.__e(i,e.__v)}})),h&&h(e,t)},o.options.unmount=function(e){d&&d(e);var t=e.__c;if(t&&t.__H)try{t.__H.__.forEach(C)}catch(e){o.options.__e(e,t.__v)}};var A="function"==typeof requestAnimationFrame;function C(e){"function"==typeof e.u&&e.u()}function x(e){e.u=e.__()}function I(e,t){return!e||t.some((function(t,i){return t!==e[i]}))}function P(e,t){return"function"==typeof t?t(e):t}},function(e,t,i){"use strict";i.r(t),i.d(t,"__DO_NOT_USE__ActionTypes",(function(){return a})),i.d(t,"applyMiddleware",(function(){return _})),i.d(t,"bindActionCreators",(function(){return h})),i.d(t,"combineReducers",(function(){return c})),i.d(t,"compose",(function(){return g})),i.d(t,"createStore",(function(){return s}));var n=i(13),r=function(){return Math.random().toString(36).substring(7).split("").join(".")},a={INIT:"@@redux/INIT"+r(),REPLACE:"@@redux/REPLACE"+r(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+r()}};function o(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function s(e,t,i){var r;if("function"==typeof t&&"function"==typeof i||"function"==typeof i&&"function"==typeof arguments[3])throw new Error("It looks like you are passing several store enhancers to createStore(). This is not supported. Instead, compose them together to a single function.");if("function"==typeof t&&void 0===i&&(i=t,t=void 0),void 0!==i){if("function"!=typeof i)throw new Error("Expected the enhancer to be a function.");return i(s)(e,t)}if("function"!=typeof e)throw new Error("Expected the reducer to be a function.");var l=e,c=t,u=[],h=u,d=!1;function p(){h===u&&(h=u.slice())}function f(){if(d)throw new Error("You may not call store.getState() while the reducer is executing. The reducer has already received the state as an argument. Pass it down from the top reducer instead of reading it from the store.");return c}function g(e){if("function"!=typeof e)throw new Error("Expected the listener to be a function.");if(d)throw new Error("You may not call store.subscribe() while the reducer is executing. If you would like to be notified after the store has been updated, subscribe from a component and invoke store.getState() in the callback to access the latest state. See https://redux.js.org/api-reference/store#subscribelistener for more details.");var t=!0;return p(),h.push(e),function(){if(t){if(d)throw new Error("You may not unsubscribe from a store listener while the reducer is executing. See https://redux.js.org/api-reference/store#subscribelistener for more details.");t=!1,p();var i=h.indexOf(e);h.splice(i,1),u=null}}}function _(e){if(!o(e))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if(void 0===e.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(d)throw new Error("Reducers may not dispatch actions.");try{d=!0,c=l(c,e)}finally{d=!1}for(var t=u=h,i=0;i<t.length;i++){(0,t[i])()}return e}function m(e){if("function"!=typeof e)throw new Error("Expected the nextReducer to be a function.");l=e,_({type:a.REPLACE})}function v(){var e,t=g;return(e={subscribe:function(e){if("object"!=typeof e||null===e)throw new TypeError("Expected the observer to be an object.");function i(){e.next&&e.next(f())}return i(),{unsubscribe:t(i)}}})[n.a]=function(){return this},e}return _({type:a.INIT}),(r={dispatch:_,subscribe:g,getState:f,replaceReducer:m})[n.a]=v,r}function l(e,t){var i=t&&t.type;return"Given "+(i&&'action "'+String(i)+'"'||"an action")+', reducer "'+e+'" returned undefined. To ignore an action, you must explicitly return the previous state. If you want this reducer to hold no value, you can return null instead of undefined.'}function c(e){for(var t=Object.keys(e),i={},n=0;n<t.length;n++){var r=t[n];0,"function"==typeof e[r]&&(i[r]=e[r])}var o,s=Object.keys(i);try{!function(e){Object.keys(e).forEach((function(t){var i=e[t];if(void 0===i(void 0,{type:a.INIT}))throw new Error('Reducer "'+t+"\" returned undefined during initialization. If the state passed to the reducer is undefined, you must explicitly return the initial state. The initial state may not be undefined. If you don't want to set a value for this reducer, you can use null instead of undefined.");if(void 0===i(void 0,{type:a.PROBE_UNKNOWN_ACTION()}))throw new Error('Reducer "'+t+"\" returned undefined when probed with a random type. Don't try to handle "+a.INIT+' or other actions in "redux/*" namespace. They are considered private. Instead, you must return the current state for any unknown actions, unless it is undefined, in which case you must return the initial state, regardless of the action type. The initial state may not be undefined, but can be null.')}))}(i)}catch(e){o=e}return function(e,t){if(void 0===e&&(e={}),o)throw o;for(var n=!1,r={},a=0;a<s.length;a++){var c=s[a],u=i[c],h=e[c],d=u(h,t);if(void 0===d){var p=l(c,t);throw new Error(p)}r[c]=d,n=n||d!==h}return(n=n||s.length!==Object.keys(e).length)?r:e}}function u(e,t){return function(){return t(e.apply(this,arguments))}}function h(e,t){if("function"==typeof e)return u(e,t);if("object"!=typeof e||null===e)throw new Error("bindActionCreators expected an object or a function, instead received "+(null===e?"null":typeof e)+'. Did you write "import ActionCreators from" instead of "import * as ActionCreators from"?');var i={};for(var n in e){var r=e[n];"function"==typeof r&&(i[n]=u(r,t))}return i}function d(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function p(e,t){var i=Object.keys(e);return Object.getOwnPropertySymbols&&i.push.apply(i,Object.getOwnPropertySymbols(e)),t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i}function f(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?p(i,!0).forEach((function(t){d(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):p(i).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function g(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce((function(e,t){return function(){return e(t.apply(void 0,arguments))}}))}function _(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return function(e){return function(){var i=e.apply(void 0,arguments),n=function(){throw new Error("Dispatching while constructing your middleware is not allowed. Other middleware would not be applied to this dispatch.")},r={getState:i.getState,dispatch:function(){return n.apply(void 0,arguments)}},a=t.map((function(e){return e(r)}));return f({},i,{dispatch:n=g.apply(void 0,a)(i.dispatch)})}}}},function(e,t,i){"use strict";function n(e){var t=Math.floor(e/60)<10?"0"+Math.floor(e/60):Math.floor(e/60),i=Math.floor(e-60*t)<10?"0"+Math.floor(e-60*t):Math.floor(e-60*t);return isNaN(i)?"00:00":t+":"+i}function r(e){void 0!==performance.mark&&performance.mark(e)}function a(e,t,i){const n=t/i>1?1:0;let r=e.findIndex(e=>!(1==n&&e.aspectRatio<1||0==n&&e.aspectRatio>1)&&e.width>=t);if(window.devicePixelRatio>1){const i=2*t;for(r+=1;r<e.length;r++){const t=e[r];if(!(1==n&&t.aspectRatio<1||0==n&&t.aspectRatio>1)&&t.width>=i)break}}return-1===r||r===e.length?e[e.length-1].url:e[r].url}function o(e){if(e)for(;e.firstChild;)e.removeChild(e.firstChild)}function s(e){let t;return t="0"===e.slice(0,1)?e.slice(1,e.length):e,t}function l(e){for(var t=e+"=",i=document.cookie.split(";"),n=0;n<i.length;n++){for(var r=i[n];" "==r.charAt(0);)r=r.substring(1);if(-1!=r.indexOf(t))return r.substring(t.length,r.length)}return""}function c(e){return fetch(e).then(e=>{if(!e.ok)throw new Error("".concat(e.status," ").concat(e.statusText));return e.json()}).then(e=>{if(!e.items||0===e.items.length)return null;const t=e.items[0];if(t.error)throw new Error(t.error);return e.items})}function u(e,t,i,n){var r="";t.useHttps&&(r="&https=1");var a="";a=null!==i.column?"&type=column&query="+encodeURIComponent(i.column):"&type="+t.suggestionsType+"&query=news";try{t.suggestionsDoctype?a="&doctype="+t.suggestionsDoctype:""!==t.suggestionsQuery?a="&type="+t.suggestionsType+"&query="+t.suggestionsQuery.replace("&","%26"):i.column||(i["wsj-subsection"]?a="&type=wsj-subsection&query="+i["wsj-subsection"].replace("&","%26").replace(" ","%20"):i["wsj-section"]&&(a="&type=wsj-section&query="+i["wsj-section"].replace("&","%26"))),""!=t.suggestionsGroupId?a+="&groupid="+t.suggestionsGroupId:i.doctypeID?a+="&groupid=".concat(i.doctypeID):-1!==document.location.href.indexOf("www.wsj.com")&&(a+="&groupid=4276")}catch(e){}return c(e+"find_all_videos.asp?count=15"+r+a+"&fields="+n)}function h(e){return fetch(e).then(e=>{if(!e.ok)throw new Error("".concat(e.status," ").concat(e.statusText));return e.json()})}function d(e,t){e="string"==typeof e?e:e.host;const i=["mansionglobal.com"];for(let n=0;n<i.length;n++)if(-1!==e.indexOf(i[n]))return t?"oms."+i[n]:"om."+i[n];return t?"oms.dowjoneson.com":"om.dowjoneson.com"}function p(e){return-1!==(e="string"==typeof e?e:e.host).indexOf("cwsj.com")||-1!==e.indexOf("cn.wsj.com")?"WSJ China":-1!==e.indexOf("jwsj.com")?"WSJ Japan":-1!==e.indexOf("kr.wsj.com")?"WSJ Korea":-1!==e.indexOf("indo.wsj.com")?"WSJ Indonesia":-1!==e.indexOf("wsj.com")?"WSJ":-1!==e.indexOf("marketwatch.com")?"MarketWatch":-1!==e.indexOf("barrons.com")?"Barrons Online":-1!==e.indexOf("wsj.de")?"WSJ Germany":-1!==e.indexOf("allthingsd.com")?"AllThingsD":-1!==e.indexOf("smartmoney.com")?"SmartMoney":-1!==e.indexOf("fxtrader")?"DJFXTrader":-1!==e.indexOf("fins.com")?"FINS":-1!==e.indexOf("mansionglobal.com")?"Mansion Global":-1!==e.indexOf("moneyish.com")?"Moneyish":"WSJ"}function f(){try{var e,t;let i=null===(e=window)||void 0===e||null===(t=e.utag_data)||void 0===t?void 0:t.user_type;if(!i){const e=document.querySelector('meta[name="user.type"]');null!==e&&(i=e.getAttribute("content"))}return void 0!==i&&"nonsubscriber"!==i}catch(e){return!1}}function g(e){e.type}function _(e){const t=["abort","canplay","canplaythrough","durationchange","emptied","encrypted","ended","error","interruptbegin","interruptend","loadeddata","loadedmetadata","loadstart","mozaudioavailable","pause","play","playing","progress","ratechange","seeked","seeking","stalled","suspend","timeupdate","volumechange","waiting"];for(const i of t)e.removeEventListener(i,g),e.addEventListener(i,g)}function m(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(location.search);return null===t?"":decodeURIComponent(t[1].replace(/\+/g," "))}function v(){switch(m("wsjVideoApi")){case"prod":return"https://video-api.shdsvc.dowjones.io/api/";case"dev":return"https://video-api.dev.shdsvc.dowjones.io/api/";default:return null}}i.r(t),i.d(t,"gTimeFormat",(function(){return n})),i.d(t,"createMark",(function(){return r})),i.d(t,"pickBestThumbnail",(function(){return a})),i.d(t,"emptyElement",(function(){return o})),i.d(t,"removeZeros",(function(){return s})),i.d(t,"getCookie",(function(){return l})),i.d(t,"fetchFromApi",(function(){return c})),i.d(t,"getNewPlaylist",(function(){return u})),i.d(t,"fetchServerTime",(function(){return h})),i.d(t,"getOmnitureTrackingServer",(function(){return d})),i.d(t,"getChannelFromDomain",(function(){return p})),i.d(t,"isUserLoggedIn",(function(){return f})),i.d(t,"debugVideoEvents",(function(){return _})),i.d(t,"getUrlParameter",(function(){return m})),i.d(t,"getApiUrlOverride",(function(){return v}))},function(e,t,i){"use strict";i.r(t),i.d(t,"NONE",(function(){return n})),i.d(t,"STARTED",(function(){return r})),i.d(t,"FINISHED",(function(){return a})),i.d(t,"FAILED",(function(){return o}));const n="NONE",r="STARTED",a="FINISHED",o="FAILED"},function(e,t,i){"use strict";function n(e){for(var t=arguments.length,i=Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];throw Error("[Immer] minified error nr: "+e+(i.length?" "+i.join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function r(e){return!!e&&!!e[K]}function a(e){return!!e&&(function(e){if(!e||"object"!=typeof e)return!1;var t=Object.getPrototypeOf(e);return!t||t===Object.prototype}(e)||Array.isArray(e)||!!e[Y]||!!e.constructor[Y]||d(e)||p(e))}function o(e,t,i){void 0===i&&(i=!1),0===s(e)?(i?Object.keys:q)(e).forEach((function(n){i&&"symbol"==typeof n||t(n,e[n],e)})):e.forEach((function(i,n){return t(n,i,e)}))}function s(e){var t=e[K];return t?t.i>3?t.i-4:t.i:Array.isArray(e)?1:d(e)?2:p(e)?3:0}function l(e,t){return 2===s(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function c(e,t){return 2===s(e)?e.get(t):e[t]}function u(e,t,i){var n=s(e);2===n?e.set(t,i):3===n?(e.delete(t),e.add(i)):e[t]=i}function h(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}function d(e){return G&&e instanceof Map}function p(e){return j&&e instanceof Set}function f(e){return e.o||e.t}function g(e){if(Array.isArray(e))return Array.prototype.slice.call(e);var t=X(e);delete t[K];for(var i=q(t),n=0;n<i.length;n++){var r=i[n],a=t[r];!1===a.writable&&(a.writable=!0,a.configurable=!0),(a.get||a.set)&&(t[r]={configurable:!0,writable:!0,enumerable:a.enumerable,value:e[r]})}return Object.create(Object.getPrototypeOf(e),t)}function _(e,t){v(e)||r(e)||!a(e)||(s(e)>1&&(e.set=e.add=e.clear=e.delete=m),Object.freeze(e),t&&o(e,(function(e,t){return _(t,!0)}),!0))}function m(){n(2)}function v(e){return null==e||"object"!=typeof e||Object.isFrozen(e)}function y(e){var t=Q[e];return t||n(19,e),t}function b(e,t){Q[e]=t}function S(){return U}function E(e,t){t&&(y("Patches"),e.u=[],e.s=[],e.v=t)}function w(e){T(e),e.p.forEach(A),e.p=null}function T(e){e===U&&(U=e.l)}function M(e){return U={p:[],l:U,h:e,m:!0,_:0}}function A(e){var t=e[K];0===t.i||1===t.i?t.j():t.g=!0}function C(e,t){t._=t.p.length;var i=t.p[0],r=void 0!==e&&e!==i;return t.h.O||y("ES5").S(t,e,r),r?(i[K].P&&(w(t),n(4)),a(e)&&(e=x(t,e),t.l||P(t,e)),t.u&&y("Patches").M(i[K],e,t.u,t.s)):e=x(t,i,[]),w(t),t.u&&t.v(t.u,t.s),e!==W?e:void 0}function x(e,t,i){if(v(t))return t;var n=t[K];if(!n)return o(t,(function(r,a){return I(e,n,t,r,a,i)}),!0),t;if(n.A!==e)return t;if(!n.P)return P(e,n.t,!0),n.t;if(!n.I){n.I=!0,n.A._--;var r=4===n.i||5===n.i?n.o=g(n.k):n.o;o(3===n.i?new Set(r):r,(function(t,a){return I(e,n,r,t,a,i)})),P(e,r,!1),i&&e.u&&y("Patches").R(n,i,e.u,e.s)}return n.o}function I(e,t,i,n,o,s){if(r(o)){var c=x(e,o,s&&t&&3!==t.i&&!l(t.D,n)?s.concat(n):void 0);if(u(i,n,c),!r(c))return;e.m=!1}if(a(o)&&!v(o)){if(!e.h.N&&e._<1)return;x(e,o),t&&t.A.l||P(e,o)}}function P(e,t,i){void 0===i&&(i=!1),e.h.N&&e.m&&_(t,i)}function L(e,t){var i=e[K];return(i?f(i):e)[t]}function D(e,t){if(t in e)for(var i=Object.getPrototypeOf(e);i;){var n=Object.getOwnPropertyDescriptor(i,t);if(n)return n;i=Object.getPrototypeOf(i)}}function R(e){e.P||(e.P=!0,e.l&&R(e.l))}function k(e){e.o||(e.o=g(e.t))}function O(e,t,i){var n=d(t)?y("MapSet").T(t,i):p(t)?y("MapSet").F(t,i):e.O?function(e,t){var i=Array.isArray(e),n={i:i?1:0,A:t?t.A:S(),P:!1,I:!1,D:{},l:t,t:e,k:null,o:null,j:null,C:!1},r=n,a=Z;i&&(r=[n],a=J);var o=Proxy.revocable(r,a),s=o.revoke,l=o.proxy;return n.k=l,n.j=s,l}(t,i):y("ES5").J(t,i);return(i?i.A:S()).p.push(n),n}function N(e){return r(e)||n(22,e),function e(t){if(!a(t))return t;var i,n=t[K],r=s(t);if(n){if(!n.P&&(n.i<4||!y("ES5").K(n)))return n.t;n.I=!0,i=F(t,r),n.I=!1}else i=F(t,r);return o(i,(function(t,r){n&&c(n.t,t)===r||u(i,t,e(r))})),3===r?new Set(i):i}(e)}function F(e,t){switch(t){case 2:return new Map(e);case 3:return Array.from(e)}return g(e)}function V(){function e(e,t){var i=a[e];return i?i.enumerable=t:a[e]=i={configurable:!0,enumerable:t,get:function(){var t=this[K];return Z.get(t,e)},set:function(t){var i=this[K];Z.set(i,e,t)}},i}function t(e){for(var t=e.length-1;t>=0;t--){var r=e[t][K];if(!r.P)switch(r.i){case 5:n(r)&&R(r);break;case 4:i(r)&&R(r)}}}function i(e){for(var t=e.t,i=e.k,n=q(i),r=n.length-1;r>=0;r--){var a=n[r];if(a!==K){var o=t[a];if(void 0===o&&!l(t,a))return!0;var s=i[a],c=s&&s[K];if(c?c.t!==o:!h(s,o))return!0}}var u=!!t[K];return n.length!==q(t).length+(u?0:1)}function n(e){var t=e.k;if(t.length!==e.t.length)return!0;var i=Object.getOwnPropertyDescriptor(t,t.length-1);return!(!i||i.get)}var a={};b("ES5",{J:function(t,i){var n=Array.isArray(t),r=function(t,i){if(t){for(var n=Array(i.length),r=0;r<i.length;r++)Object.defineProperty(n,""+r,e(r,!0));return n}var a=X(i);delete a[K];for(var o=q(a),s=0;s<o.length;s++){var l=o[s];a[l]=e(l,t||!!a[l].enumerable)}return Object.create(Object.getPrototypeOf(i),a)}(n,t),a={i:n?5:4,A:i?i.A:S(),P:!1,I:!1,D:{},l:i,t:t,k:r,o:null,g:!1,C:!1};return Object.defineProperty(r,K,{value:a,writable:!0}),r},S:function(e,i,a){a?r(i)&&i[K].A===e&&t(e.p):(e.u&&function e(t){if(t&&"object"==typeof t){var i=t[K];if(i){var r=i.t,a=i.k,s=i.D,c=i.i;if(4===c)o(a,(function(t){t!==K&&(void 0!==r[t]||l(r,t)?s[t]||e(a[t]):(s[t]=!0,R(i)))})),o(r,(function(e){void 0!==a[e]||l(a,e)||(s[e]=!1,R(i))}));else if(5===c){if(n(i)&&(R(i),s.length=!0),a.length<r.length)for(var u=a.length;u<r.length;u++)s[u]=!1;else for(var h=r.length;h<a.length;h++)s[h]=!0;for(var d=Math.min(a.length,r.length),p=0;p<d;p++)void 0===s[p]&&e(a[p])}}}}(e.p[0]),t(e.p))},K:function(e){return 4===e.i?i(e):n(e)}})}i.r(t),i.d(t,"showControls",(function(){return se})),i.d(t,"hideControls",(function(){return le})),i.d(t,"playVideo",(function(){return ce})),i.d(t,"pauseVideo",(function(){return ue})),i.d(t,"updateProgress",(function(){return he})),i.d(t,"updateDuration",(function(){return de})),i.d(t,"mute",(function(){return pe})),i.d(t,"unmute",(function(){return fe})),i.d(t,"setVolume",(function(){return ge})),i.d(t,"setVolumeControlVisibility",(function(){return _e})),i.d(t,"enterFullScreen",(function(){return me})),i.d(t,"exitFullScreen",(function(){return ve})),i.d(t,"startAdMode",(function(){return ye})),i.d(t,"stopAdMode",(function(){return be})),i.d(t,"updateAdProgress",(function(){return Se})),i.d(t,"playAd",(function(){return Ee})),i.d(t,"pauseAd",(function(){return we})),i.d(t,"adBuffering",(function(){return Te})),i.d(t,"resize",(function(){return Me})),i.d(t,"showThumbnail",(function(){return Ae})),i.d(t,"hideThumbnail",(function(){return Ce})),i.d(t,"updateVideoData",(function(){return xe})),i.d(t,"showMoreVideosSlide",(function(){return Ie})),i.d(t,"hideMoreVideosSlide",(function(){return Pe})),i.d(t,"showEndscreen",(function(){return Le})),i.d(t,"hideEndscreen",(function(){return De})),i.d(t,"showShareScreen",(function(){return Re})),i.d(t,"hideShareScreen",(function(){return ke})),i.d(t,"replacePlaylist",(function(){return Oe})),i.d(t,"dequeuePlaylist",(function(){return Ne})),i.d(t,"showCountdown",(function(){return Fe})),i.d(t,"hideCountdown",(function(){return Ve})),i.d(t,"showClickForSound",(function(){return Be})),i.d(t,"hideClickForSound",(function(){return Ue})),i.d(t,"showClosedCaptions",(function(){return He})),i.d(t,"hideClosedCaptions",(function(){return Ge})),i.d(t,"setFocus",(function(){return je})),i.d(t,"showLoadingSpinner",(function(){return ze})),i.d(t,"hideLoadingSpinner",(function(){return We})),i.d(t,"setVideoApiLoadState",(function(){return Ye})),i.d(t,"setAdInitState",(function(){return Ke})),i.d(t,"setIMALoadState",(function(){return qe})),i.d(t,"setAdError",(function(){return Xe})),i.d(t,"setHlsJsLoadState",(function(){return Qe})),i.d(t,"startVideoPlaybackInit",(function(){return Ze})),i.d(t,"endVideoPlaybackInit",(function(){return Je})),i.d(t,"buffering",(function(){return $e})),i.d(t,"canPlay",(function(){return et})),i.d(t,"showSavedModal",(function(){return tt})),i.d(t,"hideSavedModal",(function(){return it})),i.d(t,"enableLogging",(function(){return nt}));var B,U,H="undefined"!=typeof Symbol&&"symbol"==typeof Symbol("x"),G="undefined"!=typeof Map,j="undefined"!=typeof Set,z="undefined"!=typeof Proxy&&void 0!==Proxy.revocable&&"undefined"!=typeof Reflect,W=H?Symbol.for("immer-nothing"):((B={})["immer-nothing"]=!0,B),Y=H?Symbol.for("immer-draftable"):"__$immer_draftable",K=H?Symbol.for("immer-state"):"__$immer_state",q=("undefined"!=typeof Symbol&&Symbol.iterator,"undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames),X=Object.getOwnPropertyDescriptors||function(e){var t={};return q(e).forEach((function(i){t[i]=Object.getOwnPropertyDescriptor(e,i)})),t},Q={},Z={get:function(e,t){if(t===K)return e;var i=f(e);if(!l(i,t))return function(e,t,i){var n,r=D(t,i);return r?"value"in r?r.value:null===(n=r.get)||void 0===n?void 0:n.call(e.k):void 0}(e,i,t);var n=i[t];return e.I||!a(n)?n:n===L(e.t,t)?(k(e),e.o[t]=O(e.A.h,n,e)):n},has:function(e,t){return t in f(e)},ownKeys:function(e){return Reflect.ownKeys(f(e))},set:function(e,t,i){var n=D(f(e),t);if(null==n?void 0:n.set)return n.set.call(e.k,i),!0;if(e.D[t]=!0,!e.P){if(h(i,L(f(e),t))&&(void 0!==i||l(e.t,t)))return!0;k(e),R(e)}return e.o[t]=i,!0},deleteProperty:function(e,t){return void 0!==L(e.t,t)||t in e.t?(e.D[t]=!1,k(e),R(e)):delete e.D[t],e.o&&delete e.o[t],!0},getOwnPropertyDescriptor:function(e,t){var i=f(e),n=Reflect.getOwnPropertyDescriptor(i,t);return n?{writable:!0,configurable:1!==e.i||"length"!==t,enumerable:n.enumerable,value:i[t]}:n},defineProperty:function(){n(11)},getPrototypeOf:function(e){return Object.getPrototypeOf(e.t)},setPrototypeOf:function(){n(12)}},J={};o(Z,(function(e,t){J[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}})),J.deleteProperty=function(e,t){return Z.deleteProperty.call(this,e[0],t)},J.set=function(e,t,i){return Z.set.call(this,e[0],t,i,e[0])};var $=new(function(){function e(e){this.O=z,this.N=!1,"boolean"==typeof(null==e?void 0:e.useProxies)&&this.setUseProxies(e.useProxies),"boolean"==typeof(null==e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze),this.produce=this.produce.bind(this),this.produceWithPatches=this.produceWithPatches.bind(this)}var t=e.prototype;return t.produce=function(e,t,i){if("function"==typeof e&&"function"!=typeof t){var r=t;t=e;var o=this;return function(e){var i=this;void 0===e&&(e=r);for(var n=arguments.length,a=Array(n>1?n-1:0),s=1;s<n;s++)a[s-1]=arguments[s];return o.produce(e,(function(e){var n;return(n=t).call.apply(n,[i,e].concat(a))}))}}var s;if("function"!=typeof t&&n(6),void 0!==i&&"function"!=typeof i&&n(7),a(e)){var l=M(this),c=O(this,e,void 0),u=!0;try{s=t(c),u=!1}finally{u?w(l):T(l)}return"undefined"!=typeof Promise&&s instanceof Promise?s.then((function(e){return E(l,i),C(e,l)}),(function(e){throw w(l),e})):(E(l,i),C(s,l))}if(!e||"object"!=typeof e){if((s=t(e))===W)return;return void 0===s&&(s=e),this.N&&_(s,!0),s}n(21,e)},t.produceWithPatches=function(e,t){var i,n,r=this;return"function"==typeof e?function(t){for(var i=arguments.length,n=Array(i>1?i-1:0),a=1;a<i;a++)n[a-1]=arguments[a];return r.produceWithPatches(t,(function(t){return e.apply(void 0,[t].concat(n))}))}:[this.produce(e,t,(function(e,t){i=e,n=t})),i,n]},t.createDraft=function(e){a(e)||n(8),r(e)&&(e=N(e));var t=M(this),i=O(this,e,void 0);return i[K].C=!0,T(t),i},t.finishDraft=function(e,t){var i=(e&&e[K]).A;return E(i,t),C(void 0,i)},t.setAutoFreeze=function(e){this.N=e},t.setUseProxies=function(e){e&&!z&&n(20),this.O=e},t.applyPatches=function(e,t){var i;for(i=t.length-1;i>=0;i--){var n=t[i];if(0===n.path.length&&"replace"===n.op){e=n.value;break}}var a=y("Patches").$;return r(e)?a(e,t):this.produce(e,(function(e){return a(e,t.slice(i+1))}))},e}()),ee=($.produce,$.produceWithPatches.bind($),$.setAutoFreeze.bind($),$.setUseProxies.bind($),$.applyPatches.bind($),$.createDraft.bind($),$.finishDraft.bind($),i(4));function te(e,t){return e===t}function ie(e,t,i){if(null===t||null===i||t.length!==i.length)return!1;for(var n=t.length,r=0;r<n;r++)if(!e(t[r],i[r]))return!1;return!0}function ne(e){var t=Array.isArray(e[0])?e[0]:e;if(!t.every((function(e){return"function"==typeof e}))){var i=t.map((function(e){return typeof e})).join(", ");throw new Error("Selector creators expect all input-selectors to be functions, instead received the following types: ["+i+"]")}return t}!function(e){for(var t=arguments.length,i=Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n]}((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:te,i=null,n=null;return function(){return ie(t,i,arguments)||(n=e.apply(null,arguments)),i=arguments,n}}));i(15);function re(){return(re=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e}).apply(this,arguments)}"undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__;function ae(e,t){function i(){if(t){var i=t.apply(void 0,arguments);if(!i)throw new Error("prepareAction did not return an object");return re({type:e,payload:i.payload},"meta"in i&&{meta:i.meta},{},"error"in i&&{error:i.error})}return{type:e,payload:arguments.length<=0?void 0:arguments[0]}}return i.toString=function(){return""+e},i.type=e,i.match=function(t){return t.type===e},i}"undefined"!=typeof Symbol&&(Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator"))),"undefined"!=typeof Symbol&&(Symbol.asyncIterator||(Symbol.asyncIterator=Symbol("Symbol.asyncIterator")));V();var oe=i(0);function se(){return{type:oe.h}}function le(){return{type:oe.g}}function ce(){return{type:oe.U}}function ue(){return{type:oe.T}}function he(e){return{type:oe.V,currentPosition:e}}function de(e){return"number"!=typeof e&&(e=parseInt(e,10)),{type:oe.O,duration:e}}function pe(){return{type:oe.S}}function fe(){return{type:oe.X}}function ge(e){return{type:oe.Y,volume:e}}function _e(e){return{type:oe.w,isVolumeControlVisible:e}}function me(){return{type:oe.Q}}function ve(){return{type:oe.R}}const ye=ae(oe.f),be=ae(oe.b),Se=ae(oe.e),Ee=ae(oe.d),we=ae(oe.c),Te=ae(oe.a);function Me(e,t){return{type:oe.u,width:e,height:t}}const Ae=ae(oe.F),Ce=ae(oe.E);function xe(e){return{type:oe.L,videoData:e}}const Ie=ae(oe.s),Pe=ae(oe.r),Le=ae(oe.A),De=ae(oe.n),Re=ae(oe.D),ke=ae(oe.q);function Oe(e){return{type:oe.t,playlist:e}}const Ne=ae(oe.i),Fe=ae(oe.z),Ve=ae(oe.m),Be=ae(oe.x),Ue=ae(oe.k),He=ae(oe.y),Ge=ae(oe.l),je=ae(oe.v),ze=ae(oe.B),We=ae(oe.o),Ye=ae(oe.K),Ke=ae(oe.H),qe=ae(oe.J),Xe=ae(oe.G),Qe=ae(oe.I),Ze=ae(oe.W),Je=ae(oe.P),$e=ae(oe.M),et=ae(oe.N),tt=ae(oe.C),it=ae(oe.p),nt=ae(oe.j)},function(e,t){var i="Webkit Moz O ms".split(" ");function n(e,t,n){for(var a=e.style,o=0;o<i.length;++o){a[i[o]+r(t)]=n}a[t]=n}function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}function a(e){return!function(e){return"[object Array]"===Object.prototype.toString.call(e)}(e)&&("object"===typeof e&&!!e)}function o(e,t){for(var i in e){if(e.hasOwnProperty(i))t(e[i],i)}}e.exports={extend:function e(t,i,n){for(var r in t=t||{},n=n||!1,i=i||{})if(i.hasOwnProperty(r)){var o=t[r],s=i[r];n&&a(o)&&a(s)?t[r]=e(o,s,n):t[r]=s}return t},render:function(e,t){var i=e;for(var n in t)if(t.hasOwnProperty(n)){var r=t[n],a=new RegExp("\\{"+n+"\\}","g");i=i.replace(a,r)}return i},setStyle:n,setStyles:function(e,t){o(t,(function(t,i){null!=t&&(a(t)&&!0===t.prefix?n(e,i,t.value):e.style[i]=t)}))},capitalize:r,isString:function(e){return"string"==typeof e||e instanceof String},isFunction:function(e){return"function"==typeof e},isObject:a,forEachObject:o,floatEquals:function(e,t){return Math.abs(e-t)<.001},removeChildren:function(e){for(;e.firstChild;)e.removeChild(e.firstChild)}}},function(e,t){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(e){"object"==typeof window&&(i=window)}e.exports=i},function(e,t,i){var n;
/*!
  Copyright (c) 2017 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/!function(){"use strict";var i={}.hasOwnProperty;function r(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(n){var a=typeof n;if("string"===a||"number"===a)e.push(n);else if(Array.isArray(n)&&n.length){var o=r.apply(null,n);o&&e.push(o)}else if("object"===a)for(var s in n)i.call(n,s)&&n[s]&&e.push(s)}}return e.join(" ")}e.exports?(r.default=r,e.exports=r):void 0===(n=function(){return r}.apply(t,[]))||(e.exports=n)}()},function(e,t,i){function n(){return(n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e}).apply(this,arguments)}const{h:r,Component:a}=i(1),o=i(60),s=i(61);class l extends a{constructor(e){super(e),this._setCloseBtnRef=this._setCloseBtnRef.bind(this),this._handleTransitionEnd=this._handleTransitionEnd.bind(this),this._handleClose=this._handleClose.bind(this)}componentWillUnmount(){clearTimeout(this._closeTimer)}_setCloseBtnRef(e){this._closeBtnRef=e}_handleTransitionEnd(){const{onFadeIn:e,onFadeOut:t,isVisible:i}=this.props;i?e():t()}_handleClose(e){e&&e.stopPropagation(),this.props.onClose(e)}componentDidMount(){this._closeBtnRef&&(this._closeBtnRef.innerHTML=s),this.props.hideTimer&&(this._closeTimer=setTimeout(()=>this._handleClose(),this.props.hideTimer,this))}render(){const e=[o.modal],{isVisible:t}=this.props;this.props.className&&e.push(this.props.className),t||e.push(o.fadeOut);const i={className:e.join(" ")};return this.props.onClick&&(i.onClick=this.props.onClick,i.style={cursor:"pointer"}),this.props.style&&"object"==typeof this.props.style&&(i.style=Object.assign({},i.style,this.props.style)),r("div",n({},i,{onTransitionEnd:this._handleTransitionEnd}),this.props.children,!this.props.hideCloseButton&&r("button",{className:o.closeBtn,ref:this._setCloseBtnRef,onClick:this._handleClose,tabIndex:t?"0":"-1"}))}}l.defaultProps={onClose(){},onFadeIn(){},onFadeOut(){},isVisible:!0,hideCloseButton:!1},e.exports=l},function(e,t,i){var n=i(20),r=i(8),a=function e(t,i){if(!(this instanceof e))throw new Error("Constructor was called without new keyword");if(0!==arguments.length){this._opts=r.extend({color:"#555",strokeWidth:1,trailColor:null,trailWidth:null,fill:null,text:{style:{color:null,position:"absolute",left:"50%",top:"50%",padding:0,margin:0,transform:{prefix:!0,value:"translate(-50%, -50%)"}},autoStyleContainer:!0,alignToBottom:!0,value:null,className:"progressbar-text"},svgStyle:{display:"block",width:"100%"},warnings:!1},i,!0),r.isObject(i)&&void 0!==i.svgStyle&&(this._opts.svgStyle=i.svgStyle),r.isObject(i)&&r.isObject(i.text)&&void 0!==i.text.style&&(this._opts.text.style=i.text.style);var a,o=this._createSvgView(this._opts);if(!(a=r.isString(t)?document.querySelector(t):t))throw new Error("Container does not exist: "+t);this._container=a,this._container.appendChild(o.svg),this._opts.warnings&&this._warnContainerAspectRatio(this._container),this._opts.svgStyle&&r.setStyles(o.svg,this._opts.svgStyle),this.svg=o.svg,this.path=o.path,this.trail=o.trail,this.text=null;var s=r.extend({attachment:void 0,shape:this},this._opts);this._progressPath=new n(o.path,s),r.isObject(this._opts.text)&&null!==this._opts.text.value&&this.setText(this._opts.text.value)}};a.prototype.animate=function(e,t,i){if(null===this._progressPath)throw new Error("Object is destroyed");this._progressPath.animate(e,t,i)},a.prototype.stop=function(){if(null===this._progressPath)throw new Error("Object is destroyed");void 0!==this._progressPath&&this._progressPath.stop()},a.prototype.destroy=function(){if(null===this._progressPath)throw new Error("Object is destroyed");this.stop(),this.svg.parentNode.removeChild(this.svg),this.svg=null,this.path=null,this.trail=null,this._progressPath=null,null!==this.text&&(this.text.parentNode.removeChild(this.text),this.text=null)},a.prototype.set=function(e){if(null===this._progressPath)throw new Error("Object is destroyed");this._progressPath.set(e)},a.prototype.value=function(){if(null===this._progressPath)throw new Error("Object is destroyed");return void 0===this._progressPath?0:this._progressPath.value()},a.prototype.setText=function(e){if(null===this._progressPath)throw new Error("Object is destroyed");null===this.text&&(this.text=this._createTextContainer(this._opts,this._container),this._container.appendChild(this.text)),r.isObject(e)?(r.removeChildren(this.text),this.text.appendChild(e)):this.text.innerHTML=e},a.prototype._createSvgView=function(e){var t=document.createElementNS("http://www.w3.org/2000/svg","svg");this._initializeSvg(t,e);var i=null;(e.trailColor||e.trailWidth)&&(i=this._createTrail(e),t.appendChild(i));var n=this._createPath(e);return t.appendChild(n),{svg:t,path:n,trail:i}},a.prototype._initializeSvg=function(e,t){e.setAttribute("viewBox","0 0 100 100")},a.prototype._createPath=function(e){var t=this._pathString(e);return this._createPathElement(t,e)},a.prototype._createTrail=function(e){var t=this._trailString(e),i=r.extend({},e);return i.trailColor||(i.trailColor="#eee"),i.trailWidth||(i.trailWidth=i.strokeWidth),i.color=i.trailColor,i.strokeWidth=i.trailWidth,i.fill=null,this._createPathElement(t,i)},a.prototype._createPathElement=function(e,t){var i=document.createElementNS("http://www.w3.org/2000/svg","path");return i.setAttribute("d",e),i.setAttribute("stroke",t.color),i.setAttribute("stroke-width",t.strokeWidth),t.fill?i.setAttribute("fill",t.fill):i.setAttribute("fill-opacity","0"),i},a.prototype._createTextContainer=function(e,t){var i=document.createElement("div");i.className=e.text.className;var n=e.text.style;return n&&(e.text.autoStyleContainer&&(t.style.position="relative"),r.setStyles(i,n),n.color||(i.style.color=e.color)),this._initializeTextContainer(e,t,i),i},a.prototype._initializeTextContainer=function(e,t,i){},a.prototype._pathString=function(e){throw new Error("Override this function for each progress bar")},a.prototype._trailString=function(e){throw new Error("Override this function for each progress bar")},a.prototype._warnContainerAspectRatio=function(e){if(this.containerAspectRatio){var t=window.getComputedStyle(e,null),i=parseFloat(t.getPropertyValue("width"),10),n=parseFloat(t.getPropertyValue("height"),10);r.floatEquals(this.containerAspectRatio,i/n)||(console.warn("Incorrect aspect ratio of container","#"+e.id,"detected:",t.getPropertyValue("width")+"(width)","/",t.getPropertyValue("height")+"(height)","=",i/n),console.warn("Aspect ratio of should be",this.containerAspectRatio))}},e.exports=a},function(e,t,i){"use strict";(function(e,n){var r,a=i(22);r="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==e?e:n;var o=Object(a.a)(r);t.a=o}).call(this,i(9),i(35)(e))},function(e,t,i){"use strict";e.exports=i(41)},function(e,t,i){"use strict";function n(e){return function(t){var i=t.dispatch,n=t.getState;return function(t){return function(r){return"function"==typeof r?r(i,n,e):t(r)}}}}i.r(t);var r=n();r.withExtraArgument=n,t.default=r},function(e,t,i){"use strict";var n=i(14),r={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},a={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},o={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},s={};function l(e){return n.isMemo(e)?o:s[e.$$typeof]||r}s[n.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},s[n.Memo]=o;var c=Object.defineProperty,u=Object.getOwnPropertyNames,h=Object.getOwnPropertySymbols,d=Object.getOwnPropertyDescriptor,p=Object.getPrototypeOf,f=Object.prototype;e.exports=function e(t,i,n){if("string"!=typeof i){if(f){var r=p(i);r&&r!==f&&e(t,r,n)}var o=u(i);h&&(o=o.concat(h(i)));for(var s=l(t),g=l(i),_=0;_<o.length;++_){var m=o[_];if(!(a[m]||n&&n[m]||g&&g[m]||s&&s[m])){var v=d(i,m);try{c(t,m,v)}catch(e){}}}}return t}},function(e,t,i){var n,r,a,o,s,l,c,u,h,d,p,f,g,_,m,v,y,b,S,E,w,T,M,A,C,x,I,P,L,D,R,k,O,N,F,V,B,U,H,G,j,z,W,Y,K,q={REVISION:"78"};void 0===(r="function"==typeof(n=q)?n.call(t,i,t,e):n)||(e.exports=r),void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Math.sign&&(Math.sign=function(e){return e<0?-1:e>0?1:+e}),void 0===Function.prototype.name&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*(\S*)\s*\(/)[1]}}),void 0===Object.assign&&(Object.assign=function(e){"use strict";if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),i=1;i<arguments.length;i++){var n=arguments[i];if(null!=n)for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}),Object.assign(q,{MOUSE:{LEFT:0,MIDDLE:1,RIGHT:2},CullFaceNone:0,CullFaceBack:1,CullFaceFront:2,CullFaceFrontBack:3,FrontFaceDirectionCW:0,FrontFaceDirectionCCW:1,BasicShadowMap:0,PCFShadowMap:1,PCFSoftShadowMap:2,FrontSide:0,BackSide:1,DoubleSide:2,FlatShading:1,SmoothShading:2,NoColors:0,FaceColors:1,VertexColors:2,NoBlending:0,NormalBlending:1,AdditiveBlending:2,SubtractiveBlending:3,MultiplyBlending:4,CustomBlending:5,AddEquation:100,SubtractEquation:101,ReverseSubtractEquation:102,MinEquation:103,MaxEquation:104,ZeroFactor:200,OneFactor:201,SrcColorFactor:202,OneMinusSrcColorFactor:203,SrcAlphaFactor:204,OneMinusSrcAlphaFactor:205,DstAlphaFactor:206,OneMinusDstAlphaFactor:207,DstColorFactor:208,OneMinusDstColorFactor:209,SrcAlphaSaturateFactor:210,NeverDepth:0,AlwaysDepth:1,LessDepth:2,LessEqualDepth:3,EqualDepth:4,GreaterEqualDepth:5,GreaterDepth:6,NotEqualDepth:7,MultiplyOperation:0,MixOperation:1,AddOperation:2,NoToneMapping:0,LinearToneMapping:1,ReinhardToneMapping:2,Uncharted2ToneMapping:3,CineonToneMapping:4,UVMapping:300,CubeReflectionMapping:301,CubeRefractionMapping:302,EquirectangularReflectionMapping:303,EquirectangularRefractionMapping:304,SphericalReflectionMapping:305,CubeUVReflectionMapping:306,CubeUVRefractionMapping:307,RepeatWrapping:1e3,ClampToEdgeWrapping:1001,MirroredRepeatWrapping:1002,NearestFilter:1003,NearestMipMapNearestFilter:1004,NearestMipMapLinearFilter:1005,LinearFilter:1006,LinearMipMapNearestFilter:1007,LinearMipMapLinearFilter:1008,UnsignedByteType:1009,ByteType:1010,ShortType:1011,UnsignedShortType:1012,IntType:1013,UnsignedIntType:1014,FloatType:1015,HalfFloatType:1025,UnsignedShort4444Type:1016,UnsignedShort5551Type:1017,UnsignedShort565Type:1018,AlphaFormat:1019,RGBFormat:1020,RGBAFormat:1021,LuminanceFormat:1022,LuminanceAlphaFormat:1023,RGBEFormat:q.RGBAFormat,DepthFormat:1026,RGB_S3TC_DXT1_Format:2001,RGBA_S3TC_DXT1_Format:2002,RGBA_S3TC_DXT3_Format:2003,RGBA_S3TC_DXT5_Format:2004,RGB_PVRTC_4BPPV1_Format:2100,RGB_PVRTC_2BPPV1_Format:2101,RGBA_PVRTC_4BPPV1_Format:2102,RGBA_PVRTC_2BPPV1_Format:2103,RGB_ETC1_Format:2151,LoopOnce:2200,LoopRepeat:2201,LoopPingPong:2202,InterpolateDiscrete:2300,InterpolateLinear:2301,InterpolateSmooth:2302,ZeroCurvatureEnding:2400,ZeroSlopeEnding:2401,WrapAroundEnding:2402,TrianglesDrawMode:0,TriangleStripDrawMode:1,TriangleFanDrawMode:2,LinearEncoding:3e3,sRGBEncoding:3001,GammaEncoding:3007,RGBEEncoding:3002,LogLuvEncoding:3003,RGBM7Encoding:3004,RGBM16Encoding:3005,RGBDEncoding:3006,BasicDepthPacking:3200,RGBADepthPacking:3201}),q.Color=function(e,t,i){return void 0===t&&void 0===i?this.set(e):this.setRGB(e,t,i)},q.Color.prototype={constructor:q.Color,r:1,g:1,b:1,set:function(e){return e instanceof q.Color?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this},setScalar:function(e){this.r=e,this.g=e,this.b=e},setHex:function(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,this},setRGB:function(e,t,i){return this.r=e,this.g=t,this.b=i,this},setHSL:function(){function e(e,t,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?e+6*(t-e)*i:i<.5?t:i<2/3?e+6*(t-e)*(2/3-i):e}return function(t,i,n){if(t=q.Math.euclideanModulo(t,1),i=q.Math.clamp(i,0,1),n=q.Math.clamp(n,0,1),0===i)this.r=this.g=this.b=n;else{var r=n<=.5?n*(1+i):n+i-n*i,a=2*n-r;this.r=e(a,r,t+1/3),this.g=e(a,r,t),this.b=e(a,r,t-1/3)}return this}}(),setStyle:function(e){function t(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}var i;if(i=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(e)){var n,r=i[1],a=i[2];switch(r){case"rgb":case"rgba":if(n=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a))return this.r=Math.min(255,parseInt(n[1],10))/255,this.g=Math.min(255,parseInt(n[2],10))/255,this.b=Math.min(255,parseInt(n[3],10))/255,t(n[5]),this;if(n=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a))return this.r=Math.min(100,parseInt(n[1],10))/100,this.g=Math.min(100,parseInt(n[2],10))/100,this.b=Math.min(100,parseInt(n[3],10))/100,t(n[5]),this;break;case"hsl":case"hsla":if(n=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a)){var o=parseFloat(n[1])/360,s=parseInt(n[2],10)/100,l=parseInt(n[3],10)/100;return t(n[5]),this.setHSL(o,s,l)}}}else if(i=/^\#([A-Fa-f0-9]+)$/.exec(e)){var c,u=(c=i[1]).length;if(3===u)return this.r=parseInt(c.charAt(0)+c.charAt(0),16)/255,this.g=parseInt(c.charAt(1)+c.charAt(1),16)/255,this.b=parseInt(c.charAt(2)+c.charAt(2),16)/255,this;if(6===u)return this.r=parseInt(c.charAt(0)+c.charAt(1),16)/255,this.g=parseInt(c.charAt(2)+c.charAt(3),16)/255,this.b=parseInt(c.charAt(4)+c.charAt(5),16)/255,this}e&&e.length>0&&(void 0!==(c=q.ColorKeywords[e])?this.setHex(c):console.warn("THREE.Color: Unknown color "+e));return this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this},copyGammaToLinear:function(e,t){return void 0===t&&(t=2),this.r=Math.pow(e.r,t),this.g=Math.pow(e.g,t),this.b=Math.pow(e.b,t),this},copyLinearToGamma:function(e,t){void 0===t&&(t=2);var i=t>0?1/t:1;return this.r=Math.pow(e.r,i),this.g=Math.pow(e.g,i),this.b=Math.pow(e.b,i),this},convertGammaToLinear:function(){var e=this.r,t=this.g,i=this.b;return this.r=e*e,this.g=t*t,this.b=i*i,this},convertLinearToGamma:function(){return this.r=Math.sqrt(this.r),this.g=Math.sqrt(this.g),this.b=Math.sqrt(this.b),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(e){var t,i,n=e||{h:0,s:0,l:0},r=this.r,a=this.g,o=this.b,s=Math.max(r,a,o),l=Math.min(r,a,o),c=(l+s)/2;if(l===s)t=0,i=0;else{var u=s-l;switch(i=c<=.5?u/(s+l):u/(2-s-l),s){case r:t=(a-o)/u+(a<o?6:0);break;case a:t=(o-r)/u+2;break;case o:t=(r-a)/u+4}t/=6}return n.h=t,n.s=i,n.l=c,n},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(e,t,i){var n=this.getHSL();return n.h+=e,n.s+=t,n.l+=i,this.setHSL(n.h,n.s,n.l),this},add:function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this},addColors:function(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this},addScalar:function(e){return this.r+=e,this.g+=e,this.b+=e,this},multiply:function(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this},multiplyScalar:function(e){return this.r*=e,this.g*=e,this.b*=e,this},lerp:function(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this},equals:function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b},fromArray:function(e,t){return void 0===t&&(t=0),this.r=e[t],this.g=e[t+1],this.b=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}},q.ColorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},q.Quaternion=function(e,t,i,n){this._x=e||0,this._y=t||0,this._z=i||0,this._w=void 0!==n?n:1},q.Quaternion.prototype={constructor:q.Quaternion,get x(){return this._x},set x(e){this._x=e,this.onChangeCallback()},get y(){return this._y},set y(e){this._y=e,this.onChangeCallback()},get z(){return this._z},set z(e){this._z=e,this.onChangeCallback()},get w(){return this._w},set w(e){this._w=e,this.onChangeCallback()},set:function(e,t,i,n){return this._x=e,this._y=t,this._z=i,this._w=n,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this.onChangeCallback(),this},setFromEuler:function(e,t){if(e instanceof q.Euler==!1)throw new Error("THREE.Quaternion: .setFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var i=Math.cos(e._x/2),n=Math.cos(e._y/2),r=Math.cos(e._z/2),a=Math.sin(e._x/2),o=Math.sin(e._y/2),s=Math.sin(e._z/2),l=e.order;return"XYZ"===l?(this._x=a*n*r+i*o*s,this._y=i*o*r-a*n*s,this._z=i*n*s+a*o*r,this._w=i*n*r-a*o*s):"YXZ"===l?(this._x=a*n*r+i*o*s,this._y=i*o*r-a*n*s,this._z=i*n*s-a*o*r,this._w=i*n*r+a*o*s):"ZXY"===l?(this._x=a*n*r-i*o*s,this._y=i*o*r+a*n*s,this._z=i*n*s+a*o*r,this._w=i*n*r-a*o*s):"ZYX"===l?(this._x=a*n*r-i*o*s,this._y=i*o*r+a*n*s,this._z=i*n*s-a*o*r,this._w=i*n*r+a*o*s):"YZX"===l?(this._x=a*n*r+i*o*s,this._y=i*o*r+a*n*s,this._z=i*n*s-a*o*r,this._w=i*n*r-a*o*s):"XZY"===l&&(this._x=a*n*r-i*o*s,this._y=i*o*r-a*n*s,this._z=i*n*s+a*o*r,this._w=i*n*r+a*o*s),!1!==t&&this.onChangeCallback(),this},setFromAxisAngle:function(e,t){var i=t/2,n=Math.sin(i);return this._x=e.x*n,this._y=e.y*n,this._z=e.z*n,this._w=Math.cos(i),this.onChangeCallback(),this},setFromRotationMatrix:function(e){var t,i=e.elements,n=i[0],r=i[4],a=i[8],o=i[1],s=i[5],l=i[9],c=i[2],u=i[6],h=i[10],d=n+s+h;return d>0?(t=.5/Math.sqrt(d+1),this._w=.25/t,this._x=(u-l)*t,this._y=(a-c)*t,this._z=(o-r)*t):n>s&&n>h?(t=2*Math.sqrt(1+n-s-h),this._w=(u-l)/t,this._x=.25*t,this._y=(r+o)/t,this._z=(a+c)/t):s>h?(t=2*Math.sqrt(1+s-n-h),this._w=(a-c)/t,this._x=(r+o)/t,this._y=.25*t,this._z=(l+u)/t):(t=2*Math.sqrt(1+h-n-s),this._w=(o-r)/t,this._x=(a+c)/t,this._y=(l+u)/t,this._z=.25*t),this.onChangeCallback(),this},setFromUnitVectors:function(e,t){return void 0===a&&(a=new q.Vector3),(o=e.dot(t)+1)<1e-6?(o=0,Math.abs(e.x)>Math.abs(e.z)?a.set(-e.y,e.x,0):a.set(0,-e.z,e.y)):a.crossVectors(e,t),this._x=a.x,this._y=a.y,this._z=a.z,this._w=o,this.normalize()},inverse:function(){return this.conjugate().normalize()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this.onChangeCallback(),this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)},premultiply:function(e){return this.multiplyQuaternions(e,this)},multiplyQuaternions:function(e,t){var i=e._x,n=e._y,r=e._z,a=e._w,o=t._x,s=t._y,l=t._z,c=t._w;return this._x=i*c+a*o+n*l-r*s,this._y=n*c+a*s+r*o-i*l,this._z=r*c+a*l+i*s-n*o,this._w=a*c-i*o-n*s-r*l,this.onChangeCallback(),this},slerp:function(e,t){if(0===t)return this;if(1===t)return this.copy(e);var i=this._x,n=this._y,r=this._z,a=this._w,o=a*e._w+i*e._x+n*e._y+r*e._z;if(o<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,o=-o):this.copy(e),o>=1)return this._w=a,this._x=i,this._y=n,this._z=r,this;var s=Math.sqrt(1-o*o);if(Math.abs(s)<.001)return this._w=.5*(a+this._w),this._x=.5*(i+this._x),this._y=.5*(n+this._y),this._z=.5*(r+this._z),this;var l=Math.atan2(s,o),c=Math.sin((1-t)*l)/s,u=Math.sin(t*l)/s;return this._w=a*c+this._w*u,this._x=i*c+this._x*u,this._y=n*c+this._y*u,this._z=r*c+this._z*u,this.onChangeCallback(),this},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w},fromArray:function(e,t){return void 0===t&&(t=0),this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this.onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e},onChange:function(e){return this.onChangeCallback=e,this},onChangeCallback:function(){}},Object.assign(q.Quaternion,{slerp:function(e,t,i,n){return i.copy(e).slerp(t,n)},slerpFlat:function(e,t,i,n,r,a,o){var s=i[n+0],l=i[n+1],c=i[n+2],u=i[n+3],h=r[a+0],d=r[a+1],p=r[a+2],f=r[a+3];if(u!==f||s!==h||l!==d||c!==p){var g=1-o,_=s*h+l*d+c*p+u*f,m=_>=0?1:-1,v=1-_*_;if(v>Number.EPSILON){var y=Math.sqrt(v),b=Math.atan2(y,_*m);g=Math.sin(g*b)/y,o=Math.sin(o*b)/y}var S=o*m;if(s=s*g+h*S,l=l*g+d*S,c=c*g+p*S,u=u*g+f*S,g===1-o){var E=1/Math.sqrt(s*s+l*l+c*c+u*u);s*=E,l*=E,c*=E,u*=E}}e[t]=s,e[t+1]=l,e[t+2]=c,e[t+3]=u}}),q.Vector2=function(e,t){this.x=e||0,this.y=t||0},q.Vector2.prototype={constructor:q.Vector2,get width(){return this.x},set width(e){this.x=e},get height(){return this.y},set height(e){this.y=e},set:function(e,t){return this.x=e,this.y=t,this},setScalar:function(e){return this.x=e,this.y=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(e){return this.x=e.x,this.y=e.y,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)},addScalar:function(e){return this.x+=e,this.y+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)},subScalar:function(e){return this.x-=e,this.y-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this},multiply:function(e){return this.x*=e.x,this.y*=e.y,this},multiplyScalar:function(e){return isFinite(e)?(this.x*=e,this.y*=e):(this.x=0,this.y=0),this},divide:function(e){return this.x/=e.x,this.y/=e.y,this},divideScalar:function(e){return this.multiplyScalar(1/e)},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this},clampScalar:function(e,t){return void 0===s&&(s=new q.Vector2,l=new q.Vector2),s.set(e,e),l.set(t,t),this.clamp(s,l)},clampLength:function(e,t){var i=this.length();return this.multiplyScalar(Math.max(e,Math.min(t,i))/i)},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(e){return this.x*e.x+this.y*e.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length())},angle:function(){var e=Math.atan2(this.y,this.x);return e<0&&(e+=2*Math.PI),e},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,i=this.y-e.y;return t*t+i*i},setLength:function(e){return this.multiplyScalar(e/this.length())},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this},lerpVectors:function(e,t,i){return this.subVectors(t,e).multiplyScalar(i).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e},fromAttribute:function(e,t,i){return void 0===i&&(i=0),t=t*e.itemSize+i,this.x=e.array[t],this.y=e.array[t+1],this},rotateAround:function(e,t){var i=Math.cos(t),n=Math.sin(t),r=this.x-e.x,a=this.y-e.y;return this.x=r*i-a*n+e.x,this.y=r*n+a*i+e.y,this}},q.Vector3=function(e,t,i){this.x=e||0,this.y=t||0,this.z=i||0},q.Vector3.prototype={constructor:q.Vector3,set:function(e,t,i){return this.x=e,this.y=t,this.z=i,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)},multiplyScalar:function(e){return isFinite(e)?(this.x*=e,this.y*=e,this.z*=e):(this.x=0,this.y=0,this.z=0),this},multiplyVectors:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this},applyEuler:function(e){return e instanceof q.Euler==0&&console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),void 0===u&&(u=new q.Quaternion),this.applyQuaternion(u.setFromEuler(e))},applyAxisAngle:function(){var e;return function(t,i){return void 0===e&&(e=new q.Quaternion),this.applyQuaternion(e.setFromAxisAngle(t,i))}}(),applyMatrix3:function(e){var t=this.x,i=this.y,n=this.z,r=e.elements;return this.x=r[0]*t+r[3]*i+r[6]*n,this.y=r[1]*t+r[4]*i+r[7]*n,this.z=r[2]*t+r[5]*i+r[8]*n,this},applyMatrix4:function(e){var t=this.x,i=this.y,n=this.z,r=e.elements;return this.x=r[0]*t+r[4]*i+r[8]*n+r[12],this.y=r[1]*t+r[5]*i+r[9]*n+r[13],this.z=r[2]*t+r[6]*i+r[10]*n+r[14],this},applyProjection:function(e){var t=this.x,i=this.y,n=this.z,r=e.elements,a=1/(r[3]*t+r[7]*i+r[11]*n+r[15]);return this.x=(r[0]*t+r[4]*i+r[8]*n+r[12])*a,this.y=(r[1]*t+r[5]*i+r[9]*n+r[13])*a,this.z=(r[2]*t+r[6]*i+r[10]*n+r[14])*a,this},applyQuaternion:function(e){var t=this.x,i=this.y,n=this.z,r=e.x,a=e.y,o=e.z,s=e.w,l=s*t+a*n-o*i,c=s*i+o*t-r*n,u=s*n+r*i-a*t,h=-r*t-a*i-o*n;return this.x=l*s+h*-r+c*-o-u*-a,this.y=c*s+h*-a+u*-r-l*-o,this.z=u*s+h*-o+l*-a-c*-r,this},project:function(e){return void 0===c&&(c=new q.Matrix4),c.multiplyMatrices(e.projectionMatrix,c.getInverse(e.matrixWorld)),this.applyProjection(c)},unproject:function(){var e;return function(t){return void 0===e&&(e=new q.Matrix4),e.multiplyMatrices(t.matrixWorld,e.getInverse(t.projectionMatrix)),this.applyProjection(e)}}(),transformDirection:function(e){var t=this.x,i=this.y,n=this.z,r=e.elements;return this.x=r[0]*t+r[4]*i+r[8]*n,this.y=r[1]*t+r[5]*i+r[9]*n,this.z=r[2]*t+r[6]*i+r[10]*n,this.normalize()},divide:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this},divideScalar:function(e){return this.multiplyScalar(1/e)},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this},clampScalar:function(){var e,t;return function(i,n){return void 0===e&&(e=new q.Vector3,t=new q.Vector3),e.set(i,i,i),t.set(n,n,n),this.clamp(e,t)}}(),clampLength:function(e,t){var i=this.length();return this.multiplyScalar(Math.max(e,Math.min(t,i))/i)},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(e){return this.multiplyScalar(e/this.length())},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this},lerpVectors:function(e,t,i){return this.subVectors(t,e).multiplyScalar(i).add(e)},cross:function(e,t){if(void 0!==t)return console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t);var i=this.x,n=this.y,r=this.z;return this.x=n*e.z-r*e.y,this.y=r*e.x-i*e.z,this.z=i*e.y-n*e.x,this},crossVectors:function(e,t){var i=e.x,n=e.y,r=e.z,a=t.x,o=t.y,s=t.z;return this.x=n*s-r*o,this.y=r*a-i*s,this.z=i*o-n*a,this},projectOnVector:function(e){var t=e.dot(this)/e.lengthSq();return this.copy(e).multiplyScalar(t)},projectOnPlane:function(){var e;return function(t){return void 0===e&&(e=new q.Vector3),e.copy(this).projectOnVector(t),this.sub(e)}}(),reflect:function(){var e;return function(t){return void 0===e&&(e=new q.Vector3),this.sub(e.copy(t).multiplyScalar(2*this.dot(t)))}}(),angleTo:function(e){var t=this.dot(e)/Math.sqrt(this.lengthSq()*e.lengthSq());return Math.acos(q.Math.clamp(t,-1,1))},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,i=this.y-e.y,n=this.z-e.z;return t*t+i*i+n*n},setFromSpherical:function(e){var t=Math.sin(e.phi)*e.radius;return this.x=t*Math.sin(e.theta),this.y=Math.cos(e.phi)*e.radius,this.z=t*Math.cos(e.theta),this},setFromMatrixPosition:function(e){return this.setFromMatrixColumn(e,3)},setFromMatrixScale:function(e){var t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),n=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=n,this},setFromMatrixColumn:function(e,t){if("number"==typeof e){console.warn("THREE.Vector3: setFromMatrixColumn now expects ( matrix, index ).");var i=e;e=t,t=i}return this.fromArray(e.elements,4*t)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e},fromAttribute:function(e,t,i){return void 0===i&&(i=0),t=t*e.itemSize+i,this.x=e.array[t],this.y=e.array[t+1],this.z=e.array[t+2],this}},q.Vector4=function(e,t,i,n){this.x=e||0,this.y=t||0,this.z=i||0,this.w=void 0!==n?n:1},q.Vector4.prototype={constructor:q.Vector4,set:function(e,t,i,n){return this.x=e,this.y=t,this.z=i,this.w=n,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this.w=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setW:function(e){return this.w=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this},multiplyScalar:function(e){return isFinite(e)?(this.x*=e,this.y*=e,this.z*=e,this.w*=e):(this.x=0,this.y=0,this.z=0,this.w=0),this},applyMatrix4:function(e){var t=this.x,i=this.y,n=this.z,r=this.w,a=e.elements;return this.x=a[0]*t+a[4]*i+a[8]*n+a[12]*r,this.y=a[1]*t+a[5]*i+a[9]*n+a[13]*r,this.z=a[2]*t+a[6]*i+a[10]*n+a[14]*r,this.w=a[3]*t+a[7]*i+a[11]*n+a[15]*r,this},divideScalar:function(e){return this.multiplyScalar(1/e)},setAxisAngleFromQuaternion:function(e){this.w=2*Math.acos(e.w);var t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this},setAxisAngleFromRotationMatrix:function(e){var t,i,n,r,a=e.elements,o=a[0],s=a[4],l=a[8],c=a[1],u=a[5],h=a[9],d=a[2],p=a[6],f=a[10];if(Math.abs(s-c)<.01&&Math.abs(l-d)<.01&&Math.abs(h-p)<.01){if(Math.abs(s+c)<.1&&Math.abs(l+d)<.1&&Math.abs(h+p)<.1&&Math.abs(o+u+f-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;var g=(o+1)/2,_=(u+1)/2,m=(f+1)/2,v=(s+c)/4,y=(l+d)/4,b=(h+p)/4;return g>_&&g>m?g<.01?(i=0,n=.707106781,r=.707106781):(n=v/(i=Math.sqrt(g)),r=y/i):_>m?_<.01?(i=.707106781,n=0,r=.707106781):(i=v/(n=Math.sqrt(_)),r=b/n):m<.01?(i=.707106781,n=.707106781,r=0):(i=y/(r=Math.sqrt(m)),n=b/r),this.set(i,n,r,t),this}var S=Math.sqrt((p-h)*(p-h)+(l-d)*(l-d)+(c-s)*(c-s));return Math.abs(S)<.001&&(S=1),this.x=(p-h)/S,this.y=(l-d)/S,this.z=(c-s)/S,this.w=Math.acos((o+u+f-1)/2),this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this},clampScalar:function(){var e,t;return function(i,n){return void 0===e&&(e=new q.Vector4,t=new q.Vector4),e.set(i,i,i,i),t.set(n,n,n,n),this.clamp(e,t)}}(),floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length())},setLength:function(e){return this.multiplyScalar(e/this.length())},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this},lerpVectors:function(e,t,i){return this.subVectors(t,e).multiplyScalar(i).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e},fromAttribute:function(e,t,i){return void 0===i&&(i=0),t=t*e.itemSize+i,this.x=e.array[t],this.y=e.array[t+1],this.z=e.array[t+2],this.w=e.array[t+3],this}},q.Euler=function(e,t,i,n){this._x=e||0,this._y=t||0,this._z=i||0,this._order=n||q.Euler.DefaultOrder},q.Euler.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],q.Euler.DefaultOrder="XYZ",q.Euler.prototype={constructor:q.Euler,get x(){return this._x},set x(e){this._x=e,this.onChangeCallback()},get y(){return this._y},set y(e){this._y=e,this.onChangeCallback()},get z(){return this._z},set z(e){this._z=e,this.onChangeCallback()},get order(){return this._order},set order(e){this._order=e,this.onChangeCallback()},set:function(e,t,i,n){return this._x=e,this._y=t,this._z=i,this._order=n||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this.onChangeCallback(),this},setFromRotationMatrix:function(e,t,i){var n=q.Math.clamp,r=e.elements,a=r[0],o=r[4],s=r[8],l=r[1],c=r[5],u=r[9],h=r[2],d=r[6],p=r[10];return"XYZ"===(t=t||this._order)?(this._y=Math.asin(n(s,-1,1)),Math.abs(s)<.99999?(this._x=Math.atan2(-u,p),this._z=Math.atan2(-o,a)):(this._x=Math.atan2(d,c),this._z=0)):"YXZ"===t?(this._x=Math.asin(-n(u,-1,1)),Math.abs(u)<.99999?(this._y=Math.atan2(s,p),this._z=Math.atan2(l,c)):(this._y=Math.atan2(-h,a),this._z=0)):"ZXY"===t?(this._x=Math.asin(n(d,-1,1)),Math.abs(d)<.99999?(this._y=Math.atan2(-h,p),this._z=Math.atan2(-o,c)):(this._y=0,this._z=Math.atan2(l,a))):"ZYX"===t?(this._y=Math.asin(-n(h,-1,1)),Math.abs(h)<.99999?(this._x=Math.atan2(d,p),this._z=Math.atan2(l,a)):(this._x=0,this._z=Math.atan2(-o,c))):"YZX"===t?(this._z=Math.asin(n(l,-1,1)),Math.abs(l)<.99999?(this._x=Math.atan2(-u,c),this._y=Math.atan2(-h,a)):(this._x=0,this._y=Math.atan2(s,p))):"XZY"===t?(this._z=Math.asin(-n(o,-1,1)),Math.abs(o)<.99999?(this._x=Math.atan2(d,c),this._y=Math.atan2(s,a)):(this._x=Math.atan2(-u,p),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+t),this._order=t,!1!==i&&this.onChangeCallback(),this},setFromQuaternion:function(){var e;return function(t,i,n){return void 0===e&&(e=new q.Matrix4),e.makeRotationFromQuaternion(t),this.setFromRotationMatrix(e,i,n)}}(),setFromVector3:function(e,t){return this.set(e.x,e.y,e.z,t||this._order)},reorder:(h=new q.Quaternion,function(e){return h.setFromEuler(this),this.setFromQuaternion(h,e)}),equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order},fromArray:function(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this.onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e},toVector3:function(e){return e?e.set(this._x,this._y,this._z):new q.Vector3(this._x,this._y,this._z)},onChange:function(e){return this.onChangeCallback=e,this},onChangeCallback:function(){}},q.Line3=function(e,t){this.start=void 0!==e?e:new q.Vector3,this.end=void 0!==t?t:new q.Vector3},q.Line3.prototype={constructor:q.Line3,set:function(e,t){return this.start.copy(e),this.end.copy(t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.start.copy(e.start),this.end.copy(e.end),this},center:function(e){return(e||new q.Vector3).addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(e){return(e||new q.Vector3).subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(e,t){var i=t||new q.Vector3;return this.delta(i).multiplyScalar(e).add(this.start)},closestPointToPointParameter:(d=new q.Vector3,p=new q.Vector3,function(e,t){d.subVectors(e,this.start),p.subVectors(this.end,this.start);var i=p.dot(p),n=p.dot(d)/i;return t&&(n=q.Math.clamp(n,0,1)),n}),closestPointToPoint:function(e,t,i){var n=this.closestPointToPointParameter(e,t),r=i||new q.Vector3;return this.delta(r).multiplyScalar(n).add(this.start)},applyMatrix4:function(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this},equals:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)}},q.Box2=function(e,t){this.min=void 0!==e?e:new q.Vector2(1/0,1/0),this.max=void 0!==t?t:new q.Vector2(-1/0,-1/0)},q.Box2.prototype={constructor:q.Box2,set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(){var e=new q.Vector2;return function(t,i){var n=e.copy(i).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},center:function(e){return(e||new q.Vector2).addVectors(this.min,this.max).multiplyScalar(.5)},size:function(e){return(e||new q.Vector2).subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y},getParameter:function(e,t){return(t||new q.Vector2).set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)},clampPoint:function(e,t){return(t||new q.Vector2).copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var e=new q.Vector2;return function(t){return e.copy(t).clamp(this.min,this.max).sub(t).length()}}(),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}},q.Box3=function(e,t){this.min=void 0!==e?e:new q.Vector3(1/0,1/0,1/0),this.max=void 0!==t?t:new q.Vector3(-1/0,-1/0,-1/0)},q.Box3.prototype={constructor:q.Box3,set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromArray:function(e){for(var t=1/0,i=1/0,n=1/0,r=-1/0,a=-1/0,o=-1/0,s=0,l=e.length;s<l;s+=3){var c=e[s],u=e[s+1],h=e[s+2];c<t&&(t=c),u<i&&(i=u),h<n&&(n=h),c>r&&(r=c),u>a&&(a=u),h>o&&(o=h)}this.min.set(t,i,n),this.max.set(r,a,o)},setFromPoints:function(e){this.makeEmpty();for(var t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(){var e=new q.Vector3;return function(t,i){var n=e.copy(i).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}}(),setFromObject:function(){var e=new q.Vector3;return function(t){var i=this;return t.updateMatrixWorld(!0),this.makeEmpty(),t.traverse((function(t){var n=t.geometry;if(void 0!==n)if(n instanceof q.Geometry)for(var r=n.vertices,a=0,o=r.length;a<o;a++)e.copy(r[a]),e.applyMatrix4(t.matrixWorld),i.expandByPoint(e);else if(n instanceof q.BufferGeometry&&void 0!==n.attributes.position){var s=n.attributes.position.array;for(a=0,o=s.length;a<o;a+=3)e.fromArray(s,a),e.applyMatrix4(t.matrixWorld),i.expandByPoint(e)}})),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},center:function(e){return(e||new q.Vector3).addVectors(this.min,this.max).multiplyScalar(.5)},size:function(e){return(e||new q.Vector3).subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z},getParameter:function(e,t){return(t||new q.Vector3).set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)},intersectsSphere:function(e){return void 0===g&&(g=new q.Vector3),this.clampPoint(e.center,g),g.distanceToSquared(e.center)<=e.radius*e.radius},intersectsPlane:function(e){var t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=e.constant&&i>=e.constant},clampPoint:function(e,t){return(t||new q.Vector3).copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var e=new q.Vector3;return function(t){return e.copy(t).clamp(this.min,this.max).sub(t).length()}}(),getBoundingSphere:function(){var e=new q.Vector3;return function(t){var i=t||new q.Sphere;return i.center=this.center(),i.radius=.5*this.size(e).length(),i}}(),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},applyMatrix4:(f=[new q.Vector3,new q.Vector3,new q.Vector3,new q.Vector3,new q.Vector3,new q.Vector3,new q.Vector3,new q.Vector3],function(e){return this.isEmpty()||(f[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),f[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),f[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),f[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),f[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),f[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),f[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),f[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(f)),this}),translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}},q.Matrix3=function(){this.elements=new Float32Array([1,0,0,0,1,0,0,0,1]),arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")},q.Matrix3.prototype={constructor:q.Matrix3,set:function(e,t,i,n,r,a,o,s,l){var c=this.elements;return c[0]=e,c[1]=n,c[2]=o,c[3]=t,c[4]=r,c[5]=s,c[6]=i,c[7]=a,c[8]=l,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(e){var t=e.elements;return this.set(t[0],t[3],t[6],t[1],t[4],t[7],t[2],t[5],t[8]),this},setFromMatrix4:function(e){var t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this},applyToVector3Array:function(){var e;return function(t,i,n){void 0===e&&(e=new q.Vector3),void 0===i&&(i=0),void 0===n&&(n=t.length);for(var r=0,a=i;r<n;r+=3,a+=3)e.fromArray(t,a),e.applyMatrix3(this),e.toArray(t,a);return t}}(),applyToBuffer:function(){var e;return function(t,i,n){void 0===e&&(e=new q.Vector3),void 0===i&&(i=0),void 0===n&&(n=t.length/t.itemSize);for(var r=0,a=i;r<n;r++,a++)e.x=t.getX(a),e.y=t.getY(a),e.z=t.getZ(a),e.applyMatrix3(this),t.setXYZ(e.x,e.y,e.z);return t}}(),multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this},determinant:function(){var e=this.elements,t=e[0],i=e[1],n=e[2],r=e[3],a=e[4],o=e[5],s=e[6],l=e[7],c=e[8];return t*a*c-t*o*l-i*r*c+i*o*s+n*r*l-n*a*s},getInverse:function(e,t){e instanceof q.Matrix4&&console.error("THREE.Matrix3.getInverse no longer takes a Matrix4 argument.");var i=e.elements,n=this.elements,r=i[0],a=i[1],o=i[2],s=i[3],l=i[4],c=i[5],u=i[6],h=i[7],d=i[8],p=d*l-c*h,f=c*u-d*s,g=h*s-l*u,_=r*p+a*f+o*g;if(0===_){var m="THREE.Matrix3.getInverse(): can't invert matrix, determinant is 0";if(t)throw new Error(m);return console.warn(m),this.identity()}var v=1/_;return n[0]=p*v,n[1]=(o*h-d*a)*v,n[2]=(c*a-o*l)*v,n[3]=f*v,n[4]=(d*r-o*u)*v,n[5]=(o*s-c*r)*v,n[6]=g*v,n[7]=(a*u-h*r)*v,n[8]=(l*r-a*s)*v,this},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this},flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix3: .flattenToArrayOffset is deprecated - just use .toArray instead."),this.toArray(e,t)},getNormalMatrix:function(e){return this.setFromMatrix4(e).getInverse(this).transpose()},transposeIntoArray:function(e){var t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this},fromArray:function(e){return this.elements.set(e),this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);var i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}},q.Matrix4=function(){this.elements=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")},q.Matrix4.prototype={constructor:q.Matrix4,set:function(e,t,i,n,r,a,o,s,l,c,u,h,d,p,f,g){var _=this.elements;return _[0]=e,_[4]=t,_[8]=i,_[12]=n,_[1]=r,_[5]=a,_[9]=o,_[13]=s,_[2]=l,_[6]=c,_[10]=u,_[14]=h,_[3]=d,_[7]=p,_[11]=f,_[15]=g,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new q.Matrix4).fromArray(this.elements)},copy:function(e){return this.elements.set(e.elements),this},copyPosition:function(e){var t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this},extractBasis:function(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this},makeBasis:function(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this},extractRotation:function(){var e;return function(t){void 0===e&&(e=new q.Vector3);var i=this.elements,n=t.elements,r=1/e.setFromMatrixColumn(t,0).length(),a=1/e.setFromMatrixColumn(t,1).length(),o=1/e.setFromMatrixColumn(t,2).length();return i[0]=n[0]*r,i[1]=n[1]*r,i[2]=n[2]*r,i[4]=n[4]*a,i[5]=n[5]*a,i[6]=n[6]*a,i[8]=n[8]*o,i[9]=n[9]*o,i[10]=n[10]*o,this}}(),makeRotationFromEuler:function(e){e instanceof q.Euler==!1&&console.error("THREE.Matrix: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var t=this.elements,i=e.x,n=e.y,r=e.z,a=Math.cos(i),o=Math.sin(i),s=Math.cos(n),l=Math.sin(n),c=Math.cos(r),u=Math.sin(r);if("XYZ"===e.order){var h=a*c,d=a*u,p=o*c,f=o*u;t[0]=s*c,t[4]=-s*u,t[8]=l,t[1]=d+p*l,t[5]=h-f*l,t[9]=-o*s,t[2]=f-h*l,t[6]=p+d*l,t[10]=a*s}else if("YXZ"===e.order){var g=s*c,_=s*u,m=l*c,v=l*u;t[0]=g+v*o,t[4]=m*o-_,t[8]=a*l,t[1]=a*u,t[5]=a*c,t[9]=-o,t[2]=_*o-m,t[6]=v+g*o,t[10]=a*s}else if("ZXY"===e.order){g=s*c,_=s*u,m=l*c,v=l*u;t[0]=g-v*o,t[4]=-a*u,t[8]=m+_*o,t[1]=_+m*o,t[5]=a*c,t[9]=v-g*o,t[2]=-a*l,t[6]=o,t[10]=a*s}else if("ZYX"===e.order){h=a*c,d=a*u,p=o*c,f=o*u;t[0]=s*c,t[4]=p*l-d,t[8]=h*l+f,t[1]=s*u,t[5]=f*l+h,t[9]=d*l-p,t[2]=-l,t[6]=o*s,t[10]=a*s}else if("YZX"===e.order){var y=a*s,b=a*l,S=o*s,E=o*l;t[0]=s*c,t[4]=E-y*u,t[8]=S*u+b,t[1]=u,t[5]=a*c,t[9]=-o*c,t[2]=-l*c,t[6]=b*u+S,t[10]=y-E*u}else if("XZY"===e.order){y=a*s,b=a*l,S=o*s,E=o*l;t[0]=s*c,t[4]=-u,t[8]=l*c,t[1]=y*u+E,t[5]=a*c,t[9]=b*u-S,t[2]=S*u-b,t[6]=o*c,t[10]=E*u+y}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},makeRotationFromQuaternion:function(e){var t=this.elements,i=e.x,n=e.y,r=e.z,a=e.w,o=i+i,s=n+n,l=r+r,c=i*o,u=i*s,h=i*l,d=n*s,p=n*l,f=r*l,g=a*o,_=a*s,m=a*l;return t[0]=1-(d+f),t[4]=u-m,t[8]=h+_,t[1]=u+m,t[5]=1-(c+f),t[9]=p-g,t[2]=h-_,t[6]=p+g,t[10]=1-(c+d),t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},lookAt:function(e,t,i){void 0===_&&(_=new q.Vector3,m=new q.Vector3,v=new q.Vector3);var n=this.elements;return v.subVectors(e,t).normalize(),0===v.lengthSq()&&(v.z=1),_.crossVectors(i,v).normalize(),0===_.lengthSq()&&(v.z+=1e-4,_.crossVectors(i,v).normalize()),m.crossVectors(v,_),n[0]=_.x,n[4]=m.x,n[8]=v.x,n[1]=_.y,n[5]=m.y,n[9]=v.y,n[2]=_.z,n[6]=m.z,n[10]=v.z,this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){var i=e.elements,n=t.elements,r=this.elements,a=i[0],o=i[4],s=i[8],l=i[12],c=i[1],u=i[5],h=i[9],d=i[13],p=i[2],f=i[6],g=i[10],_=i[14],m=i[3],v=i[7],y=i[11],b=i[15],S=n[0],E=n[4],w=n[8],T=n[12],M=n[1],A=n[5],C=n[9],x=n[13],I=n[2],P=n[6],L=n[10],D=n[14],R=n[3],k=n[7],O=n[11],N=n[15];return r[0]=a*S+o*M+s*I+l*R,r[4]=a*E+o*A+s*P+l*k,r[8]=a*w+o*C+s*L+l*O,r[12]=a*T+o*x+s*D+l*N,r[1]=c*S+u*M+h*I+d*R,r[5]=c*E+u*A+h*P+d*k,r[9]=c*w+u*C+h*L+d*O,r[13]=c*T+u*x+h*D+d*N,r[2]=p*S+f*M+g*I+_*R,r[6]=p*E+f*A+g*P+_*k,r[10]=p*w+f*C+g*L+_*O,r[14]=p*T+f*x+g*D+_*N,r[3]=m*S+v*M+y*I+b*R,r[7]=m*E+v*A+y*P+b*k,r[11]=m*w+v*C+y*L+b*O,r[15]=m*T+v*x+y*D+b*N,this},multiplyToArray:function(e,t,i){var n=this.elements;return this.multiplyMatrices(e,t),i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=n[3],i[4]=n[4],i[5]=n[5],i[6]=n[6],i[7]=n[7],i[8]=n[8],i[9]=n[9],i[10]=n[10],i[11]=n[11],i[12]=n[12],i[13]=n[13],i[14]=n[14],i[15]=n[15],this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this},applyToVector3Array:function(){var e;return function(t,i,n){void 0===e&&(e=new q.Vector3),void 0===i&&(i=0),void 0===n&&(n=t.length);for(var r=0,a=i;r<n;r+=3,a+=3)e.fromArray(t,a),e.applyMatrix4(this),e.toArray(t,a);return t}}(),applyToBuffer:function(){var e;return function(t,i,n){void 0===e&&(e=new q.Vector3),void 0===i&&(i=0),void 0===n&&(n=t.length/t.itemSize);for(var r=0,a=i;r<n;r++,a++)e.x=t.getX(a),e.y=t.getY(a),e.z=t.getZ(a),e.applyMatrix4(this),t.setXYZ(e.x,e.y,e.z);return t}}(),determinant:function(){var e=this.elements,t=e[0],i=e[4],n=e[8],r=e[12],a=e[1],o=e[5],s=e[9],l=e[13],c=e[2],u=e[6],h=e[10],d=e[14];return e[3]*(+r*s*u-n*l*u-r*o*h+i*l*h+n*o*d-i*s*d)+e[7]*(+t*s*d-t*l*h+r*a*h-n*a*d+n*l*c-r*s*c)+e[11]*(+t*l*u-t*o*d-r*a*u+i*a*d+r*o*c-i*l*c)+e[15]*(-n*o*c-t*s*u+t*o*h+n*a*u-i*a*h+i*s*c)},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this},flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix3: .flattenToArrayOffset is deprecated - just use .toArray instead."),this.toArray(e,t)},getPosition:function(){var e;return function(){return void 0===e&&(e=new q.Vector3),console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),e.setFromMatrixColumn(this,3)}}(),setPosition:function(e){var t=this.elements;return t[12]=e.x,t[13]=e.y,t[14]=e.z,this},getInverse:function(e,t){var i=this.elements,n=e.elements,r=n[0],a=n[1],o=n[2],s=n[3],l=n[4],c=n[5],u=n[6],h=n[7],d=n[8],p=n[9],f=n[10],g=n[11],_=n[12],m=n[13],v=n[14],y=n[15],b=p*v*h-m*f*h+m*u*g-c*v*g-p*u*y+c*f*y,S=_*f*h-d*v*h-_*u*g+l*v*g+d*u*y-l*f*y,E=d*m*h-_*p*h+_*c*g-l*m*g-d*c*y+l*p*y,w=_*p*u-d*m*u-_*c*f+l*m*f+d*c*v-l*p*v,T=r*b+a*S+o*E+s*w;if(0===T){var M="THREE.Matrix4.getInverse(): can't invert matrix, determinant is 0";if(t)throw new Error(M);return console.warn(M),this.identity()}var A=1/T;return i[0]=b*A,i[1]=(m*f*s-p*v*s-m*o*g+a*v*g+p*o*y-a*f*y)*A,i[2]=(c*v*s-m*u*s+m*o*h-a*v*h-c*o*y+a*u*y)*A,i[3]=(p*u*s-c*f*s-p*o*h+a*f*h+c*o*g-a*u*g)*A,i[4]=S*A,i[5]=(d*v*s-_*f*s+_*o*g-r*v*g-d*o*y+r*f*y)*A,i[6]=(_*u*s-l*v*s-_*o*h+r*v*h+l*o*y-r*u*y)*A,i[7]=(l*f*s-d*u*s+d*o*h-r*f*h-l*o*g+r*u*g)*A,i[8]=E*A,i[9]=(_*p*s-d*m*s-_*a*g+r*m*g+d*a*y-r*p*y)*A,i[10]=(l*m*s-_*c*s+_*a*h-r*m*h-l*a*y+r*c*y)*A,i[11]=(d*c*s-l*p*s-d*a*h+r*p*h+l*a*g-r*c*g)*A,i[12]=w*A,i[13]=(d*m*o-_*p*o+_*a*f-r*m*f-d*a*v+r*p*v)*A,i[14]=(_*c*o-l*m*o-_*a*u+r*m*u+l*a*v-r*c*v)*A,i[15]=(l*p*o-d*c*o+d*a*u-r*p*u-l*a*f+r*c*f)*A,this},scale:function(e){var t=this.elements,i=e.x,n=e.y,r=e.z;return t[0]*=i,t[4]*=n,t[8]*=r,t[1]*=i,t[5]*=n,t[9]*=r,t[2]*=i,t[6]*=n,t[10]*=r,t[3]*=i,t[7]*=n,t[11]*=r,this},getMaxScaleOnAxis:function(){var e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],n=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,i,n))},makeTranslation:function(e,t,i){return this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this},makeRotationX:function(e){var t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this},makeRotationY:function(e){var t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this},makeRotationZ:function(e){var t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(e,t){var i=Math.cos(t),n=Math.sin(t),r=1-i,a=e.x,o=e.y,s=e.z,l=r*a,c=r*o;return this.set(l*a+i,l*o-n*s,l*s+n*o,0,l*o+n*s,c*o+i,c*s-n*a,0,l*s-n*o,c*s+n*a,r*s*s+i,0,0,0,0,1),this},makeScale:function(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this},compose:function(e,t,i){return this.makeRotationFromQuaternion(t),this.scale(i),this.setPosition(e),this},decompose:function(){var e,t;return function(i,n,r){void 0===e&&(e=new q.Vector3,t=new q.Matrix4);var a=this.elements,o=e.set(a[0],a[1],a[2]).length(),s=e.set(a[4],a[5],a[6]).length(),l=e.set(a[8],a[9],a[10]).length();this.determinant()<0&&(o=-o),i.x=a[12],i.y=a[13],i.z=a[14],t.elements.set(this.elements);var c=1/o,u=1/s,h=1/l;return t.elements[0]*=c,t.elements[1]*=c,t.elements[2]*=c,t.elements[4]*=u,t.elements[5]*=u,t.elements[6]*=u,t.elements[8]*=h,t.elements[9]*=h,t.elements[10]*=h,n.setFromRotationMatrix(t),r.x=o,r.y=s,r.z=l,this}}(),makeFrustum:function(e,t,i,n,r,a){var o=this.elements,s=2*r/(t-e),l=2*r/(n-i),c=(t+e)/(t-e),u=(n+i)/(n-i),h=-(a+r)/(a-r),d=-2*a*r/(a-r);return o[0]=s,o[4]=0,o[8]=c,o[12]=0,o[1]=0,o[5]=l,o[9]=u,o[13]=0,o[2]=0,o[6]=0,o[10]=h,o[14]=d,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this},makePerspective:function(e,t,i,n){var r=i*Math.tan(q.Math.DEG2RAD*e*.5),a=-r,o=a*t,s=r*t;return this.makeFrustum(o,s,a,r,i,n)},makeOrthographic:function(e,t,i,n,r,a){var o=this.elements,s=1/(t-e),l=1/(i-n),c=1/(a-r),u=(t+e)*s,h=(i+n)*l,d=(a+r)*c;return o[0]=2*s,o[4]=0,o[8]=0,o[12]=-u,o[1]=0,o[5]=2*l,o[9]=0,o[13]=-h,o[2]=0,o[6]=0,o[10]=-2*c,o[14]=-d,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this},equals:function(e){for(var t=this.elements,i=e.elements,n=0;n<16;n++)if(t[n]!==i[n])return!1;return!0},fromArray:function(e){return this.elements.set(e),this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);var i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}},q.Ray=function(e,t){this.origin=void 0!==e?e:new q.Vector3,this.direction=void 0!==t?t:new q.Vector3},q.Ray.prototype={constructor:q.Ray,set:function(e,t){return this.origin.copy(e),this.direction.copy(t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this},at:function(e,t){return(t||new q.Vector3).copy(this.direction).multiplyScalar(e).add(this.origin)},lookAt:function(e){return this.direction.copy(e).sub(this.origin).normalize(),this},recast:function(){var e=new q.Vector3;return function(t){return this.origin.copy(this.at(t,e)),this}}(),closestPointToPoint:function(e,t){var i=t||new q.Vector3;i.subVectors(e,this.origin);var n=i.dot(this.direction);return n<0?i.copy(this.origin):i.copy(this.direction).multiplyScalar(n).add(this.origin)},distanceToPoint:function(e){return Math.sqrt(this.distanceSqToPoint(e))},distanceSqToPoint:function(){var e=new q.Vector3;return function(t){var i=e.subVectors(t,this.origin).dot(this.direction);return i<0?this.origin.distanceToSquared(t):(e.copy(this.direction).multiplyScalar(i).add(this.origin),e.distanceToSquared(t))}}(),distanceSqToSegment:(y=new q.Vector3,b=new q.Vector3,S=new q.Vector3,function(e,t,i,n){y.copy(e).add(t).multiplyScalar(.5),b.copy(t).sub(e).normalize(),S.copy(this.origin).sub(y);var r,a,o,s,l=.5*e.distanceTo(t),c=-this.direction.dot(b),u=S.dot(this.direction),h=-S.dot(b),d=S.lengthSq(),p=Math.abs(1-c*c);if(p>0)if(a=c*u-h,s=l*p,(r=c*h-u)>=0)if(a>=-s)if(a<=s){var f=1/p;o=(r*=f)*(r+c*(a*=f)+2*u)+a*(c*r+a+2*h)+d}else a=l,o=-(r=Math.max(0,-(c*a+u)))*r+a*(a+2*h)+d;else a=-l,o=-(r=Math.max(0,-(c*a+u)))*r+a*(a+2*h)+d;else a<=-s?o=-(r=Math.max(0,-(-c*l+u)))*r+(a=r>0?-l:Math.min(Math.max(-l,-h),l))*(a+2*h)+d:a<=s?(r=0,o=(a=Math.min(Math.max(-l,-h),l))*(a+2*h)+d):o=-(r=Math.max(0,-(c*l+u)))*r+(a=r>0?l:Math.min(Math.max(-l,-h),l))*(a+2*h)+d;else a=c>0?-l:l,o=-(r=Math.max(0,-(c*a+u)))*r+a*(a+2*h)+d;return i&&i.copy(this.direction).multiplyScalar(r).add(this.origin),n&&n.copy(b).multiplyScalar(a).add(y),o}),intersectSphere:function(){var e=new q.Vector3;return function(t,i){e.subVectors(t.center,this.origin);var n=e.dot(this.direction),r=e.dot(e)-n*n,a=t.radius*t.radius;if(r>a)return null;var o=Math.sqrt(a-r),s=n-o,l=n+o;return s<0&&l<0?null:s<0?this.at(l,i):this.at(s,i)}}(),intersectsSphere:function(e){return this.distanceToPoint(e.center)<=e.radius},distanceToPlane:function(e){var t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;var i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null},intersectPlane:function(e,t){var i=this.distanceToPlane(e);return null===i?null:this.at(i,t)},intersectsPlane:function(e){var t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0},intersectBox:function(e,t){var i,n,r,a,o,s,l=1/this.direction.x,c=1/this.direction.y,u=1/this.direction.z,h=this.origin;return l>=0?(i=(e.min.x-h.x)*l,n=(e.max.x-h.x)*l):(i=(e.max.x-h.x)*l,n=(e.min.x-h.x)*l),c>=0?(r=(e.min.y-h.y)*c,a=(e.max.y-h.y)*c):(r=(e.max.y-h.y)*c,a=(e.min.y-h.y)*c),i>a||r>n?null:((r>i||i!=i)&&(i=r),(a<n||n!=n)&&(n=a),u>=0?(o=(e.min.z-h.z)*u,s=(e.max.z-h.z)*u):(o=(e.max.z-h.z)*u,s=(e.min.z-h.z)*u),i>s||o>n?null:((o>i||i!=i)&&(i=o),(s<n||n!=n)&&(n=s),n<0?null:this.at(i>=0?i:n,t)))},intersectsBox:function(){var e=new q.Vector3;return function(t){return null!==this.intersectBox(t,e)}}(),intersectTriangle:function(){var e=new q.Vector3,t=new q.Vector3,i=new q.Vector3,n=new q.Vector3;return function(r,a,o,s,l){t.subVectors(a,r),i.subVectors(o,r),n.crossVectors(t,i);var c,u=this.direction.dot(n);if(u>0){if(s)return null;c=1}else{if(!(u<0))return null;c=-1,u=-u}e.subVectors(this.origin,r);var h=c*this.direction.dot(i.crossVectors(e,i));if(h<0)return null;var d=c*this.direction.dot(t.cross(e));if(d<0)return null;if(h+d>u)return null;var p=-c*e.dot(n);return p<0?null:this.at(p/u,l)}}(),applyMatrix4:function(e){return this.direction.add(this.origin).applyMatrix4(e),this.origin.applyMatrix4(e),this.direction.sub(this.origin),this.direction.normalize(),this},equals:function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}},q.Sphere=function(e,t){this.center=void 0!==e?e:new q.Vector3,this.radius=void 0!==t?t:0},q.Sphere.prototype={constructor:q.Sphere,set:function(e,t){return this.center.copy(e),this.radius=t,this},setFromPoints:(E=new q.Box3,function(e,t){var i=this.center;void 0!==t?i.copy(t):E.setFromPoints(e).center(i);for(var n=0,r=0,a=e.length;r<a;r++)n=Math.max(n,i.distanceToSquared(e[r]));return this.radius=Math.sqrt(n),this}),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.center.copy(e.center),this.radius=e.radius,this},empty:function(){return this.radius<=0},containsPoint:function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(e){return e.distanceTo(this.center)-this.radius},intersectsSphere:function(e){var t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t},intersectsBox:function(e){return e.intersectsSphere(this)},intersectsPlane:function(e){return Math.abs(this.center.dot(e.normal)-e.constant)<=this.radius},clampPoint:function(e,t){var i=this.center.distanceToSquared(e),n=t||new q.Vector3;return n.copy(e),i>this.radius*this.radius&&(n.sub(this.center).normalize(),n.multiplyScalar(this.radius).add(this.center)),n},getBoundingBox:function(e){var t=e||new q.Box3;return t.set(this.center,this.center),t.expandByScalar(this.radius),t},applyMatrix4:function(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this},translate:function(e){return this.center.add(e),this},equals:function(e){return e.center.equals(this.center)&&e.radius===this.radius}},q.Frustum=function(e,t,i,n,r,a){this.planes=[void 0!==e?e:new q.Plane,void 0!==t?t:new q.Plane,void 0!==i?i:new q.Plane,void 0!==n?n:new q.Plane,void 0!==r?r:new q.Plane,void 0!==a?a:new q.Plane]},q.Frustum.prototype={constructor:q.Frustum,set:function(e,t,i,n,r,a){var o=this.planes;return o[0].copy(e),o[1].copy(t),o[2].copy(i),o[3].copy(n),o[4].copy(r),o[5].copy(a),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){for(var t=this.planes,i=0;i<6;i++)t[i].copy(e.planes[i]);return this},setFromMatrix:function(e){var t=this.planes,i=e.elements,n=i[0],r=i[1],a=i[2],o=i[3],s=i[4],l=i[5],c=i[6],u=i[7],h=i[8],d=i[9],p=i[10],f=i[11],g=i[12],_=i[13],m=i[14],v=i[15];return t[0].setComponents(o-n,u-s,f-h,v-g).normalize(),t[1].setComponents(o+n,u+s,f+h,v+g).normalize(),t[2].setComponents(o+r,u+l,f+d,v+_).normalize(),t[3].setComponents(o-r,u-l,f-d,v-_).normalize(),t[4].setComponents(o-a,u-c,f-p,v-m).normalize(),t[5].setComponents(o+a,u+c,f+p,v+m).normalize(),this},intersectsObject:(M=new q.Sphere,function(e){var t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),M.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(M)}),intersectsSprite:function(){var e=new q.Sphere;return function(t){return e.center.set(0,0,0),e.radius=.7071067811865476,e.applyMatrix4(t.matrixWorld),this.intersectsSphere(e)}}(),intersectsSphere:function(e){for(var t=this.planes,i=e.center,n=-e.radius,r=0;r<6;r++){if(t[r].distanceToPoint(i)<n)return!1}return!0},intersectsBox:(w=new q.Vector3,T=new q.Vector3,function(e){for(var t=this.planes,i=0;i<6;i++){var n=t[i];w.x=n.normal.x>0?e.min.x:e.max.x,T.x=n.normal.x>0?e.max.x:e.min.x,w.y=n.normal.y>0?e.min.y:e.max.y,T.y=n.normal.y>0?e.max.y:e.min.y,w.z=n.normal.z>0?e.min.z:e.max.z,T.z=n.normal.z>0?e.max.z:e.min.z;var r=n.distanceToPoint(w),a=n.distanceToPoint(T);if(r<0&&a<0)return!1}return!0}),containsPoint:function(e){for(var t=this.planes,i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}},q.Plane=function(e,t){this.normal=void 0!==e?e:new q.Vector3(1,0,0),this.constant=void 0!==t?t:0},q.Plane.prototype={constructor:q.Plane,set:function(e,t){return this.normal.copy(e),this.constant=t,this},setComponents:function(e,t,i,n){return this.normal.set(e,t,i),this.constant=n,this},setFromNormalAndCoplanarPoint:function(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this},setFromCoplanarPoints:function(){var e=new q.Vector3,t=new q.Vector3;return function(i,n,r){var a=e.subVectors(r,n).cross(t.subVectors(i,n)).normalize();return this.setFromNormalAndCoplanarPoint(a,i),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this},normalize:function(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(e){return this.normal.dot(e)+this.constant},distanceToSphere:function(e){return this.distanceToPoint(e.center)-e.radius},projectPoint:function(e,t){return this.orthoPoint(e,t).sub(e).negate()},orthoPoint:function(e,t){var i=this.distanceToPoint(e);return(t||new q.Vector3).copy(this.normal).multiplyScalar(i)},intersectLine:function(){var e=new q.Vector3;return function(t,i){var n=i||new q.Vector3,r=t.delta(e),a=this.normal.dot(r);if(0===a)return 0===this.distanceToPoint(t.start)?n.copy(t.start):void 0;var o=-(t.start.dot(this.normal)+this.constant)/a;return o<0||o>1?void 0:n.copy(r).multiplyScalar(o).add(t.start)}}(),intersectsLine:function(e){var t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0},intersectsBox:function(e){return e.intersectsPlane(this)},intersectsSphere:function(e){return e.intersectsPlane(this)},coplanarPoint:function(e){return(e||new q.Vector3).copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var e=new q.Vector3,t=new q.Matrix3;return function(i,n){var r=this.coplanarPoint(e).applyMatrix4(i),a=n||t.getNormalMatrix(i),o=this.normal.applyMatrix3(a).normalize();return this.constant=-r.dot(o),this}}(),translate:function(e){return this.constant=this.constant-e.dot(this.normal),this},equals:function(e){return e.normal.equals(this.normal)&&e.constant===this.constant}},q.Spherical=function(e,t,i){return this.radius=void 0!==e?e:1,this.phi=void 0!==t?t:0,this.theta=void 0!==i?i:0,this},q.Spherical.prototype={constructor:q.Spherical,set:function(e,t,i){return this.radius=e,this.phi=t,this.theta=i,this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.radius.copy(e.radius),this.phi.copy(e.phi),this.theta.copy(e.theta),this},makeSafe:function(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this},setFromVector3:function(e){return this.radius=e.length(),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e.x,e.z),this.phi=Math.acos(q.Math.clamp(e.y/this.radius,-1,1))),this}},q.Math={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var e,t="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),i=new Array(36),n=0;return function(){for(var r=0;r<36;r++)8===r||13===r||18===r||23===r?i[r]="-":14===r?i[r]="4":(n<=2&&(n=33554432+16777216*Math.random()|0),e=15&n,n>>=4,i[r]=t[19===r?3&e|8:e]);return i.join("")}}(),clamp:function(e,t,i){return Math.max(t,Math.min(i,e))},euclideanModulo:function(e,t){return(e%t+t)%t},mapLinear:function(e,t,i,n,r){return n+(e-t)*(r-n)/(i-t)},smoothstep:function(e,t,i){return e<=t?0:e>=i?1:(e=(e-t)/(i-t))*e*(3-2*e)},smootherstep:function(e,t,i){return e<=t?0:e>=i?1:(e=(e-t)/(i-t))*e*e*(e*(6*e-15)+10)},random16:function(){return console.warn("THREE.Math.random16() has been deprecated. Use Math.random() instead."),Math.random()},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},degToRad:function(e){return e*q.Math.DEG2RAD},radToDeg:function(e){return e*q.Math.RAD2DEG},isPowerOfTwo:function(e){return 0==(e&e-1)&&0!==e},nearestPowerOfTwo:function(e){return Math.pow(2,Math.round(Math.log(e)/Math.LN2))},nextPowerOfTwo:function(e){return e--,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,++e}},q.Spline=function(e){this.points=e;var t,i,n,r,a,o,s,l,c,u=[],h={x:0,y:0,z:0};function d(e,t,i,n,r,a,o){var s=.5*(i-e),l=.5*(n-t);return(2*(t-i)+s+l)*o+(-3*(t-i)-2*s-l)*a+s*r+t}this.initFromArray=function(e){this.points=[];for(var t=0;t<e.length;t++)this.points[t]={x:e[t][0],y:e[t][1],z:e[t][2]}},this.getPoint=function(e){return t=(this.points.length-1)*e,i=Math.floor(t),n=t-i,u[0]=0===i?i:i-1,u[1]=i,u[2]=i>this.points.length-2?this.points.length-1:i+1,u[3]=i>this.points.length-3?this.points.length-1:i+2,o=this.points[u[0]],s=this.points[u[1]],l=this.points[u[2]],c=this.points[u[3]],a=n*(r=n*n),h.x=d(o.x,s.x,l.x,c.x,n,r,a),h.y=d(o.y,s.y,l.y,c.y,n,r,a),h.z=d(o.z,s.z,l.z,c.z,n,r,a),h},this.getControlPointsArray=function(){var e,t,i=this.points.length,n=[];for(e=0;e<i;e++)t=this.points[e],n[e]=[t.x,t.y,t.z];return n},this.getLength=function(e){var t,i,n,r,a=0,o=0,s=0,l=new q.Vector3,c=new q.Vector3,u=[],h=0;for(u[0]=0,e||(e=100),n=this.points.length*e,l.copy(this.points[0]),t=1;t<n;t++)i=t/n,r=this.getPoint(i),c.copy(r),h+=c.distanceTo(l),l.copy(r),a=(this.points.length-1)*i,(o=Math.floor(a))!==s&&(u[o]=h,s=o);return u[u.length]=h,{chunks:u,total:h}},this.reparametrizeByArcLength=function(e){var t,i,n,r,a,o,s,l,c=[],u=new q.Vector3,h=this.getLength();for(c.push(u.copy(this.points[0]).clone()),t=1;t<this.points.length;t++){for(o=h.chunks[t]-h.chunks[t-1],s=Math.ceil(e*o/h.total),r=(t-1)/(this.points.length-1),a=t/(this.points.length-1),i=1;i<s-1;i++)n=r+i*(1/s)*(a-r),l=this.getPoint(n),c.push(u.copy(l).clone());c.push(u.copy(this.points[t]).clone())}this.points=c}},q.Triangle=function(e,t,i){this.a=void 0!==e?e:new q.Vector3,this.b=void 0!==t?t:new q.Vector3,this.c=void 0!==i?i:new q.Vector3},q.Triangle.normal=(A=new q.Vector3,function(e,t,i,n){var r=n||new q.Vector3;r.subVectors(i,t),A.subVectors(e,t),r.cross(A);var a=r.lengthSq();return a>0?r.multiplyScalar(1/Math.sqrt(a)):r.set(0,0,0)}),q.Triangle.barycoordFromPoint=function(){var e=new q.Vector3,t=new q.Vector3,i=new q.Vector3;return function(n,r,a,o,s){e.subVectors(o,r),t.subVectors(a,r),i.subVectors(n,r);var l=e.dot(e),c=e.dot(t),u=e.dot(i),h=t.dot(t),d=t.dot(i),p=l*h-c*c,f=s||new q.Vector3;if(0===p)return f.set(-2,-1,-1);var g=1/p,_=(h*u-c*d)*g,m=(l*d-c*u)*g;return f.set(1-_-m,m,_)}}(),q.Triangle.containsPoint=function(){var e=new q.Vector3;return function(t,i,n,r){var a=q.Triangle.barycoordFromPoint(t,i,n,r,e);return a.x>=0&&a.y>=0&&a.x+a.y<=1}}(),q.Triangle.prototype={constructor:q.Triangle,set:function(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this},setFromPointsAndIndices:function(e,t,i,n){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[n]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this},area:function(){var e=new q.Vector3,t=new q.Vector3;return function(){return e.subVectors(this.c,this.b),t.subVectors(this.a,this.b),.5*e.cross(t).length()}}(),midpoint:function(e){return(e||new q.Vector3).addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(e){return q.Triangle.normal(this.a,this.b,this.c,e)},plane:function(e){return(e||new q.Plane).setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(e,t){return q.Triangle.barycoordFromPoint(e,this.a,this.b,this.c,t)},containsPoint:function(e){return q.Triangle.containsPoint(e,this.a,this.b,this.c)},closestPointToPoint:function(){var e,t,i,n;return function(r,a){void 0===e&&(e=new q.Plane,t=[new q.Line3,new q.Line3,new q.Line3],i=new q.Vector3,n=new q.Vector3);var o=a||new q.Vector3,s=1/0;if(e.setFromCoplanarPoints(this.a,this.b,this.c),e.projectPoint(r,i),!0===this.containsPoint(i))o.copy(i);else{t[0].set(this.a,this.b),t[1].set(this.b,this.c),t[2].set(this.c,this.a);for(var l=0;l<t.length;l++){t[l].closestPointToPoint(i,!0,n);var c=i.distanceToSquared(n);c<s&&(s=c,o.copy(n))}}return o}}(),equals:function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}},q.Interpolant=function(e,t,i,n){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==n?n:new t.constructor(i),this.sampleValues=t,this.valueSize=i},q.Interpolant.prototype={constructor:q.Interpolant,evaluate:function(e){var t=this.parameterPositions,i=this._cachedIndex,n=t[i],r=t[i-1];e:{t:{var a;i:{n:if(!(e<n)){for(var o=i+2;;){if(void 0===n){if(e<r)break n;return i=t.length,this._cachedIndex=i,this.afterEnd_(i-1,e,r)}if(i===o)break;if(r=n,e<(n=t[++i]))break t}a=t.length;break i}if(e>=r)break e;var s=t[1];e<s&&(i=2,r=s);for(o=i-2;;){if(void 0===r)return this._cachedIndex=0,this.beforeStart_(0,e,n);if(i===o)break;if(n=r,e>=(r=t[--i-1]))break t}a=i,i=0}for(;i<a;){var l=i+a>>>1;e<t[l]?a=l:i=l+1}if(n=t[i],void 0===(r=t[i-1]))return this._cachedIndex=0,this.beforeStart_(0,e,n);if(void 0===n)return i=t.length,this._cachedIndex=i,this.afterEnd_(i-1,r,e)}this._cachedIndex=i,this.intervalChanged_(i,r,n)}return this.interpolate_(i,r,e,n)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(e){for(var t=this.resultBuffer,i=this.sampleValues,n=this.valueSize,r=e*n,a=0;a!==n;++a)t[a]=i[r+a];return t},interpolate_:function(e,t,i,n){throw new Error("call to abstract method")},intervalChanged_:function(e,t,i){}},Object.assign(q.Interpolant.prototype,{beforeStart_:q.Interpolant.prototype.copySampleValue_,afterEnd_:q.Interpolant.prototype.copySampleValue_}),q.CubicInterpolant=function(e,t,i,n){q.Interpolant.call(this,e,t,i,n),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0},q.CubicInterpolant.prototype=Object.assign(Object.create(q.Interpolant.prototype),{constructor:q.CubicInterpolant,DefaultSettings_:{endingStart:q.ZeroCurvatureEnding,endingEnd:q.ZeroCurvatureEnding},intervalChanged_:function(e,t,i){var n=this.parameterPositions,r=e-2,a=e+1,o=n[r],s=n[a];if(void 0===o)switch(this.getSettings_().endingStart){case q.ZeroSlopeEnding:r=e,o=2*t-i;break;case q.WrapAroundEnding:o=t+n[r=n.length-2]-n[r+1];break;default:r=e,o=i}if(void 0===s)switch(this.getSettings_().endingEnd){case q.ZeroSlopeEnding:a=e,s=2*i-t;break;case q.WrapAroundEnding:a=1,s=i+n[1]-n[0];break;default:a=e-1,s=t}var l=.5*(i-t),c=this.valueSize;this._weightPrev=l/(t-o),this._weightNext=l/(s-i),this._offsetPrev=r*c,this._offsetNext=a*c},interpolate_:function(e,t,i,n){for(var r=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,l=s-o,c=this._offsetPrev,u=this._offsetNext,h=this._weightPrev,d=this._weightNext,p=(i-t)/(n-t),f=p*p,g=f*p,_=-h*g+2*h*f-h*p,m=(1+h)*g+(-1.5-2*h)*f+(-.5+h)*p+1,v=(-1-d)*g+(1.5+d)*f+.5*p,y=d*g-d*f,b=0;b!==o;++b)r[b]=_*a[c+b]+m*a[l+b]+v*a[s+b]+y*a[u+b];return r}}),q.DiscreteInterpolant=function(e,t,i,n){q.Interpolant.call(this,e,t,i,n)},q.DiscreteInterpolant.prototype=Object.assign(Object.create(q.Interpolant.prototype),{constructor:q.DiscreteInterpolant,interpolate_:function(e,t,i,n){return this.copySampleValue_(e-1)}}),q.LinearInterpolant=function(e,t,i,n){q.Interpolant.call(this,e,t,i,n)},q.LinearInterpolant.prototype=Object.assign(Object.create(q.Interpolant.prototype),{constructor:q.LinearInterpolant,interpolate_:function(e,t,i,n){for(var r=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,l=s-o,c=(i-t)/(n-t),u=1-c,h=0;h!==o;++h)r[h]=a[l+h]*u+a[s+h]*c;return r}}),q.QuaternionLinearInterpolant=function(e,t,i,n){q.Interpolant.call(this,e,t,i,n)},q.QuaternionLinearInterpolant.prototype=Object.assign(Object.create(q.Interpolant.prototype),{constructor:q.QuaternionLinearInterpolant,interpolate_:function(e,t,i,n){for(var r=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,l=(i-t)/(n-t),c=s+o;s!==c;s+=4)q.Quaternion.slerpFlat(r,0,a,s-o,a,s,l);return r}}),q.Clock=function(e){this.autoStart=void 0===e||e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1},q.Clock.prototype={constructor:q.Clock,start:function(){this.startTime=(performance||Date).now(),this.oldTime=this.startTime,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var e=0;if(this.autoStart&&!this.running&&this.start(),this.running){var t=(performance||Date).now();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}},q.EventDispatcher=function(){},Object.assign(q.EventDispatcher.prototype,{addEventListener:function(e,t){void 0===this._listeners&&(this._listeners={});var i=this._listeners;void 0===i[e]&&(i[e]=[]),-1===i[e].indexOf(t)&&i[e].push(t)},hasEventListener:function(e,t){if(void 0===this._listeners)return!1;var i=this._listeners;return void 0!==i[e]&&-1!==i[e].indexOf(t)},removeEventListener:function(e,t){if(void 0!==this._listeners){var i=this._listeners[e];if(void 0!==i){var n=i.indexOf(t);-1!==n&&i.splice(n,1)}}},dispatchEvent:function(e){if(void 0!==this._listeners){var t=this._listeners[e.type];if(void 0!==t){e.target=this;var i=[],n=0,r=t.length;for(n=0;n<r;n++)i[n]=t[n];for(n=0;n<r;n++)i[n].call(this,e)}}}}),q.Layers=function(){this.mask=1},q.Layers.prototype={constructor:q.Layers,set:function(e){this.mask=1<<e},enable:function(e){this.mask|=1<<e},toggle:function(e){this.mask^=1<<e},disable:function(e){this.mask&=~(1<<e)},test:function(e){return 0!=(this.mask&e.mask)}},function(e){function t(e,t){return e.distance-t.distance}function i(e,t,n,r){if(!1!==e.visible&&(e.raycast(t,n),!0===r))for(var a=e.children,o=0,s=a.length;o<s;o++)i(a[o],t,n,!0)}e.Raycaster=function(t,i,n,r){this.ray=new e.Ray(t,i),this.near=n||0,this.far=r||1/0,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})},e.Raycaster.prototype={constructor:e.Raycaster,linePrecision:1,set:function(e,t){this.ray.set(e,t)},setFromCamera:function(t,i){i instanceof e.PerspectiveCamera?(this.ray.origin.setFromMatrixPosition(i.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(i).sub(this.ray.origin).normalize()):i instanceof e.OrthographicCamera?(this.ray.origin.set(t.x,t.y,(i.near+i.far)/(i.near-i.far)).unproject(i),this.ray.direction.set(0,0,-1).transformDirection(i.matrixWorld)):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(e,n){var r=[];return i(e,this,r,n),r.sort(t),r},intersectObjects:function(e,n){var r=[];if(!1===Array.isArray(e))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),r;for(var a=0,o=e.length;a<o;a++)i(e[a],this,r,n);return r.sort(t),r}}}(q),q.Object3D=function(){Object.defineProperty(this,"id",{value:q.Object3DIdCount++}),this.uuid=q.Math.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=q.Object3D.DefaultUp.clone();var e=new q.Vector3,t=new q.Euler,i=new q.Quaternion,n=new q.Vector3(1,1,1);t.onChange((function(){i.setFromEuler(t,!1)})),i.onChange((function(){t.setFromQuaternion(i,void 0,!1)})),Object.defineProperties(this,{position:{enumerable:!0,value:e},rotation:{enumerable:!0,value:t},quaternion:{enumerable:!0,value:i},scale:{enumerable:!0,value:n},modelViewMatrix:{value:new q.Matrix4},normalMatrix:{value:new q.Matrix3}}),this.matrix=new q.Matrix4,this.matrixWorld=new q.Matrix4,this.matrixAutoUpdate=q.Object3D.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new q.Layers,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}},q.Object3D.DefaultUp=new q.Vector3(0,1,0),q.Object3D.DefaultMatrixAutoUpdate=!0,Object.assign(q.Object3D.prototype,q.EventDispatcher.prototype,{applyMatrix:function(e){this.matrix.multiplyMatrices(e,this.matrix),this.matrix.decompose(this.position,this.quaternion,this.scale)},setRotationFromAxisAngle:function(e,t){this.quaternion.setFromAxisAngle(e,t)},setRotationFromEuler:function(e){this.quaternion.setFromEuler(e,!0)},setRotationFromMatrix:function(e){this.quaternion.setFromRotationMatrix(e)},setRotationFromQuaternion:function(e){this.quaternion.copy(e)},rotateOnAxis:(P=new q.Quaternion,function(e,t){return P.setFromAxisAngle(e,t),this.quaternion.multiply(P),this}),rotateX:function(){var e=new q.Vector3(1,0,0);return function(t){return this.rotateOnAxis(e,t)}}(),rotateY:function(){var e=new q.Vector3(0,1,0);return function(t){return this.rotateOnAxis(e,t)}}(),rotateZ:function(){var e=new q.Vector3(0,0,1);return function(t){return this.rotateOnAxis(e,t)}}(),translateOnAxis:function(){var e=new q.Vector3;return function(t,i){return e.copy(t).applyQuaternion(this.quaternion),this.position.add(e.multiplyScalar(i)),this}}(),translateX:function(){var e=new q.Vector3(1,0,0);return function(t){return this.translateOnAxis(e,t)}}(),translateY:function(){var e=new q.Vector3(0,1,0);return function(t){return this.translateOnAxis(e,t)}}(),translateZ:function(){var e=new q.Vector3(0,0,1);return function(t){return this.translateOnAxis(e,t)}}(),localToWorld:function(e){return e.applyMatrix4(this.matrixWorld)},worldToLocal:(I=new q.Matrix4,function(e){return e.applyMatrix4(I.getInverse(this.matrixWorld))}),lookAt:function(){var e=new q.Matrix4;return function(t){e.lookAt(t,this.position,this.up),this.quaternion.setFromRotationMatrix(e)}}(),add:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e instanceof q.Object3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,e.dispatchEvent({type:"added"}),this.children.push(e)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)},remove:function(e){if(arguments.length>1)for(var t=0;t<arguments.length;t++)this.remove(arguments[t]);var i=this.children.indexOf(e);-1!==i&&(e.parent=null,e.dispatchEvent({type:"removed"}),this.children.splice(i,1))},getObjectById:function(e){return this.getObjectByProperty("id",e)},getObjectByName:function(e){return this.getObjectByProperty("name",e)},getObjectByProperty:function(e,t){if(this[e]===t)return this;for(var i=0,n=this.children.length;i<n;i++){var r=this.children[i].getObjectByProperty(e,t);if(void 0!==r)return r}},getWorldPosition:function(e){var t=e||new q.Vector3;return this.updateMatrixWorld(!0),t.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:(C=new q.Vector3,x=new q.Vector3,function(e){var t=e||new q.Quaternion;return this.updateMatrixWorld(!0),this.matrixWorld.decompose(C,t,x),t}),getWorldRotation:function(){var e=new q.Quaternion;return function(t){var i=t||new q.Euler;return this.getWorldQuaternion(e),i.setFromQuaternion(e,this.rotation.order,!1)}}(),getWorldScale:function(){var e=new q.Vector3,t=new q.Quaternion;return function(i){var n=i||new q.Vector3;return this.updateMatrixWorld(!0),this.matrixWorld.decompose(e,t,n),n}}(),getWorldDirection:function(){var e=new q.Quaternion;return function(t){var i=t||new q.Vector3;return this.getWorldQuaternion(e),i.set(0,0,1).applyQuaternion(e)}}(),raycast:function(){},traverse:function(e){e(this);for(var t=this.children,i=0,n=t.length;i<n;i++)t[i].traverse(e)},traverseVisible:function(e){if(!1!==this.visible){e(this);for(var t=this.children,i=0,n=t.length;i<n;i++)t[i].traverseVisible(e)}},traverseAncestors:function(e){var t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(e){!0===this.matrixAutoUpdate&&this.updateMatrix(),!0!==this.matrixWorldNeedsUpdate&&!0!==e||(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);for(var t=0,i=this.children.length;t<i;t++)this.children[t].updateMatrixWorld(e)},toJSON:function(e){var t=void 0===e||""===e,i={};t&&(e={geometries:{},materials:{},textures:{},images:{}},i.metadata={version:4.4,type:"Object",generator:"Object3D.toJSON"});var n={};if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),!0===this.castShadow&&(n.castShadow=!0),!0===this.receiveShadow&&(n.receiveShadow=!0),!1===this.visible&&(n.visible=!1),n.matrix=this.matrix.toArray(),void 0!==this.geometry&&(void 0===e.geometries[this.geometry.uuid]&&(e.geometries[this.geometry.uuid]=this.geometry.toJSON(e)),n.geometry=this.geometry.uuid),void 0!==this.material&&(void 0===e.materials[this.material.uuid]&&(e.materials[this.material.uuid]=this.material.toJSON(e)),n.material=this.material.uuid),this.children.length>0){n.children=[];for(var r=0;r<this.children.length;r++)n.children.push(this.children[r].toJSON(e).object)}if(t){var a=c(e.geometries),o=c(e.materials),s=c(e.textures),l=c(e.images);a.length>0&&(i.geometries=a),o.length>0&&(i.materials=o),s.length>0&&(i.textures=s),l.length>0&&(i.images=l)}return i.object=n,i;function c(e){var t=[];for(var i in e){var n=e[i];delete n.metadata,t.push(n)}return t}},clone:function(e){return(new this.constructor).copy(this,e)},copy:function(e,t){if(void 0===t&&(t=!0),this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(var i=0;i<e.children.length;i++){var n=e.children[i];this.add(n.clone())}return this}}),q.Object3DIdCount=0,q.Face3=function(e,t,i,n,r,a){this.a=e,this.b=t,this.c=i,this.normal=n instanceof q.Vector3?n:new q.Vector3,this.vertexNormals=Array.isArray(n)?n:[],this.color=r instanceof q.Color?r:new q.Color,this.vertexColors=Array.isArray(r)?r:[],this.materialIndex=void 0!==a?a:0},q.Face3.prototype={constructor:q.Face3,clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.a=e.a,this.b=e.b,this.c=e.c,this.normal.copy(e.normal),this.color.copy(e.color),this.materialIndex=e.materialIndex;for(var t=0,i=e.vertexNormals.length;t<i;t++)this.vertexNormals[t]=e.vertexNormals[t].clone();for(t=0,i=e.vertexColors.length;t<i;t++)this.vertexColors[t]=e.vertexColors[t].clone();return this}},q.BufferAttribute=function(e,t,i){this.uuid=q.Math.generateUUID(),this.array=e,this.itemSize=t,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0,this.normalized=!0===i},q.BufferAttribute.prototype={constructor:q.BufferAttribute,get count(){return this.array.length/this.itemSize},set needsUpdate(e){!0===e&&this.version++},setDynamic:function(e){return this.dynamic=e,this},copy:function(e){return this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.dynamic=e.dynamic,this},copyAt:function(e,t,i){e*=this.itemSize,i*=t.itemSize;for(var n=0,r=this.itemSize;n<r;n++)this.array[e+n]=t.array[i+n];return this},copyArray:function(e){return this.array.set(e),this},copyColorsArray:function(e){for(var t=this.array,i=0,n=0,r=e.length;n<r;n++){var a=e[n];void 0===a&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",n),a=new q.Color),t[i++]=a.r,t[i++]=a.g,t[i++]=a.b}return this},copyIndicesArray:function(e){for(var t=this.array,i=0,n=0,r=e.length;n<r;n++){var a=e[n];t[i++]=a.a,t[i++]=a.b,t[i++]=a.c}return this},copyVector2sArray:function(e){for(var t=this.array,i=0,n=0,r=e.length;n<r;n++){var a=e[n];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",n),a=new q.Vector2),t[i++]=a.x,t[i++]=a.y}return this},copyVector3sArray:function(e){for(var t=this.array,i=0,n=0,r=e.length;n<r;n++){var a=e[n];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",n),a=new q.Vector3),t[i++]=a.x,t[i++]=a.y,t[i++]=a.z}return this},copyVector4sArray:function(e){for(var t=this.array,i=0,n=0,r=e.length;n<r;n++){var a=e[n];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",n),a=new q.Vector4),t[i++]=a.x,t[i++]=a.y,t[i++]=a.z,t[i++]=a.w}return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},getX:function(e){return this.array[e*this.itemSize]},setX:function(e,t){return this.array[e*this.itemSize]=t,this},getY:function(e){return this.array[e*this.itemSize+1]},setY:function(e,t){return this.array[e*this.itemSize+1]=t,this},getZ:function(e){return this.array[e*this.itemSize+2]},setZ:function(e,t){return this.array[e*this.itemSize+2]=t,this},getW:function(e){return this.array[e*this.itemSize+3]},setW:function(e,t){return this.array[e*this.itemSize+3]=t,this},setXY:function(e,t,i){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=i,this},setXYZ:function(e,t,i,n){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=n,this},setXYZW:function(e,t,i,n,r){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=n,this.array[e+3]=r,this},clone:function(){return(new this.constructor).copy(this)}},q.Int8Attribute=function(e,t){return new q.BufferAttribute(new Int8Array(e),t)},q.Uint8Attribute=function(e,t){return new q.BufferAttribute(new Uint8Array(e),t)},q.Uint8ClampedAttribute=function(e,t){return new q.BufferAttribute(new Uint8ClampedArray(e),t)},q.Int16Attribute=function(e,t){return new q.BufferAttribute(new Int16Array(e),t)},q.Uint16Attribute=function(e,t){return new q.BufferAttribute(new Uint16Array(e),t)},q.Int32Attribute=function(e,t){return new q.BufferAttribute(new Int32Array(e),t)},q.Uint32Attribute=function(e,t){return new q.BufferAttribute(new Uint32Array(e),t)},q.Float32Attribute=function(e,t){return new q.BufferAttribute(new Float32Array(e),t)},q.Float64Attribute=function(e,t){return new q.BufferAttribute(new Float64Array(e),t)},q.DynamicBufferAttribute=function(e,t){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead."),new q.BufferAttribute(e,t).setDynamic(!0)},q.InstancedBufferAttribute=function(e,t,i){q.BufferAttribute.call(this,e,t),this.meshPerAttribute=i||1},q.InstancedBufferAttribute.prototype=Object.create(q.BufferAttribute.prototype),q.InstancedBufferAttribute.prototype.constructor=q.InstancedBufferAttribute,q.InstancedBufferAttribute.prototype.copy=function(e){return q.BufferAttribute.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this},q.InterleavedBuffer=function(e,t){this.uuid=q.Math.generateUUID(),this.array=e,this.stride=t,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0},q.InterleavedBuffer.prototype={constructor:q.InterleavedBuffer,get length(){return this.array.length},get count(){return this.array.length/this.stride},set needsUpdate(e){!0===e&&this.version++},setDynamic:function(e){return this.dynamic=e,this},copy:function(e){return this.array=new e.array.constructor(e.array),this.stride=e.stride,this.dynamic=e.dynamic,this},copyAt:function(e,t,i){e*=this.stride,i*=t.stride;for(var n=0,r=this.stride;n<r;n++)this.array[e+n]=t.array[i+n];return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},clone:function(){return(new this.constructor).copy(this)}},q.InstancedInterleavedBuffer=function(e,t,i){q.InterleavedBuffer.call(this,e,t),this.meshPerAttribute=i||1},q.InstancedInterleavedBuffer.prototype=Object.create(q.InterleavedBuffer.prototype),q.InstancedInterleavedBuffer.prototype.constructor=q.InstancedInterleavedBuffer,q.InstancedInterleavedBuffer.prototype.copy=function(e){return q.InterleavedBuffer.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this},q.InterleavedBufferAttribute=function(e,t,i){this.uuid=q.Math.generateUUID(),this.data=e,this.itemSize=t,this.offset=i},q.InterleavedBufferAttribute.prototype={constructor:q.InterleavedBufferAttribute,get length(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Please use .count."),this.array.length},get count(){return this.data.count},setX:function(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this},setY:function(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this},setZ:function(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this},setW:function(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this},getX:function(e){return this.data.array[e*this.data.stride+this.offset]},getY:function(e){return this.data.array[e*this.data.stride+this.offset+1]},getZ:function(e){return this.data.array[e*this.data.stride+this.offset+2]},getW:function(e){return this.data.array[e*this.data.stride+this.offset+3]},setXY:function(e,t,i){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=i,this},setXYZ:function(e,t,i,n){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=n,this},setXYZW:function(e,t,i,n,r){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=n,this.data.array[e+3]=r,this}},q.Geometry=function(){Object.defineProperty(this,"id",{value:q.GeometryIdCount++}),this.uuid=q.Math.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.elementsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1},Object.assign(q.Geometry.prototype,q.EventDispatcher.prototype,{applyMatrix:function(e){for(var t=(new q.Matrix3).getNormalMatrix(e),i=0,n=this.vertices.length;i<n;i++){this.vertices[i].applyMatrix4(e)}for(i=0,n=this.faces.length;i<n;i++){var r=this.faces[i];r.normal.applyMatrix3(t).normalize();for(var a=0,o=r.vertexNormals.length;a<o;a++)r.vertexNormals[a].applyMatrix3(t).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(){var e;return function(t){return void 0===e&&(e=new q.Matrix4),e.makeRotationX(t),this.applyMatrix(e),this}}(),rotateY:function(){var e;return function(t){return void 0===e&&(e=new q.Matrix4),e.makeRotationY(t),this.applyMatrix(e),this}}(),rotateZ:function(){var e;return function(t){return void 0===e&&(e=new q.Matrix4),e.makeRotationZ(t),this.applyMatrix(e),this}}(),translate:function(){var e;return function(t,i,n){return void 0===e&&(e=new q.Matrix4),e.makeTranslation(t,i,n),this.applyMatrix(e),this}}(),scale:function(){var e;return function(t,i,n){return void 0===e&&(e=new q.Matrix4),e.makeScale(t,i,n),this.applyMatrix(e),this}}(),lookAt:function(e){void 0===L&&(L=new q.Object3D),L.lookAt(e),L.updateMatrix(),this.applyMatrix(L.matrix)},fromBufferGeometry:function(e){var t=this,i=null!==e.index?e.index.array:void 0,n=e.attributes,r=n.position.array,a=void 0!==n.normal?n.normal.array:void 0,o=void 0!==n.color?n.color.array:void 0,s=void 0!==n.uv?n.uv.array:void 0,l=void 0!==n.uv2?n.uv2.array:void 0;void 0!==l&&(this.faceVertexUvs[1]=[]);for(var c=[],u=[],h=[],d=0,p=0;d<r.length;d+=3,p+=2)t.vertices.push(new q.Vector3(r[d],r[d+1],r[d+2])),void 0!==a&&c.push(new q.Vector3(a[d],a[d+1],a[d+2])),void 0!==o&&t.colors.push(new q.Color(o[d],o[d+1],o[d+2])),void 0!==s&&u.push(new q.Vector2(s[p],s[p+1])),void 0!==l&&h.push(new q.Vector2(l[p],l[p+1]));function f(e,i,n,r){var d=void 0!==a?[c[e].clone(),c[i].clone(),c[n].clone()]:[],p=void 0!==o?[t.colors[e].clone(),t.colors[i].clone(),t.colors[n].clone()]:[],f=new q.Face3(e,i,n,d,p,r);t.faces.push(f),void 0!==s&&t.faceVertexUvs[0].push([u[e].clone(),u[i].clone(),u[n].clone()]),void 0!==l&&t.faceVertexUvs[1].push([h[e].clone(),h[i].clone(),h[n].clone()])}if(void 0!==i){var g=e.groups;if(g.length>0)for(d=0;d<g.length;d++)for(var _=g[d],m=_.start,v=(p=m,m+_.count);p<v;p+=3)f(i[p],i[p+1],i[p+2],_.materialIndex);else for(d=0;d<i.length;d+=3)f(i[d],i[d+1],i[d+2])}else for(d=0;d<r.length/3;d+=3)f(d,d+1,d+2);return this.computeFaceNormals(),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this},center:function(){this.computeBoundingBox();var e=this.boundingBox.center().negate();return this.translate(e.x,e.y,e.z),e},normalize:function(){this.computeBoundingSphere();var e=this.boundingSphere.center,t=this.boundingSphere.radius,i=0===t?1:1/t,n=new q.Matrix4;return n.set(i,0,0,-i*e.x,0,i,0,-i*e.y,0,0,i,-i*e.z,0,0,0,1),this.applyMatrix(n),this},computeFaceNormals:function(){for(var e=new q.Vector3,t=new q.Vector3,i=0,n=this.faces.length;i<n;i++){var r=this.faces[i],a=this.vertices[r.a],o=this.vertices[r.b],s=this.vertices[r.c];e.subVectors(s,o),t.subVectors(a,o),e.cross(t),e.normalize(),r.normal.copy(e)}},computeVertexNormals:function(e){var t,i,n,r,a,o;for(void 0===e&&(e=!0),o=new Array(this.vertices.length),t=0,i=this.vertices.length;t<i;t++)o[t]=new q.Vector3;if(e){var s,l,c,u=new q.Vector3,h=new q.Vector3;for(n=0,r=this.faces.length;n<r;n++)a=this.faces[n],s=this.vertices[a.a],l=this.vertices[a.b],c=this.vertices[a.c],u.subVectors(c,l),h.subVectors(s,l),u.cross(h),o[a.a].add(u),o[a.b].add(u),o[a.c].add(u)}else for(n=0,r=this.faces.length;n<r;n++)o[(a=this.faces[n]).a].add(a.normal),o[a.b].add(a.normal),o[a.c].add(a.normal);for(t=0,i=this.vertices.length;t<i;t++)o[t].normalize();for(n=0,r=this.faces.length;n<r;n++){var d=(a=this.faces[n]).vertexNormals;3===d.length?(d[0].copy(o[a.a]),d[1].copy(o[a.b]),d[2].copy(o[a.c])):(d[0]=o[a.a].clone(),d[1]=o[a.b].clone(),d[2]=o[a.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var e,t,i,n,r;for(i=0,n=this.faces.length;i<n;i++)for((r=this.faces[i]).__originalFaceNormal?r.__originalFaceNormal.copy(r.normal):r.__originalFaceNormal=r.normal.clone(),r.__originalVertexNormals||(r.__originalVertexNormals=[]),e=0,t=r.vertexNormals.length;e<t;e++)r.__originalVertexNormals[e]?r.__originalVertexNormals[e].copy(r.vertexNormals[e]):r.__originalVertexNormals[e]=r.vertexNormals[e].clone();var a=new q.Geometry;for(a.faces=this.faces,e=0,t=this.morphTargets.length;e<t;e++){if(!this.morphNormals[e]){this.morphNormals[e]={},this.morphNormals[e].faceNormals=[],this.morphNormals[e].vertexNormals=[];var o=this.morphNormals[e].faceNormals,s=this.morphNormals[e].vertexNormals;for(i=0,n=this.faces.length;i<n;i++)l=new q.Vector3,c={a:new q.Vector3,b:new q.Vector3,c:new q.Vector3},o.push(l),s.push(c)}var l,c,u=this.morphNormals[e];for(a.vertices=this.morphTargets[e].vertices,a.computeFaceNormals(),a.computeVertexNormals(),i=0,n=this.faces.length;i<n;i++)r=this.faces[i],l=u.faceNormals[i],c=u.vertexNormals[i],l.copy(r.normal),c.a.copy(r.vertexNormals[0]),c.b.copy(r.vertexNormals[1]),c.c.copy(r.vertexNormals[2])}for(i=0,n=this.faces.length;i<n;i++)(r=this.faces[i]).normal=r.__originalFaceNormal,r.vertexNormals=r.__originalVertexNormals},computeTangents:function(){console.warn("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){for(var e=0,t=this.vertices,i=0,n=t.length;i<n;i++)i>0&&(e+=t[i].distanceTo(t[i-1])),this.lineDistances[i]=e},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new q.Box3),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new q.Sphere),this.boundingSphere.setFromPoints(this.vertices)},merge:function(e,t,i){if(e instanceof q.Geometry!=!1){var n,r=this.vertices.length,a=this.vertices,o=e.vertices,s=this.faces,l=e.faces,c=this.faceVertexUvs[0],u=e.faceVertexUvs[0];void 0===i&&(i=0),void 0!==t&&(n=(new q.Matrix3).getNormalMatrix(t));for(var h=0,d=o.length;h<d;h++){var p=o[h].clone();void 0!==t&&p.applyMatrix4(t),a.push(p)}for(h=0,d=l.length;h<d;h++){var f,g,_,m=l[h],v=m.vertexNormals,y=m.vertexColors;(f=new q.Face3(m.a+r,m.b+r,m.c+r)).normal.copy(m.normal),void 0!==n&&f.normal.applyMatrix3(n).normalize();for(var b=0,S=v.length;b<S;b++)g=v[b].clone(),void 0!==n&&g.applyMatrix3(n).normalize(),f.vertexNormals.push(g);f.color.copy(m.color);for(b=0,S=y.length;b<S;b++)_=y[b],f.vertexColors.push(_.clone());f.materialIndex=m.materialIndex+i,s.push(f)}for(h=0,d=u.length;h<d;h++){var E=u[h],w=[];if(void 0!==E){for(b=0,S=E.length;b<S;b++)w.push(E[b].clone());c.push(w)}}}else console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",e)},mergeMesh:function(e){e instanceof q.Mesh!=!1?(e.matrixAutoUpdate&&e.updateMatrix(),this.merge(e.geometry,e.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",e)},mergeVertices:function(){var e,t,i,n,r,a,o,s,l={},c=[],u=[],h=Math.pow(10,4);for(i=0,n=this.vertices.length;i<n;i++)e=this.vertices[i],void 0===l[t=Math.round(e.x*h)+"_"+Math.round(e.y*h)+"_"+Math.round(e.z*h)]?(l[t]=i,c.push(this.vertices[i]),u[i]=c.length-1):u[i]=u[l[t]];var d=[];for(i=0,n=this.faces.length;i<n;i++){(r=this.faces[i]).a=u[r.a],r.b=u[r.b],r.c=u[r.c],a=[r.a,r.b,r.c];for(var p=0;p<3;p++)if(a[p]===a[(p+1)%3]){p,d.push(i);break}}for(i=d.length-1;i>=0;i--){var f=d[i];for(this.faces.splice(f,1),o=0,s=this.faceVertexUvs.length;o<s;o++)this.faceVertexUvs[o].splice(f,1)}var g=this.vertices.length-c.length;return this.vertices=c,g},sortFacesByMaterialIndex:function(){for(var e=this.faces,t=e.length,i=0;i<t;i++)e[i]._id=i;e.sort((function(e,t){return e.materialIndex-t.materialIndex}));var n,r,a=this.faceVertexUvs[0],o=this.faceVertexUvs[1];a&&a.length===t&&(n=[]),o&&o.length===t&&(r=[]);for(i=0;i<t;i++){var s=e[i]._id;n&&n.push(a[s]),r&&r.push(o[s])}n&&(this.faceVertexUvs[0]=n),r&&(this.faceVertexUvs[1]=r)},toJSON:function(){var e={metadata:{version:4.4,type:"Geometry",generator:"Geometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),void 0!==this.parameters){var t=this.parameters;for(var i in t)void 0!==t[i]&&(e[i]=t[i]);return e}for(var n=[],r=0;r<this.vertices.length;r++){var a=this.vertices[r];n.push(a.x,a.y,a.z)}var o=[],s=[],l={},c=[],u={},h=[],d={};for(r=0;r<this.faces.length;r++){var p=this.faces[r],f=void 0!==this.faceVertexUvs[0][r],g=p.normal.length()>0,_=p.vertexNormals.length>0,m=1!==p.color.r||1!==p.color.g||1!==p.color.b,v=p.vertexColors.length>0,y=0;if(y=w(y,0,0),y=w(y,1,!0),y=w(y,2,!1),y=w(y,3,f),y=w(y,4,g),y=w(y,5,_),y=w(y,6,m),y=w(y,7,v),o.push(y),o.push(p.a,p.b,p.c),o.push(p.materialIndex),f){var b=this.faceVertexUvs[0][r];o.push(A(b[0]),A(b[1]),A(b[2]))}if(g&&o.push(T(p.normal)),_){var S=p.vertexNormals;o.push(T(S[0]),T(S[1]),T(S[2]))}if(m&&o.push(M(p.color)),v){var E=p.vertexColors;o.push(M(E[0]),M(E[1]),M(E[2]))}}function w(e,t,i){return i?e|1<<t:e&~(1<<t)}function T(e){var t=e.x.toString()+e.y.toString()+e.z.toString();return void 0!==l[t]||(l[t]=s.length/3,s.push(e.x,e.y,e.z)),l[t]}function M(e){var t=e.r.toString()+e.g.toString()+e.b.toString();return void 0!==u[t]||(u[t]=c.length,c.push(e.getHex())),u[t]}function A(e){var t=e.x.toString()+e.y.toString();return void 0!==d[t]||(d[t]=h.length/2,h.push(e.x,e.y)),d[t]}return e.data={},e.data.vertices=n,e.data.normals=s,c.length>0&&(e.data.colors=c),h.length>0&&(e.data.uvs=[h]),e.data.faces=o,e},clone:function(){return(new q.Geometry).copy(this)},copy:function(e){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]];for(var t=e.vertices,i=0,n=t.length;i<n;i++)this.vertices.push(t[i].clone());var r=e.faces;for(i=0,n=r.length;i<n;i++)this.faces.push(r[i].clone());for(i=0,n=e.faceVertexUvs.length;i<n;i++){var a=e.faceVertexUvs[i];void 0===this.faceVertexUvs[i]&&(this.faceVertexUvs[i]=[]);for(var o=0,s=a.length;o<s;o++){for(var l=a[o],c=[],u=0,h=l.length;u<h;u++){var d=l[u];c.push(d.clone())}this.faceVertexUvs[i].push(c)}}return this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),q.GeometryIdCount=0,q.DirectGeometry=function(){Object.defineProperty(this,"id",{value:q.GeometryIdCount++}),this.uuid=q.Math.generateUUID(),this.name="",this.type="DirectGeometry",this.indices=[],this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1},Object.assign(q.DirectGeometry.prototype,q.EventDispatcher.prototype,{computeBoundingBox:q.Geometry.prototype.computeBoundingBox,computeBoundingSphere:q.Geometry.prototype.computeBoundingSphere,computeFaceNormals:function(){console.warn("THREE.DirectGeometry: computeFaceNormals() is not a method of this type of geometry.")},computeVertexNormals:function(){console.warn("THREE.DirectGeometry: computeVertexNormals() is not a method of this type of geometry.")},computeGroups:function(e){for(var t,i,n=[],r=e.faces,a=0;a<r.length;a++){var o=r[a];o.materialIndex!==i&&(i=o.materialIndex,void 0!==t&&(t.count=3*a-t.start,n.push(t)),t={start:3*a,materialIndex:i})}void 0!==t&&(t.count=3*a-t.start,n.push(t)),this.groups=n},fromGeometry:function(e){var t,i=e.faces,n=e.vertices,r=e.faceVertexUvs,a=r[0]&&r[0].length>0,o=r[1]&&r[1].length>0,s=e.morphTargets,l=s.length;if(l>0){t=[];for(var c=0;c<l;c++)t[c]=[];this.morphTargets.position=t}var u,h=e.morphNormals,d=h.length;if(d>0){u=[];for(c=0;c<d;c++)u[c]=[];this.morphTargets.normal=u}var p=e.skinIndices,f=e.skinWeights,g=p.length===n.length,_=f.length===n.length;for(c=0;c<i.length;c++){var m=i[c];this.vertices.push(n[m.a],n[m.b],n[m.c]);var v=m.vertexNormals;if(3===v.length)this.normals.push(v[0],v[1],v[2]);else{var y=m.normal;this.normals.push(y,y,y)}var b,S=m.vertexColors;if(3===S.length)this.colors.push(S[0],S[1],S[2]);else{var E=m.color;this.colors.push(E,E,E)}if(!0===a)void 0!==(b=r[0][c])?this.uvs.push(b[0],b[1],b[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",c),this.uvs.push(new q.Vector2,new q.Vector2,new q.Vector2));if(!0===o)void 0!==(b=r[1][c])?this.uvs2.push(b[0],b[1],b[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",c),this.uvs2.push(new q.Vector2,new q.Vector2,new q.Vector2));for(var w=0;w<l;w++){var T=s[w].vertices;t[w].push(T[m.a],T[m.b],T[m.c])}for(w=0;w<d;w++){var M=h[w].vertexNormals[c];u[w].push(M.a,M.b,M.c)}g&&this.skinIndices.push(p[m.a],p[m.b],p[m.c]),_&&this.skinWeights.push(f[m.a],f[m.b],f[m.c])}return this.computeGroups(e),this.verticesNeedUpdate=e.verticesNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),q.BufferGeometry=function(){Object.defineProperty(this,"id",{value:q.GeometryIdCount++}),this.uuid=q.Math.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0}},Object.assign(q.BufferGeometry.prototype,q.EventDispatcher.prototype,{getIndex:function(){return this.index},setIndex:function(e){this.index=e},addAttribute:function(e,t){return t instanceof q.BufferAttribute==!1&&t instanceof q.InterleavedBufferAttribute==!1?(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),void this.addAttribute(e,new q.BufferAttribute(arguments[1],arguments[2]))):"index"===e?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),void this.setIndex(t)):(this.attributes[e]=t,this)},getAttribute:function(e){return this.attributes[e]},removeAttribute:function(e){return delete this.attributes[e],this},addGroup:function(e,t,i){this.groups.push({start:e,count:t,materialIndex:void 0!==i?i:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(e,t){this.drawRange.start=e,this.drawRange.count=t},applyMatrix:function(e){var t=this.attributes.position;void 0!==t&&(e.applyToVector3Array(t.array),t.needsUpdate=!0);var i=this.attributes.normal;void 0!==i&&((new q.Matrix3).getNormalMatrix(e).applyToVector3Array(i.array),i.needsUpdate=!0);return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(){var e;return function(t){return void 0===e&&(e=new q.Matrix4),e.makeRotationX(t),this.applyMatrix(e),this}}(),rotateY:function(){var e;return function(t){return void 0===e&&(e=new q.Matrix4),e.makeRotationY(t),this.applyMatrix(e),this}}(),rotateZ:function(){var e;return function(t){return void 0===e&&(e=new q.Matrix4),e.makeRotationZ(t),this.applyMatrix(e),this}}(),translate:function(){var e;return function(t,i,n){return void 0===e&&(e=new q.Matrix4),e.makeTranslation(t,i,n),this.applyMatrix(e),this}}(),scale:function(){var e;return function(t,i,n){return void 0===e&&(e=new q.Matrix4),e.makeScale(t,i,n),this.applyMatrix(e),this}}(),lookAt:function(){var e;return function(t){void 0===e&&(e=new q.Object3D),e.lookAt(t),e.updateMatrix(),this.applyMatrix(e.matrix)}}(),center:function(){this.computeBoundingBox();var e=this.boundingBox.center().negate();return this.translate(e.x,e.y,e.z),e},setFromObject:function(e){var t=e.geometry;if(e instanceof q.Points||e instanceof q.Line){var i=new q.Float32Attribute(3*t.vertices.length,3),n=new q.Float32Attribute(3*t.colors.length,3);if(this.addAttribute("position",i.copyVector3sArray(t.vertices)),this.addAttribute("color",n.copyColorsArray(t.colors)),t.lineDistances&&t.lineDistances.length===t.vertices.length){var r=new q.Float32Attribute(t.lineDistances.length,1);this.addAttribute("lineDistance",r.copyArray(t.lineDistances))}null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone())}else e instanceof q.Mesh&&t instanceof q.Geometry&&this.fromGeometry(t);return this},updateFromObject:function(e){var t,i=e.geometry;if(e instanceof q.Mesh){var n=i.__directGeometry;if(void 0===n)return this.fromGeometry(i);n.verticesNeedUpdate=i.verticesNeedUpdate,n.normalsNeedUpdate=i.normalsNeedUpdate,n.colorsNeedUpdate=i.colorsNeedUpdate,n.uvsNeedUpdate=i.uvsNeedUpdate,n.groupsNeedUpdate=i.groupsNeedUpdate,i.verticesNeedUpdate=!1,i.normalsNeedUpdate=!1,i.colorsNeedUpdate=!1,i.uvsNeedUpdate=!1,i.groupsNeedUpdate=!1,i=n}!0===i.verticesNeedUpdate&&(void 0!==(t=this.attributes.position)&&(t.copyVector3sArray(i.vertices),t.needsUpdate=!0),i.verticesNeedUpdate=!1);!0===i.normalsNeedUpdate&&(void 0!==(t=this.attributes.normal)&&(t.copyVector3sArray(i.normals),t.needsUpdate=!0),i.normalsNeedUpdate=!1);!0===i.colorsNeedUpdate&&(void 0!==(t=this.attributes.color)&&(t.copyColorsArray(i.colors),t.needsUpdate=!0),i.colorsNeedUpdate=!1);i.uvsNeedUpdate&&(void 0!==(t=this.attributes.uv)&&(t.copyVector2sArray(i.uvs),t.needsUpdate=!0),i.uvsNeedUpdate=!1);i.lineDistancesNeedUpdate&&(void 0!==(t=this.attributes.lineDistance)&&(t.copyArray(i.lineDistances),t.needsUpdate=!0),i.lineDistancesNeedUpdate=!1);return i.groupsNeedUpdate&&(i.computeGroups(e.geometry),this.groups=i.groups,i.groupsNeedUpdate=!1),this},fromGeometry:function(e){return e.__directGeometry=(new q.DirectGeometry).fromGeometry(e),this.fromDirectGeometry(e.__directGeometry)},fromDirectGeometry:function(e){var t=new Float32Array(3*e.vertices.length);if(this.addAttribute("position",new q.BufferAttribute(t,3).copyVector3sArray(e.vertices)),e.normals.length>0){var i=new Float32Array(3*e.normals.length);this.addAttribute("normal",new q.BufferAttribute(i,3).copyVector3sArray(e.normals))}if(e.colors.length>0){var n=new Float32Array(3*e.colors.length);this.addAttribute("color",new q.BufferAttribute(n,3).copyColorsArray(e.colors))}if(e.uvs.length>0){var r=new Float32Array(2*e.uvs.length);this.addAttribute("uv",new q.BufferAttribute(r,2).copyVector2sArray(e.uvs))}if(e.uvs2.length>0){var a=new Float32Array(2*e.uvs2.length);this.addAttribute("uv2",new q.BufferAttribute(a,2).copyVector2sArray(e.uvs2))}if(e.indices.length>0){var o=new(e.vertices.length>65535?Uint32Array:Uint16Array)(3*e.indices.length);this.setIndex(new q.BufferAttribute(o,1).copyIndicesArray(e.indices))}for(var s in this.groups=e.groups,e.morphTargets){for(var l=[],c=e.morphTargets[s],u=0,h=c.length;u<h;u++){var d=c[u],p=new q.Float32Attribute(3*d.length,3);l.push(p.copyVector3sArray(d))}this.morphAttributes[s]=l}if(e.skinIndices.length>0){var f=new q.Float32Attribute(4*e.skinIndices.length,4);this.addAttribute("skinIndex",f.copyVector4sArray(e.skinIndices))}if(e.skinWeights.length>0){var g=new q.Float32Attribute(4*e.skinWeights.length,4);this.addAttribute("skinWeight",g.copyVector4sArray(e.skinWeights))}return null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new q.Box3);var e=this.attributes.position.array;void 0!==e?this.boundingBox.setFromArray(e):this.boundingBox.makeEmpty(),(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){var e=new q.Box3,t=new q.Vector3;return function(){null===this.boundingSphere&&(this.boundingSphere=new q.Sphere);var i=this.attributes.position;if(i){var n=i.array,r=this.boundingSphere.center;e.setFromArray(n),e.center(r);for(var a=0,o=0,s=n.length;o<s;o+=3)t.fromArray(n,o),a=Math.max(a,r.distanceToSquared(t));this.boundingSphere.radius=Math.sqrt(a),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){var e=this.index,t=this.attributes,i=this.groups;if(t.position){var n=t.position.array;if(void 0===t.normal)this.addAttribute("normal",new q.BufferAttribute(new Float32Array(n.length),3));else for(var r=t.normal.array,a=0,o=r.length;a<o;a++)r[a]=0;var s,l,c,u=t.normal.array,h=new q.Vector3,d=new q.Vector3,p=new q.Vector3,f=new q.Vector3,g=new q.Vector3;if(e){var _=e.array;0===i.length&&this.addGroup(0,_.length);for(var m=0,v=i.length;m<v;++m){var y=i[m],b=y.start;for(a=b,o=b+y.count;a<o;a+=3)s=3*_[a+0],l=3*_[a+1],c=3*_[a+2],h.fromArray(n,s),d.fromArray(n,l),p.fromArray(n,c),f.subVectors(p,d),g.subVectors(h,d),f.cross(g),u[s]+=f.x,u[s+1]+=f.y,u[s+2]+=f.z,u[l]+=f.x,u[l+1]+=f.y,u[l+2]+=f.z,u[c]+=f.x,u[c+1]+=f.y,u[c+2]+=f.z}}else for(a=0,o=n.length;a<o;a+=9)h.fromArray(n,a),d.fromArray(n,a+3),p.fromArray(n,a+6),f.subVectors(p,d),g.subVectors(h,d),f.cross(g),u[a]=f.x,u[a+1]=f.y,u[a+2]=f.z,u[a+3]=f.x,u[a+4]=f.y,u[a+5]=f.z,u[a+6]=f.x,u[a+7]=f.y,u[a+8]=f.z;this.normalizeNormals(),t.normal.needsUpdate=!0}},merge:function(e,t){if(e instanceof q.BufferGeometry!=!1){void 0===t&&(t=0);var i=this.attributes;for(var n in i)if(void 0!==e.attributes[n])for(var r=i[n].array,a=e.attributes[n],o=a.array,s=0,l=a.itemSize*t;s<o.length;s++,l++)r[l]=o[s];return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e)},normalizeNormals:function(){for(var e,t,i,n,r=this.attributes.normal.array,a=0,o=r.length;a<o;a+=3)e=r[a],t=r[a+1],i=r[a+2],n=1/Math.sqrt(e*e+t*t+i*i),r[a]*=n,r[a+1]*=n,r[a+2]*=n},toNonIndexed:function(){if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var e=new q.BufferGeometry,t=this.index.array,i=this.attributes;for(var n in i){for(var r=i[n],a=r.array,o=r.itemSize,s=new a.constructor(t.length*o),l=0,c=0,u=0,h=t.length;u<h;u++){l=t[u]*o;for(var d=0;d<o;d++)s[c++]=a[l++]}e.addAttribute(n,new q.BufferAttribute(s,o))}return e},toJSON:function(){var e={metadata:{version:4.4,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),void 0!==this.parameters){var t=this.parameters;for(var i in t)void 0!==t[i]&&(e[i]=t[i]);return e}e.data={attributes:{}};var n=this.index;if(null!==n){var r=Array.prototype.slice.call(n.array);e.data.index={type:n.array.constructor.name,array:r}}var a=this.attributes;for(var i in a){var o=a[i];r=Array.prototype.slice.call(o.array);e.data.attributes[i]={itemSize:o.itemSize,type:o.array.constructor.name,array:r,normalized:o.normalized}}var s=this.groups;s.length>0&&(e.data.groups=JSON.parse(JSON.stringify(s)));var l=this.boundingSphere;return null!==l&&(e.data.boundingSphere={center:l.center.toArray(),radius:l.radius}),e},clone:function(){return(new q.BufferGeometry).copy(this)},copy:function(e){var t=e.index;null!==t&&this.setIndex(t.clone());var i=e.attributes;for(var n in i){var r=i[n];this.addAttribute(n,r.clone())}for(var a=e.groups,o=0,s=a.length;o<s;o++){var l=a[o];this.addGroup(l.start,l.count,l.materialIndex)}return this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),q.BufferGeometry.MaxIndex=65535,q.InstancedBufferGeometry=function(){q.BufferGeometry.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0},q.InstancedBufferGeometry.prototype=Object.create(q.BufferGeometry.prototype),q.InstancedBufferGeometry.prototype.constructor=q.InstancedBufferGeometry,q.InstancedBufferGeometry.prototype.addGroup=function(e,t,i){this.groups.push({start:e,count:t,instances:i})},q.InstancedBufferGeometry.prototype.copy=function(e){var t=e.index;null!==t&&this.setIndex(t.clone());var i=e.attributes;for(var n in i){var r=i[n];this.addAttribute(n,r.clone())}for(var a=e.groups,o=0,s=a.length;o<s;o++){var l=a[o];this.addGroup(l.start,l.count,l.instances)}return this},q.Uniform=function(e){"string"==typeof e&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=arguments[1]),this.value=e,this.dynamic=!1},q.Uniform.prototype={constructor:q.Uniform,onUpdate:function(e){return this.dynamic=!0,this.onUpdateCallback=e,this}},q.AnimationAction=function(){throw new Error("THREE.AnimationAction: Use mixer.clipAction for construction.")},q.AnimationAction._new=function(e,t,i){this._mixer=e,this._clip=t,this._localRoot=i||null;for(var n=t.tracks,r=n.length,a=new Array(r),o={endingStart:q.ZeroCurvatureEnding,endingEnd:q.ZeroCurvatureEnding},s=0;s!==r;++s){var l=n[s].createInterpolant(null);a[s]=l,l.settings=o}this._interpolantSettings=o,this._interpolants=a,this._propertyBindings=new Array(r),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=q.LoopRepeat,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0},q.AnimationAction._new.prototype={constructor:q.AnimationAction._new,play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){this._startTime;return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(e){return this._startTime=e,this},setLoop:function(e,t){return this.loop=e,this.repetitions=t,this},setEffectiveWeight:function(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(e){return this._scheduleFading(e,0,1)},fadeOut:function(e){return this._scheduleFading(e,1,0)},crossFadeFrom:function(e,t,i){this._mixer;if(e.fadeOut(t),this.fadeIn(t),i){var n=this._clip.duration,r=e._clip.duration,a=r/n,o=n/r;e.warp(1,a,t),this.warp(o,1,t)}return this},crossFadeTo:function(e,t,i){return e.crossFadeFrom(this,t,i)},stopFading:function(){var e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},setEffectiveTimeScale:function(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(e){return this.timeScale=this._clip.duration/e,this.stopWarping()},syncWith:function(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()},halt:function(e){return this.warp(this._effectiveTimeScale,0,e)},warp:function(e,t,i){var n=this._mixer,r=n.time,a=this._timeScaleInterpolant,o=this.timeScale;null===a&&(a=n._lendControlInterpolant(),this._timeScaleInterpolant=a);var s=a.parameterPositions,l=a.sampleValues;return s[0]=r,s[1]=r+i,l[0]=e/o,l[1]=t/o,this},stopWarping:function(){var e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(e,t,i,n){var r=this._startTime;if(null!==r){var a=(e-r)*i;if(a<0||0===i)return;this._startTime=null,t=i*a}t*=this._updateTimeScale(e);var o=this._updateTime(t),s=this._updateWeight(e);if(s>0)for(var l=this._interpolants,c=this._propertyBindings,u=0,h=l.length;u!==h;++u)l[u].evaluate(o),c[u].accumulate(n,s)},_updateWeight:function(e){var t=0;if(this.enabled){t=this.weight;var i=this._weightInterpolant;if(null!==i){var n=i.evaluate(e)[0];t*=n,e>i.parameterPositions[1]&&(this.stopFading(),0===n&&(this.enabled=!1))}}return this._effectiveWeight=t,t},_updateTimeScale:function(e){var t=0;if(!this.paused){t=this.timeScale;var i=this._timeScaleInterpolant;if(null!==i)t*=i.evaluate(e)[0],e>i.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t)}return this._effectiveTimeScale=t,t},_updateTime:function(e){var t=this.time+e;if(0===e)return t;var i=this._clip.duration,n=this.loop,r=this._loopCount;if(n===q.LoopOnce){-1===r&&(this.loopCount=0,this._setEndings(!0,!0,!1));e:{if(t>=i)t=i;else{if(!(t<0))break e;t=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{var a=n===q.LoopPingPong;if(-1===r&&(e>=0?(r=0,this._setEndings(!0,0===this.repetitions,a)):this._setEndings(0===this.repetitions,!0,a)),t>=i||t<0){var o=Math.floor(t/i);t-=i*o,r+=Math.abs(o);var s=this.repetitions-r;if(s<0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,t=e>0?i:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(0===s){var l=e<0;this._setEndings(l,!l,a)}else this._setEndings(!1,!1,a);this._loopCount=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:o})}}if(a&&1==(1&r))return this.time=t,i-t}return this.time=t,t},_setEndings:function(e,t,i){var n=this._interpolantSettings;i?(n.endingStart=q.ZeroSlopeEnding,n.endingEnd=q.ZeroSlopeEnding):(n.endingStart=e?this.zeroSlopeAtStart?q.ZeroSlopeEnding:q.ZeroCurvatureEnding:q.WrapAroundEnding,n.endingEnd=t?this.zeroSlopeAtEnd?q.ZeroSlopeEnding:q.ZeroCurvatureEnding:q.WrapAroundEnding)},_scheduleFading:function(e,t,i){var n=this._mixer,r=n.time,a=this._weightInterpolant;null===a&&(a=n._lendControlInterpolant(),this._weightInterpolant=a);var o=a.parameterPositions,s=a.sampleValues;return o[0]=r,s[0]=t,o[1]=r+e,s[1]=i,this}},q.AnimationClip=function(e,t,i){this.name=e,this.tracks=i,this.duration=void 0!==t?t:-1,this.uuid=q.Math.generateUUID(),this.duration<0&&this.resetDuration(),this.trim(),this.optimize()},q.AnimationClip.prototype={constructor:q.AnimationClip,resetDuration:function(){for(var e=0,t=0,i=this.tracks.length;t!==i;++t){var n=this.tracks[t];e=Math.max(e,n.times[n.times.length-1])}this.duration=e},trim:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this},optimize:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}},Object.assign(q.AnimationClip,{parse:function(e){for(var t=[],i=e.tracks,n=1/(e.fps||1),r=0,a=i.length;r!==a;++r)t.push(q.KeyframeTrack.parse(i[r]).scale(n));return new q.AnimationClip(e.name,e.duration,t)},toJSON:function(e){for(var t=[],i=e.tracks,n={name:e.name,duration:e.duration,tracks:t},r=0,a=i.length;r!==a;++r)t.push(q.KeyframeTrack.toJSON(i[r]));return n},CreateFromMorphTargetSequence:function(e,t,i,n){for(var r=t.length,a=[],o=0;o<r;o++){var s=[],l=[];s.push((o+r-1)%r,o,(o+1)%r),l.push(0,1,0);var c=q.AnimationUtils.getKeyframeOrder(s);s=q.AnimationUtils.sortedArray(s,1,c),l=q.AnimationUtils.sortedArray(l,1,c),n||0!==s[0]||(s.push(r),l.push(l[0])),a.push(new q.NumberKeyframeTrack(".morphTargetInfluences["+t[o].name+"]",s,l).scale(1/i))}return new q.AnimationClip(e,-1,a)},findByName:function(e,t){var i=e;if(!Array.isArray(e)){var n=e;i=n.geometry&&n.geometry.animations||n.animations}for(var r=0;r<i.length;r++)if(i[r].name===t)return i[r];return null},CreateClipsFromMorphTargetSequences:function(e,t,i){for(var n={},r=/^([\w-]*?)([\d]+)$/,a=0,o=e.length;a<o;a++){var s=e[a],l=s.name.match(r);if(l&&l.length>1){var c=n[h=l[1]];c||(n[h]=c=[]),c.push(s)}}var u=[];for(var h in n)u.push(q.AnimationClip.CreateFromMorphTargetSequence(h,n[h],t,i));return u},parseAnimation:function(e,t,i){if(!e)return console.error("  no animation in JSONLoader data"),null;for(var n=function(e,t,i,n,r){if(0!==i.length){var a=[],o=[];q.AnimationUtils.flattenJSON(i,a,o,n),0!==a.length&&r.push(new e(t,a,o))}},r=[],a=e.name||"default",o=e.length||-1,s=e.fps||30,l=e.hierarchy||[],c=0;c<l.length;c++){var u=l[c].keys;if(u&&0!==u.length)if(u[0].morphTargets){for(var h={},d=0;d<u.length;d++)if(u[d].morphTargets)for(var p=0;p<u[d].morphTargets.length;p++)h[u[d].morphTargets[p]]=-1;for(var f in h){var g=[],_=[];for(p=0;p!==u[d].morphTargets.length;++p){var m=u[d];g.push(m.time),_.push(m.morphTarget===f?1:0)}r.push(new q.NumberKeyframeTrack(".morphTargetInfluence["+f+"]",g,_))}o=h.length*(s||1)}else{var v=".bones["+t[c].name+"]";n(q.VectorKeyframeTrack,v+".position",u,"pos",r),n(q.QuaternionKeyframeTrack,v+".quaternion",u,"rot",r),n(q.VectorKeyframeTrack,v+".scale",u,"scl",r)}}return 0===r.length?null:new q.AnimationClip(a,o,r)}}),q.AnimationMixer=function(e){this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1},Object.assign(q.AnimationMixer.prototype,q.EventDispatcher.prototype,{clipAction:function(e,t){var i=t||this._root,n=i.uuid,r="string"==typeof e?q.AnimationClip.findByName(i,e):e,a=null!==r?r.uuid:e,o=this._actionsByClip[a],s=null;if(void 0!==o){var l=o.actionByRoot[n];if(void 0!==l)return l;s=o.knownActions[0],null===r&&(r=s._clip)}if(null===r)return null;var c=new q.AnimationMixer._Action(this,r,t);return this._bindAction(c,s),this._addInactiveAction(c,a,n),c},existingAction:function(e,t){var i=t||this._root,n=i.uuid,r="string"==typeof e?q.AnimationClip.findByName(i,e):e,a=r?r.uuid:e,o=this._actionsByClip[a];return void 0!==o&&o.actionByRoot[n]||null},stopAllAction:function(){var e=this._actions,t=this._nActiveActions,i=this._bindings,n=this._nActiveBindings;this._nActiveActions=0,this._nActiveBindings=0;for(var r=0;r!==t;++r)e[r].reset();for(r=0;r!==n;++r)i[r].useCount=0;return this},update:function(e){e*=this.timeScale;for(var t=this._actions,i=this._nActiveActions,n=this.time+=e,r=Math.sign(e),a=this._accuIndex^=1,o=0;o!==i;++o){var s=t[o];s.enabled&&s._update(n,e,r,a)}var l=this._bindings,c=this._nActiveBindings;for(o=0;o!==c;++o)l[o].apply(a);return this},getRoot:function(){return this._root},uncacheClip:function(e){var t=this._actions,i=e.uuid,n=this._actionsByClip,r=n[i];if(void 0!==r){for(var a=r.knownActions,o=0,s=a.length;o!==s;++o){var l=a[o];this._deactivateAction(l);var c=l._cacheIndex,u=t[t.length-1];l._cacheIndex=null,l._byClipCacheIndex=null,u._cacheIndex=c,t[c]=u,t.pop(),this._removeInactiveBindingsForAction(l)}delete n[i]}},uncacheRoot:function(e){var t=e.uuid,i=this._actionsByClip;for(var n in i){var r=i[n].actionByRoot[t];void 0!==r&&(this._deactivateAction(r),this._removeInactiveAction(r))}var a=this._bindingsByRootAndName[t];if(void 0!==a)for(var o in a){var s=a[o];s.restoreOriginalState(),this._removeInactiveBinding(s)}},uncacheAction:function(e,t){var i=this.existingAction(e,t);null!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}}),q.AnimationMixer._Action=q.AnimationAction._new,Object.assign(q.AnimationMixer.prototype,{_bindAction:function(e,t){var i=e._localRoot||this._root,n=e._clip.tracks,r=n.length,a=e._propertyBindings,o=e._interpolants,s=i.uuid,l=this._bindingsByRootAndName,c=l[s];void 0===c&&(c={},l[s]=c);for(var u=0;u!==r;++u){var h=n[u],d=h.name,p=c[d];if(void 0!==p)a[u]=p;else{if(void 0!==(p=a[u])){null===p._cacheIndex&&(++p.referenceCount,this._addInactiveBinding(p,s,d));continue}var f=t&&t._propertyBindings[u].binding.parsedPath;++(p=new q.PropertyMixer(q.PropertyBinding.create(i,d,f),h.ValueTypeName,h.getValueSize())).referenceCount,this._addInactiveBinding(p,s,d),a[u]=p}o[u].resultBuffer=p.buffer}},_activateAction:function(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){var t=(e._localRoot||this._root).uuid,i=e._clip.uuid,n=this._actionsByClip[i];this._bindAction(e,n&&n.knownActions[0]),this._addInactiveAction(e,i,t)}for(var r=e._propertyBindings,a=0,o=r.length;a!==o;++a){var s=r[a];0==s.useCount++&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}},_deactivateAction:function(e){if(this._isActiveAction(e)){for(var t=e._propertyBindings,i=0,n=t.length;i!==n;++i){var r=t[i];0==--r.useCount&&(r.restoreOriginalState(),this._takeBackBinding(r))}this._takeBackAction(e)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}},_isActiveAction:function(e){var t=e._cacheIndex;return null!==t&&t<this._nActiveActions},_addInactiveAction:function(e,t,i){var n=this._actions,r=this._actionsByClip,a=r[t];if(void 0===a)a={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,r[t]=a;else{var o=a.knownActions;e._byClipCacheIndex=o.length,o.push(e)}e._cacheIndex=n.length,n.push(e),a.actionByRoot[i]=e},_removeInactiveAction:function(e){var t=this._actions,i=t[t.length-1],n=e._cacheIndex;i._cacheIndex=n,t[n]=i,t.pop(),e._cacheIndex=null;var r=e._clip.uuid,a=this._actionsByClip,o=a[r],s=o.knownActions,l=s[s.length-1],c=e._byClipCacheIndex;l._byClipCacheIndex=c,s[c]=l,s.pop(),e._byClipCacheIndex=null,delete o.actionByRoot[(t._localRoot||this._root).uuid],0===s.length&&delete a[r],this._removeInactiveBindingsForAction(e)},_removeInactiveBindingsForAction:function(e){for(var t=e._propertyBindings,i=0,n=t.length;i!==n;++i){var r=t[i];0==--r.referenceCount&&this._removeInactiveBinding(r)}},_lendAction:function(e){var t=this._actions,i=e._cacheIndex,n=this._nActiveActions++,r=t[n];e._cacheIndex=n,t[n]=e,r._cacheIndex=i,t[i]=r},_takeBackAction:function(e){var t=this._actions,i=e._cacheIndex,n=--this._nActiveActions,r=t[n];e._cacheIndex=n,t[n]=e,r._cacheIndex=i,t[i]=r},_addInactiveBinding:function(e,t,i){var n=this._bindingsByRootAndName,r=n[t],a=this._bindings;void 0===r&&(r={},n[t]=r),r[i]=e,e._cacheIndex=a.length,a.push(e)},_removeInactiveBinding:function(e){var t=this._bindings,i=e.binding,n=i.rootNode.uuid,r=i.path,a=this._bindingsByRootAndName,o=a[n],s=t[t.length-1],l=e._cacheIndex;s._cacheIndex=l,t[l]=s,t.pop(),delete o[r];e:{for(var c in o)break e;delete a[n]}},_lendBinding:function(e){var t=this._bindings,i=e._cacheIndex,n=this._nActiveBindings++,r=t[n];e._cacheIndex=n,t[n]=e,r._cacheIndex=i,t[i]=r},_takeBackBinding:function(e){var t=this._bindings,i=e._cacheIndex,n=--this._nActiveBindings,r=t[n];e._cacheIndex=n,t[n]=e,r._cacheIndex=i,t[i]=r},_lendControlInterpolant:function(){var e=this._controlInterpolants,t=this._nActiveControlInterpolants++,i=e[t];return void 0===i&&((i=new q.LinearInterpolant(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=t,e[t]=i),i},_takeBackControlInterpolant:function(e){var t=this._controlInterpolants,i=e.__cacheIndex,n=--this._nActiveControlInterpolants,r=t[n];e.__cacheIndex=n,t[n]=e,r.__cacheIndex=i,t[i]=r},_controlInterpolantsResultBuffer:new Float32Array(1)}),q.AnimationObjectGroup=function(e){this.uuid=q.Math.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var t={};this._indicesByUUID=t;for(var i=0,n=arguments.length;i!==n;++i)t[arguments[i].uuid]=i;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var r=this;this.stats={objects:{get total(){return r._objects.length},get inUse(){return this.total-r.nCachedObjects_}},get bindingsPerObject(){return r._bindings.length}}},q.AnimationObjectGroup.prototype={constructor:q.AnimationObjectGroup,add:function(e){for(var t=this._objects,i=t.length,n=this.nCachedObjects_,r=this._indicesByUUID,a=this._paths,o=this._parsedPaths,s=this._bindings,l=s.length,c=0,u=arguments.length;c!==u;++c){var h=arguments[c],d=h.uuid,p=r[d];if(void 0===p){p=i++,r[d]=p,t.push(h);for(var f=0,g=l;f!==g;++f)s[f].push(new q.PropertyBinding(h,a[f],o[f]))}else if(p<n){var _=t[p],m=--n,v=t[m];r[v.uuid]=p,t[p]=v,r[d]=m,t[m]=h;for(f=0,g=l;f!==g;++f){var y=s[f],b=y[m],S=y[p];y[p]=b,void 0===S&&(S=new q.PropertyBinding(h,a[f],o[f])),y[m]=S}}else t[p]!==_&&console.error("Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes...")}this.nCachedObjects_=n},remove:function(e){for(var t=this._objects,i=(t.length,this.nCachedObjects_),n=this._indicesByUUID,r=this._bindings,a=r.length,o=0,s=arguments.length;o!==s;++o){var l=arguments[o],c=l.uuid,u=n[c];if(void 0!==u&&u>=i){var h=i++,d=t[h];n[d.uuid]=u,t[u]=d,n[c]=h,t[h]=l;for(var p=0,f=a;p!==f;++p){var g=r[p],_=g[h],m=g[u];g[u]=_,g[h]=m}}}this.nCachedObjects_=i},uncache:function(e){for(var t=this._objects,i=t.length,n=this.nCachedObjects_,r=this._indicesByUUID,a=this._bindings,o=a.length,s=0,l=arguments.length;s!==l;++s){var c=arguments[s],u=c.uuid,h=r[u];if(void 0!==h)if(delete r[u],h<n){var d=--n,p=t[d],f=t[y=--i];r[p.uuid]=h,t[h]=p,r[f.uuid]=d,t[d]=f,t.pop();for(var g=0,_=o;g!==_;++g){var m=(b=a[g])[d],v=b[y];b[h]=m,b[d]=v,b.pop()}}else{var y;r[(f=t[y=--i]).uuid]=h,t[h]=f,t.pop();for(g=0,_=o;g!==_;++g){var b;(b=a[g])[h]=b[y],b.pop()}}}this.nCachedObjects_=n},subscribe_:function(e,t){var i=this._bindingsIndicesByPath,n=i[e],r=this._bindings;if(void 0!==n)return r[n];var a=this._paths,o=this._parsedPaths,s=this._objects,l=s.length,c=this.nCachedObjects_,u=new Array(l);n=r.length,i[e]=n,a.push(e),o.push(t),r.push(u);for(var h=c,d=s.length;h!==d;++h){var p=s[h];u[h]=new q.PropertyBinding(p,e,t)}return u},unsubscribe_:function(e){var t=this._bindingsIndicesByPath,i=t[e];if(void 0!==i){var n=this._paths,r=this._parsedPaths,a=this._bindings,o=a.length-1,s=a[o];t[e[o]]=i,a[i]=s,a.pop(),r[i]=r[o],r.pop(),n[i]=n[o],n.pop()}}},q.AnimationUtils={arraySlice:function(e,t,i){return q.AnimationUtils.isTypedArray(e)?new e.constructor(e.subarray(t,i)):e.slice(t,i)},convertArray:function(e,t,i){return!e||!i&&e.constructor===t?e:"number"==typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e)},isTypedArray:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)},getKeyframeOrder:function(e){for(var t=e.length,i=new Array(t),n=0;n!==t;++n)i[n]=n;return i.sort((function(t,i){return e[t]-e[i]})),i},sortedArray:function(e,t,i){for(var n=e.length,r=new e.constructor(n),a=0,o=0;o!==n;++a)for(var s=i[a]*t,l=0;l!==t;++l)r[o++]=e[s+l];return r},flattenJSON:function(e,t,i,n){for(var r=1,a=e[0];void 0!==a&&void 0===a[n];)a=e[r++];if(void 0!==a){var o=a[n];if(void 0!==o)if(Array.isArray(o))do{void 0!==(o=a[n])&&(t.push(a.time),i.push.apply(i,o)),a=e[r++]}while(void 0!==a);else if(void 0!==o.toArray)do{void 0!==(o=a[n])&&(t.push(a.time),o.toArray(i,i.length)),a=e[r++]}while(void 0!==a);else do{void 0!==(o=a[n])&&(t.push(a.time),i.push(o)),a=e[r++]}while(void 0!==a)}}},q.KeyframeTrack=function(e,t,i,n){if(void 0===e)throw new Error("track name is undefined");if(void 0===t||0===t.length)throw new Error("no keyframes in track named "+e);this.name=e,this.times=q.AnimationUtils.convertArray(t,this.TimeBufferType),this.values=q.AnimationUtils.convertArray(i,this.ValueBufferType),this.setInterpolation(n||this.DefaultInterpolation),this.validate(),this.optimize()},q.KeyframeTrack.prototype={constructor:q.KeyframeTrack,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:q.InterpolateLinear,InterpolantFactoryMethodDiscrete:function(e){return new q.DiscreteInterpolant(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodLinear:function(e){return new q.LinearInterpolant(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:function(e){return new q.CubicInterpolant(this.times,this.values,this.getValueSize(),e)},setInterpolation:function(e){var t;switch(e){case q.InterpolateDiscrete:t=this.InterpolantFactoryMethodDiscrete;break;case q.InterpolateLinear:t=this.InterpolantFactoryMethodLinear;break;case q.InterpolateSmooth:t=this.InterpolantFactoryMethodSmooth}if(void 0!==t)this.createInterpolant=t;else{var i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(i);this.setInterpolation(this.DefaultInterpolation)}console.warn(i)}},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return q.InterpolateDiscrete;case this.InterpolantFactoryMethodLinear:return q.InterpolateLinear;case this.InterpolantFactoryMethodSmooth:return q.InterpolateSmooth}},getValueSize:function(){return this.values.length/this.times.length},shift:function(e){if(0!==e)for(var t=this.times,i=0,n=t.length;i!==n;++i)t[i]+=e;return this},scale:function(e){if(1!==e)for(var t=this.times,i=0,n=t.length;i!==n;++i)t[i]*=e;return this},trim:function(e,t){for(var i=this.times,n=i.length,r=0,a=n-1;r!==n&&i[r]<e;)++r;for(;-1!==a&&i[a]>t;)--a;if(++a,0!==r||a!==n){r>=a&&(r=(a=Math.max(a,1))-1);var o=this.getValueSize();this.times=q.AnimationUtils.arraySlice(i,r,a),this.values=q.AnimationUtils.arraySlice(this.values,r*o,a*o)}return this},validate:function(){var e=!0,t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("invalid value size in track",this),e=!1);var i=this.times,n=this.values,r=i.length;0===r&&(console.error("track is empty",this),e=!1);for(var a=null,o=0;o!==r;o++){var s=i[o];if("number"==typeof s&&isNaN(s)){console.error("time is not a valid number",this,o,s),e=!1;break}if(null!==a&&a>s){console.error("out of order keys",this,o,s,a),e=!1;break}a=s}if(void 0!==n&&q.AnimationUtils.isTypedArray(n)){o=0;for(var l=n.length;o!==l;++o){var c=n[o];if(isNaN(c)){console.error("value is not a valid number",this,o,c),e=!1;break}}}return e},optimize:function(){for(var e=this.times,t=this.values,i=this.getValueSize(),n=1,r=1,a=e.length-1;r<=a;++r){var o=!1,s=e[r];if(s!==e[r+1]&&(1!==r||s!==s[0]))for(var l=r*i,c=l-i,u=l+i,h=0;h!==i;++h){var d=t[l+h];if(d!==t[c+h]||d!==t[u+h]){o=!0;break}}if(o){if(r!==n){e[n]=e[r];var p=r*i,f=n*i;for(h=0;h!==i;++h)t[f+h]=t[p+h]}++n}}return n!==e.length&&(this.times=q.AnimationUtils.arraySlice(e,0,n),this.values=q.AnimationUtils.arraySlice(t,0,n*i)),this}},Object.assign(q.KeyframeTrack,{parse:function(e){if(void 0===e.type)throw new Error("track type undefined, can not parse");var t=q.KeyframeTrack._getTrackTypeForValueTypeName(e.type);if(void 0===e.times){var i=[],n=[];q.AnimationUtils.flattenJSON(e.keys,i,n,"value"),e.times=i,e.values=n}return void 0!==t.parse?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)},toJSON:function(e){var t,i=e.constructor;if(void 0!==i.toJSON)t=i.toJSON(e);else{t={name:e.name,times:q.AnimationUtils.convertArray(e.times,Array),values:q.AnimationUtils.convertArray(e.values,Array)};var n=e.getInterpolation();n!==e.DefaultInterpolation&&(t.interpolation=n)}return t.type=e.ValueTypeName,t},_getTrackTypeForValueTypeName:function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return q.NumberKeyframeTrack;case"vector":case"vector2":case"vector3":case"vector4":return q.VectorKeyframeTrack;case"color":return q.ColorKeyframeTrack;case"quaternion":return q.QuaternionKeyframeTrack;case"bool":case"boolean":return q.BooleanKeyframeTrack;case"string":return q.StringKeyframeTrack}throw new Error("Unsupported typeName: "+e)}}),q.PropertyBinding=function(e,t,i){this.path=t,this.parsedPath=i||q.PropertyBinding.parseTrackName(t),this.node=q.PropertyBinding.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e},q.PropertyBinding.prototype={constructor:q.PropertyBinding,getValue:function(e,t){this.bind(),this.getValue(e,t)},setValue:function(e,t){this.bind(),this.setValue(e,t)},bind:function(){var e=this.node,t=this.parsedPath,i=t.objectName,n=t.propertyName,r=t.propertyIndex;if(e||(e=q.PropertyBinding.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,e){if(i){var a=t.objectIndex;switch(i){case"materials":if(!e.material)return void console.error("  can not bind to material as node does not have a material",this);if(!e.material.materials)return void console.error("  can not bind to material.materials as node.material does not have a materials array",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("  can not bind to bones as node does not have a skeleton",this);e=e.skeleton.bones;for(var o=0;o<e.length;o++)if(e[o].name===a){a=o;break}break;default:if(void 0===e[i])return void console.error("  can not bind to objectName of node, undefined",this);e=e[i]}if(void 0!==a){if(void 0===e[a])return void console.error("  trying to bind to objectIndex of objectName, but is undefined:",this,e);e=e[a]}}var s=e[n];if(void 0!==s){var l=this.Versioning.None;void 0!==e.needsUpdate?(l=this.Versioning.NeedsUpdate,this.targetObject=e):void 0!==e.matrixWorldNeedsUpdate&&(l=this.Versioning.MatrixWorldNeedsUpdate,this.targetObject=e);var c=this.BindingType.Direct;if(void 0!==r){if("morphTargetInfluences"===n){if(!e.geometry)return void console.error("  can not bind to morphTargetInfluences becasuse node does not have a geometry",this);if(!e.geometry.morphTargets)return void console.error("  can not bind to morphTargetInfluences becasuse node does not have a geometry.morphTargets",this);for(o=0;o<this.node.geometry.morphTargets.length;o++)if(e.geometry.morphTargets[o].name===r){r=o;break}}c=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=r}else void 0!==s.fromArray&&void 0!==s.toArray?(c=this.BindingType.HasFromToArray,this.resolvedProperty=s):void 0!==s.length?(c=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=n;this.getValue=this.GetterByBindingType[c],this.setValue=this.SetterByBindingTypeAndVersioning[c][l]}else{var u=t.nodeName;console.error("  trying to update property for track: "+u+"."+n+" but it wasn't found.",e)}}else console.error("  trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}},Object.assign(q.PropertyBinding.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},_getValue_unbound:q.PropertyBinding.prototype.getValue,_setValue_unbound:q.PropertyBinding.prototype.setValue,BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(e,t){e[t]=this.node[this.propertyName]},function(e,t){for(var i=this.resolvedProperty,n=0,r=i.length;n!==r;++n)e[t++]=i[n]},function(e,t){e[t]=this.resolvedProperty[this.propertyIndex]},function(e,t){this.resolvedProperty.toArray(e,t)}],SetterByBindingTypeAndVersioning:[[function(e,t){this.node[this.propertyName]=e[t]},function(e,t){this.node[this.propertyName]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.node[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){for(var i=this.resolvedProperty,n=0,r=i.length;n!==r;++n)i[n]=e[t++]},function(e,t){for(var i=this.resolvedProperty,n=0,r=i.length;n!==r;++n)i[n]=e[t++];this.targetObject.needsUpdate=!0},function(e,t){for(var i=this.resolvedProperty,n=0,r=i.length;n!==r;++n)i[n]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty[this.propertyIndex]=e[t]},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty.fromArray(e,t)},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}]]}),q.PropertyBinding.Composite=function(e,t,i){var n=i||q.PropertyBinding.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,n)},q.PropertyBinding.Composite.prototype={constructor:q.PropertyBinding.Composite,getValue:function(e,t){this.bind();var i=this._targetGroup.nCachedObjects_,n=this._bindings[i];void 0!==n&&n.getValue(e,t)},setValue:function(e,t){for(var i=this._bindings,n=this._targetGroup.nCachedObjects_,r=i.length;n!==r;++n)i[n].setValue(e,t)},bind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].bind()},unbind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].unbind()}},q.PropertyBinding.create=function(e,t,i){return e instanceof q.AnimationObjectGroup?new q.PropertyBinding.Composite(e,t,i):new q.PropertyBinding(e,t,i)},q.PropertyBinding.parseTrackName=function(e){var t=/^(([\w]+\/)*)([\w-\d]+)?(\.([\w]+)(\[([\w\d\[\]\_.:\- ]+)\])?)?(\.([\w.]+)(\[([\w\d\[\]\_. ]+)\])?)$/,i=t.exec(e);if(!i)throw new Error("cannot parse trackName at all: "+e);i.index===t.lastIndex&&t.lastIndex++;var n={nodeName:i[3],objectName:i[5],objectIndex:i[7],propertyName:i[9],propertyIndex:i[11]};if(null===n.propertyName||0===n.propertyName.length)throw new Error("can not parse propertyName from trackName: "+e);return n},q.PropertyBinding.findNode=function(e,t){if(!t||""===t||"root"===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){var i=function(e){for(var i=0;i<e.bones.length;i++){var n=e.bones[i];if(n.name===t)return n}return null}(e.skeleton);if(i)return i}if(e.children){var n=function(e){for(var i=0;i<e.length;i++){var r=e[i];if(r.name===t||r.uuid===t)return r;var a=n(r.children);if(a)return a}return null},r=n(e.children);if(r)return r}return null},q.PropertyMixer=function(e,t,i){this.binding=e,this.valueSize=i;var n,r=Float64Array;switch(t){case"quaternion":n=this._slerp;break;case"string":case"bool":r=Array,n=this._select;break;default:n=this._lerp}this.buffer=new r(4*i),this._mixBufferRegion=n,this.cumulativeWeight=0,this.useCount=0,this.referenceCount=0},q.PropertyMixer.prototype={constructor:q.PropertyMixer,accumulate:function(e,t){var i=this.buffer,n=this.valueSize,r=e*n+n,a=this.cumulativeWeight;if(0===a){for(var o=0;o!==n;++o)i[r+o]=i[o];a=t}else{var s=t/(a+=t);this._mixBufferRegion(i,r,0,s,n)}this.cumulativeWeight=a},apply:function(e){var t=this.valueSize,i=this.buffer,n=e*t+t,r=this.cumulativeWeight,a=this.binding;if(this.cumulativeWeight=0,r<1){var o=3*t;this._mixBufferRegion(i,n,o,1-r,t)}for(var s=t,l=t+t;s!==l;++s)if(i[s]!==i[s+t]){a.setValue(i,n);break}},saveOriginalState:function(){var e=this.binding,t=this.buffer,i=this.valueSize,n=3*i;e.getValue(t,n);for(var r=i,a=n;r!==a;++r)t[r]=t[n+r%i];this.cumulativeWeight=0},restoreOriginalState:function(){var e=3*this.valueSize;this.binding.setValue(this.buffer,e)},_select:function(e,t,i,n,r){if(n>=.5)for(var a=0;a!==r;++a)e[t+a]=e[i+a]},_slerp:function(e,t,i,n,r){q.Quaternion.slerpFlat(e,t,e,t,e,i,n)},_lerp:function(e,t,i,n,r){for(var a=1-n,o=0;o!==r;++o){var s=t+o;e[s]=e[s]*a+e[i+o]*n}}},q.BooleanKeyframeTrack=function(e,t,i){q.KeyframeTrack.call(this,e,t,i)},q.BooleanKeyframeTrack.prototype=Object.assign(Object.create(q.KeyframeTrack.prototype),{constructor:q.BooleanKeyframeTrack,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:q.InterpolateDiscrete,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),q.ColorKeyframeTrack=function(e,t,i,n){q.KeyframeTrack.call(this,e,t,i,n)},q.ColorKeyframeTrack.prototype=Object.assign(Object.create(q.KeyframeTrack.prototype),{constructor:q.ColorKeyframeTrack,ValueTypeName:"color"}),q.NumberKeyframeTrack=function(e,t,i,n){q.KeyframeTrack.call(this,e,t,i,n)},q.NumberKeyframeTrack.prototype=Object.assign(Object.create(q.KeyframeTrack.prototype),{constructor:q.NumberKeyframeTrack,ValueTypeName:"number"}),q.QuaternionKeyframeTrack=function(e,t,i,n){q.KeyframeTrack.call(this,e,t,i,n)},q.QuaternionKeyframeTrack.prototype=Object.assign(Object.create(q.KeyframeTrack.prototype),{constructor:q.QuaternionKeyframeTrack,ValueTypeName:"quaternion",DefaultInterpolation:q.InterpolateLinear,InterpolantFactoryMethodLinear:function(e){return new q.QuaternionLinearInterpolant(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:void 0}),q.StringKeyframeTrack=function(e,t,i,n){q.KeyframeTrack.call(this,e,t,i,n)},q.StringKeyframeTrack.prototype=Object.assign(Object.create(q.KeyframeTrack.prototype),{constructor:q.StringKeyframeTrack,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:q.InterpolateDiscrete,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),q.VectorKeyframeTrack=function(e,t,i,n){q.KeyframeTrack.call(this,e,t,i,n)},q.VectorKeyframeTrack.prototype=Object.assign(Object.create(q.KeyframeTrack.prototype),{constructor:q.VectorKeyframeTrack,ValueTypeName:"vector"}),q.Audio=function(e){q.Object3D.call(this),this.type="Audio",this.context=e.context,this.source=this.context.createBufferSource(),this.source.onended=this.onEnded.bind(this),this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.startTime=0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this.filters=[]},q.Audio.prototype=Object.assign(Object.create(q.Object3D.prototype),{constructor:q.Audio,getOutput:function(){return this.gain},setNodeSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this},setBuffer:function(e){return this.source.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(){if(!0!==this.isPlaying){if(!1!==this.hasPlaybackControl){var e=this.context.createBufferSource();return e.buffer=this.source.buffer,e.loop=this.source.loop,e.onended=this.source.onended,e.start(0,this.startTime),e.playbackRate.value=this.playbackRate,this.isPlaying=!0,this.source=e,this.connect()}console.warn("THREE.Audio: this Audio has no playback control.")}else console.warn("THREE.Audio: Audio is already playing.")},pause:function(){if(!1!==this.hasPlaybackControl)return this.source.stop(),this.startTime=this.context.currentTime,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")},stop:function(){if(!1!==this.hasPlaybackControl)return this.source.stop(),this.startTime=0,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")},connect:function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(e){return e||(e=[]),!0===this.isPlaying?(this.disconnect(),this.filters=e,this.connect()):this.filters=e,this},getFilter:function(){return this.getFilters()[0]},setFilter:function(e){return this.setFilters(e?[e]:[])},setPlaybackRate:function(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&(this.source.playbackRate.value=this.playbackRate),this;console.warn("THREE.Audio: this Audio has no playback control.")},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.source.loop},setLoop:function(e){!1!==this.hasPlaybackControl?this.source.loop=e:console.warn("THREE.Audio: this Audio has no playback control.")},getVolume:function(){return this.gain.gain.value},setVolume:function(e){return this.gain.gain.value=e,this}}),q.AudioAnalyser=function(e,t){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=void 0!==t?t:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)},Object.assign(q.AudioAnalyser.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var e=0,t=this.getFrequencyData(),i=0;i<t.length;i++)e+=t[i];return e/t.length}}),Object.defineProperty(q,"AudioContext",{get:function(){return void 0===D&&(D=new(window.AudioContext||window.webkitAudioContext)),D}}),q.PositionalAudio=function(e){q.Audio.call(this,e),this.panner=this.context.createPanner(),this.panner.connect(this.gain)},q.PositionalAudio.prototype=Object.assign(Object.create(q.Audio.prototype),{constructor:q.PositionalAudio,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(e){this.panner.refDistance=e},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(e){this.panner.rolloffFactor=e},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(e){this.panner.distanceModel=e},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(e){this.panner.maxDistance=e},updateMatrixWorld:function(){var e=new q.Vector3;return function(t){q.Object3D.prototype.updateMatrixWorld.call(this,t),e.setFromMatrixPosition(this.matrixWorld),this.panner.setPosition(e.x,e.y,e.z)}}()}),q.AudioListener=function(){q.Object3D.call(this),this.type="AudioListener",this.context=q.AudioContext,this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null},q.AudioListener.prototype=Object.assign(Object.create(q.Object3D.prototype),{constructor:q.AudioListener,getInput:function(){return this.gain},removeFilter:function(){null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null)},getFilter:function(){return this.filter},setFilter:function(e){null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination)},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(e){this.gain.gain.value=e},updateMatrixWorld:function(){var e=new q.Vector3,t=new q.Quaternion,i=new q.Vector3,n=new q.Vector3;return function(r){q.Object3D.prototype.updateMatrixWorld.call(this,r);var a=this.context.listener,o=this.up;this.matrixWorld.decompose(e,t,i),n.set(0,0,-1).applyQuaternion(t),a.setPosition(e.x,e.y,e.z),a.setOrientation(n.x,n.y,n.z,o.x,o.y,o.z)}}()}),q.Camera=function(){q.Object3D.call(this),this.type="Camera",this.matrixWorldInverse=new q.Matrix4,this.projectionMatrix=new q.Matrix4},q.Camera.prototype=Object.create(q.Object3D.prototype),q.Camera.prototype.constructor=q.Camera,q.Camera.prototype.getWorldDirection=function(){var e=new q.Quaternion;return function(t){var i=t||new q.Vector3;return this.getWorldQuaternion(e),i.set(0,0,-1).applyQuaternion(e)}}(),q.Camera.prototype.lookAt=function(){var e=new q.Matrix4;return function(t){e.lookAt(this.position,t,this.up),this.quaternion.setFromRotationMatrix(e)}}(),q.Camera.prototype.clone=function(){return(new this.constructor).copy(this)},q.Camera.prototype.copy=function(e){return q.Object3D.prototype.copy.call(this,e),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this},q.CubeCamera=function(e,t,i){q.Object3D.call(this),this.type="CubeCamera";var n=new q.PerspectiveCamera(90,1,e,t);n.up.set(0,-1,0),n.lookAt(new q.Vector3(1,0,0)),this.add(n);var r=new q.PerspectiveCamera(90,1,e,t);r.up.set(0,-1,0),r.lookAt(new q.Vector3(-1,0,0)),this.add(r);var a=new q.PerspectiveCamera(90,1,e,t);a.up.set(0,0,1),a.lookAt(new q.Vector3(0,1,0)),this.add(a);var o=new q.PerspectiveCamera(90,1,e,t);o.up.set(0,0,-1),o.lookAt(new q.Vector3(0,-1,0)),this.add(o);var s=new q.PerspectiveCamera(90,1,e,t);s.up.set(0,-1,0),s.lookAt(new q.Vector3(0,0,1)),this.add(s);var l=new q.PerspectiveCamera(90,1,e,t);l.up.set(0,-1,0),l.lookAt(new q.Vector3(0,0,-1)),this.add(l);var c={format:q.RGBFormat,magFilter:q.LinearFilter,minFilter:q.LinearFilter};this.renderTarget=new q.WebGLRenderTargetCube(i,i,c),this.updateCubeMap=function(e,t){null===this.parent&&this.updateMatrixWorld();var i=this.renderTarget,c=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,i.activeCubeFace=0,e.render(t,n,i),i.activeCubeFace=1,e.render(t,r,i),i.activeCubeFace=2,e.render(t,a,i),i.activeCubeFace=3,e.render(t,o,i),i.activeCubeFace=4,e.render(t,s,i),i.texture.generateMipmaps=c,i.activeCubeFace=5,e.render(t,l,i),e.setRenderTarget(null)}},q.CubeCamera.prototype=Object.create(q.Object3D.prototype),q.CubeCamera.prototype.constructor=q.CubeCamera,q.OrthographicCamera=function(e,t,i,n,r,a){q.Camera.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=n,this.near=void 0!==r?r:.1,this.far=void 0!==a?a:2e3,this.updateProjectionMatrix()},q.OrthographicCamera.prototype=Object.assign(Object.create(q.Camera.prototype),{constructor:q.OrthographicCamera,copy:function(e){return q.Camera.prototype.copy.call(this,e),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this},setViewOffset:function(e,t,i,n,r,a){this.view={fullWidth:e,fullHeight:t,offsetX:i,offsetY:n,width:r,height:a},this.updateProjectionMatrix()},clearViewOffset:function(){this.view=null,this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,n=(this.top+this.bottom)/2,r=i-e,a=i+e,o=n+t,s=n-t;if(null!==this.view){var l=this.zoom/(this.view.width/this.view.fullWidth),c=this.zoom/(this.view.height/this.view.fullHeight),u=(this.right-this.left)/this.view.width,h=(this.top-this.bottom)/this.view.height;a=(r+=u*(this.view.offsetX/l))+u*(this.view.width/l),s=(o-=h*(this.view.offsetY/c))-h*(this.view.height/c)}this.projectionMatrix.makeOrthographic(r,a,o,s,this.near,this.far)},toJSON:function(e){var t=q.Object3D.prototype.toJSON.call(this,e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}),q.PerspectiveCamera=function(e,t,i,n){q.Camera.call(this),this.type="PerspectiveCamera",this.fov=void 0!==e?e:50,this.zoom=1,this.near=void 0!==i?i:.1,this.far=void 0!==n?n:2e3,this.focus=10,this.aspect=void 0!==t?t:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()},q.PerspectiveCamera.prototype=Object.assign(Object.create(q.Camera.prototype),{constructor:q.PerspectiveCamera,copy:function(e){return q.Camera.prototype.copy.call(this,e),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this},setFocalLength:function(e){var t=.5*this.getFilmHeight()/e;this.fov=2*q.Math.RAD2DEG*Math.atan(t),this.updateProjectionMatrix()},getFocalLength:function(){var e=Math.tan(.5*q.Math.DEG2RAD*this.fov);return.5*this.getFilmHeight()/e},getEffectiveFOV:function(){return 2*q.Math.RAD2DEG*Math.atan(Math.tan(.5*q.Math.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(e,t,i,n,r,a){this.aspect=e/t,this.view={fullWidth:e,fullHeight:t,offsetX:i,offsetY:n,width:r,height:a},this.updateProjectionMatrix()},clearViewOffset:function(){this.view=null,this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=this.near,t=e*Math.tan(.5*q.Math.DEG2RAD*this.fov)/this.zoom,i=2*t,n=this.aspect*i,r=-.5*n,a=this.view;if(null!==a){var o=a.fullWidth,s=a.fullHeight;r+=a.offsetX*n/o,t-=a.offsetY*i/s,n*=a.width/o,i*=a.height/s}var l=this.filmOffset;0!==l&&(r+=e*l/this.getFilmWidth()),this.projectionMatrix.makeFrustum(r,r+n,t-i,t,e,this.far)},toJSON:function(e){var t=q.Object3D.prototype.toJSON.call(this,e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}),q.StereoCamera=function(){this.type="StereoCamera",this.aspect=1,this.cameraL=new q.PerspectiveCamera,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new q.PerspectiveCamera,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1},Object.assign(q.StereoCamera.prototype,{update:(V=new q.Matrix4,B=new q.Matrix4,function(e){if(R!==e.focus||k!==e.fov||O!==e.aspect*this.aspect||N!==e.near||F!==e.far){R=e.focus,k=e.fov,O=e.aspect*this.aspect,N=e.near,F=e.far;var t,i,n=e.projectionMatrix.clone(),r=.032*N/R,a=N*Math.tan(q.Math.DEG2RAD*k*.5);B.elements[12]=-.032,V.elements[12]=.032,t=-a*O+r,i=a*O+r,n.elements[0]=2*N/(i-t),n.elements[8]=(i+t)/(i-t),this.cameraL.projectionMatrix.copy(n),t=-a*O-r,i=a*O-r,n.elements[0]=2*N/(i-t),n.elements[8]=(i+t)/(i-t),this.cameraR.projectionMatrix.copy(n)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(B),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(V)})}),q.Light=function(e,t){q.Object3D.call(this),this.type="Light",this.color=new q.Color(e),this.intensity=void 0!==t?t:1,this.receiveShadow=void 0},q.Light.prototype=Object.assign(Object.create(q.Object3D.prototype),{constructor:q.Light,copy:function(e){return q.Object3D.prototype.copy.call(this,e),this.color.copy(e.color),this.intensity=e.intensity,this},toJSON:function(e){var t=q.Object3D.prototype.toJSON.call(this,e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),t}}),q.LightShadow=function(e){this.camera=e,this.bias=0,this.radius=1,this.mapSize=new q.Vector2(512,512),this.map=null,this.matrix=new q.Matrix4},Object.assign(q.LightShadow.prototype,{copy:function(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this},clone:function(){return(new this.constructor).copy(this)}}),q.AmbientLight=function(e,t){q.Light.call(this,e,t),this.type="AmbientLight",this.castShadow=void 0},q.AmbientLight.prototype=Object.assign(Object.create(q.Light.prototype),{constructor:q.AmbientLight}),q.DirectionalLight=function(e,t){q.Light.call(this,e,t),this.type="DirectionalLight",this.position.set(0,1,0),this.updateMatrix(),this.target=new q.Object3D,this.shadow=new q.DirectionalLightShadow},q.DirectionalLight.prototype=Object.assign(Object.create(q.Light.prototype),{constructor:q.DirectionalLight,copy:function(e){return q.Light.prototype.copy.call(this,e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),q.DirectionalLightShadow=function(e){q.LightShadow.call(this,new q.OrthographicCamera(-5,5,5,-5,.5,500))},q.DirectionalLightShadow.prototype=Object.assign(Object.create(q.LightShadow.prototype),{constructor:q.DirectionalLightShadow}),q.HemisphereLight=function(e,t,i){q.Light.call(this,e,i),this.type="HemisphereLight",this.castShadow=void 0,this.position.set(0,1,0),this.updateMatrix(),this.groundColor=new q.Color(t)},q.HemisphereLight.prototype=Object.assign(Object.create(q.Light.prototype),{constructor:q.HemisphereLight,copy:function(e){return q.Light.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}),q.PointLight=function(e,t,i,n){q.Light.call(this,e,t),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(e){this.intensity=e/(4*Math.PI)}}),this.distance=void 0!==i?i:0,this.decay=void 0!==n?n:1,this.shadow=new q.LightShadow(new q.PerspectiveCamera(90,1,.5,500))},q.PointLight.prototype=Object.assign(Object.create(q.Light.prototype),{constructor:q.PointLight,copy:function(e){return q.Light.prototype.copy.call(this,e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}),q.SpotLight=function(e,t,i,n,r,a){q.Light.call(this,e,t),this.type="SpotLight",this.position.set(0,1,0),this.updateMatrix(),this.target=new q.Object3D,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(e){this.intensity=e/Math.PI}}),this.distance=void 0!==i?i:0,this.angle=void 0!==n?n:Math.PI/3,this.penumbra=void 0!==r?r:0,this.decay=void 0!==a?a:1,this.shadow=new q.SpotLightShadow},q.SpotLight.prototype=Object.assign(Object.create(q.Light.prototype),{constructor:q.SpotLight,copy:function(e){return q.Light.prototype.copy.call(this,e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),q.SpotLightShadow=function(){q.LightShadow.call(this,new q.PerspectiveCamera(50,1,.5,500))},q.SpotLightShadow.prototype=Object.assign(Object.create(q.LightShadow.prototype),{constructor:q.SpotLightShadow,update:function(e){var t=2*q.Math.RAD2DEG*e.angle,i=this.mapSize.width/this.mapSize.height,n=e.distance||500,r=this.camera;t===r.fov&&i===r.aspect&&n===r.far||(r.fov=t,r.aspect=i,r.far=n,r.updateProjectionMatrix())}}),q.AudioLoader=function(e){this.manager=void 0!==e?e:q.DefaultLoadingManager},Object.assign(q.AudioLoader.prototype,{load:function(e,t,i,n){var r=new q.XHRLoader(this.manager);r.setResponseType("arraybuffer"),r.load(e,(function(e){q.AudioContext.decodeAudioData(e,(function(e){t(e)}))}),i,n)}}),q.Cache={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}},q.Loader=function(){this.onLoadStart=function(){},this.onLoadProgress=function(){},this.onLoadComplete=function(){}},q.Loader.prototype={constructor:q.Loader,crossOrigin:void 0,extractUrlBase:function(e){var t=e.split("/");return 1===t.length?"./":(t.pop(),t.join("/")+"/")},initMaterials:function(e,t,i){for(var n=[],r=0;r<e.length;++r)n[r]=this.createMaterial(e[r],t,i);return n},createMaterial:function(e,t,i){void 0===U&&(U=new q.Color),void 0===H&&(H=new q.TextureLoader),void 0===G&&(G=new q.MaterialLoader);var n={};function r(e,r,a,o,s){var l,c=t+e,u=q.Loader.Handlers.get(c);null!==u?l=u.load(c):(H.setCrossOrigin(i),l=H.load(c)),void 0!==r&&(l.repeat.fromArray(r),1!==r[0]&&(l.wrapS=q.RepeatWrapping),1!==r[1]&&(l.wrapT=q.RepeatWrapping)),void 0!==a&&l.offset.fromArray(a),void 0!==o&&("repeat"===o[0]&&(l.wrapS=q.RepeatWrapping),"mirror"===o[0]&&(l.wrapS=q.MirroredRepeatWrapping),"repeat"===o[1]&&(l.wrapT=q.RepeatWrapping),"mirror"===o[1]&&(l.wrapT=q.MirroredRepeatWrapping)),void 0!==s&&(l.anisotropy=s);var h=q.Math.generateUUID();return n[h]=l,h}var a={uuid:q.Math.generateUUID(),type:"MeshLambertMaterial"};for(var o in e){var s=e[o];switch(o){case"DbgColor":case"DbgIndex":case"opticalDensity":case"illumination":break;case"DbgName":a.name=s;break;case"blending":a.blending=q[s];break;case"colorAmbient":case"mapAmbient":console.warn("THREE.Loader.createMaterial:",o,"is no longer supported.");break;case"colorDiffuse":a.color=U.fromArray(s).getHex();break;case"colorSpecular":a.specular=U.fromArray(s).getHex();break;case"colorEmissive":a.emissive=U.fromArray(s).getHex();break;case"specularCoef":a.shininess=s;break;case"shading":"basic"===s.toLowerCase()&&(a.type="MeshBasicMaterial"),"phong"===s.toLowerCase()&&(a.type="MeshPhongMaterial"),"standard"===s.toLowerCase()&&(a.type="MeshStandardMaterial");break;case"mapDiffuse":a.map=r(s,e.mapDiffuseRepeat,e.mapDiffuseOffset,e.mapDiffuseWrap,e.mapDiffuseAnisotropy);break;case"mapDiffuseRepeat":case"mapDiffuseOffset":case"mapDiffuseWrap":case"mapDiffuseAnisotropy":break;case"mapEmissive":a.emissiveMap=r(s,e.mapEmissiveRepeat,e.mapEmissiveOffset,e.mapEmissiveWrap,e.mapEmissiveAnisotropy);break;case"mapEmissiveRepeat":case"mapEmissiveOffset":case"mapEmissiveWrap":case"mapEmissiveAnisotropy":break;case"mapLight":a.lightMap=r(s,e.mapLightRepeat,e.mapLightOffset,e.mapLightWrap,e.mapLightAnisotropy);break;case"mapLightRepeat":case"mapLightOffset":case"mapLightWrap":case"mapLightAnisotropy":break;case"mapAO":a.aoMap=r(s,e.mapAORepeat,e.mapAOOffset,e.mapAOWrap,e.mapAOAnisotropy);break;case"mapAORepeat":case"mapAOOffset":case"mapAOWrap":case"mapAOAnisotropy":break;case"mapBump":a.bumpMap=r(s,e.mapBumpRepeat,e.mapBumpOffset,e.mapBumpWrap,e.mapBumpAnisotropy);break;case"mapBumpScale":a.bumpScale=s;break;case"mapBumpRepeat":case"mapBumpOffset":case"mapBumpWrap":case"mapBumpAnisotropy":break;case"mapNormal":a.normalMap=r(s,e.mapNormalRepeat,e.mapNormalOffset,e.mapNormalWrap,e.mapNormalAnisotropy);break;case"mapNormalFactor":a.normalScale=[s,s];break;case"mapNormalRepeat":case"mapNormalOffset":case"mapNormalWrap":case"mapNormalAnisotropy":break;case"mapSpecular":a.specularMap=r(s,e.mapSpecularRepeat,e.mapSpecularOffset,e.mapSpecularWrap,e.mapSpecularAnisotropy);break;case"mapSpecularRepeat":case"mapSpecularOffset":case"mapSpecularWrap":case"mapSpecularAnisotropy":break;case"mapMetalness":a.metalnessMap=r(s,e.mapMetalnessRepeat,e.mapMetalnessOffset,e.mapMetalnessWrap,e.mapMetalnessAnisotropy);break;case"mapMetalnessRepeat":case"mapMetalnessOffset":case"mapMetalnessWrap":case"mapMetalnessAnisotropy":break;case"mapRoughness":a.roughnessMap=r(s,e.mapRoughnessRepeat,e.mapRoughnessOffset,e.mapRoughnessWrap,e.mapRoughnessAnisotropy);break;case"mapRoughnessRepeat":case"mapRoughnessOffset":case"mapRoughnessWrap":case"mapRoughnessAnisotropy":break;case"mapAlpha":a.alphaMap=r(s,e.mapAlphaRepeat,e.mapAlphaOffset,e.mapAlphaWrap,e.mapAlphaAnisotropy);break;case"mapAlphaRepeat":case"mapAlphaOffset":case"mapAlphaWrap":case"mapAlphaAnisotropy":break;case"flipSided":a.side=q.BackSide;break;case"doubleSided":a.side=q.DoubleSide;break;case"transparency":console.warn("THREE.Loader.createMaterial: transparency has been renamed to opacity"),a.opacity=s;break;case"depthTest":case"depthWrite":case"colorWrite":case"opacity":case"reflectivity":case"transparent":case"visible":case"wireframe":a[o]=s;break;case"vertexColors":!0===s&&(a.vertexColors=q.VertexColors),"face"===s&&(a.vertexColors=q.FaceColors);break;default:console.error("THREE.Loader.createMaterial: Unsupported",o,s)}}return"MeshBasicMaterial"===a.type&&delete a.emissive,"MeshPhongMaterial"!==a.type&&delete a.specular,a.opacity<1&&(a.transparent=!0),G.setTextures(n),G.parse(a)}},q.Loader.Handlers={handlers:[],add:function(e,t){this.handlers.push(e,t)},get:function(e){for(var t=this.handlers,i=0,n=t.length;i<n;i+=2){var r=t[i],a=t[i+1];if(r.test(e))return a}return null}},q.XHRLoader=function(e){this.manager=void 0!==e?e:q.DefaultLoadingManager},Object.assign(q.XHRLoader.prototype,{load:function(e,t,i,n){void 0!==this.path&&(e=this.path+e);var r=this,a=q.Cache.get(e);if(void 0!==a)return t&&setTimeout((function(){t(a)}),0),a;var o=new XMLHttpRequest;return o.overrideMimeType("text/plain"),o.open("GET",e,!0),o.addEventListener("load",(function(i){var a=i.target.response;q.Cache.add(e,a),200===this.status?(t&&t(a),r.manager.itemEnd(e)):0===this.status?(console.warn("THREE.XHRLoader: HTTP Status 0 received."),t&&t(a),r.manager.itemEnd(e)):(n&&n(i),r.manager.itemError(e))}),!1),void 0!==i&&o.addEventListener("progress",(function(e){i(e)}),!1),o.addEventListener("error",(function(t){n&&n(t),r.manager.itemError(e)}),!1),void 0!==this.responseType&&(o.responseType=this.responseType),void 0!==this.withCredentials&&(o.withCredentials=this.withCredentials),o.send(null),r.manager.itemStart(e),o},setPath:function(e){return this.path=e,this},setResponseType:function(e){return this.responseType=e,this},setWithCredentials:function(e){return this.withCredentials=e,this}}),q.FontLoader=function(e){this.manager=void 0!==e?e:q.DefaultLoadingManager},Object.assign(q.FontLoader.prototype,{load:function(e,t,i,n){var r=this;new q.XHRLoader(this.manager).load(e,(function(e){var i;try{i=JSON.parse(e)}catch(t){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),i=JSON.parse(e.substring(65,e.length-2))}var n=r.parse(i);t&&t(n)}),i,n)},parse:function(e){return new q.Font(e)}}),q.ImageLoader=function(e){this.manager=void 0!==e?e:q.DefaultLoadingManager},Object.assign(q.ImageLoader.prototype,{load:function(e,t,i,n){var r=document.createElementNS("http://www.w3.org/1999/xhtml","img");if(r.onload=function(){URL.revokeObjectURL(r.src),t&&t(r)},0===e.indexOf("data:"))r.src=e;else{var a=new q.XHRLoader(this.manager);a.setPath(this.path),a.setResponseType("blob"),a.load(e,(function(e){r.src=URL.createObjectURL(e)}),i,n)}return r},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}}),q.JSONLoader=function(e){"boolean"==typeof e&&(console.warn("THREE.JSONLoader: showStatus parameter has been removed from constructor."),e=void 0),this.manager=void 0!==e?e:q.DefaultLoadingManager,this.withCredentials=!1},Object.assign(q.JSONLoader.prototype,{load:function(e,t,i,n){var r=this,a=this.texturePath&&"string"==typeof this.texturePath?this.texturePath:q.Loader.prototype.extractUrlBase(e),o=new q.XHRLoader(this.manager);o.setWithCredentials(this.withCredentials),o.load(e,(function(i){var n=JSON.parse(i),o=n.metadata;if(void 0!==o){var s=o.type;if(void 0!==s){if("object"===s.toLowerCase())return void console.error("THREE.JSONLoader: "+e+" should be loaded with THREE.ObjectLoader instead.");if("scene"===s.toLowerCase())return void console.error("THREE.JSONLoader: "+e+" should be loaded with THREE.SceneLoader instead.")}}var l=r.parse(n,a);t(l.geometry,l.materials)}),i,n)},setTexturePath:function(e){this.texturePath=e},parse:function(e,t){var i=new q.Geometry,n=void 0!==e.scale?1/e.scale:1;if(function(t){function n(e,t){return e&1<<t}var r,a,o,s,l,c,u,h,d,p,f,g,_,m,v,y,b,S,E,w,T,M,A,C,x,I,P,L=e.faces,D=e.vertices,R=e.normals,k=e.colors,O=0;if(void 0!==e.uvs){for(r=0;r<e.uvs.length;r++)e.uvs[r].length&&O++;for(r=0;r<O;r++)i.faceVertexUvs[r]=[]}s=0,l=D.length;for(;s<l;)(S=new q.Vector3).x=D[s++]*t,S.y=D[s++]*t,S.z=D[s++]*t,i.vertices.push(S);s=0,l=L.length;for(;s<l;)if(p=L[s++],f=n(p,0),g=n(p,1),_=n(p,3),m=n(p,4),v=n(p,5),y=n(p,6),b=n(p,7),f){if((w=new q.Face3).a=L[s],w.b=L[s+1],w.c=L[s+3],(T=new q.Face3).a=L[s+1],T.b=L[s+2],T.c=L[s+3],s+=4,g&&(d=L[s++],w.materialIndex=d,T.materialIndex=d),o=i.faces.length,_)for(r=0;r<O;r++)for(C=e.uvs[r],i.faceVertexUvs[r][o]=[],i.faceVertexUvs[r][o+1]=[],a=0;a<4;a++)h=L[s++],I=C[2*h],P=C[2*h+1],x=new q.Vector2(I,P),2!==a&&i.faceVertexUvs[r][o].push(x),0!==a&&i.faceVertexUvs[r][o+1].push(x);if(m&&(u=3*L[s++],w.normal.set(R[u++],R[u++],R[u]),T.normal.copy(w.normal)),v)for(r=0;r<4;r++)u=3*L[s++],A=new q.Vector3(R[u++],R[u++],R[u]),2!==r&&w.vertexNormals.push(A),0!==r&&T.vertexNormals.push(A);if(y&&(c=L[s++],M=k[c],w.color.setHex(M),T.color.setHex(M)),b)for(r=0;r<4;r++)c=L[s++],M=k[c],2!==r&&w.vertexColors.push(new q.Color(M)),0!==r&&T.vertexColors.push(new q.Color(M));i.faces.push(w),i.faces.push(T)}else{if((E=new q.Face3).a=L[s++],E.b=L[s++],E.c=L[s++],g&&(d=L[s++],E.materialIndex=d),o=i.faces.length,_)for(r=0;r<O;r++)for(C=e.uvs[r],i.faceVertexUvs[r][o]=[],a=0;a<3;a++)h=L[s++],I=C[2*h],P=C[2*h+1],x=new q.Vector2(I,P),i.faceVertexUvs[r][o].push(x);if(m&&(u=3*L[s++],E.normal.set(R[u++],R[u++],R[u])),v)for(r=0;r<3;r++)u=3*L[s++],A=new q.Vector3(R[u++],R[u++],R[u]),E.vertexNormals.push(A);if(y&&(c=L[s++],E.color.setHex(k[c])),b)for(r=0;r<3;r++)c=L[s++],E.vertexColors.push(new q.Color(k[c]));i.faces.push(E)}}(n),function(){var t=void 0!==e.influencesPerVertex?e.influencesPerVertex:2;if(e.skinWeights)for(var n=0,r=e.skinWeights.length;n<r;n+=t){var a=e.skinWeights[n],o=t>1?e.skinWeights[n+1]:0,s=t>2?e.skinWeights[n+2]:0,l=t>3?e.skinWeights[n+3]:0;i.skinWeights.push(new q.Vector4(a,o,s,l))}if(e.skinIndices)for(n=0,r=e.skinIndices.length;n<r;n+=t){var c=e.skinIndices[n],u=t>1?e.skinIndices[n+1]:0,h=t>2?e.skinIndices[n+2]:0,d=t>3?e.skinIndices[n+3]:0;i.skinIndices.push(new q.Vector4(c,u,h,d))}i.bones=e.bones,i.bones&&i.bones.length>0&&(i.skinWeights.length!==i.skinIndices.length||i.skinIndices.length!==i.vertices.length)&&console.warn("When skinning, number of vertices ("+i.vertices.length+"), skinIndices ("+i.skinIndices.length+"), and skinWeights ("+i.skinWeights.length+") should match.")}(),function(t){if(void 0!==e.morphTargets)for(var n=0,r=e.morphTargets.length;n<r;n++){i.morphTargets[n]={},i.morphTargets[n].name=e.morphTargets[n].name,i.morphTargets[n].vertices=[];for(var a=i.morphTargets[n].vertices,o=e.morphTargets[n].vertices,s=0,l=o.length;s<l;s+=3){var c=new q.Vector3;c.x=o[s]*t,c.y=o[s+1]*t,c.z=o[s+2]*t,a.push(c)}}if(void 0!==e.morphColors&&e.morphColors.length>0){console.warn('THREE.JSONLoader: "morphColors" no longer supported. Using them as face colors.');var u=i.faces,h=e.morphColors[0].colors;for(n=0,r=u.length;n<r;n++)u[n].color.fromArray(h,3*n)}}(n),function(){var t=[],n=[];void 0!==e.animation&&n.push(e.animation);void 0!==e.animations&&(e.animations.length?n=n.concat(e.animations):n.push(e.animations));for(var r=0;r<n.length;r++){var a=q.AnimationClip.parseAnimation(n[r],i.bones);a&&t.push(a)}if(i.morphTargets){var o=q.AnimationClip.CreateClipsFromMorphTargetSequences(i.morphTargets,10);t=t.concat(o)}t.length>0&&(i.animations=t)}(),i.computeFaceNormals(),i.computeBoundingSphere(),void 0===e.materials||0===e.materials.length)return{geometry:i};var r=q.Loader.prototype.initMaterials(e.materials,t,this.crossOrigin);return{geometry:i,materials:r}}}),q.LoadingManager=function(e,t,i){var n=this,r=!1,a=0,o=0;this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=i,this.itemStart=function(e){o++,!1===r&&void 0!==n.onStart&&n.onStart(e,a,o),r=!0},this.itemEnd=function(e){a++,void 0!==n.onProgress&&n.onProgress(e,a,o),a===o&&(r=!1,void 0!==n.onLoad&&n.onLoad())},this.itemError=function(e){void 0!==n.onError&&n.onError(e)}},q.DefaultLoadingManager=new q.LoadingManager,q.BufferGeometryLoader=function(e){this.manager=void 0!==e?e:q.DefaultLoadingManager},Object.assign(q.BufferGeometryLoader.prototype,{load:function(e,t,i,n){var r=this;new q.XHRLoader(r.manager).load(e,(function(e){t(r.parse(JSON.parse(e)))}),i,n)},parse:function(e){var t=new q.BufferGeometry,i=e.data.index,n={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:Uint8ClampedArray,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};if(void 0!==i){var r=new n[i.type](i.array);t.setIndex(new q.BufferAttribute(r,1))}var a=e.data.attributes;for(var o in a){var s=a[o];r=new n[s.type](s.array);t.addAttribute(o,new q.BufferAttribute(r,s.itemSize,s.normalized))}var l=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==l)for(var c=0,u=l.length;c!==u;++c){var h=l[c];t.addGroup(h.start,h.count,h.materialIndex)}var d=e.data.boundingSphere;if(void 0!==d){var p=new q.Vector3;void 0!==d.center&&p.fromArray(d.center),t.boundingSphere=new q.Sphere(p,d.radius)}return t}}),q.MaterialLoader=function(e){this.manager=void 0!==e?e:q.DefaultLoadingManager,this.textures={}},Object.assign(q.MaterialLoader.prototype,{load:function(e,t,i,n){var r=this;new q.XHRLoader(r.manager).load(e,(function(e){t(r.parse(JSON.parse(e)))}),i,n)},setTextures:function(e){this.textures=e},getTexture:function(e){var t=this.textures;return void 0===t[e]&&console.warn("THREE.MaterialLoader: Undefined texture",e),t[e]},parse:function(e){var t=new q[e.type];if(void 0!==e.uuid&&(t.uuid=e.uuid),void 0!==e.name&&(t.name=e.name),void 0!==e.color&&t.color.setHex(e.color),void 0!==e.roughness&&(t.roughness=e.roughness),void 0!==e.metalness&&(t.metalness=e.metalness),void 0!==e.emissive&&t.emissive.setHex(e.emissive),void 0!==e.specular&&t.specular.setHex(e.specular),void 0!==e.shininess&&(t.shininess=e.shininess),void 0!==e.uniforms&&(t.uniforms=e.uniforms),void 0!==e.vertexShader&&(t.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(t.fragmentShader=e.fragmentShader),void 0!==e.vertexColors&&(t.vertexColors=e.vertexColors),void 0!==e.shading&&(t.shading=e.shading),void 0!==e.blending&&(t.blending=e.blending),void 0!==e.side&&(t.side=e.side),void 0!==e.opacity&&(t.opacity=e.opacity),void 0!==e.transparent&&(t.transparent=e.transparent),void 0!==e.alphaTest&&(t.alphaTest=e.alphaTest),void 0!==e.depthTest&&(t.depthTest=e.depthTest),void 0!==e.depthWrite&&(t.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(t.colorWrite=e.colorWrite),void 0!==e.wireframe&&(t.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(t.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.size&&(t.size=e.size),void 0!==e.sizeAttenuation&&(t.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(t.map=this.getTexture(e.map)),void 0!==e.alphaMap&&(t.alphaMap=this.getTexture(e.alphaMap),t.transparent=!0),void 0!==e.bumpMap&&(t.bumpMap=this.getTexture(e.bumpMap)),void 0!==e.bumpScale&&(t.bumpScale=e.bumpScale),void 0!==e.normalMap&&(t.normalMap=this.getTexture(e.normalMap)),void 0!==e.normalScale){var i=e.normalScale;!1===Array.isArray(i)&&(i=[i,i]),t.normalScale=(new q.Vector2).fromArray(i)}if(void 0!==e.displacementMap&&(t.displacementMap=this.getTexture(e.displacementMap)),void 0!==e.displacementScale&&(t.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(t.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(t.roughnessMap=this.getTexture(e.roughnessMap)),void 0!==e.metalnessMap&&(t.metalnessMap=this.getTexture(e.metalnessMap)),void 0!==e.emissiveMap&&(t.emissiveMap=this.getTexture(e.emissiveMap)),void 0!==e.emissiveIntensity&&(t.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(t.specularMap=this.getTexture(e.specularMap)),void 0!==e.envMap&&(t.envMap=this.getTexture(e.envMap),t.combine=q.MultiplyOperation),void 0!==e.reflectivity&&(t.reflectivity=e.reflectivity),void 0!==e.lightMap&&(t.lightMap=this.getTexture(e.lightMap)),void 0!==e.lightMapIntensity&&(t.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(t.aoMap=this.getTexture(e.aoMap)),void 0!==e.aoMapIntensity&&(t.aoMapIntensity=e.aoMapIntensity),void 0!==e.materials)for(var n=0,r=e.materials.length;n<r;n++)t.materials.push(this.parse(e.materials[n]));return t}}),q.ObjectLoader=function(e){this.manager=void 0!==e?e:q.DefaultLoadingManager,this.texturePath=""},Object.assign(q.ObjectLoader.prototype,{load:function(e,t,i,n){""===this.texturePath&&(this.texturePath=e.substring(0,e.lastIndexOf("/")+1));var r=this;new q.XHRLoader(r.manager).load(e,(function(e){r.parse(JSON.parse(e),t)}),i,n)},setTexturePath:function(e){this.texturePath=e},setCrossOrigin:function(e){this.crossOrigin=e},parse:function(e,t){var i=this.parseGeometries(e.geometries),n=this.parseImages(e.images,(function(){void 0!==t&&t(o)})),r=this.parseTextures(e.textures,n),a=this.parseMaterials(e.materials,r),o=this.parseObject(e.object,i,a);return e.animations&&(o.animations=this.parseAnimations(e.animations)),void 0!==e.images&&0!==e.images.length||void 0!==t&&t(o),o},parseGeometries:function(e){var t={};if(void 0!==e)for(var i=new q.JSONLoader,n=new q.BufferGeometryLoader,r=0,a=e.length;r<a;r++){var o,s=e[r];switch(s.type){case"PlaneGeometry":case"PlaneBufferGeometry":o=new q[s.type](s.width,s.height,s.widthSegments,s.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":o=new q[s.type](s.width,s.height,s.depth,s.widthSegments,s.heightSegments,s.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":o=new q[s.type](s.radius,s.segments,s.thetaStart,s.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":o=new q[s.type](s.radiusTop,s.radiusBottom,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":o=new q[s.type](s.radius,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":o=new q[s.type](s.radius,s.widthSegments,s.heightSegments,s.phiStart,s.phiLength,s.thetaStart,s.thetaLength);break;case"DodecahedronGeometry":case"IcosahedronGeometry":case"OctahedronGeometry":case"TetrahedronGeometry":o=new q[s.type](s.radius,s.detail);break;case"RingGeometry":case"RingBufferGeometry":o=new q[s.type](s.innerRadius,s.outerRadius,s.thetaSegments,s.phiSegments,s.thetaStart,s.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":o=new q[s.type](s.radius,s.tube,s.radialSegments,s.tubularSegments,s.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":o=new q[s.type](s.radius,s.tube,s.tubularSegments,s.radialSegments,s.p,s.q);break;case"LatheGeometry":case"LatheBufferGeometry":o=new q[s.type](s.points,s.segments,s.phiStart,s.phiLength);break;case"BufferGeometry":o=n.parse(s);break;case"Geometry":o=i.parse(s.data,this.texturePath).geometry;break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+s.type+'"');continue}o.uuid=s.uuid,void 0!==s.name&&(o.name=s.name),t[s.uuid]=o}return t},parseMaterials:function(e,t){var i={};if(void 0!==e){var n=new q.MaterialLoader;n.setTextures(t);for(var r=0,a=e.length;r<a;r++){var o=n.parse(e[r]);i[o.uuid]=o}}return i},parseAnimations:function(e){for(var t=[],i=0;i<e.length;i++){var n=q.AnimationClip.parse(e[i]);t.push(n)}return t},parseImages:function(e,t){var i=this,n={};function r(e){return i.manager.itemStart(e),o.load(e,(function(){i.manager.itemEnd(e)}))}if(void 0!==e&&e.length>0){var a=new q.LoadingManager(t),o=new q.ImageLoader(a);o.setCrossOrigin(this.crossOrigin);for(var s=0,l=e.length;s<l;s++){var c=e[s],u=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c.url)?c.url:i.texturePath+c.url;n[c.uuid]=r(u)}}return n},parseTextures:function(e,t){function i(e){return"number"==typeof e?e:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",e),q[e])}var n={};if(void 0!==e)for(var r=0,a=e.length;r<a;r++){var o=e[r];void 0===o.image&&console.warn('THREE.ObjectLoader: No "image" specified for',o.uuid),void 0===t[o.image]&&console.warn("THREE.ObjectLoader: Undefined image",o.image);var s=new q.Texture(t[o.image]);s.needsUpdate=!0,s.uuid=o.uuid,void 0!==o.name&&(s.name=o.name),void 0!==o.mapping&&(s.mapping=i(o.mapping)),void 0!==o.offset&&(s.offset=new q.Vector2(o.offset[0],o.offset[1])),void 0!==o.repeat&&(s.repeat=new q.Vector2(o.repeat[0],o.repeat[1])),void 0!==o.minFilter&&(s.minFilter=i(o.minFilter)),void 0!==o.magFilter&&(s.magFilter=i(o.magFilter)),void 0!==o.anisotropy&&(s.anisotropy=o.anisotropy),Array.isArray(o.wrap)&&(s.wrapS=i(o.wrap[0]),s.wrapT=i(o.wrap[1])),n[o.uuid]=s}return n},parseObject:function(){var e=new q.Matrix4;return function(t,i,n){var r;function a(e){return void 0===i[e]&&console.warn("THREE.ObjectLoader: Undefined geometry",e),i[e]}function o(e){if(void 0!==e)return void 0===n[e]&&console.warn("THREE.ObjectLoader: Undefined material",e),n[e]}switch(t.type){case"Scene":r=new q.Scene;break;case"PerspectiveCamera":r=new q.PerspectiveCamera(t.fov,t.aspect,t.near,t.far),void 0!==t.focus&&(r.focus=t.focus),void 0!==t.zoom&&(r.zoom=t.zoom),void 0!==t.filmGauge&&(r.filmGauge=t.filmGauge),void 0!==t.filmOffset&&(r.filmOffset=t.filmOffset),void 0!==t.view&&(r.view=Object.assign({},t.view));break;case"OrthographicCamera":r=new q.OrthographicCamera(t.left,t.right,t.top,t.bottom,t.near,t.far);break;case"AmbientLight":r=new q.AmbientLight(t.color,t.intensity);break;case"DirectionalLight":r=new q.DirectionalLight(t.color,t.intensity);break;case"PointLight":r=new q.PointLight(t.color,t.intensity,t.distance,t.decay);break;case"SpotLight":r=new q.SpotLight(t.color,t.intensity,t.distance,t.angle,t.penumbra,t.decay);break;case"HemisphereLight":r=new q.HemisphereLight(t.color,t.groundColor,t.intensity);break;case"Mesh":var s=a(t.geometry),l=o(t.material);r=s.bones&&s.bones.length>0?new q.SkinnedMesh(s,l):new q.Mesh(s,l);break;case"LOD":r=new q.LOD;break;case"Line":r=new q.Line(a(t.geometry),o(t.material),t.mode);break;case"PointCloud":case"Points":r=new q.Points(a(t.geometry),o(t.material));break;case"Sprite":r=new q.Sprite(o(t.material));break;case"Group":r=new q.Group;break;default:r=new q.Object3D}if(r.uuid=t.uuid,void 0!==t.name&&(r.name=t.name),void 0!==t.matrix?(e.fromArray(t.matrix),e.decompose(r.position,r.quaternion,r.scale)):(void 0!==t.position&&r.position.fromArray(t.position),void 0!==t.rotation&&r.rotation.fromArray(t.rotation),void 0!==t.scale&&r.scale.fromArray(t.scale)),void 0!==t.castShadow&&(r.castShadow=t.castShadow),void 0!==t.receiveShadow&&(r.receiveShadow=t.receiveShadow),void 0!==t.visible&&(r.visible=t.visible),void 0!==t.userData&&(r.userData=t.userData),void 0!==t.children)for(var c in t.children)r.add(this.parseObject(t.children[c],i,n));if("LOD"===t.type)for(var u=t.levels,h=0;h<u.length;h++){var d=u[h];void 0!==(c=r.getObjectByProperty("uuid",d.object))&&r.addLevel(c,d.distance)}return r}}()}),q.TextureLoader=function(e){this.manager=void 0!==e?e:q.DefaultLoadingManager},Object.assign(q.TextureLoader.prototype,{load:function(e,t,i,n){var r=new q.Texture,a=new q.ImageLoader(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,(function(e){r.image=e,r.needsUpdate=!0,void 0!==t&&t(r)}),i,n),r},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}}),q.CubeTextureLoader=function(e){this.manager=void 0!==e?e:q.DefaultLoadingManager},Object.assign(q.CubeTextureLoader.prototype,{load:function(e,t,i,n){var r=new q.CubeTexture,a=new q.ImageLoader(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);var o=0;function s(i){a.load(e[i],(function(e){r.images[i]=e,6===++o&&(r.needsUpdate=!0,t&&t(r))}),void 0,n)}for(var l=0;l<e.length;++l)s(l);return r},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}}),q.DataTextureLoader=q.BinaryTextureLoader=function(e){this.manager=void 0!==e?e:q.DefaultLoadingManager,this._parser=null},Object.assign(q.BinaryTextureLoader.prototype,{load:function(e,t,i,n){var r=this,a=new q.DataTexture,o=new q.XHRLoader(this.manager);return o.setResponseType("arraybuffer"),o.load(e,(function(e){var i=r._parser(e);i&&(void 0!==i.image?a.image=i.image:void 0!==i.data&&(a.image.width=i.width,a.image.height=i.height,a.image.data=i.data),a.wrapS=void 0!==i.wrapS?i.wrapS:q.ClampToEdgeWrapping,a.wrapT=void 0!==i.wrapT?i.wrapT:q.ClampToEdgeWrapping,a.magFilter=void 0!==i.magFilter?i.magFilter:q.LinearFilter,a.minFilter=void 0!==i.minFilter?i.minFilter:q.LinearMipMapLinearFilter,a.anisotropy=void 0!==i.anisotropy?i.anisotropy:1,void 0!==i.format&&(a.format=i.format),void 0!==i.type&&(a.type=i.type),void 0!==i.mipmaps&&(a.mipmaps=i.mipmaps),1===i.mipmapCount&&(a.minFilter=q.LinearFilter),a.needsUpdate=!0,t&&t(a,i))}),i,n),a}}),q.CompressedTextureLoader=function(e){this.manager=void 0!==e?e:q.DefaultLoadingManager,this._parser=null},Object.assign(q.CompressedTextureLoader.prototype,{load:function(e,t,i,n){var r=this,a=[],o=new q.CompressedTexture;o.image=a;var s=new q.XHRLoader(this.manager);function l(l){s.load(e[l],(function(e){var i=r._parser(e,!0);a[l]={width:i.width,height:i.height,format:i.format,mipmaps:i.mipmaps},6===(c+=1)&&(1===i.mipmapCount&&(o.minFilter=q.LinearFilter),o.format=i.format,o.needsUpdate=!0,t&&t(o))}),i,n)}if(s.setPath(this.path),s.setResponseType("arraybuffer"),Array.isArray(e))for(var c=0,u=0,h=e.length;u<h;++u)l(u);else s.load(e,(function(e){var i=r._parser(e,!0);if(i.isCubemap)for(var n=i.mipmaps.length/i.mipmapCount,s=0;s<n;s++){a[s]={mipmaps:[]};for(var l=0;l<i.mipmapCount;l++)a[s].mipmaps.push(i.mipmaps[s*i.mipmapCount+l]),a[s].format=i.format,a[s].width=i.width,a[s].height=i.height}else o.image.width=i.width,o.image.height=i.height,o.mipmaps=i.mipmaps;1===i.mipmapCount&&(o.minFilter=q.LinearFilter),o.format=i.format,o.needsUpdate=!0,t&&t(o)}),i,n);return o},setPath:function(e){return this.path=e,this}}),q.Material=function(){Object.defineProperty(this,"id",{value:q.MaterialIdCount++}),this.uuid=q.Math.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.lights=!0,this.blending=q.NormalBlending,this.side=q.FrontSide,this.shading=q.SmoothShading,this.vertexColors=q.NoColors,this.opacity=1,this.transparent=!1,this.blendSrc=q.SrcAlphaFactor,this.blendDst=q.OneMinusSrcAlphaFactor,this.blendEquation=q.AddEquation,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=q.LessEqualDepth,this.depthTest=!0,this.depthWrite=!0,this.clippingPlanes=null,this.clipShadows=!1,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.alphaTest=0,this.premultipliedAlpha=!1,this.overdraw=0,this.visible=!0,this._needsUpdate=!0},q.Material.prototype={constructor:q.Material,get needsUpdate(){return this._needsUpdate},set needsUpdate(e){!0===e&&this.update(),this._needsUpdate=e},setValues:function(e){if(void 0!==e)for(var t in e){var i=e[t];if(void 0!==i){var n=this[t];void 0!==n?n instanceof q.Color?n.set(i):n instanceof q.Vector3&&i instanceof q.Vector3?n.copy(i):this[t]="overdraw"===t?Number(i):i:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.")}else console.warn("THREE.Material: '"+t+"' parameter is undefined.")}},toJSON:function(e){var t=void 0===e;t&&(e={textures:{},images:{}});var i={metadata:{version:4.4,type:"Material",generator:"Material.toJSON"}};function n(e){var t=[];for(var i in e){var n=e[i];delete n.metadata,t.push(n)}return t}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),this.color instanceof q.Color&&(i.color=this.color.getHex()),void 0!==this.roughness&&(i.roughness=this.roughness),void 0!==this.metalness&&(i.metalness=this.metalness),this.emissive instanceof q.Color&&(i.emissive=this.emissive.getHex()),this.specular instanceof q.Color&&(i.specular=this.specular.getHex()),void 0!==this.shininess&&(i.shininess=this.shininess),this.map instanceof q.Texture&&(i.map=this.map.toJSON(e).uuid),this.alphaMap instanceof q.Texture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap instanceof q.Texture&&(i.lightMap=this.lightMap.toJSON(e).uuid),this.bumpMap instanceof q.Texture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap instanceof q.Texture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalScale=this.normalScale.toArray()),this.displacementMap instanceof q.Texture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap instanceof q.Texture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap instanceof q.Texture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap instanceof q.Texture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap instanceof q.Texture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.envMap instanceof q.Texture&&(i.envMap=this.envMap.toJSON(e).uuid,i.reflectivity=this.reflectivity),void 0!==this.size&&(i.size=this.size),void 0!==this.sizeAttenuation&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==q.NormalBlending&&(i.blending=this.blending),this.shading!==q.SmoothShading&&(i.shading=this.shading),this.side!==q.FrontSide&&(i.side=this.side),this.vertexColors!==q.NoColors&&(i.vertexColors=this.vertexColors),this.opacity<1&&(i.opacity=this.opacity),!0===this.transparent&&(i.transparent=this.transparent),this.alphaTest>0&&(i.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(i.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(i.wireframe=this.wireframe),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),t){var r=n(e.textures),a=n(e.images);r.length>0&&(i.textures=r),a.length>0&&(i.images=a)}return i},clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.name=e.name,this.fog=e.fog,this.lights=e.lights,this.blending=e.blending,this.side=e.side,this.shading=e.shading,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.alphaTest=e.alphaTest,this.premultipliedAlpha=e.premultipliedAlpha,this.overdraw=e.overdraw,this.visible=e.visible,this.clipShadows=e.clipShadows;var t=e.clippingPlanes,i=null;if(null!==t){var n=t.length;i=new Array(n);for(var r=0;r!==n;++r)i[r]=t[r].clone()}return this.clippingPlanes=i,this},update:function(){this.dispatchEvent({type:"update"})},dispose:function(){this.dispatchEvent({type:"dispose"})}},Object.assign(q.Material.prototype,q.EventDispatcher.prototype),q.MaterialIdCount=0,q.LineBasicMaterial=function(e){q.Material.call(this),this.type="LineBasicMaterial",this.color=new q.Color(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.lights=!1,this.setValues(e)},q.LineBasicMaterial.prototype=Object.create(q.Material.prototype),q.LineBasicMaterial.prototype.constructor=q.LineBasicMaterial,q.LineBasicMaterial.prototype.copy=function(e){return q.Material.prototype.copy.call(this,e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this},q.LineDashedMaterial=function(e){q.Material.call(this),this.type="LineDashedMaterial",this.color=new q.Color(16777215),this.linewidth=1,this.scale=1,this.dashSize=3,this.gapSize=1,this.lights=!1,this.setValues(e)},q.LineDashedMaterial.prototype=Object.create(q.Material.prototype),q.LineDashedMaterial.prototype.constructor=q.LineDashedMaterial,q.LineDashedMaterial.prototype.copy=function(e){return q.Material.prototype.copy.call(this,e),this.color.copy(e.color),this.linewidth=e.linewidth,this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this},q.MeshBasicMaterial=function(e){q.Material.call(this),this.type="MeshBasicMaterial",this.color=new q.Color(16777215),this.map=null,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=q.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.lights=!1,this.setValues(e)},q.MeshBasicMaterial.prototype=Object.create(q.Material.prototype),q.MeshBasicMaterial.prototype.constructor=q.MeshBasicMaterial,q.MeshBasicMaterial.prototype.copy=function(e){return q.Material.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this},q.MeshDepthMaterial=function(e){q.Material.call(this),this.type="MeshDepthMaterial",this.depthPacking=q.BasicDepthPacking,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.setValues(e)},q.MeshDepthMaterial.prototype=Object.create(q.Material.prototype),q.MeshDepthMaterial.prototype.constructor=q.MeshDepthMaterial,q.MeshDepthMaterial.prototype.copy=function(e){return q.Material.prototype.copy.call(this,e),this.depthPacking=e.depthPacking,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this},q.MeshLambertMaterial=function(e){q.Material.call(this),this.type="MeshLambertMaterial",this.color=new q.Color(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new q.Color(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=q.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)},q.MeshLambertMaterial.prototype=Object.create(q.Material.prototype),q.MeshLambertMaterial.prototype.constructor=q.MeshLambertMaterial,q.MeshLambertMaterial.prototype.copy=function(e){return q.Material.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},q.MeshNormalMaterial=function(e){q.Material.call(this,e),this.type="MeshNormalMaterial",this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.morphTargets=!1,this.setValues(e)},q.MeshNormalMaterial.prototype=Object.create(q.Material.prototype),q.MeshNormalMaterial.prototype.constructor=q.MeshNormalMaterial,q.MeshNormalMaterial.prototype.copy=function(e){return q.Material.prototype.copy.call(this,e),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this},q.MeshPhongMaterial=function(e){q.Material.call(this),this.type="MeshPhongMaterial",this.color=new q.Color(16777215),this.specular=new q.Color(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new q.Color(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new q.Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=q.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)},q.MeshPhongMaterial.prototype=Object.create(q.Material.prototype),q.MeshPhongMaterial.prototype.constructor=q.MeshPhongMaterial,q.MeshPhongMaterial.prototype.copy=function(e){return q.Material.prototype.copy.call(this,e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},q.MeshStandardMaterial=function(e){q.Material.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new q.Color(16777215),this.roughness=.5,this.metalness=.5,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new q.Color(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new q.Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)},q.MeshStandardMaterial.prototype=Object.create(q.Material.prototype),q.MeshStandardMaterial.prototype.constructor=q.MeshStandardMaterial,q.MeshStandardMaterial.prototype.copy=function(e){return q.Material.prototype.copy.call(this,e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},q.MeshPhysicalMaterial=function(e){q.MeshStandardMaterial.call(this),this.defines={PHYSICAL:""},this.type="MeshPhysicalMaterial",this.reflectivity=.5,this.clearCoat=0,this.clearCoatRoughness=0,this.setValues(e)},q.MeshPhysicalMaterial.prototype=Object.create(q.MeshStandardMaterial.prototype),q.MeshPhysicalMaterial.prototype.constructor=q.MeshPhysicalMaterial,q.MeshPhysicalMaterial.prototype.copy=function(e){return q.MeshStandardMaterial.prototype.copy.call(this,e),this.defines={PHYSICAL:""},this.reflectivity=e.reflectivity,this.clearCoat=e.clearCoat,this.clearCoatRoughness=e.clearCoatRoughness,this},q.MultiMaterial=function(e){this.uuid=q.Math.generateUUID(),this.type="MultiMaterial",this.materials=e instanceof Array?e:[],this.visible=!0},q.MultiMaterial.prototype={constructor:q.MultiMaterial,toJSON:function(e){for(var t={metadata:{version:4.2,type:"material",generator:"MaterialExporter"},uuid:this.uuid,type:this.type,materials:[]},i=this.materials,n=0,r=i.length;n<r;n++){var a=i[n].toJSON(e);delete a.metadata,t.materials.push(a)}return t.visible=this.visible,t},clone:function(){for(var e=new this.constructor,t=0;t<this.materials.length;t++)e.materials.push(this.materials[t].clone());return e.visible=this.visible,e}},q.PointsMaterial=function(e){q.Material.call(this),this.type="PointsMaterial",this.color=new q.Color(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.lights=!1,this.setValues(e)},q.PointsMaterial.prototype=Object.create(q.Material.prototype),q.PointsMaterial.prototype.constructor=q.PointsMaterial,q.PointsMaterial.prototype.copy=function(e){return q.Material.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this},q.ShaderMaterial=function(e){q.Material.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,void 0!==e&&(void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))},q.ShaderMaterial.prototype=Object.create(q.Material.prototype),q.ShaderMaterial.prototype.constructor=q.ShaderMaterial,q.ShaderMaterial.prototype.copy=function(e){return q.Material.prototype.copy.call(this,e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=q.UniformsUtils.clone(e.uniforms),this.defines=e.defines,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.extensions=e.extensions,this},q.ShaderMaterial.prototype.toJSON=function(e){var t=q.Material.prototype.toJSON.call(this,e);return t.uniforms=this.uniforms,t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t},q.RawShaderMaterial=function(e){q.ShaderMaterial.call(this,e),this.type="RawShaderMaterial"},q.RawShaderMaterial.prototype=Object.create(q.ShaderMaterial.prototype),q.RawShaderMaterial.prototype.constructor=q.RawShaderMaterial,q.SpriteMaterial=function(e){q.Material.call(this),this.type="SpriteMaterial",this.color=new q.Color(16777215),this.map=null,this.rotation=0,this.fog=!1,this.lights=!1,this.setValues(e)},q.SpriteMaterial.prototype=Object.create(q.Material.prototype),q.SpriteMaterial.prototype.constructor=q.SpriteMaterial,q.SpriteMaterial.prototype.copy=function(e){return q.Material.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.rotation=e.rotation,this},q.ShadowMaterial=function(){q.ShaderMaterial.call(this,{uniforms:q.UniformsUtils.merge([q.UniformsLib.lights,{opacity:{value:1}}]),vertexShader:q.ShaderChunk.shadow_vert,fragmentShader:q.ShaderChunk.shadow_frag}),this.lights=!0,this.transparent=!0,Object.defineProperties(this,{opacity:{enumerable:!0,get:function(){return this.uniforms.opacity.value},set:function(e){this.uniforms.opacity.value=e}}})},q.ShadowMaterial.prototype=Object.create(q.ShaderMaterial.prototype),q.ShadowMaterial.prototype.constructor=q.ShadowMaterial,q.Texture=function(e,t,i,n,r,a,o,s,l,c){Object.defineProperty(this,"id",{value:q.TextureIdCount++}),this.uuid=q.Math.generateUUID(),this.name="",this.sourceFile="",this.image=void 0!==e?e:q.Texture.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==t?t:q.Texture.DEFAULT_MAPPING,this.wrapS=void 0!==i?i:q.ClampToEdgeWrapping,this.wrapT=void 0!==n?n:q.ClampToEdgeWrapping,this.magFilter=void 0!==r?r:q.LinearFilter,this.minFilter=void 0!==a?a:q.LinearMipMapLinearFilter,this.anisotropy=void 0!==l?l:1,this.format=void 0!==o?o:q.RGBAFormat,this.type=void 0!==s?s:q.UnsignedByteType,this.offset=new q.Vector2(0,0),this.repeat=new q.Vector2(1,1),this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==c?c:q.LinearEncoding,this.version=0,this.onUpdate=null},q.Texture.DEFAULT_IMAGE=void 0,q.Texture.DEFAULT_MAPPING=q.UVMapping,q.Texture.prototype={constructor:q.Texture,set needsUpdate(e){!0===e&&this.version++},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this},toJSON:function(e){if(void 0!==e.textures[this.uuid])return e.textures[this.uuid];var t={metadata:{version:4.4,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],wrap:[this.wrapS,this.wrapT],minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy};if(void 0!==this.image){var i=this.image;void 0===i.uuid&&(i.uuid=q.Math.generateUUID()),void 0===e.images[i.uuid]&&(e.images[i.uuid]={uuid:i.uuid,url:function(e){var t;return void 0!==e.toDataURL?t=e:((t=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")).width=e.width,t.height=e.height,t.getContext("2d").drawImage(e,0,0,e.width,e.height)),t.width>2048||t.height>2048?t.toDataURL("image/jpeg",.6):t.toDataURL("image/png")}(i)}),t.image=i.uuid}return e.textures[this.uuid]=t,t},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(e){if(this.mapping===q.UVMapping){if(e.multiply(this.repeat),e.add(this.offset),e.x<0||e.x>1)switch(this.wrapS){case q.RepeatWrapping:e.x=e.x-Math.floor(e.x);break;case q.ClampToEdgeWrapping:e.x=e.x<0?0:1;break;case q.MirroredRepeatWrapping:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case q.RepeatWrapping:e.y=e.y-Math.floor(e.y);break;case q.ClampToEdgeWrapping:e.y=e.y<0?0:1;break;case q.MirroredRepeatWrapping:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}this.flipY&&(e.y=1-e.y)}}},Object.assign(q.Texture.prototype,q.EventDispatcher.prototype),q.TextureIdCount=0,q.DepthTexture=function(e,t,i,n,r,a,o,s,l){q.Texture.call(this,null,n,r,a,o,s,q.DepthFormat,i,l),this.image={width:e,height:t},this.type=void 0!==i?i:q.UnsignedShortType,this.magFilter=void 0!==o?o:q.NearestFilter,this.minFilter=void 0!==s?s:q.NearestFilter,this.flipY=!1,this.generateMipmaps=!1},q.DepthTexture.prototype=Object.create(q.Texture.prototype),q.DepthTexture.prototype.constructor=q.DepthTexture,q.CanvasTexture=function(e,t,i,n,r,a,o,s,l){q.Texture.call(this,e,t,i,n,r,a,o,s,l),this.needsUpdate=!0},q.CanvasTexture.prototype=Object.create(q.Texture.prototype),q.CanvasTexture.prototype.constructor=q.CanvasTexture,q.CubeTexture=function(e,t,i,n,r,a,o,s,l,c){e=void 0!==e?e:[],t=void 0!==t?t:q.CubeReflectionMapping,q.Texture.call(this,e,t,i,n,r,a,o,s,l,c),this.flipY=!1},q.CubeTexture.prototype=Object.create(q.Texture.prototype),q.CubeTexture.prototype.constructor=q.CubeTexture,Object.defineProperty(q.CubeTexture.prototype,"images",{get:function(){return this.image},set:function(e){this.image=e}}),q.CompressedTexture=function(e,t,i,n,r,a,o,s,l,c,u,h){q.Texture.call(this,null,a,o,s,l,c,n,r,u,h),this.image={width:t,height:i},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1},q.CompressedTexture.prototype=Object.create(q.Texture.prototype),q.CompressedTexture.prototype.constructor=q.CompressedTexture,q.DataTexture=function(e,t,i,n,r,a,o,s,l,c,u,h){q.Texture.call(this,null,a,o,s,l,c,n,r,u,h),this.image={data:e,width:t,height:i},this.magFilter=void 0!==l?l:q.NearestFilter,this.minFilter=void 0!==c?c:q.NearestFilter,this.flipY=!1,this.generateMipmaps=!1},q.DataTexture.prototype=Object.create(q.Texture.prototype),q.DataTexture.prototype.constructor=q.DataTexture,q.VideoTexture=function(e,t,i,n,r,a,o,s,l){q.Texture.call(this,e,t,i,n,r,a,o,s,l),this.generateMipmaps=!1;var c=this;!function t(){requestAnimationFrame(t),e.readyState>=e.HAVE_CURRENT_DATA&&(c.needsUpdate=!0)}()},q.VideoTexture.prototype=Object.create(q.Texture.prototype),q.VideoTexture.prototype.constructor=q.VideoTexture,q.Group=function(){q.Object3D.call(this),this.type="Group"},q.Group.prototype=Object.assign(Object.create(q.Object3D.prototype),{constructor:q.Group}),q.Points=function(e,t){q.Object3D.call(this),this.type="Points",this.geometry=void 0!==e?e:new q.BufferGeometry,this.material=void 0!==t?t:new q.PointsMaterial({color:16777215*Math.random()})},q.Points.prototype=Object.assign(Object.create(q.Object3D.prototype),{constructor:q.Points,raycast:function(){var e=new q.Matrix4,t=new q.Ray,i=new q.Sphere;return function(n,r){var a=this,o=this.geometry,s=this.matrixWorld,l=n.params.Points.threshold;if(null===o.boundingSphere&&o.computeBoundingSphere(),i.copy(o.boundingSphere),i.applyMatrix4(s),!1!==n.ray.intersectsSphere(i)){e.getInverse(s),t.copy(n.ray).applyMatrix4(e);var c=l/((this.scale.x+this.scale.y+this.scale.z)/3),u=c*c,h=new q.Vector3;if(o instanceof q.BufferGeometry){var d=o.index,p=o.attributes.position.array;if(null!==d)for(var f=d.array,g=0,_=f.length;g<_;g++){var m=f[g];h.fromArray(p,3*m),b(h,m)}else{g=0;for(var v=p.length/3;g<v;g++)h.fromArray(p,3*g),b(h,g)}}else{var y=o.vertices;for(g=0,v=y.length;g<v;g++)b(y[g],g)}}function b(e,i){var o=t.distanceSqToPoint(e);if(o<u){var l=t.closestPointToPoint(e);l.applyMatrix4(s);var c=n.ray.origin.distanceTo(l);if(c<n.near||c>n.far)return;r.push({distance:c,distanceToRay:Math.sqrt(o),point:l.clone(),index:i,face:null,object:a})}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),q.Line=function(e,t,i){if(1===i)return console.warn("THREE.Line: parameter THREE.LinePieces no longer supported. Created THREE.LineSegments instead."),new q.LineSegments(e,t);q.Object3D.call(this),this.type="Line",this.geometry=void 0!==e?e:new q.BufferGeometry,this.material=void 0!==t?t:new q.LineBasicMaterial({color:16777215*Math.random()})},q.Line.prototype=Object.assign(Object.create(q.Object3D.prototype),{constructor:q.Line,raycast:function(){var e=new q.Matrix4,t=new q.Ray,i=new q.Sphere;return function(n,r){var a=n.linePrecision,o=a*a,s=this.geometry,l=this.matrixWorld;if(null===s.boundingSphere&&s.computeBoundingSphere(),i.copy(s.boundingSphere),i.applyMatrix4(l),!1!==n.ray.intersectsSphere(i)){e.getInverse(l),t.copy(n.ray).applyMatrix4(e);var c=new q.Vector3,u=new q.Vector3,h=new q.Vector3,d=new q.Vector3,p=this instanceof q.LineSegments?2:1;if(s instanceof q.BufferGeometry){var f=s.index,g=s.attributes.position.array;if(null!==f)for(var _=f.array,m=0,v=_.length-1;m<v;m+=p){var y=_[m],b=_[m+1];if(c.fromArray(g,3*y),u.fromArray(g,3*b),!(t.distanceSqToSegment(c,u,d,h)>o))d.applyMatrix4(this.matrixWorld),(w=n.ray.origin.distanceTo(d))<n.near||w>n.far||r.push({distance:w,point:h.clone().applyMatrix4(this.matrixWorld),index:m,face:null,faceIndex:null,object:this})}else for(m=0,v=g.length/3-1;m<v;m+=p){if(c.fromArray(g,3*m),u.fromArray(g,3*m+3),!(t.distanceSqToSegment(c,u,d,h)>o))d.applyMatrix4(this.matrixWorld),(w=n.ray.origin.distanceTo(d))<n.near||w>n.far||r.push({distance:w,point:h.clone().applyMatrix4(this.matrixWorld),index:m,face:null,faceIndex:null,object:this})}}else if(s instanceof q.Geometry){var S=s.vertices,E=S.length;for(m=0;m<E-1;m+=p){var w;if(!(t.distanceSqToSegment(S[m],S[m+1],d,h)>o))d.applyMatrix4(this.matrixWorld),(w=n.ray.origin.distanceTo(d))<n.near||w>n.far||r.push({distance:w,point:h.clone().applyMatrix4(this.matrixWorld),index:m,face:null,faceIndex:null,object:this})}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),q.LineSegments=function(e,t){q.Line.call(this,e,t),this.type="LineSegments"},q.LineSegments.prototype=Object.assign(Object.create(q.Line.prototype),{constructor:q.LineSegments}),q.Mesh=function(e,t){q.Object3D.call(this),this.type="Mesh",this.geometry=void 0!==e?e:new q.BufferGeometry,this.material=void 0!==t?t:new q.MeshBasicMaterial({color:16777215*Math.random()}),this.drawMode=q.TrianglesDrawMode,this.updateMorphTargets()},q.Mesh.prototype=Object.assign(Object.create(q.Object3D.prototype),{constructor:q.Mesh,setDrawMode:function(e){this.drawMode=e},copy:function(e){return q.Object3D.prototype.copy.call(this,e),this.drawMode=e.drawMode,this},updateMorphTargets:function(){if(void 0!==this.geometry.morphTargets&&this.geometry.morphTargets.length>0){this.morphTargetBase=-1,this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var e=0,t=this.geometry.morphTargets.length;e<t;e++)this.morphTargetInfluences.push(0),this.morphTargetDictionary[this.geometry.morphTargets[e].name]=e}},getMorphTargetIndexByName:function(e){return void 0!==this.morphTargetDictionary[e]?this.morphTargetDictionary[e]:(console.warn("THREE.Mesh.getMorphTargetIndexByName: morph target "+e+" does not exist. Returning 0."),0)},raycast:function(){var e=new q.Matrix4,t=new q.Ray,i=new q.Sphere,n=new q.Vector3,r=new q.Vector3,a=new q.Vector3,o=new q.Vector3,s=new q.Vector3,l=new q.Vector3,c=new q.Vector2,u=new q.Vector2,h=new q.Vector2,d=new q.Vector3,p=new q.Vector3,f=new q.Vector3;function g(e,t,i,n,r,a,o){return q.Triangle.barycoordFromPoint(e,t,i,n,d),r.multiplyScalar(d.x),a.multiplyScalar(d.y),o.multiplyScalar(d.z),r.add(a).add(o),r.clone()}function _(e,t,i,n,r,a,o){var s=e.material;if(null===(s.side===q.BackSide?i.intersectTriangle(a,r,n,!0,o):i.intersectTriangle(n,r,a,s.side!==q.DoubleSide,o)))return null;f.copy(o),f.applyMatrix4(e.matrixWorld);var l=t.ray.origin.distanceTo(f);return l<t.near||l>t.far?null:{distance:l,point:f.clone(),object:e}}function m(e,t,i,o,s,l,d,f){n.fromArray(o,3*l),r.fromArray(o,3*d),a.fromArray(o,3*f);var m=_(e,t,i,n,r,a,p);return m&&(s&&(c.fromArray(s,2*l),u.fromArray(s,2*d),h.fromArray(s,2*f),m.uv=g(p,n,r,a,c,u,h)),m.face=new q.Face3(l,d,f,q.Triangle.normal(n,r,a)),m.faceIndex=l),m}return function(d,f){var v,y,b=this.geometry,S=this.material,E=this.matrixWorld;if(void 0!==S&&(null===b.boundingSphere&&b.computeBoundingSphere(),i.copy(b.boundingSphere),i.applyMatrix4(E),!1!==d.ray.intersectsSphere(i)&&(e.getInverse(E),t.copy(d.ray).applyMatrix4(e),null===b.boundingBox||!1!==t.intersectsBox(b.boundingBox))))if(b instanceof q.BufferGeometry){var w,T,M,A=b.index,C=b.attributes,x=C.position.array;if(void 0!==C.uv&&(v=C.uv.array),null!==A)for(var I=A.array,P=0,L=I.length;P<L;P+=3)w=I[P],T=I[P+1],M=I[P+2],(y=m(this,d,t,x,v,w,T,M))&&(y.faceIndex=Math.floor(P/3),f.push(y));else for(P=0,L=x.length;P<L;P+=9)(y=m(this,d,t,x,v,w=P/3,T=w+1,M=w+2))&&(y.index=w,f.push(y))}else if(b instanceof q.Geometry){var D,R,k,O=S instanceof q.MultiMaterial,N=!0===O?S.materials:null,F=b.vertices,V=b.faces,B=b.faceVertexUvs[0];B.length>0&&(v=B);for(var U=0,H=V.length;U<H;U++){var G=V[U],j=!0===O?N[G.materialIndex]:S;if(void 0!==j){if(D=F[G.a],R=F[G.b],k=F[G.c],!0===j.morphTargets){var z=b.morphTargets,W=this.morphTargetInfluences;n.set(0,0,0),r.set(0,0,0),a.set(0,0,0);for(var Y=0,K=z.length;Y<K;Y++){var X=W[Y];if(0!==X){var Q=z[Y].vertices;n.addScaledVector(o.subVectors(Q[G.a],D),X),r.addScaledVector(s.subVectors(Q[G.b],R),X),a.addScaledVector(l.subVectors(Q[G.c],k),X)}}n.add(D),r.add(R),a.add(k),D=n,R=r,k=a}if(y=_(this,d,t,D,R,k,p)){if(v){var Z=v[U];c.copy(Z[0]),u.copy(Z[1]),h.copy(Z[2]),y.uv=g(p,D,R,k,c,u,h)}y.face=G,y.faceIndex=U,f.push(y)}}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),q.Bone=function(e){q.Object3D.call(this),this.type="Bone",this.skin=e},q.Bone.prototype=Object.assign(Object.create(q.Object3D.prototype),{constructor:q.Bone,copy:function(e){return q.Object3D.prototype.copy.call(this,e),this.skin=e.skin,this}}),q.Skeleton=function(e,t,i){if(this.useVertexTexture=void 0===i||i,this.identityMatrix=new q.Matrix4,e=e||[],this.bones=e.slice(0),this.useVertexTexture){var n=Math.sqrt(4*this.bones.length);n=q.Math.nextPowerOfTwo(Math.ceil(n)),n=Math.max(n,4),this.boneTextureWidth=n,this.boneTextureHeight=n,this.boneMatrices=new Float32Array(this.boneTextureWidth*this.boneTextureHeight*4),this.boneTexture=new q.DataTexture(this.boneMatrices,this.boneTextureWidth,this.boneTextureHeight,q.RGBAFormat,q.FloatType)}else this.boneMatrices=new Float32Array(16*this.bones.length);if(void 0===t)this.calculateInverses();else if(this.bones.length===t.length)this.boneInverses=t.slice(0);else{console.warn("THREE.Skeleton bonInverses is the wrong length."),this.boneInverses=[];for(var r=0,a=this.bones.length;r<a;r++)this.boneInverses.push(new q.Matrix4)}},Object.assign(q.Skeleton.prototype,{calculateInverses:function(){this.boneInverses=[];for(var e=0,t=this.bones.length;e<t;e++){var i=new q.Matrix4;this.bones[e]&&i.getInverse(this.bones[e].matrixWorld),this.boneInverses.push(i)}},pose:function(){for(var e,t=0,i=this.bones.length;t<i;t++)(e=this.bones[t])&&e.matrixWorld.getInverse(this.boneInverses[t]);for(t=0,i=this.bones.length;t<i;t++)(e=this.bones[t])&&(e.parent instanceof q.Bone?(e.matrix.getInverse(e.parent.matrixWorld),e.matrix.multiply(e.matrixWorld)):e.matrix.copy(e.matrixWorld),e.matrix.decompose(e.position,e.quaternion,e.scale))},update:(j=new q.Matrix4,function(){for(var e=0,t=this.bones.length;e<t;e++){var i=this.bones[e]?this.bones[e].matrixWorld:this.identityMatrix;j.multiplyMatrices(i,this.boneInverses[e]),j.toArray(this.boneMatrices,16*e)}this.useVertexTexture&&(this.boneTexture.needsUpdate=!0)}),clone:function(){return new q.Skeleton(this.bones,this.boneInverses,this.useVertexTexture)}}),q.SkinnedMesh=function(e,t,i){q.Mesh.call(this,e,t),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new q.Matrix4,this.bindMatrixInverse=new q.Matrix4;var n=[];if(this.geometry&&void 0!==this.geometry.bones){for(var r,a,o=0,s=this.geometry.bones.length;o<s;++o)a=this.geometry.bones[o],r=new q.Bone(this),n.push(r),r.name=a.name,r.position.fromArray(a.pos),r.quaternion.fromArray(a.rotq),void 0!==a.scl&&r.scale.fromArray(a.scl);for(o=0,s=this.geometry.bones.length;o<s;++o)-1!==(a=this.geometry.bones[o]).parent&&null!==a.parent&&void 0!==n[a.parent]?n[a.parent].add(n[o]):this.add(n[o])}this.normalizeSkinWeights(),this.updateMatrixWorld(!0),this.bind(new q.Skeleton(n,void 0,i),this.matrixWorld)},q.SkinnedMesh.prototype=Object.assign(Object.create(q.Mesh.prototype),{constructor:q.SkinnedMesh,bind:function(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.getInverse(t)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){if(this.geometry instanceof q.Geometry)for(var e=0;e<this.geometry.skinWeights.length;e++){var t=this.geometry.skinWeights[e];(r=1/t.lengthManhattan())!==1/0?t.multiplyScalar(r):t.set(1,0,0,0)}else if(this.geometry instanceof q.BufferGeometry){var i=new q.Vector4,n=this.geometry.attributes.skinWeight;for(e=0;e<n.count;e++){var r;i.x=n.getX(e),i.y=n.getY(e),i.z=n.getZ(e),i.w=n.getW(e),(r=1/i.lengthManhattan())!==1/0?i.multiplyScalar(r):i.set(1,0,0,0),n.setXYZW(e,i.x,i.y,i.z,i.w)}}},updateMatrixWorld:function(e){q.Mesh.prototype.updateMatrixWorld.call(this,!0),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material,this.skeleton.useVertexTexture).copy(this)}}),q.LOD=function(){q.Object3D.call(this),this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}})},q.LOD.prototype=Object.assign(Object.create(q.Object3D.prototype),{constructor:q.LOD,copy:function(e){q.Object3D.prototype.copy.call(this,e,!1);for(var t=e.levels,i=0,n=t.length;i<n;i++){var r=t[i];this.addLevel(r.object.clone(),r.distance)}return this},addLevel:function(e,t){void 0===t&&(t=0),t=Math.abs(t);for(var i=this.levels,n=0;n<i.length&&!(t<i[n].distance);n++);i.splice(n,0,{distance:t,object:e}),this.add(e)},getObjectForDistance:function(e){for(var t=this.levels,i=1,n=t.length;i<n&&!(e<t[i].distance);i++);return t[i-1].object},raycast:(z=new q.Vector3,function(e,t){z.setFromMatrixPosition(this.matrixWorld);var i=e.ray.origin.distanceTo(z);this.getObjectForDistance(i).raycast(e,t)}),update:function(){var e=new q.Vector3,t=new q.Vector3;return function(i){var n=this.levels;if(n.length>1){e.setFromMatrixPosition(i.matrixWorld),t.setFromMatrixPosition(this.matrixWorld);var r=e.distanceTo(t);n[0].object.visible=!0;for(var a=1,o=n.length;a<o&&r>=n[a].distance;a++)n[a-1].object.visible=!1,n[a].object.visible=!0;for(;a<o;a++)n[a].object.visible=!1}}}(),toJSON:function(e){var t=q.Object3D.prototype.toJSON.call(this,e);t.object.levels=[];for(var i=this.levels,n=0,r=i.length;n<r;n++){var a=i[n];t.object.levels.push({object:a.object.uuid,distance:a.distance})}return t}}),q.Sprite=function(e){q.Object3D.call(this),this.type="Sprite",this.material=void 0!==e?e:new q.SpriteMaterial},q.Sprite.prototype=Object.assign(Object.create(q.Object3D.prototype),{constructor:q.Sprite,raycast:function(){var e=new q.Vector3;return function(t,i){e.setFromMatrixPosition(this.matrixWorld);var n=t.ray.distanceSqToPoint(e);n>this.scale.x*this.scale.y/4||i.push({distance:Math.sqrt(n),point:this.position,face:null,object:this})}}(),clone:function(){return new this.constructor(this.material).copy(this)}}),q.LensFlare=function(e,t,i,n,r){q.Object3D.call(this),this.lensFlares=[],this.positionScreen=new q.Vector3,this.customUpdateCallback=void 0,void 0!==e&&this.add(e,t,i,n,r)},q.LensFlare.prototype=Object.assign(Object.create(q.Object3D.prototype),{constructor:q.LensFlare,copy:function(e){q.Object3D.prototype.copy.call(this,e),this.positionScreen.copy(e.positionScreen),this.customUpdateCallback=e.customUpdateCallback;for(var t=0,i=e.lensFlares.length;t<i;t++)this.lensFlares.push(e.lensFlares[t]);return this},add:function(e,t,i,n,r,a){void 0===t&&(t=-1),void 0===i&&(i=0),void 0===a&&(a=1),void 0===r&&(r=new q.Color(16777215)),void 0===n&&(n=q.NormalBlending),i=Math.min(i,Math.max(0,i)),this.lensFlares.push({texture:e,size:t,distance:i,x:0,y:0,z:0,scale:1,rotation:0,opacity:a,color:r,blending:n})},updateLensFlares:function(){var e,t,i=this.lensFlares.length,n=2*-this.positionScreen.x,r=2*-this.positionScreen.y;for(e=0;e<i;e++)(t=this.lensFlares[e]).x=this.positionScreen.x+n*t.distance,t.y=this.positionScreen.y+r*t.distance,t.wantedRotation=t.x*Math.PI*.25,t.rotation+=.25*(t.wantedRotation-t.rotation)}}),q.Scene=function(){q.Object3D.call(this),this.type="Scene",this.background=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0},q.Scene.prototype=Object.create(q.Object3D.prototype),q.Scene.prototype.constructor=q.Scene,q.Scene.prototype.copy=function(e,t){return q.Object3D.prototype.copy.call(this,e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this},q.Fog=function(e,t,i){this.name="",this.color=new q.Color(e),this.near=void 0!==t?t:1,this.far=void 0!==i?i:1e3},q.Fog.prototype.clone=function(){return new q.Fog(this.color.getHex(),this.near,this.far)},q.FogExp2=function(e,t){this.name="",this.color=new q.Color(e),this.density=void 0!==t?t:25e-5},q.FogExp2.prototype.clone=function(){return new q.FogExp2(this.color.getHex(),this.density)},q.ShaderChunk={},q.ShaderChunk.alphamap_fragment="#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif\n",q.ShaderChunk.alphamap_pars_fragment="#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif\n",q.ShaderChunk.alphatest_fragment="#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif\n",q.ShaderChunk.aomap_fragment="#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif\n",q.ShaderChunk.aomap_pars_fragment="#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",q.ShaderChunk.begin_vertex="\nvec3 transformed = vec3( position );\n",q.ShaderChunk.beginnormal_vertex="\nvec3 objectNormal = vec3( normal );\n",q.ShaderChunk.bsdfs="bool testLightInRange( const in float lightDistance, const in float cutoffDistance ) {\n\treturn any( bvec2( cutoffDistance == 0.0, lightDistance < cutoffDistance ) );\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t\tif( decayExponent > 0.0 ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\t\tfloat maxDistanceCutoffFactor = pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t\treturn distanceFalloff * maxDistanceCutoffFactor;\n#else\n\t\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n#endif\n\t\t}\n\t\treturn 1.0;\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\n\treturn specularColor * AB.x + AB.y;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n",q.ShaderChunk.bumpmap_pars_fragment="#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = dFdx( surf_pos );\n\t\tvec3 vSigmaY = dFdy( surf_pos );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif\n",q.ShaderChunk.clipping_planes_fragment="#if NUM_CLIPPING_PLANES > 0\n\tfor ( int i = 0; i < NUM_CLIPPING_PLANES; ++ i ) {\n\t\tvec4 plane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\t}\n#endif\n",q.ShaderChunk.clipping_planes_pars_fragment="#if NUM_CLIPPING_PLANES > 0\n\t#if ! defined( PHYSICAL ) && ! defined( PHONG )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif\n",q.ShaderChunk.clipping_planes_pars_vertex="#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvarying vec3 vViewPosition;\n#endif\n",q.ShaderChunk.clipping_planes_vertex="#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n",q.ShaderChunk.color_fragment="#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",q.ShaderChunk.color_pars_fragment="#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif\n",q.ShaderChunk.color_pars_vertex="#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",q.ShaderChunk.color_vertex="#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",q.ShaderChunk.common="#define PI 3.14159265359\n#define PI2 6.28318530718\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\n",q.ShaderChunk.cube_uv_reflection_fragment="#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_textureSize (1024.0)\nint getFaceFromDirection(vec3 direction) {\n\tvec3 absDirection = abs(direction);\n\tint face = -1;\n\tif( absDirection.x > absDirection.z ) {\n\t\tif(absDirection.x > absDirection.y )\n\t\t\tface = direction.x > 0.0 ? 0 : 3;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\telse {\n\t\tif(absDirection.z > absDirection.y )\n\t\t\tface = direction.z > 0.0 ? 2 : 5;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\treturn face;\n}\n#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)\n#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\n\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\n\tfloat dxRoughness = dFdx(roughness);\n\tfloat dyRoughness = dFdy(roughness);\n\tvec3 dx = dFdx( vec * scale * dxRoughness );\n\tvec3 dy = dFdy( vec * scale * dyRoughness );\n\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\n\td = clamp(d, 1.0, cubeUV_rangeClamp);\n\tfloat mipLevel = 0.5 * log2(d);\n\treturn vec2(floor(mipLevel), fract(mipLevel));\n}\n#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)\n#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\n\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\n\tfloat a = 16.0 * cubeUV_rcpTextureSize;\n\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\n\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\n\tfloat powScale = exp2_packed.x * exp2_packed.y;\n\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\n\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\n\tbool bRes = mipLevel == 0.0;\n\tscale =  bRes && (scale < a) ? a : scale;\n\tvec3 r;\n\tvec2 offset;\n\tint face = getFaceFromDirection(direction);\n\tfloat rcpPowScale = 1.0 / powScale;\n\tif( face == 0) {\n\t\tr = vec3(direction.x, -direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  a : offset.y;\n\t}\n\telse if( face == 1) {\n\t\tr = vec3(direction.y, direction.x, direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  a : offset.y;\n\t}\n\telse if( face == 2) {\n\t\tr = vec3(direction.z, direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  a : offset.y;\n\t}\n\telse if( face == 3) {\n\t\tr = vec3(direction.x, direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  0.0 : offset.y;\n\t}\n\telse if( face == 4) {\n\t\tr = vec3(direction.y, direction.x, -direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  0.0 : offset.y;\n\t}\n\telse {\n\t\tr = vec3(direction.z, -direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  0.0 : offset.y;\n\t}\n\tr = normalize(r);\n\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\n\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\n\tvec2 base = offset + vec2( texelOffset );\n\treturn base + s * ( scale - 2.0 * texelOffset );\n}\n#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)\nvec4 textureCubeUV(vec3 reflectedDirection, float roughness ) {\n\tfloat roughnessVal = roughness* cubeUV_maxLods3;\n\tfloat r1 = floor(roughnessVal);\n\tfloat r2 = r1 + 1.0;\n\tfloat t = fract(roughnessVal);\n\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\n\tfloat s = mipInfo.y;\n\tfloat level0 = mipInfo.x;\n\tfloat level1 = level0 + 1.0;\n\tlevel1 = level1 > 5.0 ? 5.0 : level1;\n\tlevel0 += min( floor( s + 0.5 ), 5.0 );\n\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\n\tvec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\n\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\n\tvec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\n\tvec4 result = mix(color10, color20, t);\n\treturn vec4(result.rgb, 1.0);\n}\n#endif\n",q.ShaderChunk.defaultnormal_vertex="#ifdef FLIP_SIDED\n\tobjectNormal = -objectNormal;\n#endif\nvec3 transformedNormal = normalMatrix * objectNormal;\n",q.ShaderChunk.displacementmap_vertex="#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normal * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n#endif\n",q.ShaderChunk.displacementmap_pars_vertex="#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif\n",q.ShaderChunk.emissivemap_fragment="#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif\n",q.ShaderChunk.emissivemap_pars_fragment="#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif\n",q.ShaderChunk.encodings_pars_fragment="\nvec4 LinearToLinear( in vec4 value ) {\n  return value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n  return vec4( pow( value.xyz, vec3( gammaFactor ) ), value.w );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n  return vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n  return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n  return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n  return vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n  float maxComponent = max( max( value.r, value.g ), value.b );\n  float fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n  return vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n  return vec4( value.xyz * value.w * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n  float maxRGB = max( value.x, max( value.g, value.b ) );\n  float M      = clamp( maxRGB / maxRange, 0.0, 1.0 );\n  M            = ceil( M * 255.0 ) / 255.0;\n  return vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n    return vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n    float maxRGB = max( value.x, max( value.g, value.b ) );\n    float D      = max( maxRange / maxRGB, 1.0 );\n    D            = min( floor( D ) / 255.0, 1.0 );\n    return vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n  vec3 Xp_Y_XYZp = value.rgb * cLogLuvM;\n  Xp_Y_XYZp = max(Xp_Y_XYZp, vec3(1e-6, 1e-6, 1e-6));\n  vec4 vResult;\n  vResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n  float Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n  vResult.w = fract(Le);\n  vResult.z = (Le - (floor(vResult.w*255.0))/255.0)/255.0;\n  return vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n  float Le = value.z * 255.0 + value.w;\n  vec3 Xp_Y_XYZp;\n  Xp_Y_XYZp.y = exp2((Le - 127.0) / 2.0);\n  Xp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n  Xp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n  vec3 vRGB = Xp_Y_XYZp.rgb * cLogLuvInverseM;\n  return vec4( max(vRGB, 0.0), 1.0 );\n}\n",q.ShaderChunk.encodings_fragment="  gl_FragColor = linearToOutputTexel( gl_FragColor );\n",q.ShaderChunk.envmap_fragment="#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\tsampleUV.y = saturate( flipNormal * reflectVec.y * 0.5 + 0.5 );\n\t\tsampleUV.x = atan( flipNormal * reflectVec.z, flipNormal * reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\tvec3 reflectView = flipNormal * normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#endif\n\tenvColor = envMapTexelToLinear( envColor );\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif\n",q.ShaderChunk.envmap_pars_fragment="#if defined( USE_ENVMAP ) || defined( PHYSICAL )\n\tuniform float reflectivity;\n\tuniform float envMapIntenstiy;\n#endif\n#ifdef USE_ENVMAP\n\t#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )\n\t\tvarying vec3 vWorldPosition;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif\n",q.ShaderChunk.envmap_pars_vertex="#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif\n",q.ShaderChunk.envmap_vertex="#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif\n",q.ShaderChunk.fog_fragment="#ifdef USE_FOG\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tfloat depth = gl_FragDepthEXT / gl_FragCoord.w;\n\t#else\n\t\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;\n\t#endif\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * depth * depth * LOG2 ) );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, depth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif\n",q.ShaderChunk.fog_pars_fragment="#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",q.ShaderChunk.lightmap_fragment="#ifdef USE_LIGHTMAP\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n#endif\n",q.ShaderChunk.lightmap_pars_fragment="#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",q.ShaderChunk.lights_lambert_vertex="vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvLightFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif\n",q.ShaderChunk.lights_pars="uniform vec3 ambientLightColor;\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tif ( testLightInRange( lightDistance, pointLight.distance ) ) {\n\t\t\tdirectLight.color = pointLight.color;\n\t\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( all( bvec2( angleCos > spotLight.coneCos, testLightInRange( lightDistance, spotLight.distance ) ) ) ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif\n#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\t#include <normal_flip>\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = flipNormal * vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryVec = flipNormal * vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( queryVec, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar - 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n\t\t#endif\n\t\t#include <normal_flip>\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryReflectVec = flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV(queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent));\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = saturate( flipNormal * reflectVec.y * 0.5 + 0.5 );\n\t\t\tsampleUV.x = atan( flipNormal * reflectVec.z, flipNormal * reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = flipNormal * normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif\n",q.ShaderChunk.lights_phong_fragment="BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;\n",q.ShaderChunk.lights_phong_pars_fragment="varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)\n",q.ShaderChunk.lights_physical_fragment="PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\n#ifdef STANDARD\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.clearCoat = saturate( clearCoat );\tmaterial.clearCoatRoughness = clamp( clearCoatRoughness, 0.04, 1.0 );\n#endif\n",q.ShaderChunk.lights_physical_pars_fragment="struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n\t#ifndef STANDARD\n\t\tfloat clearCoat;\n\t\tfloat clearCoatRoughness;\n\t#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\t#ifndef STANDARD\n\t\treflectedLight.directSpecular += irradiance * material.clearCoat * BRDF_Specular_GGX( directLight, geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 clearCoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectSpecular += radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\n\t#ifndef STANDARD\n\t\treflectedLight.indirectSpecular += clearCoatRadiance * material.clearCoat * BRDF_Specular_GGX_Environment( geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\n#define Material_ClearCoat_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.clearCoatRoughness )\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}\n",q.ShaderChunk.lights_template="\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#ifdef USE_LIGHTMAP\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t \tirradiance += getLightProbeIndirectIrradiance( geometry, 8 );\n\t#endif\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tvec3 radiance = getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), 8 );\n\t#ifndef STANDARD\n\t\tvec3 clearCoatRadiance = getLightProbeIndirectRadiance( geometry, Material_ClearCoat_BlinnShininessExponent( material ), 8 );\n\t#else\n\t\tvec3 clearCoatRadiance = vec3( 0.0 );\n\t#endif\n\t\t\n\tRE_IndirectSpecular( radiance, clearCoatRadiance, geometry, material, reflectedLight );\n#endif\n",q.ShaderChunk.logdepthbuf_fragment="#if defined(USE_LOGDEPTHBUF) && defined(USE_LOGDEPTHBUF_EXT)\n\tgl_FragDepthEXT = log2(vFragDepth) * logDepthBufFC * 0.5;\n#endif",q.ShaderChunk.logdepthbuf_pars_fragment="#ifdef USE_LOGDEPTHBUF\n\tuniform float logDepthBufFC;\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n#endif\n",q.ShaderChunk.logdepthbuf_pars_vertex="#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n\tuniform float logDepthBufFC;\n#endif",q.ShaderChunk.logdepthbuf_vertex="#ifdef USE_LOGDEPTHBUF\n\tgl_Position.z = log2(max( EPSILON, gl_Position.w + 1.0 )) * logDepthBufFC;\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t#else\n\t\tgl_Position.z = (gl_Position.z - 1.0) * gl_Position.w;\n\t#endif\n#endif\n",q.ShaderChunk.map_fragment="#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif\n",q.ShaderChunk.map_pars_fragment="#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n",q.ShaderChunk.map_particle_fragment="#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) * offsetRepeat.zw + offsetRepeat.xy );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n",q.ShaderChunk.map_particle_pars_fragment="#ifdef USE_MAP\n\tuniform vec4 offsetRepeat;\n\tuniform sampler2D map;\n#endif\n",q.ShaderChunk.metalnessmap_fragment="float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.r;\n#endif\n",q.ShaderChunk.metalnessmap_pars_fragment="#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",q.ShaderChunk.morphnormal_vertex="#ifdef USE_MORPHNORMALS\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n#endif\n",q.ShaderChunk.morphtarget_pars_vertex="#ifdef USE_MORPHTARGETS\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",q.ShaderChunk.morphtarget_vertex="#ifdef USE_MORPHTARGETS\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\t#endif\n#endif\n",q.ShaderChunk.normal_flip="#ifdef DOUBLE_SIDED\n\tfloat flipNormal = ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n#else\n\tfloat flipNormal = 1.0;\n#endif\n",q.ShaderChunk.normal_fragment="#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal ) * flipNormal;\n#endif\n#ifdef USE_NORMALMAP\n\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif\n",q.ShaderChunk.normalmap_pars_fragment="#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 S = normalize( q0 * st1.t - q1 * st0.t );\n\t\tvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\n\t\tvec3 N = normalize( surf_norm );\n\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\tmapN.xy = normalScale * mapN.xy;\n\t\tmat3 tsn = mat3( S, T, N );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif\n",q.ShaderChunk.packing="vec3 packNormalToRGB( const in vec3 normal ) {\n  return normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n  return 1.0 - 2.0 * rgb.xyz;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n  return ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n  return linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n  return (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n  return ( near * far ) / ( ( far - near ) * invClipZ - far );\n}\n",q.ShaderChunk.premultiplied_alpha_fragment="#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif\n",q.ShaderChunk.project_vertex="#ifdef USE_SKINNING\n\tvec4 mvPosition = modelViewMatrix * skinned;\n#else\n\tvec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\n#endif\ngl_Position = projectionMatrix * mvPosition;\n",q.ShaderChunk.roughnessmap_fragment="float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.r;\n#endif\n",q.ShaderChunk.roughnessmap_pars_fragment="#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",q.ShaderChunk.shadowmap_pars_fragment="#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n\t\tvec2 f = fract( uv * size + 0.5 );\n\t\tfloat a = mix( lb, lt, f.y );\n\t\tfloat b = mix( rb, rt, f.y );\n\t\tfloat c = mix( a, b, f.x );\n\t\treturn c;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\treturn (\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn 1.0;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\tfloat dp = ( length( lightToPosition ) - shadowBias ) / 1000.0;\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif\n",q.ShaderChunk.shadowmap_pars_vertex="#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n#endif\n",q.ShaderChunk.shadowmap_vertex="#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n#endif\n",q.ShaderChunk.shadowmask_pars_fragment="float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tDirectionalLight directionalLight;\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tSpotLight spotLight;\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tPointLight pointLight;\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#endif\n\treturn shadow;\n}\n",q.ShaderChunk.skinbase_vertex="#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",q.ShaderChunk.skinning_pars_vertex="#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureWidth;\n\t\tuniform int boneTextureHeight;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureWidth ) );\n\t\t\tfloat y = floor( j / float( boneTextureWidth ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureWidth );\n\t\t\tfloat dy = 1.0 / float( boneTextureHeight );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif\n",q.ShaderChunk.skinning_vertex="#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\tskinned  = bindMatrixInverse * skinned;\n#endif\n",q.ShaderChunk.skinnormal_vertex="#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n#endif\n",q.ShaderChunk.specularmap_fragment="float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",q.ShaderChunk.specularmap_pars_fragment="#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",q.ShaderChunk.tonemapping_fragment="#if defined( TONE_MAPPING )\n  gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif\n",q.ShaderChunk.tonemapping_pars_fragment="#define saturate(a) clamp( a, 0.0, 1.0 )\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n  return toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n  color *= toneMappingExposure;\n  return saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n  color *= toneMappingExposure;\n  return saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n  color *= toneMappingExposure;\n  color = max( vec3( 0.0 ), color - 0.004 );\n  return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\n",q.ShaderChunk.uv2_pars_fragment="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",q.ShaderChunk.uv2_pars_vertex="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n#endif",q.ShaderChunk.uv2_vertex="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = uv2;\n#endif",q.ShaderChunk.uv_pars_fragment="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n#endif",q.ShaderChunk.uv_pars_vertex="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n\tuniform vec4 offsetRepeat;\n#endif\n",q.ShaderChunk.uv_vertex="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvUv = uv * offsetRepeat.zw + offsetRepeat.xy;\n#endif",q.ShaderChunk.worldpos_vertex="#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( PHYSICAL ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\n\t#ifdef USE_SKINNING\n\t\tvec4 worldPosition = modelMatrix * skinned;\n\t#else\n\t\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n\t#endif\n#endif\n",q.UniformsUtils={merge:function(e){for(var t={},i=0;i<e.length;i++){var n=this.clone(e[i]);for(var r in n)t[r]=n[r]}return t},clone:function(e){var t={};for(var i in e)for(var n in t[i]={},e[i]){var r=e[i][n];r instanceof q.Color||r instanceof q.Vector2||r instanceof q.Vector3||r instanceof q.Vector4||r instanceof q.Matrix3||r instanceof q.Matrix4||r instanceof q.Texture?t[i][n]=r.clone():Array.isArray(r)?t[i][n]=r.slice():t[i][n]=r}return t}},q.UniformsLib={common:{diffuse:{value:new q.Color(15658734)},opacity:{value:1},map:{value:null},offsetRepeat:{value:new q.Vector4(0,0,1,1)},specularMap:{value:null},alphaMap:{value:null},envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new q.Vector2(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new q.Color(16777215)}},lights:{ambientLightColor:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}}},points:{diffuse:{value:new q.Color(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},offsetRepeat:{value:new q.Vector4(0,0,1,1)}}},q.ShaderChunk.cube_frag="uniform samplerCube tCube;\nuniform float tFlip;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\n\t#include <logdepthbuf_fragment>\n}\n",q.ShaderChunk.cube_vert="varying vec3 vWorldPosition;\n#include <common>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n",q.ShaderChunk.depth_frag="#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( gl_FragCoord.z ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\t#endif\n}\n",q.ShaderChunk.depth_vert="#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#include <begin_vertex>\n\t#include <displacementmap_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n",q.ShaderChunk.distanceRGBA_frag="uniform vec3 lightPos;\nvarying vec4 vWorldPosition;\n#include <common>\n#include <packing>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tgl_FragColor = packDepthToRGBA( length( vWorldPosition.xyz - lightPos.xyz ) / 1000.0 );\n}\n",q.ShaderChunk.distanceRGBA_vert="varying vec4 vWorldPosition;\n#include <common>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <skinbase_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition;\n}\n",q.ShaderChunk.equirect_frag="uniform sampler2D tEquirect;\nuniform float tFlip;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 direction = normalize( vWorldPosition );\n\tvec2 sampleUV;\n\tsampleUV.y = saturate( tFlip * direction.y * -0.5 + 0.5 );\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <logdepthbuf_fragment>\n}\n",q.ShaderChunk.equirect_vert="varying vec3 vWorldPosition;\n#include <common>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n",q.ShaderChunk.linedashed_frag="uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",q.ShaderChunk.linedashed_vert="uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n",q.ShaderChunk.meshbasic_frag="uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight;\n\treflectedLight.directDiffuse = vec3( 0.0 );\n\treflectedLight.directSpecular = vec3( 0.0 );\n\treflectedLight.indirectDiffuse = diffuseColor.rgb;\n\treflectedLight.indirectSpecular = vec3( 0.0 );\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <normal_flip>\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",q.ShaderChunk.meshbasic_vert="#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n}\n",q.ShaderChunk.meshlambert_frag="uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <normal_flip>\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",q.ShaderChunk.meshlambert_vert="#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars>\n#include <color_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n}\n",q.ShaderChunk.meshphong_frag="#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_flip>\n\t#include <normal_fragment>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_template>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",q.ShaderChunk.meshphong_vert="#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <displacementmap_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n}\n",q.ShaderChunk.meshphysical_frag="#define PHYSICAL\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifndef STANDARD\n\tuniform float clearCoat;\n\tuniform float clearCoatRoughness;\n#endif\nuniform float envMapIntensity;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <lights_pars>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_flip>\n\t#include <normal_fragment>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_template>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",q.ShaderChunk.meshphysical_vert="#define PHYSICAL\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <displacementmap_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n}\n",q.ShaderChunk.normal_frag="uniform float opacity;\nvarying vec3 vNormal;\n#include <common>\n#include <packing>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tgl_FragColor = vec4( packNormalToRGB( vNormal ), opacity );\n\t#include <logdepthbuf_fragment>\n}\n",q.ShaderChunk.normal_vert="varying vec3 vNormal;\n#include <common>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvNormal = normalize( normalMatrix * normal );\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n",q.ShaderChunk.points_frag="uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",q.ShaderChunk.points_vert="uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#ifdef USE_SIZEATTENUATION\n\t\tgl_PointSize = size * ( scale / - mvPosition.z );\n\t#else\n\t\tgl_PointSize = size;\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n}\n",q.ShaderChunk.shadow_frag="uniform float opacity;\n#include <common>\n#include <packing>\n#include <bsdfs>\n#include <lights_pars>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( 0.0, 0.0, 0.0, opacity * ( 1.0  - getShadowMask() ) );\n}\n",q.ShaderChunk.shadow_vert="#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n}\n",q.ShaderLib={basic:{uniforms:q.UniformsUtils.merge([q.UniformsLib.common,q.UniformsLib.aomap,q.UniformsLib.fog]),vertexShader:q.ShaderChunk.meshbasic_vert,fragmentShader:q.ShaderChunk.meshbasic_frag},lambert:{uniforms:q.UniformsUtils.merge([q.UniformsLib.common,q.UniformsLib.aomap,q.UniformsLib.lightmap,q.UniformsLib.emissivemap,q.UniformsLib.fog,q.UniformsLib.lights,{emissive:{value:new q.Color(0)}}]),vertexShader:q.ShaderChunk.meshlambert_vert,fragmentShader:q.ShaderChunk.meshlambert_frag},phong:{uniforms:q.UniformsUtils.merge([q.UniformsLib.common,q.UniformsLib.aomap,q.UniformsLib.lightmap,q.UniformsLib.emissivemap,q.UniformsLib.bumpmap,q.UniformsLib.normalmap,q.UniformsLib.displacementmap,q.UniformsLib.fog,q.UniformsLib.lights,{emissive:{value:new q.Color(0)},specular:{value:new q.Color(1118481)},shininess:{value:30}}]),vertexShader:q.ShaderChunk.meshphong_vert,fragmentShader:q.ShaderChunk.meshphong_frag},standard:{uniforms:q.UniformsUtils.merge([q.UniformsLib.common,q.UniformsLib.aomap,q.UniformsLib.lightmap,q.UniformsLib.emissivemap,q.UniformsLib.bumpmap,q.UniformsLib.normalmap,q.UniformsLib.displacementmap,q.UniformsLib.roughnessmap,q.UniformsLib.metalnessmap,q.UniformsLib.fog,q.UniformsLib.lights,{emissive:{value:new q.Color(0)},roughness:{value:.5},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:q.ShaderChunk.meshphysical_vert,fragmentShader:q.ShaderChunk.meshphysical_frag},points:{uniforms:q.UniformsUtils.merge([q.UniformsLib.points,q.UniformsLib.fog]),vertexShader:q.ShaderChunk.points_vert,fragmentShader:q.ShaderChunk.points_frag},dashed:{uniforms:q.UniformsUtils.merge([q.UniformsLib.common,q.UniformsLib.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:q.ShaderChunk.linedashed_vert,fragmentShader:q.ShaderChunk.linedashed_frag},depth:{uniforms:q.UniformsUtils.merge([q.UniformsLib.common,q.UniformsLib.displacementmap]),vertexShader:q.ShaderChunk.depth_vert,fragmentShader:q.ShaderChunk.depth_frag},normal:{uniforms:{opacity:{value:1}},vertexShader:q.ShaderChunk.normal_vert,fragmentShader:q.ShaderChunk.normal_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1}},vertexShader:q.ShaderChunk.cube_vert,fragmentShader:q.ShaderChunk.cube_frag},equirect:{uniforms:{tEquirect:{value:null},tFlip:{value:-1}},vertexShader:q.ShaderChunk.equirect_vert,fragmentShader:q.ShaderChunk.equirect_frag},distanceRGBA:{uniforms:{lightPos:{value:new q.Vector3}},vertexShader:q.ShaderChunk.distanceRGBA_vert,fragmentShader:q.ShaderChunk.distanceRGBA_frag}},q.ShaderLib.physical={uniforms:q.UniformsUtils.merge([q.ShaderLib.standard.uniforms,{clearCoat:{value:0},clearCoatRoughness:{value:0}}]),vertexShader:q.ShaderChunk.meshphysical_vert,fragmentShader:q.ShaderChunk.meshphysical_frag},q.WebGLRenderer=function(e){console.log("THREE.WebGLRenderer",q.REVISION);var t=void 0!==(e=e||{}).canvas?e.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),i=void 0!==e.context?e.context:null,n=void 0!==e.alpha&&e.alpha,r=void 0===e.depth||e.depth,a=void 0===e.stencil||e.stencil,o=void 0!==e.antialias&&e.antialias,s=void 0===e.premultipliedAlpha||e.premultipliedAlpha,l=void 0!==e.preserveDrawingBuffer&&e.preserveDrawingBuffer,c=[],u=[],h=-1,d=[],p=-1,f=new Float32Array(8),g=[],_=[];this.domElement=t,this.context=null,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.gammaInput=!1,this.gammaOutput=!1,this.physicallyCorrectLights=!1,this.toneMapping=q.LinearToneMapping,this.toneMappingExposure=1,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var m,v=this,y=null,b=null,S=null,E=-1,w="",T=null,M=new q.Vector4,A=null,C=new q.Vector4,x=0,I=new q.Color(0),P=0,L=t.width,D=t.height,R=1,k=new q.Vector4(0,0,L,D),O=!1,N=new q.Vector4(0,0,L,D),F=new q.Frustum,V=new q.WebGLClipping,B=!1,U=!1,H=new q.Sphere,G=new q.Matrix4,j=new q.Vector3,z={hash:"",ambient:[0,0,0],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],shadows:[]},W={calls:0,vertices:0,faces:0,points:0};this.info={render:W,memory:{geometries:0,textures:0},programs:null};try{var Y={alpha:n,depth:r,stencil:a,antialias:o,premultipliedAlpha:s,preserveDrawingBuffer:l};if(null===(m=i||t.getContext("webgl",Y)||t.getContext("experimental-webgl",Y)))throw null!==t.getContext("webgl")?"Error creating WebGL context with your selected attributes.":"Error creating WebGL context.";void 0===m.getShaderPrecisionFormat&&(m.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}}),t.addEventListener("webglcontextlost",me,!1)}catch(e){console.error("THREE.WebGLRenderer: "+e)}var K=new q.WebGLExtensions(m);K.get("WEBGL_depth_texture"),K.get("OES_texture_float"),K.get("OES_texture_float_linear"),K.get("OES_texture_half_float"),K.get("OES_texture_half_float_linear"),K.get("OES_standard_derivatives"),K.get("ANGLE_instanced_arrays"),K.get("OES_element_index_uint")&&(q.BufferGeometry.MaxIndex=4294967296);var X=new q.WebGLCapabilities(m,K,e),Q=new q.WebGLState(m,K,Pe),Z=new q.WebGLProperties,J=new q.WebGLTextures(m,K,Q,Z,X,Pe,this.info),$=new q.WebGLObjects(m,Z,this.info),ee=new q.WebGLPrograms(this,X),te=new q.WebGLLights;this.info.programs=ee.programs;var ie=new q.WebGLBufferRenderer(m,K,W),ne=new q.WebGLIndexedBufferRenderer(m,K,W),re=new q.OrthographicCamera(-1,1,1,-1,0,1),ae=new q.PerspectiveCamera,oe=new q.Mesh(new q.PlaneBufferGeometry(2,2),new q.MeshBasicMaterial({depthTest:!1,depthWrite:!1})),se=q.ShaderLib.cube,le=new q.Mesh(new q.BoxBufferGeometry(5,5,5),new q.ShaderMaterial({uniforms:se.uniforms,vertexShader:se.vertexShader,fragmentShader:se.fragmentShader,depthTest:!1,depthWrite:!1,side:q.BackSide}));function ce(){return null===b?R:1}function ue(e,t,i,n){!0===s&&(e*=n,t*=n,i*=n),Q.clearColor(e,t,i,n)}function he(){Q.init(),Q.scissor(M.copy(k).multiplyScalar(R)),Q.viewport(C.copy(N).multiplyScalar(R)),ue(I.r,I.g,I.b,P)}function de(){y=null,T=null,w="",E=-1,Q.reset()}$.update(oe),$.update(le),he(),this.context=m,this.capabilities=X,this.extensions=K,this.properties=Z,this.state=Q;var pe=new q.WebGLShadowMap(this,z,$);this.shadowMap=pe;var fe,ge=new q.SpritePlugin(this,g),_e=new q.LensFlarePlugin(this,_);function me(e){e.preventDefault(),de(),he(),Z.clear()}function ve(e){var t=e.target;t.removeEventListener("dispose",ve),function(e){ye(e),Z.delete(e)}(t)}function ye(e){var t=Z.get(e).program;e.program=void 0,void 0!==t&&ee.releaseProgram(t)}function be(e,t){return Math.abs(t[0])-Math.abs(e[0])}function Se(e,t){return e.object.renderOrder!==t.object.renderOrder?e.object.renderOrder-t.object.renderOrder:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function Ee(e,t){return e.object.renderOrder!==t.object.renderOrder?e.object.renderOrder-t.object.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function we(e,t,i,n,r){var a,o;i.transparent?(a=d,o=++p):(a=u,o=++h);var s=a[o];void 0!==s?(s.id=e.id,s.object=e,s.geometry=t,s.material=i,s.z=j.z,s.group=r):(s={id:e.id,object:e,geometry:t,material:i,z:j.z,group:r},a.push(s))}function Te(e){if(!F.intersectsSphere(e))return!1;var t=V.numPlanes;if(0===t)return!0;var i=v.clippingPlanes,n=e.center,r=-e.radius,a=0;do{if(i[a].distanceToPoint(n)<r)return!1}while(++a!==t);return!0}function Me(e,t,i,n){for(var r=0,a=e.length;r<a;r++){var o=e[r],s=o.object,l=o.geometry,c=void 0===n?o.material:n,u=o.group;if(s.modelViewMatrix.multiplyMatrices(t.matrixWorldInverse,s.matrixWorld),s.normalMatrix.getNormalMatrix(s.modelViewMatrix),s instanceof q.ImmediateRenderObject){Ae(c);var h=Ce(t,i,c,s);w="",s.render((function(e){v.renderBufferImmediate(e,h,c)}))}else v.renderBufferDirect(t,i,l,c,s,u)}}function Ae(e){e.side!==q.DoubleSide?Q.enable(m.CULL_FACE):Q.disable(m.CULL_FACE),Q.setFlipSided(e.side===q.BackSide),!0===e.transparent?Q.setBlending(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha):Q.setBlending(q.NoBlending),Q.setDepthFunc(e.depthFunc),Q.setDepthTest(e.depthTest),Q.setDepthWrite(e.depthWrite),Q.setColorWrite(e.colorWrite),Q.setPolygonOffset(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits)}function Ce(e,i,n,r){x=0;var a=Z.get(n);if(B){if(U||e!==T){var o=e===T&&n.id===E;V.setState(n.clippingPlanes,n.clipShadows,e,a,o)}void 0!==a.numClippingPlanes&&a.numClippingPlanes!==V.numPlanes&&(n.needsUpdate=!0)}void 0===a.program&&(n.needsUpdate=!0),void 0!==a.lightsHash&&a.lightsHash!==z.hash&&(n.needsUpdate=!0),n.needsUpdate&&(!function(e,t,i){var n=Z.get(e),r=ee.getParameters(e,z,t,V.numPlanes,i),a=ee.getProgramCode(e,r),o=n.program,s=!0;if(void 0===o)e.addEventListener("dispose",ve);else if(o.code!==a)ye(e);else{if(void 0!==r.shaderID)return;s=!1}if(s){if(r.shaderID){var l=q.ShaderLib[r.shaderID];n.__webglShader={name:e.type,uniforms:q.UniformsUtils.clone(l.uniforms),vertexShader:l.vertexShader,fragmentShader:l.fragmentShader}}else n.__webglShader={name:e.type,uniforms:e.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader};e.__webglShader=n.__webglShader,o=ee.acquireProgram(e,r,a),n.program=o,e.program=o}var c=o.getAttributes();if(e.morphTargets){e.numSupportedMorphTargets=0;for(var u=0;u<v.maxMorphTargets;u++)c["morphTarget"+u]>=0&&e.numSupportedMorphTargets++}if(e.morphNormals){e.numSupportedMorphNormals=0;for(u=0;u<v.maxMorphNormals;u++)c["morphNormal"+u]>=0&&e.numSupportedMorphNormals++}var h=n.__webglShader.uniforms;(e instanceof q.ShaderMaterial||e instanceof q.RawShaderMaterial)&&!0!==e.clipping||(n.numClippingPlanes=V.numPlanes,h.clippingPlanes=V.uniform),e.lights&&(n.lightsHash=z.hash,h.ambientLightColor.value=z.ambient,h.directionalLights.value=z.directional,h.spotLights.value=z.spot,h.pointLights.value=z.point,h.hemisphereLights.value=z.hemi,h.directionalShadowMap.value=z.directionalShadowMap,h.directionalShadowMatrix.value=z.directionalShadowMatrix,h.spotShadowMap.value=z.spotShadowMap,h.spotShadowMatrix.value=z.spotShadowMatrix,h.pointShadowMap.value=z.pointShadowMap,h.pointShadowMatrix.value=z.pointShadowMatrix);var d=n.program.getUniforms(),p=q.WebGLUniforms.seqWithValue(d.seq,h);n.uniformsList=p,n.dynamicUniforms=q.WebGLUniforms.splitDynamic(p,h)}(n,i,r),n.needsUpdate=!1);var s,l,c=!1,u=!1,h=!1,d=a.program,p=d.getUniforms(),f=a.__webglShader.uniforms;if(d.id!==y&&(m.useProgram(d.program),y=d.id,c=!0,u=!0,h=!0),n.id!==E&&(E=n.id,u=!0),c||e!==T){if(p.set(m,e,"projectionMatrix"),X.logarithmicDepthBuffer&&p.setValue(m,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),e!==T&&(T=e,u=!0,h=!0),n instanceof q.ShaderMaterial||n instanceof q.MeshPhongMaterial||n instanceof q.MeshStandardMaterial||n.envMap){var g=p.map.cameraPosition;void 0!==g&&g.setValue(m,j.setFromMatrixPosition(e.matrixWorld))}(n instanceof q.MeshPhongMaterial||n instanceof q.MeshLambertMaterial||n instanceof q.MeshBasicMaterial||n instanceof q.MeshStandardMaterial||n instanceof q.ShaderMaterial||n.skinning)&&p.setValue(m,"viewMatrix",e.matrixWorldInverse),p.set(m,v,"toneMappingExposure"),p.set(m,v,"toneMappingWhitePoint")}if(n.skinning){p.setOptional(m,r,"bindMatrix"),p.setOptional(m,r,"bindMatrixInverse");var _=r.skeleton;_&&(X.floatVertexTextures&&_.useVertexTexture?(p.set(m,_,"boneTexture"),p.set(m,_,"boneTextureWidth"),p.set(m,_,"boneTextureHeight")):p.setOptional(m,_,"boneMatrices"))}u&&(n.lights&&(l=h,(s=f).ambientLightColor.needsUpdate=l,s.directionalLights.needsUpdate=l,s.pointLights.needsUpdate=l,s.spotLights.needsUpdate=l,s.hemisphereLights.needsUpdate=l),i&&n.fog&&function(e,t){e.fogColor.value=t.color,t instanceof q.Fog?(e.fogNear.value=t.near,e.fogFar.value=t.far):t instanceof q.FogExp2&&(e.fogDensity.value=t.density)}(f,i),(n instanceof q.MeshBasicMaterial||n instanceof q.MeshLambertMaterial||n instanceof q.MeshPhongMaterial||n instanceof q.MeshStandardMaterial||n instanceof q.MeshDepthMaterial)&&function(e,t){e.opacity.value=t.opacity,e.diffuse.value=t.color,t.emissive&&e.emissive.value.copy(t.emissive).multiplyScalar(t.emissiveIntensity);e.map.value=t.map,e.specularMap.value=t.specularMap,e.alphaMap.value=t.alphaMap,t.aoMap&&(e.aoMap.value=t.aoMap,e.aoMapIntensity.value=t.aoMapIntensity);var i;t.map?i=t.map:t.specularMap?i=t.specularMap:t.displacementMap?i=t.displacementMap:t.normalMap?i=t.normalMap:t.bumpMap?i=t.bumpMap:t.roughnessMap?i=t.roughnessMap:t.metalnessMap?i=t.metalnessMap:t.alphaMap?i=t.alphaMap:t.emissiveMap&&(i=t.emissiveMap);if(void 0!==i){i instanceof q.WebGLRenderTarget&&(i=i.texture);var n=i.offset,r=i.repeat;e.offsetRepeat.value.set(n.x,n.y,r.x,r.y)}e.envMap.value=t.envMap,e.flipEnvMap.value=t.envMap instanceof q.CubeTexture?-1:1,e.reflectivity.value=t.reflectivity,e.refractionRatio.value=t.refractionRatio}(f,n),n instanceof q.LineBasicMaterial?xe(f,n):n instanceof q.LineDashedMaterial?(xe(f,n),function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(f,n)):n instanceof q.PointsMaterial?function(e,i){if(e.diffuse.value=i.color,e.opacity.value=i.opacity,e.size.value=i.size*R,e.scale.value=.5*t.clientHeight,e.map.value=i.map,null!==i.map){var n=i.map.offset,r=i.map.repeat;e.offsetRepeat.value.set(n.x,n.y,r.x,r.y)}}(f,n):n instanceof q.MeshLambertMaterial?function(e,t){t.lightMap&&(e.lightMap.value=t.lightMap,e.lightMapIntensity.value=t.lightMapIntensity);t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap)}(f,n):n instanceof q.MeshPhongMaterial?function(e,t){e.specular.value=t.specular,e.shininess.value=Math.max(t.shininess,1e-4),t.lightMap&&(e.lightMap.value=t.lightMap,e.lightMapIntensity.value=t.lightMapIntensity);t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap);t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale);t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale));t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(f,n):n instanceof q.MeshPhysicalMaterial?function(e,t){e.clearCoat.value=t.clearCoat,e.clearCoatRoughness.value=t.clearCoatRoughness,Ie(e,t)}(f,n):n instanceof q.MeshStandardMaterial?Ie(f,n):n instanceof q.MeshDepthMaterial?n.displacementMap&&(f.displacementMap.value=n.displacementMap,f.displacementScale.value=n.displacementScale,f.displacementBias.value=n.displacementBias):n instanceof q.MeshNormalMaterial&&(f.opacity.value=n.opacity),q.WebGLUniforms.upload(m,a.uniformsList,f,v)),p.set(m,r,"modelViewMatrix"),p.set(m,r,"normalMatrix"),p.setValue(m,"modelMatrix",r.matrixWorld);var b=a.dynamicUniforms;return null!==b&&(q.WebGLUniforms.evalDynamic(b,f,r,e),q.WebGLUniforms.upload(m,b,f,v)),d}function xe(e,t){e.diffuse.value=t.color,e.opacity.value=t.opacity}function Ie(e,t){e.roughness.value=t.roughness,e.metalness.value=t.metalness,t.roughnessMap&&(e.roughnessMap.value=t.roughnessMap),t.metalnessMap&&(e.metalnessMap.value=t.metalnessMap),t.lightMap&&(e.lightMap.value=t.lightMap,e.lightMapIntensity.value=t.lightMapIntensity),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale)),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias),t.envMap&&(e.envMapIntensity.value=t.envMapIntensity)}function Pe(e){var t;if(e===q.RepeatWrapping)return m.REPEAT;if(e===q.ClampToEdgeWrapping)return m.CLAMP_TO_EDGE;if(e===q.MirroredRepeatWrapping)return m.MIRRORED_REPEAT;if(e===q.NearestFilter)return m.NEAREST;if(e===q.NearestMipMapNearestFilter)return m.NEAREST_MIPMAP_NEAREST;if(e===q.NearestMipMapLinearFilter)return m.NEAREST_MIPMAP_LINEAR;if(e===q.LinearFilter)return m.LINEAR;if(e===q.LinearMipMapNearestFilter)return m.LINEAR_MIPMAP_NEAREST;if(e===q.LinearMipMapLinearFilter)return m.LINEAR_MIPMAP_LINEAR;if(e===q.UnsignedByteType)return m.UNSIGNED_BYTE;if(e===q.UnsignedShort4444Type)return m.UNSIGNED_SHORT_4_4_4_4;if(e===q.UnsignedShort5551Type)return m.UNSIGNED_SHORT_5_5_5_1;if(e===q.UnsignedShort565Type)return m.UNSIGNED_SHORT_5_6_5;if(e===q.ByteType)return m.BYTE;if(e===q.ShortType)return m.SHORT;if(e===q.UnsignedShortType)return m.UNSIGNED_SHORT;if(e===q.IntType)return m.INT;if(e===q.UnsignedIntType)return m.UNSIGNED_INT;if(e===q.FloatType)return m.FLOAT;if(null!==(t=K.get("OES_texture_half_float"))&&e===q.HalfFloatType)return t.HALF_FLOAT_OES;if(e===q.AlphaFormat)return m.ALPHA;if(e===q.RGBFormat)return m.RGB;if(e===q.RGBAFormat)return m.RGBA;if(e===q.LuminanceFormat)return m.LUMINANCE;if(e===q.LuminanceAlphaFormat)return m.LUMINANCE_ALPHA;if(e===q.DepthFormat)return m.DEPTH_COMPONENT;if(e===q.AddEquation)return m.FUNC_ADD;if(e===q.SubtractEquation)return m.FUNC_SUBTRACT;if(e===q.ReverseSubtractEquation)return m.FUNC_REVERSE_SUBTRACT;if(e===q.ZeroFactor)return m.ZERO;if(e===q.OneFactor)return m.ONE;if(e===q.SrcColorFactor)return m.SRC_COLOR;if(e===q.OneMinusSrcColorFactor)return m.ONE_MINUS_SRC_COLOR;if(e===q.SrcAlphaFactor)return m.SRC_ALPHA;if(e===q.OneMinusSrcAlphaFactor)return m.ONE_MINUS_SRC_ALPHA;if(e===q.DstAlphaFactor)return m.DST_ALPHA;if(e===q.OneMinusDstAlphaFactor)return m.ONE_MINUS_DST_ALPHA;if(e===q.DstColorFactor)return m.DST_COLOR;if(e===q.OneMinusDstColorFactor)return m.ONE_MINUS_DST_COLOR;if(e===q.SrcAlphaSaturateFactor)return m.SRC_ALPHA_SATURATE;if(null!==(t=K.get("WEBGL_compressed_texture_s3tc"))){if(e===q.RGB_S3TC_DXT1_Format)return t.COMPRESSED_RGB_S3TC_DXT1_EXT;if(e===q.RGBA_S3TC_DXT1_Format)return t.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(e===q.RGBA_S3TC_DXT3_Format)return t.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(e===q.RGBA_S3TC_DXT5_Format)return t.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(null!==(t=K.get("WEBGL_compressed_texture_pvrtc"))){if(e===q.RGB_PVRTC_4BPPV1_Format)return t.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(e===q.RGB_PVRTC_2BPPV1_Format)return t.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(e===q.RGBA_PVRTC_4BPPV1_Format)return t.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(e===q.RGBA_PVRTC_2BPPV1_Format)return t.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(null!==(t=K.get("WEBGL_compressed_texture_etc1"))&&e===q.RGB_ETC1_Format)return t.COMPRESSED_RGB_ETC1_WEBGL;if(null!==(t=K.get("EXT_blend_minmax"))){if(e===q.MinEquation)return t.MIN_EXT;if(e===q.MaxEquation)return t.MAX_EXT}return 0}this.getContext=function(){return m},this.getContextAttributes=function(){return m.getContextAttributes()},this.forceContextLoss=function(){K.get("WEBGL_lose_context").loseContext()},this.getMaxAnisotropy=function(){return X.getMaxAnisotropy()},this.getPrecision=function(){return X.precision},this.getPixelRatio=function(){return R},this.setPixelRatio=function(e){void 0!==e&&(R=e,this.setSize(N.z,N.w,!1))},this.getSize=function(){return{width:L,height:D}},this.setSize=function(e,i,n){L=e,D=i,t.width=e*R,t.height=i*R,!1!==n&&(t.style.width=e+"px",t.style.height=i+"px"),this.setViewport(0,0,e,i)},this.setViewport=function(e,t,i,n){Q.viewport(N.set(e,t,i,n))},this.setScissor=function(e,t,i,n){Q.scissor(k.set(e,t,i,n))},this.setScissorTest=function(e){Q.setScissorTest(O=e)},this.getClearColor=function(){return I},this.setClearColor=function(e,t){I.set(e),P=void 0!==t?t:1,ue(I.r,I.g,I.b,P)},this.getClearAlpha=function(){return P},this.setClearAlpha=function(e){P=e,ue(I.r,I.g,I.b,P)},this.clear=function(e,t,i){var n=0;(void 0===e||e)&&(n|=m.COLOR_BUFFER_BIT),(void 0===t||t)&&(n|=m.DEPTH_BUFFER_BIT),(void 0===i||i)&&(n|=m.STENCIL_BUFFER_BIT),m.clear(n)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.clearTarget=function(e,t,i,n){this.setRenderTarget(e),this.clear(t,i,n)},this.resetGLState=de,this.dispose=function(){d=[],p=-1,u=[],h=-1,t.removeEventListener("webglcontextlost",me,!1)},this.renderBufferImmediate=function(e,t,i){Q.initAttributes();var n=Z.get(e);e.hasPositions&&!n.position&&(n.position=m.createBuffer()),e.hasNormals&&!n.normal&&(n.normal=m.createBuffer()),e.hasUvs&&!n.uv&&(n.uv=m.createBuffer()),e.hasColors&&!n.color&&(n.color=m.createBuffer());var r=t.getAttributes();if(e.hasPositions&&(m.bindBuffer(m.ARRAY_BUFFER,n.position),m.bufferData(m.ARRAY_BUFFER,e.positionArray,m.DYNAMIC_DRAW),Q.enableAttribute(r.position),m.vertexAttribPointer(r.position,3,m.FLOAT,!1,0,0)),e.hasNormals){if(m.bindBuffer(m.ARRAY_BUFFER,n.normal),"MeshPhongMaterial"!==i.type&&"MeshStandardMaterial"!==i.type&&"MeshPhysicalMaterial"!==i.type&&i.shading===q.FlatShading)for(var a=0,o=3*e.count;a<o;a+=9){var s=e.normalArray,l=(s[a+0]+s[a+3]+s[a+6])/3,c=(s[a+1]+s[a+4]+s[a+7])/3,u=(s[a+2]+s[a+5]+s[a+8])/3;s[a+0]=l,s[a+1]=c,s[a+2]=u,s[a+3]=l,s[a+4]=c,s[a+5]=u,s[a+6]=l,s[a+7]=c,s[a+8]=u}m.bufferData(m.ARRAY_BUFFER,e.normalArray,m.DYNAMIC_DRAW),Q.enableAttribute(r.normal),m.vertexAttribPointer(r.normal,3,m.FLOAT,!1,0,0)}e.hasUvs&&i.map&&(m.bindBuffer(m.ARRAY_BUFFER,n.uv),m.bufferData(m.ARRAY_BUFFER,e.uvArray,m.DYNAMIC_DRAW),Q.enableAttribute(r.uv),m.vertexAttribPointer(r.uv,2,m.FLOAT,!1,0,0)),e.hasColors&&i.vertexColors!==q.NoColors&&(m.bindBuffer(m.ARRAY_BUFFER,n.color),m.bufferData(m.ARRAY_BUFFER,e.colorArray,m.DYNAMIC_DRAW),Q.enableAttribute(r.color),m.vertexAttribPointer(r.color,3,m.FLOAT,!1,0,0)),Q.disableUnusedAttributes(),m.drawArrays(m.TRIANGLES,0,e.count),e.count=0},this.renderBufferDirect=function(e,t,i,n,r,a){Ae(n);var o=Ce(e,t,n,r),s=!1,l=i.id+"_"+o.id+"_"+n.wireframe;l!==w&&(w=l,s=!0);var c=r.morphTargetInfluences;if(void 0!==c){for(var u=[],h=0,d=c.length;h<d;h++){var p=c[h];u.push([p,h])}u.sort(be),u.length>8&&(u.length=8);var g=i.morphAttributes;for(h=0,d=u.length;h<d;h++){p=u[h];if(f[h]=p[0],0!==p[0]){var _=p[1];!0===n.morphTargets&&g.position&&i.addAttribute("morphTarget"+h,g.position[_]),!0===n.morphNormals&&g.normal&&i.addAttribute("morphNormal"+h,g.normal[_])}else!0===n.morphTargets&&i.removeAttribute("morphTarget"+h),!0===n.morphNormals&&i.removeAttribute("morphNormal"+h)}o.getUniforms().setValue(m,"morphTargetInfluences",f),s=!0}_=i.index;var v,y=i.attributes.position;!0===n.wireframe&&(_=$.getWireframeAttribute(i)),null!==_?(v=ne).setIndex(_):v=ie,s&&(!function(e,t,i,n){var r;if(i instanceof q.InstancedBufferGeometry&&null===(r=K.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");void 0===n&&(n=0);Q.initAttributes();var a=i.attributes,o=t.getAttributes(),s=e.defaultAttributeValues;for(var l in o){var c=o[l];if(c>=0){var u=a[l];if(void 0!==u){var h=m.FLOAT,d=u.array,p=u.normalized;d instanceof Float32Array?h=m.FLOAT:d instanceof Float64Array?console.warn("Unsupported data buffer format: Float64Array"):d instanceof Uint16Array?h=m.UNSIGNED_SHORT:d instanceof Int16Array?h=m.SHORT:d instanceof Uint32Array?h=m.UNSIGNED_INT:d instanceof Int32Array?h=m.INT:d instanceof Int8Array?h=m.BYTE:d instanceof Uint8Array&&(h=m.UNSIGNED_BYTE);var f=u.itemSize,g=$.getAttributeBuffer(u);if(u instanceof q.InterleavedBufferAttribute){var _=u.data,v=_.stride,y=u.offset;_ instanceof q.InstancedInterleavedBuffer?(Q.enableAttributeAndDivisor(c,_.meshPerAttribute,r),void 0===i.maxInstancedCount&&(i.maxInstancedCount=_.meshPerAttribute*_.count)):Q.enableAttribute(c),m.bindBuffer(m.ARRAY_BUFFER,g),m.vertexAttribPointer(c,f,h,p,v*_.array.BYTES_PER_ELEMENT,(n*v+y)*_.array.BYTES_PER_ELEMENT)}else u instanceof q.InstancedBufferAttribute?(Q.enableAttributeAndDivisor(c,u.meshPerAttribute,r),void 0===i.maxInstancedCount&&(i.maxInstancedCount=u.meshPerAttribute*u.count)):Q.enableAttribute(c),m.bindBuffer(m.ARRAY_BUFFER,g),m.vertexAttribPointer(c,f,h,p,0,n*f*u.array.BYTES_PER_ELEMENT)}else if(void 0!==s){var b=s[l];if(void 0!==b)switch(b.length){case 2:m.vertexAttrib2fv(c,b);break;case 3:m.vertexAttrib3fv(c,b);break;case 4:m.vertexAttrib4fv(c,b);break;default:m.vertexAttrib1fv(c,b)}}}}Q.disableUnusedAttributes()}(n,o,i),null!==_&&m.bindBuffer(m.ELEMENT_ARRAY_BUFFER,$.getAttributeBuffer(_)));var b=1/0;null!==_?b=_.count:void 0!==y&&(b=y.count);var S=i.drawRange.start,E=i.drawRange.count,T=null!==a?a.start:0,M=null!==a?a.count:1/0,A=Math.max(0,S,T),C=Math.min(0+b,S+E,T+M)-1,x=Math.max(0,C-A+1);if(r instanceof q.Mesh)if(!0===n.wireframe)Q.setLineWidth(n.wireframeLinewidth*ce()),v.setMode(m.LINES);else switch(r.drawMode){case q.TrianglesDrawMode:v.setMode(m.TRIANGLES);break;case q.TriangleStripDrawMode:v.setMode(m.TRIANGLE_STRIP);break;case q.TriangleFanDrawMode:v.setMode(m.TRIANGLE_FAN)}else if(r instanceof q.Line){var I=n.linewidth;void 0===I&&(I=1),Q.setLineWidth(I*ce()),r instanceof q.LineSegments?v.setMode(m.LINES):v.setMode(m.LINE_STRIP)}else r instanceof q.Points&&v.setMode(m.POINTS);i instanceof q.InstancedBufferGeometry?i.maxInstancedCount>0&&v.renderInstances(i,A,x):v.render(A,x)},this.render=function(e,t,i,n){if(t instanceof q.Camera!=!1){var r=e.fog;w="",E=-1,T=null,!0===e.autoUpdate&&e.updateMatrixWorld(),null===t.parent&&t.updateMatrixWorld(),t.matrixWorldInverse.getInverse(t.matrixWorld),G.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),F.setFromMatrix(G),c.length=0,h=-1,p=-1,g.length=0,_.length=0,U=this.localClippingEnabled,B=V.init(this.clippingPlanes,U,t),function e(t,i){if(!1===t.visible)return;if(t.layers.test(i.layers))if(t instanceof q.Light)c.push(t);else if(t instanceof q.Sprite)!1!==t.frustumCulled&&!0!==(d=t,H.center.set(0,0,0),H.radius=.7071067811865476,H.applyMatrix4(d.matrixWorld),Te(H))||g.push(t);else if(t instanceof q.LensFlare)_.push(t);else if(t instanceof q.ImmediateRenderObject)!0===v.sortObjects&&(j.setFromMatrixPosition(t.matrixWorld),j.applyProjection(G)),we(t,null,t.material,j.z,null);else if((t instanceof q.Mesh||t instanceof q.Line||t instanceof q.Points)&&(t instanceof q.SkinnedMesh&&t.skeleton.update(),!1===t.frustumCulled||!0===function(e){var t=e.geometry;null===t.boundingSphere&&t.computeBoundingSphere();return H.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),Te(H)}(t))){var n=t.material;if(!0===n.visible){!0===v.sortObjects&&(j.setFromMatrixPosition(t.matrixWorld),j.applyProjection(G));var r=$.update(t);if(n instanceof q.MultiMaterial)for(var a=r.groups,o=n.materials,s=0,l=a.length;s<l;s++){var u=a[s],h=o[u.materialIndex];!0===h.visible&&we(t,r,h,j.z,u)}else we(t,r,n,j.z,null)}}var d;var p=t.children;for(s=0,l=p.length;s<l;s++)e(p[s],i)}(e,t),u.length=h+1,d.length=p+1,!0===v.sortObjects&&(u.sort(Se),d.sort(Ee)),B&&V.beginShadows(),function(e){for(var t=0,i=0,n=e.length;i<n;i++){var r=e[i];r.castShadow&&(z.shadows[t++]=r)}z.shadows.length=t}(c),pe.render(e,t),function(e,t){var i,n,r,a,o,s,l,c=0,u=0,h=0,d=t.matrixWorldInverse,p=0,f=0,g=0,_=0;for(i=0,n=e.length;i<n;i++)if(r=e[i],a=r.color,o=r.intensity,s=r.distance,l=r.shadow&&r.shadow.map?r.shadow.map.texture:null,r instanceof q.AmbientLight)c+=a.r*o,u+=a.g*o,h+=a.b*o;else if(r instanceof q.DirectionalLight){(m=te.get(r)).color.copy(r.color).multiplyScalar(r.intensity),m.direction.setFromMatrixPosition(r.matrixWorld),j.setFromMatrixPosition(r.target.matrixWorld),m.direction.sub(j),m.direction.transformDirection(d),m.shadow=r.castShadow,r.castShadow&&(m.shadowBias=r.shadow.bias,m.shadowRadius=r.shadow.radius,m.shadowMapSize=r.shadow.mapSize),z.directionalShadowMap[p]=l,z.directionalShadowMatrix[p]=r.shadow.matrix,z.directional[p++]=m}else if(r instanceof q.SpotLight){(m=te.get(r)).position.setFromMatrixPosition(r.matrixWorld),m.position.applyMatrix4(d),m.color.copy(a).multiplyScalar(o),m.distance=s,m.direction.setFromMatrixPosition(r.matrixWorld),j.setFromMatrixPosition(r.target.matrixWorld),m.direction.sub(j),m.direction.transformDirection(d),m.coneCos=Math.cos(r.angle),m.penumbraCos=Math.cos(r.angle*(1-r.penumbra)),m.decay=0===r.distance?0:r.decay,m.shadow=r.castShadow,r.castShadow&&(m.shadowBias=r.shadow.bias,m.shadowRadius=r.shadow.radius,m.shadowMapSize=r.shadow.mapSize),z.spotShadowMap[g]=l,z.spotShadowMatrix[g]=r.shadow.matrix,z.spot[g++]=m}else if(r instanceof q.PointLight){(m=te.get(r)).position.setFromMatrixPosition(r.matrixWorld),m.position.applyMatrix4(d),m.color.copy(r.color).multiplyScalar(r.intensity),m.distance=r.distance,m.decay=0===r.distance?0:r.decay,m.shadow=r.castShadow,r.castShadow&&(m.shadowBias=r.shadow.bias,m.shadowRadius=r.shadow.radius,m.shadowMapSize=r.shadow.mapSize),z.pointShadowMap[f]=l,void 0===z.pointShadowMatrix[f]&&(z.pointShadowMatrix[f]=new q.Matrix4),j.setFromMatrixPosition(r.matrixWorld).negate(),z.pointShadowMatrix[f].identity().setPosition(j),z.point[f++]=m}else if(r instanceof q.HemisphereLight){var m;(m=te.get(r)).direction.setFromMatrixPosition(r.matrixWorld),m.direction.transformDirection(d),m.direction.normalize(),m.skyColor.copy(r.color).multiplyScalar(o),m.groundColor.copy(r.groundColor).multiplyScalar(o),z.hemi[_++]=m}z.ambient[0]=c,z.ambient[1]=u,z.ambient[2]=h,z.directional.length=p,z.spot.length=g,z.point.length=f,z.hemi.length=_,z.hash=p+","+f+","+g+","+_+","+z.shadows.length}(c,t),B&&V.endShadows(),W.calls=0,W.vertices=0,W.faces=0,W.points=0,void 0===i&&(i=null),this.setRenderTarget(i);var a=e.background;if(null===a?ue(I.r,I.g,I.b,P):a instanceof q.Color&&ue(a.r,a.g,a.b,1),(this.autoClear||n)&&this.clear(this.autoClearColor,this.autoClearDepth,this.autoClearStencil),a instanceof q.CubeTexture?(ae.projectionMatrix.copy(t.projectionMatrix),ae.matrixWorld.extractRotation(t.matrixWorld),ae.matrixWorldInverse.getInverse(ae.matrixWorld),le.material.uniforms.tCube.value=a,le.modelViewMatrix.multiplyMatrices(ae.matrixWorldInverse,le.matrixWorld),v.renderBufferDirect(ae,null,le.geometry,le.material,le,null)):a instanceof q.Texture&&(oe.material.map=a,v.renderBufferDirect(re,null,oe.geometry,oe.material,oe,null)),e.overrideMaterial){var o=e.overrideMaterial;Me(u,t,r,o),Me(d,t,r,o)}else Q.setBlending(q.NoBlending),Me(u,t,r),Me(d,t,r);ge.render(e,t),_e.render(e,t,C),i&&J.updateRenderTargetMipmap(i),Q.setDepthTest(!0),Q.setDepthWrite(!0),Q.setColorWrite(!0)}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.setFaceCulling=function(e,t){Q.setCullFace(e),Q.setFlipSided(t===q.FrontFaceDirectionCW)},this.allocTextureUnit=function(){var e=x;return e>=X.maxTextures&&console.warn("WebGLRenderer: trying to use "+e+" texture units while this GPU supports only "+X.maxTextures),x+=1,e},this.setTexture2D=(fe=!1,function(e,t){e instanceof q.WebGLRenderTarget&&(fe||(console.warn("THREE.WebGLRenderer.setTexture2D: don't use render targets as textures. Use their .texture property instead."),fe=!0),e=e.texture),J.setTexture2D(e,t)}),this.setTexture=function(){var e=!1;return function(t,i){e||(console.warn("THREE.WebGLRenderer: .setTexture is deprecated, use setTexture2D instead."),e=!0),J.setTexture2D(t,i)}}(),this.setTextureCube=function(){var e=!1;return function(t,i){t instanceof q.WebGLRenderTargetCube&&(e||(console.warn("THREE.WebGLRenderer.setTextureCube: don't use cube render targets as textures. Use their .texture property instead."),e=!0),t=t.texture),t instanceof q.CubeTexture||Array.isArray(t.image)&&6===t.image.length?J.setTextureCube(t,i):J.setTextureCubeDynamic(t,i)}}(),this.getCurrentRenderTarget=function(){return b},this.setRenderTarget=function(e){b=e,e&&void 0===Z.get(e).__webglFramebuffer&&J.setupRenderTarget(e);var t,i=e instanceof q.WebGLRenderTargetCube;if(e){var n=Z.get(e);t=i?n.__webglFramebuffer[e.activeCubeFace]:n.__webglFramebuffer,M.copy(e.scissor),A=e.scissorTest,C.copy(e.viewport)}else t=null,M.copy(k).multiplyScalar(R),A=O,C.copy(N).multiplyScalar(R);if(S!==t&&(m.bindFramebuffer(m.FRAMEBUFFER,t),S=t),Q.scissor(M),Q.setScissorTest(A),Q.viewport(C),i){var r=Z.get(e.texture);m.framebufferTexture2D(m.FRAMEBUFFER,m.COLOR_ATTACHMENT0,m.TEXTURE_CUBE_MAP_POSITIVE_X+e.activeCubeFace,r.__webglTexture,e.activeMipMapLevel)}},this.readRenderTargetPixels=function(e,t,i,n,r,a){if(e instanceof q.WebGLRenderTarget!=!1){var o=Z.get(e).__webglFramebuffer;if(o){var s=!1;o!==S&&(m.bindFramebuffer(m.FRAMEBUFFER,o),s=!0);try{var l=e.texture;if(l.format!==q.RGBAFormat&&Pe(l.format)!==m.getParameter(m.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!(l.type===q.UnsignedByteType||Pe(l.type)===m.getParameter(m.IMPLEMENTATION_COLOR_READ_TYPE)||l.type===q.FloatType&&K.get("WEBGL_color_buffer_float")||l.type===q.HalfFloatType&&K.get("EXT_color_buffer_half_float")))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");m.checkFramebufferStatus(m.FRAMEBUFFER)===m.FRAMEBUFFER_COMPLETE?t>=0&&t<=e.width-n&&i>=0&&i<=e.height-r&&m.readPixels(t,i,n,r,Pe(l.format),Pe(l.type),a):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{s&&m.bindFramebuffer(m.FRAMEBUFFER,S)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")}},q.WebGLRenderTarget=function(e,t,i){this.uuid=q.Math.generateUUID(),this.width=e,this.height=t,this.scissor=new q.Vector4(0,0,e,t),this.scissorTest=!1,this.viewport=new q.Vector4(0,0,e,t),void 0===(i=i||{}).minFilter&&(i.minFilter=q.LinearFilter),this.texture=new q.Texture(void 0,void 0,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.encoding),this.depthBuffer=void 0===i.depthBuffer||i.depthBuffer,this.stencilBuffer=void 0===i.stencilBuffer||i.stencilBuffer,this.depthTexture=null},Object.assign(q.WebGLRenderTarget.prototype,q.EventDispatcher.prototype,{setSize:function(e,t){this.width===e&&this.height===t||(this.width=e,this.height=t,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.width=e.width,this.height=e.height,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),q.WebGLRenderTargetCube=function(e,t,i){q.WebGLRenderTarget.call(this,e,t,i),this.activeCubeFace=0,this.activeMipMapLevel=0},q.WebGLRenderTargetCube.prototype=Object.create(q.WebGLRenderTarget.prototype),q.WebGLRenderTargetCube.prototype.constructor=q.WebGLRenderTargetCube,q.WebGLBufferRenderer=function(e,t,i){var n;this.setMode=function(e){n=e},this.render=function(t,r){e.drawArrays(n,t,r),i.calls++,i.vertices+=r,n===e.TRIANGLES&&(i.faces+=r/3)},this.renderInstances=function(r){var a=t.get("ANGLE_instanced_arrays");if(null!==a){var o=r.attributes.position,s=0;o instanceof q.InterleavedBufferAttribute?(s=o.data.count,a.drawArraysInstancedANGLE(n,0,s,r.maxInstancedCount)):(s=o.count,a.drawArraysInstancedANGLE(n,0,s,r.maxInstancedCount)),i.calls++,i.vertices+=s*r.maxInstancedCount,n===e.TRIANGLES&&(i.faces+=r.maxInstancedCount*s/3)}else console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.")}},q.WebGLClipping=function(){var e=this,t=null,i=0,n=!1,r=!1,a=new q.Plane,o=new q.Matrix3,s={value:null,needsUpdate:!1};function l(){s.value!==t&&(s.value=t,s.needsUpdate=i>0),e.numPlanes=i}function c(t,i,n,r){var l=null!==t?t.length:0,c=null;if(0!==l){if(c=s.value,!0!==r||null===c){var u=n+4*l,h=i.matrixWorldInverse;o.getNormalMatrix(h),(null===c||c.length<u)&&(c=new Float32Array(u));for(var d=0,p=n;d!==l;++d,p+=4)a.copy(t[d]).applyMatrix4(h,o),a.normal.toArray(c,p),c[p+3]=a.constant}s.value=c,s.needsUpdate=!0}return e.numPlanes=l,c}this.uniform=s,this.numPlanes=0,this.init=function(e,r,a){var o=0!==e.length||r||0!==i||n;return n=r,t=c(e,a,0),i=e.length,o},this.beginShadows=function(){r=!0,c(null)},this.endShadows=function(){r=!1,l()},this.setState=function(e,a,o,u,h){if(!n||null===e||0===e.length||r&&!a)r?c(null):l();else{var d=r?0:i,p=4*d,f=u.clippingState||null;s.value=f,f=c(e,o,p,h);for(var g=0;g!==p;++g)f[g]=t[g];u.clippingState=f,this.numPlanes+=d}}},q.WebGLIndexedBufferRenderer=function(e,t,i){var n,r,a;this.setMode=function(e){n=e},this.setIndex=function(i){i.array instanceof Uint32Array&&t.get("OES_element_index_uint")?(r=e.UNSIGNED_INT,a=4):(r=e.UNSIGNED_SHORT,a=2)},this.render=function(t,o){e.drawElements(n,o,r,t*a),i.calls++,i.vertices+=o,n===e.TRIANGLES&&(i.faces+=o/3)},this.renderInstances=function(o,s,l){var c=t.get("ANGLE_instanced_arrays");null!==c?(c.drawElementsInstancedANGLE(n,l,r,s*a,o.maxInstancedCount),i.calls++,i.vertices+=l*o.maxInstancedCount,n===e.TRIANGLES&&(i.faces+=o.maxInstancedCount*l/3)):console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.")}},q.WebGLExtensions=function(e){var t={};this.get=function(i){if(void 0!==t[i])return t[i];var n;switch(i){case"WEBGL_depth_texture":n=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":n=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":n=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":n=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case"WEBGL_compressed_texture_etc1":n=e.getExtension("WEBGL_compressed_texture_etc1");break;default:n=e.getExtension(i)}return null===n&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),t[i]=n,n}},q.WebGLCapabilities=function(e,t,i){var n;function r(t){if("highp"===t){if(e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.HIGH_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.MEDIUM_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}this.getMaxAnisotropy=function(){if(void 0!==n)return n;var i=t.get("EXT_texture_filter_anisotropic");return n=null!==i?e.getParameter(i.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},this.getMaxPrecision=r,this.precision=void 0!==i.precision?i.precision:"highp",this.logarithmicDepthBuffer=void 0!==i.logarithmicDepthBuffer&&i.logarithmicDepthBuffer,this.maxTextures=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),this.maxVertexTextures=e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),this.maxCubemapSize=e.getParameter(e.MAX_CUBE_MAP_TEXTURE_SIZE),this.maxAttributes=e.getParameter(e.MAX_VERTEX_ATTRIBS),this.maxVertexUniforms=e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS),this.maxVaryings=e.getParameter(e.MAX_VARYING_VECTORS),this.maxFragmentUniforms=e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS),this.vertexTextures=this.maxVertexTextures>0,this.floatFragmentTextures=!!t.get("OES_texture_float"),this.floatVertexTextures=this.vertexTextures&&this.floatFragmentTextures;var a=r(this.precision);a!==this.precision&&(console.warn("THREE.WebGLRenderer:",this.precision,"not supported, using",a,"instead."),this.precision=a),this.logarithmicDepthBuffer&&(this.logarithmicDepthBuffer=!!t.get("EXT_frag_depth"))},q.WebGLGeometries=function(e,t,i){var n={};function r(e){var o=e.target,s=n[o.id];null!==s.index&&a(s.index),function(e){for(var t in e)a(e[t])}(s.attributes),o.removeEventListener("dispose",r),delete n[o.id];var l=t.get(o);l.wireframe&&a(l.wireframe),t.delete(o);var c=t.get(s);c.wireframe&&a(c.wireframe),t.delete(s),i.memory.geometries--}function a(i){var n=function(e){return e instanceof q.InterleavedBufferAttribute?t.get(e.data).__webglBuffer:t.get(e).__webglBuffer}(i);void 0!==n&&(e.deleteBuffer(n),function(e){e instanceof q.InterleavedBufferAttribute?t.delete(e.data):t.delete(e)}(i))}this.get=function(e){var t,a=e.geometry;return void 0!==n[a.id]?n[a.id]:(a.addEventListener("dispose",r),a instanceof q.BufferGeometry?t=a:a instanceof q.Geometry&&(void 0===a._bufferGeometry&&(a._bufferGeometry=(new q.BufferGeometry).setFromObject(e)),t=a._bufferGeometry),n[a.id]=t,i.memory.geometries++,t)}},q.WebGLLights=function(){var e={};this.get=function(t){if(void 0!==e[t.id])return e[t.id];var i;switch(t.type){case"DirectionalLight":i={direction:new q.Vector3,color:new q.Color,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new q.Vector2};break;case"SpotLight":i={position:new q.Vector3,direction:new q.Vector3,color:new q.Color,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new q.Vector2};break;case"PointLight":i={position:new q.Vector3,color:new q.Color,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new q.Vector2};break;case"HemisphereLight":i={direction:new q.Vector3,skyColor:new q.Color,groundColor:new q.Color}}return e[t.id]=i,i}},q.WebGLObjects=function(e,t,i){var n=new q.WebGLGeometries(e,t,i);function r(i,n){var r=i instanceof q.InterleavedBufferAttribute?i.data:i,a=t.get(r);void 0===a.__webglBuffer?function(t,i,n){t.__webglBuffer=e.createBuffer(),e.bindBuffer(n,t.__webglBuffer);var r=i.dynamic?e.DYNAMIC_DRAW:e.STATIC_DRAW;e.bufferData(n,i.array,r),t.version=i.version}(a,r,n):a.version!==r.version&&function(t,i,n){e.bindBuffer(n,t.__webglBuffer),!1===i.dynamic||-1===i.updateRange.count?e.bufferSubData(n,0,i.array):0===i.updateRange.count?console.error("THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually."):(e.bufferSubData(n,i.updateRange.offset*i.array.BYTES_PER_ELEMENT,i.array.subarray(i.updateRange.offset,i.updateRange.offset+i.updateRange.count)),i.updateRange.count=0);t.version=i.version}(a,r,n)}function a(e,t,i){if(t>i){var n=t;t=i,i=n}var r=e[t];return void 0===r?(e[t]=[i],!0):-1===r.indexOf(i)&&(r.push(i),!0)}this.getAttributeBuffer=function(e){return e instanceof q.InterleavedBufferAttribute?t.get(e.data).__webglBuffer:t.get(e).__webglBuffer},this.getWireframeAttribute=function(i){var n=t.get(i);if(void 0!==n.wireframe)return n.wireframe;var o,s=[],l=i.index,c=i.attributes,u=c.position;if(null!==l)for(var h={},d=0,p=(o=l.array).length;d<p;d+=3){var f=o[d+0],g=o[d+1],_=o[d+2];a(h,f,g)&&s.push(f,g),a(h,g,_)&&s.push(g,_),a(h,_,f)&&s.push(_,f)}else for(d=0,p=(o=c.position.array).length/3-1;d<p;d+=3){f=d+0,g=d+1,_=d+2;s.push(f,g,g,_,_,f)}var m=u.count>65535?Uint32Array:Uint16Array,v=new q.BufferAttribute(new m(s),1);return r(v,e.ELEMENT_ARRAY_BUFFER),n.wireframe=v,v},this.update=function(t){var i=n.get(t);t.geometry instanceof q.Geometry&&i.updateFromObject(t);var a=i.index,o=i.attributes;for(var s in null!==a&&r(a,e.ELEMENT_ARRAY_BUFFER),o)r(o[s],e.ARRAY_BUFFER);var l=i.morphAttributes;for(var s in l)for(var c=l[s],u=0,h=c.length;u<h;u++)r(c[u],e.ARRAY_BUFFER);return i}},q.WebGLProgram=function(){var e=0;function t(e){switch(e){case q.LinearEncoding:return["Linear","( value )"];case q.sRGBEncoding:return["sRGB","( value )"];case q.RGBEEncoding:return["RGBE","( value )"];case q.RGBM7Encoding:return["RGBM","( value, 7.0 )"];case q.RGBM16Encoding:return["RGBM","( value, 16.0 )"];case q.RGBDEncoding:return["RGBD","( value, 256.0 )"];case q.GammaEncoding:return["Gamma","( value, float( GAMMA_FACTOR ) )"];default:throw new Error("unsupported encoding: "+e)}}function i(e,i){var n=t(i);return"vec4 "+e+"( vec4 value ) { return "+n[0]+"ToLinear"+n[1]+"; }"}function n(e,t){var i;switch(t){case q.LinearToneMapping:i="Linear";break;case q.ReinhardToneMapping:i="Reinhard";break;case q.Uncharted2ToneMapping:i="Uncharted2";break;case q.CineonToneMapping:i="OptimizedCineon";break;default:throw new Error("unsupported toneMapping: "+t)}return"vec3 "+e+"( vec3 color ) { return "+i+"ToneMapping( color ); }"}function r(e){return""!==e}function a(e,t){return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights)}function o(e){return e.replace(/#include +<([\w\d.]+)>/g,(function(e,t){var i=q.ShaderChunk[t];if(void 0===i)throw new Error("Can not resolve #include <"+t+">");return o(i)}))}function s(e){return e.replace(/for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,(function(e,t,i,n){for(var r="",a=parseInt(t);a<parseInt(i);a++)r+=n.replace(/\[ i \]/g,"[ "+a+" ]");return r}))}return function(l,c,u,h){var d=l.context,p=u.extensions,f=u.defines,g=u.__webglShader.vertexShader,_=u.__webglShader.fragmentShader,m="SHADOWMAP_TYPE_BASIC";h.shadowMapType===q.PCFShadowMap?m="SHADOWMAP_TYPE_PCF":h.shadowMapType===q.PCFSoftShadowMap&&(m="SHADOWMAP_TYPE_PCF_SOFT");var v="ENVMAP_TYPE_CUBE",y="ENVMAP_MODE_REFLECTION",b="ENVMAP_BLENDING_MULTIPLY";if(h.envMap){switch(u.envMap.mapping){case q.CubeReflectionMapping:case q.CubeRefractionMapping:v="ENVMAP_TYPE_CUBE";break;case q.CubeUVReflectionMapping:case q.CubeUVRefractionMapping:v="ENVMAP_TYPE_CUBE_UV";break;case q.EquirectangularReflectionMapping:case q.EquirectangularRefractionMapping:v="ENVMAP_TYPE_EQUIREC";break;case q.SphericalReflectionMapping:v="ENVMAP_TYPE_SPHERE"}switch(u.envMap.mapping){case q.CubeRefractionMapping:case q.EquirectangularRefractionMapping:y="ENVMAP_MODE_REFRACTION"}switch(u.combine){case q.MultiplyOperation:b="ENVMAP_BLENDING_MULTIPLY";break;case q.MixOperation:b="ENVMAP_BLENDING_MIX";break;case q.AddOperation:b="ENVMAP_BLENDING_ADD"}}var S,E,w,T,M,A=l.gammaFactor>0?l.gammaFactor:1,C=function(e,t,i){return[(e=e||{}).derivatives||t.envMapCubeUV||t.bumpMap||t.normalMap||t.flatShading?"#extension GL_OES_standard_derivatives : enable":"",(e.fragDepth||t.logarithmicDepthBuffer)&&i.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"",e.drawBuffers&&i.get("WEBGL_draw_buffers")?"#extension GL_EXT_draw_buffers : require":"",(e.shaderTextureLOD||t.envMap)&&i.get("EXT_shader_texture_lod")?"#extension GL_EXT_shader_texture_lod : enable":""].filter(r).join("\n")}(p,h,l.extensions),x=function(e){var t=[];for(var i in e){var n=e[i];!1!==n&&t.push("#define "+i+" "+n)}return t.join("\n")}(f),I=d.createProgram();u instanceof q.RawShaderMaterial?(S=[x].filter(r).join("\n"),E=[x].filter(r).join("\n")):(S=["precision "+h.precision+" float;","precision "+h.precision+" int;","#define SHADER_NAME "+u.__webglShader.name,x,h.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+A,"#define MAX_BONES "+h.maxBones,h.map?"#define USE_MAP":"",h.envMap?"#define USE_ENVMAP":"",h.envMap?"#define "+y:"",h.lightMap?"#define USE_LIGHTMAP":"",h.aoMap?"#define USE_AOMAP":"",h.emissiveMap?"#define USE_EMISSIVEMAP":"",h.bumpMap?"#define USE_BUMPMAP":"",h.normalMap?"#define USE_NORMALMAP":"",h.displacementMap&&h.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",h.specularMap?"#define USE_SPECULARMAP":"",h.roughnessMap?"#define USE_ROUGHNESSMAP":"",h.metalnessMap?"#define USE_METALNESSMAP":"",h.alphaMap?"#define USE_ALPHAMAP":"",h.vertexColors?"#define USE_COLOR":"",h.flatShading?"#define FLAT_SHADED":"",h.skinning?"#define USE_SKINNING":"",h.useVertexTexture?"#define BONE_TEXTURE":"",h.morphTargets?"#define USE_MORPHTARGETS":"",h.morphNormals&&!1===h.flatShading?"#define USE_MORPHNORMALS":"",h.doubleSided?"#define DOUBLE_SIDED":"",h.flipSided?"#define FLIP_SIDED":"","#define NUM_CLIPPING_PLANES "+h.numClippingPlanes,h.shadowMapEnabled?"#define USE_SHADOWMAP":"",h.shadowMapEnabled?"#define "+m:"",h.sizeAttenuation?"#define USE_SIZEATTENUATION":"",h.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",h.logarithmicDepthBuffer&&l.extensions.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(r).join("\n"),E=[C,"precision "+h.precision+" float;","precision "+h.precision+" int;","#define SHADER_NAME "+u.__webglShader.name,x,h.alphaTest?"#define ALPHATEST "+h.alphaTest:"","#define GAMMA_FACTOR "+A,h.useFog&&h.fog?"#define USE_FOG":"",h.useFog&&h.fogExp?"#define FOG_EXP2":"",h.map?"#define USE_MAP":"",h.envMap?"#define USE_ENVMAP":"",h.envMap?"#define "+v:"",h.envMap?"#define "+y:"",h.envMap?"#define "+b:"",h.lightMap?"#define USE_LIGHTMAP":"",h.aoMap?"#define USE_AOMAP":"",h.emissiveMap?"#define USE_EMISSIVEMAP":"",h.bumpMap?"#define USE_BUMPMAP":"",h.normalMap?"#define USE_NORMALMAP":"",h.specularMap?"#define USE_SPECULARMAP":"",h.roughnessMap?"#define USE_ROUGHNESSMAP":"",h.metalnessMap?"#define USE_METALNESSMAP":"",h.alphaMap?"#define USE_ALPHAMAP":"",h.vertexColors?"#define USE_COLOR":"",h.flatShading?"#define FLAT_SHADED":"",h.doubleSided?"#define DOUBLE_SIDED":"",h.flipSided?"#define FLIP_SIDED":"","#define NUM_CLIPPING_PLANES "+h.numClippingPlanes,h.shadowMapEnabled?"#define USE_SHADOWMAP":"",h.shadowMapEnabled?"#define "+m:"",h.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",h.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",h.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",h.logarithmicDepthBuffer&&l.extensions.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"",h.envMap&&l.extensions.get("EXT_shader_texture_lod")?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",h.toneMapping!==q.NoToneMapping?"#define TONE_MAPPING":"",h.toneMapping!==q.NoToneMapping?q.ShaderChunk.tonemapping_pars_fragment:"",h.toneMapping!==q.NoToneMapping?n("toneMapping",h.toneMapping):"",h.outputEncoding||h.mapEncoding||h.envMapEncoding||h.emissiveMapEncoding?q.ShaderChunk.encodings_pars_fragment:"",h.mapEncoding?i("mapTexelToLinear",h.mapEncoding):"",h.envMapEncoding?i("envMapTexelToLinear",h.envMapEncoding):"",h.emissiveMapEncoding?i("emissiveMapTexelToLinear",h.emissiveMapEncoding):"",h.outputEncoding?(w="linearToOutputTexel",T=h.outputEncoding,M=t(T),"vec4 "+w+"( vec4 value ) { return LinearTo"+M[0]+M[1]+"; }"):"",h.depthPacking?"#define DEPTH_PACKING "+u.depthPacking:"","\n"].filter(r).join("\n")),g=a(g=o(g),h),_=a(_=o(_),h),u instanceof q.ShaderMaterial==!1&&(g=s(g),_=s(_));var P=S+g,L=E+_,D=q.WebGLShader(d,d.VERTEX_SHADER,P),R=q.WebGLShader(d,d.FRAGMENT_SHADER,L);d.attachShader(I,D),d.attachShader(I,R),void 0!==u.index0AttributeName?d.bindAttribLocation(I,0,u.index0AttributeName):!0===h.morphTargets&&d.bindAttribLocation(I,0,"position"),d.linkProgram(I);var k,O,N=d.getProgramInfoLog(I),F=d.getShaderInfoLog(D),V=d.getShaderInfoLog(R),B=!0,U=!0;return!1===d.getProgramParameter(I,d.LINK_STATUS)?(B=!1,console.error("THREE.WebGLProgram: shader error: ",d.getError(),"gl.VALIDATE_STATUS",d.getProgramParameter(I,d.VALIDATE_STATUS),"gl.getProgramInfoLog",N,F,V)):""!==N?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",N):""!==F&&""!==V||(U=!1),U&&(this.diagnostics={runnable:B,material:u,programLog:N,vertexShader:{log:F,prefix:S},fragmentShader:{log:V,prefix:E}}),d.deleteShader(D),d.deleteShader(R),this.getUniforms=function(){return void 0===k&&(k=new q.WebGLUniforms(d,I,l)),k},this.getAttributes=function(){return void 0===O&&(O=function(e,t,i){for(var n={},r=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),a=0;a<r;a++){var o=e.getActiveAttrib(t,a).name;n[o]=e.getAttribLocation(t,o)}return n}(d,I)),O},this.destroy=function(){d.deleteProgram(I),this.program=void 0},Object.defineProperties(this,{uniforms:{get:function(){return console.warn("THREE.WebGLProgram: .uniforms is now .getUniforms()."),this.getUniforms()}},attributes:{get:function(){return console.warn("THREE.WebGLProgram: .attributes is now .getAttributes()."),this.getAttributes()}}}),this.id=e++,this.code=c,this.usedTimes=1,this.program=I,this.vertexShader=D,this.fragmentShader=R,this}}(),q.WebGLPrograms=function(e,t){var i=[],n={MeshDepthMaterial:"depth",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points"},r=["precision","supportsVertexTextures","map","mapEncoding","envMap","envMapMode","envMapEncoding","lightMap","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","displacementMap","specularMap","roughnessMap","metalnessMap","alphaMap","combine","vertexColors","fog","useFog","fogExp","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","depthPacking"];function a(e,t){var i;return e?e instanceof q.Texture?i=e.encoding:e instanceof q.WebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),i=e.texture.encoding):i=q.LinearEncoding,i===q.LinearEncoding&&t&&(i=q.GammaEncoding),i}this.getParameters=function(i,r,o,s,l){var c=n[i.type],u=function(e){if(t.floatVertexTextures&&e&&e.skeleton&&e.skeleton.useVertexTexture)return 1024;var i=t.maxVertexUniforms,n=Math.floor((i-20)/4);return void 0!==e&&e instanceof q.SkinnedMesh&&(n=Math.min(e.skeleton.bones.length,n))<e.skeleton.bones.length&&console.warn("WebGLRenderer: too many bones - "+e.skeleton.bones.length+", this GPU supports just "+n+" (try OpenGL instead of ANGLE)"),n}(l),h=e.getPrecision();null!==i.precision&&(h=t.getMaxPrecision(i.precision))!==i.precision&&console.warn("THREE.WebGLProgram.getParameters:",i.precision,"not supported, using",h,"instead.");var d=e.getCurrentRenderTarget();return{shaderID:c,precision:h,supportsVertexTextures:t.vertexTextures,outputEncoding:a(d?d.texture:null,e.gammaOutput),map:!!i.map,mapEncoding:a(i.map,e.gammaInput),envMap:!!i.envMap,envMapMode:i.envMap&&i.envMap.mapping,envMapEncoding:a(i.envMap,e.gammaInput),envMapCubeUV:!!i.envMap&&(i.envMap.mapping===q.CubeUVReflectionMapping||i.envMap.mapping===q.CubeUVRefractionMapping),lightMap:!!i.lightMap,aoMap:!!i.aoMap,emissiveMap:!!i.emissiveMap,emissiveMapEncoding:a(i.emissiveMap,e.gammaInput),bumpMap:!!i.bumpMap,normalMap:!!i.normalMap,displacementMap:!!i.displacementMap,roughnessMap:!!i.roughnessMap,metalnessMap:!!i.metalnessMap,specularMap:!!i.specularMap,alphaMap:!!i.alphaMap,combine:i.combine,vertexColors:i.vertexColors,fog:o,useFog:i.fog,fogExp:o instanceof q.FogExp2,flatShading:i.shading===q.FlatShading,sizeAttenuation:i.sizeAttenuation,logarithmicDepthBuffer:t.logarithmicDepthBuffer,skinning:i.skinning,maxBones:u,useVertexTexture:t.floatVertexTextures&&l&&l.skeleton&&l.skeleton.useVertexTexture,morphTargets:i.morphTargets,morphNormals:i.morphNormals,maxMorphTargets:e.maxMorphTargets,maxMorphNormals:e.maxMorphNormals,numDirLights:r.directional.length,numPointLights:r.point.length,numSpotLights:r.spot.length,numHemiLights:r.hemi.length,numClippingPlanes:s,shadowMapEnabled:e.shadowMap.enabled&&l.receiveShadow&&r.shadows.length>0,shadowMapType:e.shadowMap.type,toneMapping:e.toneMapping,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:i.premultipliedAlpha,alphaTest:i.alphaTest,doubleSided:i.side===q.DoubleSide,flipSided:i.side===q.BackSide,depthPacking:void 0!==i.depthPacking&&i.depthPacking}},this.getProgramCode=function(e,t){var i=[];if(t.shaderID?i.push(t.shaderID):(i.push(e.fragmentShader),i.push(e.vertexShader)),void 0!==e.defines)for(var n in e.defines)i.push(n),i.push(e.defines[n]);for(var a=0;a<r.length;a++)i.push(t[r[a]]);return i.join()},this.acquireProgram=function(t,n,r){for(var a,o=0,s=i.length;o<s;o++){var l=i[o];if(l.code===r){++(a=l).usedTimes;break}}return void 0===a&&(a=new q.WebGLProgram(e,r,t,n),i.push(a)),a},this.releaseProgram=function(e){if(0==--e.usedTimes){var t=i.indexOf(e);i[t]=i[i.length-1],i.pop(),e.destroy()}},this.programs=i},q.WebGLProperties=function(){var e={};this.get=function(t){var i=t.uuid,n=e[i];return void 0===n&&(n={},e[i]=n),n},this.delete=function(t){delete e[t.uuid]},this.clear=function(){e={}}},q.WebGLShader=function(e,t,i){var n=e.createShader(t);return e.shaderSource(n,i),e.compileShader(n),!1===e.getShaderParameter(n,e.COMPILE_STATUS)&&console.error("THREE.WebGLShader: Shader couldn't compile."),""!==e.getShaderInfoLog(n)&&console.warn("THREE.WebGLShader: gl.getShaderInfoLog()",t===e.VERTEX_SHADER?"vertex":"fragment",e.getShaderInfoLog(n),function(e){for(var t=e.split("\n"),i=0;i<t.length;i++)t[i]=i+1+": "+t[i];return t.join("\n")}(i)),n},q.WebGLShadowMap=function(e,t,i){var n=e.context,r=e.state,a=new q.Frustum,o=new q.Matrix4,s=t.shadows,l=new q.Vector2,c=new q.Vector3,u=new q.Vector3,h=[],d=new Array(4),p=new Array(4),f={},g=[new q.Vector3(1,0,0),new q.Vector3(-1,0,0),new q.Vector3(0,0,1),new q.Vector3(0,0,-1),new q.Vector3(0,1,0),new q.Vector3(0,-1,0)],_=[new q.Vector3(0,1,0),new q.Vector3(0,1,0),new q.Vector3(0,1,0),new q.Vector3(0,1,0),new q.Vector3(0,0,1),new q.Vector3(0,0,-1)],m=[new q.Vector4,new q.Vector4,new q.Vector4,new q.Vector4,new q.Vector4,new q.Vector4],v=new q.MeshDepthMaterial;v.depthPacking=q.RGBADepthPacking,v.clipping=!0;for(var y=q.ShaderLib.distanceRGBA,b=q.UniformsUtils.clone(y.uniforms),S=0;4!==S;++S){var E=0!=(1&S),w=0!=(2&S),T=v.clone();T.morphTargets=E,T.skinning=w,d[S]=T;var M=new q.ShaderMaterial({defines:{USE_SHADOWMAP:""},uniforms:b,vertexShader:y.vertexShader,fragmentShader:y.fragmentShader,morphTargets:E,skinning:w,clipping:!0});p[S]=M}var A=this;function C(t,i,n,r){var a=t.geometry,o=null,s=d,l=t.customDepthMaterial;if(n&&(s=p,l=t.customDistanceMaterial),l)o=l;else{var c=0;void 0!==a.morphTargets&&a.morphTargets.length>0&&i.morphTargets&&(c|=1),t instanceof q.SkinnedMesh&&i.skinning&&(c|=2),o=s[c]}if(e.localClippingEnabled&&!0===i.clipShadows&&0!==i.clippingPlanes.length){var u=o.uuid,h=i.uuid,g=f[u];void 0===g&&(g={},f[u]=g);var _=g[h];void 0===_&&(_=o.clone(),g[h]=_),o=_}o.visible=i.visible,o.wireframe=i.wireframe;var m=i.side;return A.renderSingleSided&&m==q.DoubleSide&&(m=q.FrontSide),A.renderReverseSided&&(m===q.FrontSide?m=q.BackSide:m===q.BackSide&&(m=q.FrontSide)),o.side=m,o.clipShadows=i.clipShadows,o.clippingPlanes=i.clippingPlanes,o.wireframeLinewidth=i.wireframeLinewidth,o.linewidth=i.linewidth,n&&void 0!==o.uniforms.lightPos&&o.uniforms.lightPos.value.copy(r),o}function x(e,t,i){if(!1!==e.visible){if(e.layers.test(t.layers)&&(e instanceof q.Mesh||e instanceof q.Line||e instanceof q.Points))if(e.castShadow&&(!1===e.frustumCulled||!0===a.intersectsObject(e)))!0===e.material.visible&&(e.modelViewMatrix.multiplyMatrices(i.matrixWorldInverse,e.matrixWorld),h.push(e));for(var n=e.children,r=0,o=n.length;r<o;r++)x(n[r],t,i)}}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=q.PCFShadowMap,this.renderReverseSided=!0,this.renderSingleSided=!0,this.render=function(t,d){if(!1!==A.enabled&&(!1!==A.autoUpdate||!1!==A.needsUpdate)&&0!==s.length){var p,f;r.clearColor(1,1,1,1),r.disable(n.BLEND),r.setDepthTest(!0),r.setScissorTest(!1);for(var v=0,y=s.length;v<y;v++){var b=s[v],S=b.shadow;if(void 0!==S){var E=S.camera;if(l.copy(S.mapSize),b instanceof q.PointLight){p=6,f=!0;var w=l.x,T=l.y;m[0].set(2*w,T,w,T),m[1].set(0,T,w,T),m[2].set(3*w,T,w,T),m[3].set(w,T,w,T),m[4].set(3*w,0,w,T),m[5].set(w,0,w,T),l.x*=4,l.y*=2}else p=1,f=!1;if(null===S.map){var M={minFilter:q.NearestFilter,magFilter:q.NearestFilter,format:q.RGBAFormat};S.map=new q.WebGLRenderTarget(l.x,l.y,M),E.updateProjectionMatrix()}S instanceof q.SpotLightShadow&&S.update(b);var I=S.map,P=S.matrix;u.setFromMatrixPosition(b.matrixWorld),E.position.copy(u),e.setRenderTarget(I),e.clear();for(var L=0;L<p;L++){if(f){c.copy(E.position),c.add(g[L]),E.up.copy(_[L]),E.lookAt(c);var D=m[L];r.viewport(D)}else c.setFromMatrixPosition(b.target.matrixWorld),E.lookAt(c);E.updateMatrixWorld(),E.matrixWorldInverse.getInverse(E.matrixWorld),P.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),P.multiply(E.projectionMatrix),P.multiply(E.matrixWorldInverse),o.multiplyMatrices(E.projectionMatrix,E.matrixWorldInverse),a.setFromMatrix(o),h.length=0,x(t,d,E);for(var R=0,k=h.length;R<k;R++){var O=h[R],N=i.update(O),F=O.material;if(F instanceof q.MultiMaterial)for(var V=N.groups,B=F.materials,U=0,H=V.length;U<H;U++){var G=V[U],j=B[G.materialIndex];if(!0===j.visible){var z=C(O,j,f,u);e.renderBufferDirect(E,null,N,z,O,G)}}else{z=C(O,F,f,u);e.renderBufferDirect(E,null,N,z,O,null)}}}}else console.warn("THREE.WebGLShadowMap:",b,"has no shadow.")}var W=e.getClearColor(),Y=e.getClearAlpha();e.setClearColor(W,Y),A.needsUpdate=!1}}},q.WebGLState=function(e,t,i){var n=this;this.buffers={color:new q.WebGLColorBuffer(e,this),depth:new q.WebGLDepthBuffer(e,this),stencil:new q.WebGLStencilBuffer(e,this)};var r=e.getParameter(e.MAX_VERTEX_ATTRIBS),a=new Uint8Array(r),o=new Uint8Array(r),s=new Uint8Array(r),l={},c=null,u=null,h=null,d=null,p=null,f=null,g=null,_=null,m=!1,v=null,y=null,b=null,S=null,E=null,w=null,T=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),M=null,A={},C=new q.Vector4,x=new q.Vector4;function I(t,i,n){var r=new Uint8Array(4),a=e.createTexture();e.bindTexture(t,a),e.texParameteri(t,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(t,e.TEXTURE_MAG_FILTER,e.NEAREST);for(var o=0;o<n;o++)e.texImage2D(i+o,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,r);return a}var P={};P[e.TEXTURE_2D]=I(e.TEXTURE_2D,e.TEXTURE_2D,1),P[e.TEXTURE_CUBE_MAP]=I(e.TEXTURE_CUBE_MAP,e.TEXTURE_CUBE_MAP_POSITIVE_X,6),this.init=function(){this.clearColor(0,0,0,1),this.clearDepth(1),this.clearStencil(0),this.enable(e.DEPTH_TEST),this.setDepthFunc(q.LessEqualDepth),this.setFlipSided(!1),this.setCullFace(q.CullFaceBack),this.enable(e.CULL_FACE),this.enable(e.BLEND),this.setBlending(q.NormalBlending)},this.initAttributes=function(){for(var e=0,t=a.length;e<t;e++)a[e]=0},this.enableAttribute=function(i){(a[i]=1,0===o[i]&&(e.enableVertexAttribArray(i),o[i]=1),0!==s[i])&&(t.get("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(i,0),s[i]=0)},this.enableAttributeAndDivisor=function(t,i,n){a[t]=1,0===o[t]&&(e.enableVertexAttribArray(t),o[t]=1),s[t]!==i&&(n.vertexAttribDivisorANGLE(t,i),s[t]=i)},this.disableUnusedAttributes=function(){for(var t=0,i=o.length;t!==i;++t)o[t]!==a[t]&&(e.disableVertexAttribArray(t),o[t]=0)},this.enable=function(t){!0!==l[t]&&(e.enable(t),l[t]=!0)},this.disable=function(t){!1!==l[t]&&(e.disable(t),l[t]=!1)},this.getCompressedTextureFormats=function(){if(null===c&&(c=[],t.get("WEBGL_compressed_texture_pvrtc")||t.get("WEBGL_compressed_texture_s3tc")||t.get("WEBGL_compressed_texture_etc1")))for(var i=e.getParameter(e.COMPRESSED_TEXTURE_FORMATS),n=0;n<i.length;n++)c.push(i[n]);return c},this.setBlending=function(t,n,r,a,o,s,l,c){if(t===q.NoBlending)return this.disable(e.BLEND),void(u=t);this.enable(e.BLEND),t===u&&c===m||(t===q.AdditiveBlending?c?(e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD),e.blendFuncSeparate(e.ONE,e.ONE,e.ONE,e.ONE)):(e.blendEquation(e.FUNC_ADD),e.blendFunc(e.SRC_ALPHA,e.ONE)):t===q.SubtractiveBlending?c?(e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD),e.blendFuncSeparate(e.ZERO,e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ONE_MINUS_SRC_ALPHA)):(e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ZERO,e.ONE_MINUS_SRC_COLOR)):t===q.MultiplyBlending?c?(e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD),e.blendFuncSeparate(e.ZERO,e.SRC_COLOR,e.ZERO,e.SRC_ALPHA)):(e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ZERO,e.SRC_COLOR)):c?(e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD),e.blendFuncSeparate(e.ONE,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA)):(e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD),e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA)),u=t,m=c),t===q.CustomBlending?(o=o||n,s=s||r,l=l||a,n===h&&o===f||(e.blendEquationSeparate(i(n),i(o)),h=n,f=o),r===d&&a===p&&s===g&&l===_||(e.blendFuncSeparate(i(r),i(a),i(s),i(l)),d=r,p=a,g=s,_=l)):(h=null,d=null,p=null,f=null,g=null,_=null)},this.setColorWrite=function(e){this.buffers.color.setMask(e)},this.setDepthTest=function(e){this.buffers.depth.setTest(e)},this.setDepthWrite=function(e){this.buffers.depth.setMask(e)},this.setDepthFunc=function(e){this.buffers.depth.setFunc(e)},this.setStencilTest=function(e){this.buffers.stencil.setTest(e)},this.setStencilWrite=function(e){this.buffers.stencil.setMask(e)},this.setStencilFunc=function(e,t,i){this.buffers.stencil.setFunc(e,t,i)},this.setStencilOp=function(e,t,i){this.buffers.stencil.setOp(e,t,i)},this.setFlipSided=function(t){v!==t&&(t?e.frontFace(e.CW):e.frontFace(e.CCW),v=t)},this.setCullFace=function(t){t!==q.CullFaceNone?(this.enable(e.CULL_FACE),t!==y&&(t===q.CullFaceBack?e.cullFace(e.BACK):t===q.CullFaceFront?e.cullFace(e.FRONT):e.cullFace(e.FRONT_AND_BACK))):this.disable(e.CULL_FACE),y=t},this.setLineWidth=function(t){t!==b&&(e.lineWidth(t),b=t)},this.setPolygonOffset=function(t,i,n){t?(this.enable(e.POLYGON_OFFSET_FILL),S===i&&E===n||(e.polygonOffset(i,n),S=i,E=n)):this.disable(e.POLYGON_OFFSET_FILL)},this.getScissorTest=function(){return w},this.setScissorTest=function(t){w=t,t?this.enable(e.SCISSOR_TEST):this.disable(e.SCISSOR_TEST)},this.activeTexture=function(t){void 0===t&&(t=e.TEXTURE0+T-1),M!==t&&(e.activeTexture(t),M=t)},this.bindTexture=function(t,i){null===M&&n.activeTexture();var r=A[M];void 0===r&&(r={type:void 0,texture:void 0},A[M]=r),r.type===t&&r.texture===i||(e.bindTexture(t,i||P[t]),r.type=t,r.texture=i)},this.compressedTexImage2D=function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(e){console.error(e)}},this.texImage2D=function(){try{e.texImage2D.apply(e,arguments)}catch(e){console.error(e)}},this.clearColor=function(e,t,i,n){this.buffers.color.setClear(e,t,i,n)},this.clearDepth=function(e){this.buffers.depth.setClear(e)},this.clearStencil=function(e){this.buffers.stencil.setClear(e)},this.scissor=function(t){!1===C.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),C.copy(t))},this.viewport=function(t){!1===x.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),x.copy(t))},this.reset=function(){for(var t=0;t<o.length;t++)1===o[t]&&(e.disableVertexAttribArray(t),o[t]=0);l={},c=null,M=null,A={},u=null,v=null,y=null,this.buffers.color.reset(),this.buffers.depth.reset(),this.buffers.stencil.reset()}},q.WebGLColorBuffer=function(e,t){var i=!1,n=new q.Vector4,r=null,a=new q.Vector4;this.setMask=function(t){r===t||i||(e.colorMask(t,t,t,t),r=t)},this.setLocked=function(e){i=e},this.setClear=function(t,i,r,o){n.set(t,i,r,o),!1===a.equals(n)&&(e.clearColor(t,i,r,o),a.copy(n))},this.reset=function(){i=!1,r=null,a=new q.Vector4}},q.WebGLDepthBuffer=function(e,t){var i=!1,n=null,r=null,a=null;this.setTest=function(i){i?t.enable(e.DEPTH_TEST):t.disable(e.DEPTH_TEST)},this.setMask=function(t){n===t||i||(e.depthMask(t),n=t)},this.setFunc=function(t){if(r!==t){if(t)switch(t){case q.NeverDepth:e.depthFunc(e.NEVER);break;case q.AlwaysDepth:e.depthFunc(e.ALWAYS);break;case q.LessDepth:e.depthFunc(e.LESS);break;case q.LessEqualDepth:e.depthFunc(e.LEQUAL);break;case q.EqualDepth:e.depthFunc(e.EQUAL);break;case q.GreaterEqualDepth:e.depthFunc(e.GEQUAL);break;case q.GreaterDepth:e.depthFunc(e.GREATER);break;case q.NotEqualDepth:e.depthFunc(e.NOTEQUAL);break;default:e.depthFunc(e.LEQUAL)}else e.depthFunc(e.LEQUAL);r=t}},this.setLocked=function(e){i=e},this.setClear=function(t){a!==t&&(e.clearDepth(t),a=t)},this.reset=function(){i=!1,n=null,r=null,a=null}},q.WebGLStencilBuffer=function(e,t){var i=!1,n=null,r=null,a=null,o=null,s=null,l=null,c=null,u=null;this.setTest=function(i){i?t.enable(e.STENCIL_TEST):t.disable(e.STENCIL_TEST)},this.setMask=function(t){n===t||i||(e.stencilMask(t),n=t)},this.setFunc=function(t,i,n){r===t&&a===i&&o===n||(e.stencilFunc(t,i,n),r=t,a=i,o=n)},this.setOp=function(t,i,n){s===t&&l===i&&c===n||(e.stencilOp(t,i,n),s=t,l=i,c=n)},this.setLocked=function(e){i=e},this.setClear=function(t){u!==t&&(e.clearStencil(t),u=t)},this.reset=function(){i=!1,n=null,r=null,a=null,o=null,s=null,l=null,c=null,u=null}},q.WebGLTextures=function(e,t,i,n,r,a,o){var s=o.memory,l="undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext;function c(e,t){if(e.width>t||e.height>t){var i=t/Math.max(e.width,e.height),n=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");return n.width=Math.floor(e.width*i),n.height=Math.floor(e.height*i),n.getContext("2d").drawImage(e,0,0,e.width,e.height,0,0,n.width,n.height),console.warn("THREE.WebGLRenderer: image is too big ("+e.width+"x"+e.height+"). Resized to "+n.width+"x"+n.height,e),n}return e}function u(e){return q.Math.isPowerOfTwo(e.width)&&q.Math.isPowerOfTwo(e.height)}function h(t){return t===q.NearestFilter||t===q.NearestMipMapNearestFilter||t===q.NearestMipMapLinearFilter?e.NEAREST:e.LINEAR}function d(t){var i=t.target;i.removeEventListener("dispose",d),function(t){var i=n.get(t);if(t.image&&i.__image__webglTextureCube)e.deleteTexture(i.__image__webglTextureCube);else{if(void 0===i.__webglInit)return;e.deleteTexture(i.__webglTexture)}n.delete(t)}(i),s.textures--}function p(t){var i=t.target;i.removeEventListener("dispose",p),function(t){var i=n.get(t),r=n.get(t.texture);if(!t)return;void 0!==r.__webglTexture&&e.deleteTexture(r.__webglTexture);t.depthTexture&&t.depthTexture.dispose();if(t instanceof q.WebGLRenderTargetCube)for(var a=0;a<6;a++)e.deleteFramebuffer(i.__webglFramebuffer[a]),i.__webglDepthbuffer&&e.deleteRenderbuffer(i.__webglDepthbuffer[a]);else e.deleteFramebuffer(i.__webglFramebuffer),i.__webglDepthbuffer&&e.deleteRenderbuffer(i.__webglDepthbuffer);n.delete(t.texture),n.delete(t)}(i),s.textures--}function f(t,o){var h=n.get(t);if(t.version>0&&h.__version!==t.version){var p=t.image;if(void 0===p)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined",t);else{if(!1!==p.complete)return void function(t,n,o){void 0===t.__webglInit&&(t.__webglInit=!0,n.addEventListener("dispose",d),t.__webglTexture=e.createTexture(),s.textures++);i.activeTexture(e.TEXTURE0+o),i.bindTexture(e.TEXTURE_2D,t.__webglTexture),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,n.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,n.unpackAlignment);var h=c(n.image,r.maxTextureSize);(function(e){return e.wrapS!==q.ClampToEdgeWrapping||e.wrapT!==q.ClampToEdgeWrapping||e.minFilter!==q.NearestFilter&&e.minFilter!==q.LinearFilter})(n)&&!1===u(h)&&(h=function(e){if(e instanceof HTMLImageElement||e instanceof HTMLCanvasElement){var t=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");return t.width=q.Math.nearestPowerOfTwo(e.width),t.height=q.Math.nearestPowerOfTwo(e.height),t.getContext("2d").drawImage(e,0,0,t.width,t.height),console.warn("THREE.WebGLRenderer: image is not power of two ("+e.width+"x"+e.height+"). Resized to "+t.width+"x"+t.height,e),t}return e}(h));var p=u(h),f=a(n.format),_=a(n.type);g(e.TEXTURE_2D,n,p);var m,v=n.mipmaps;if(n instanceof q.DepthTexture){var y=e.DEPTH_COMPONENT;if(n.type===q.FloatType){if(!l)throw new Error("Float Depth Texture only supported in WebGL2.0");y=e.DEPTH_COMPONENT32F}else l&&(y=e.DEPTH_COMPONENT16);i.texImage2D(e.TEXTURE_2D,0,y,h.width,h.height,0,f,_,null)}else if(n instanceof q.DataTexture)if(v.length>0&&p){for(var b=0,S=v.length;b<S;b++)m=v[b],i.texImage2D(e.TEXTURE_2D,b,f,m.width,m.height,0,f,_,m.data);n.generateMipmaps=!1}else i.texImage2D(e.TEXTURE_2D,0,f,h.width,h.height,0,f,_,h.data);else if(n instanceof q.CompressedTexture)for(b=0,S=v.length;b<S;b++)m=v[b],n.format!==q.RGBAFormat&&n.format!==q.RGBFormat?i.getCompressedTextureFormats().indexOf(f)>-1?i.compressedTexImage2D(e.TEXTURE_2D,b,f,m.width,m.height,0,m.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):i.texImage2D(e.TEXTURE_2D,b,f,m.width,m.height,0,f,_,m.data);else if(v.length>0&&p){for(b=0,S=v.length;b<S;b++)m=v[b],i.texImage2D(e.TEXTURE_2D,b,f,f,_,m);n.generateMipmaps=!1}else i.texImage2D(e.TEXTURE_2D,0,f,f,_,h);n.generateMipmaps&&p&&e.generateMipmap(e.TEXTURE_2D);t.__version=n.version,n.onUpdate&&n.onUpdate(n)}(h,t,o);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete",t)}}i.activeTexture(e.TEXTURE0+o),i.bindTexture(e.TEXTURE_2D,h.__webglTexture)}function g(i,o,s){var l;if(s?(e.texParameteri(i,e.TEXTURE_WRAP_S,a(o.wrapS)),e.texParameteri(i,e.TEXTURE_WRAP_T,a(o.wrapT)),e.texParameteri(i,e.TEXTURE_MAG_FILTER,a(o.magFilter)),e.texParameteri(i,e.TEXTURE_MIN_FILTER,a(o.minFilter))):(e.texParameteri(i,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(i,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),o.wrapS===q.ClampToEdgeWrapping&&o.wrapT===q.ClampToEdgeWrapping||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping.",o),e.texParameteri(i,e.TEXTURE_MAG_FILTER,h(o.magFilter)),e.texParameteri(i,e.TEXTURE_MIN_FILTER,h(o.minFilter)),o.minFilter!==q.NearestFilter&&o.minFilter!==q.LinearFilter&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.",o)),l=t.get("EXT_texture_filter_anisotropic")){if(o.type===q.FloatType&&null===t.get("OES_texture_float_linear"))return;if(o.type===q.HalfFloatType&&null===t.get("OES_texture_half_float_linear"))return;(o.anisotropy>1||n.get(o).__currentAnisotropy)&&(e.texParameterf(i,l.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(o.anisotropy,r.getMaxAnisotropy())),n.get(o).__currentAnisotropy=o.anisotropy)}}function _(t,r,o,s){var l=a(r.texture.format),c=a(r.texture.type);i.texImage2D(s,0,l,r.width,r.height,0,l,c,null),e.bindFramebuffer(e.FRAMEBUFFER,t),e.framebufferTexture2D(e.FRAMEBUFFER,o,s,n.get(r.texture).__webglTexture,0),e.bindFramebuffer(e.FRAMEBUFFER,null)}function m(t,i){e.bindRenderbuffer(e.RENDERBUFFER,t),i.depthBuffer&&!i.stencilBuffer?(e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT16,i.width,i.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,t)):i.depthBuffer&&i.stencilBuffer?(e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,i.width,i.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,t)):e.renderbufferStorage(e.RENDERBUFFER,e.RGBA4,i.width,i.height),e.bindRenderbuffer(e.RENDERBUFFER,null)}function v(t){var i=n.get(t),r=t instanceof q.WebGLRenderTargetCube;if(t.depthTexture){if(r)throw new Error("target.depthTexture not supported in Cube render targets");!function(t,i){if(i instanceof q.WebGLRenderTargetCube)throw new Error("Depth Texture with cube render targets is not supported!");if(e.bindFramebuffer(e.FRAMEBUFFER,t),!(i.depthTexture instanceof q.DepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");n.get(i.depthTexture).__webglTexture&&i.depthTexture.image.width===i.width&&i.depthTexture.image.height===i.height||(i.depthTexture.image.width=i.width,i.depthTexture.image.height=i.height,i.depthTexture.needsUpdate=!0),f(i.depthTexture,0);var r=n.get(i.depthTexture).__webglTexture;e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,r,0)}(i.__webglFramebuffer,t)}else if(r){i.__webglDepthbuffer=[];for(var a=0;a<6;a++)e.bindFramebuffer(e.FRAMEBUFFER,i.__webglFramebuffer[a]),i.__webglDepthbuffer[a]=e.createRenderbuffer(),m(i.__webglDepthbuffer[a],t)}else e.bindFramebuffer(e.FRAMEBUFFER,i.__webglFramebuffer),i.__webglDepthbuffer=e.createRenderbuffer(),m(i.__webglDepthbuffer,t);e.bindFramebuffer(e.FRAMEBUFFER,null)}this.setTexture2D=f,this.setTextureCube=function(t,o){var l=n.get(t);if(6===t.image.length)if(t.version>0&&l.__version!==t.version){l.__image__webglTextureCube||(t.addEventListener("dispose",d),l.__image__webglTextureCube=e.createTexture(),s.textures++),i.activeTexture(e.TEXTURE0+o),i.bindTexture(e.TEXTURE_CUBE_MAP,l.__image__webglTextureCube),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,t.flipY);for(var h=t instanceof q.CompressedTexture,p=t.image[0]instanceof q.DataTexture,f=[],_=0;_<6;_++)f[_]=h||p?p?t.image[_].image:t.image[_]:c(t.image[_],r.maxCubemapSize);var m=u(f[0]),v=a(t.format),y=a(t.type);g(e.TEXTURE_CUBE_MAP,t,m);for(_=0;_<6;_++)if(h)for(var b,S=f[_].mipmaps,E=0,w=S.length;E<w;E++)b=S[E],t.format!==q.RGBAFormat&&t.format!==q.RGBFormat?i.getCompressedTextureFormats().indexOf(v)>-1?i.compressedTexImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+_,E,v,b.width,b.height,0,b.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):i.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+_,E,v,b.width,b.height,0,v,y,b.data);else p?i.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+_,0,v,f[_].width,f[_].height,0,v,y,f[_].data):i.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+_,0,v,v,y,f[_]);t.generateMipmaps&&m&&e.generateMipmap(e.TEXTURE_CUBE_MAP),l.__version=t.version,t.onUpdate&&t.onUpdate(t)}else i.activeTexture(e.TEXTURE0+o),i.bindTexture(e.TEXTURE_CUBE_MAP,l.__image__webglTextureCube)},this.setTextureCubeDynamic=function(t,r){i.activeTexture(e.TEXTURE0+r),i.bindTexture(e.TEXTURE_CUBE_MAP,n.get(t).__webglTexture)},this.setupRenderTarget=function(t){var r=n.get(t),a=n.get(t.texture);t.addEventListener("dispose",p),a.__webglTexture=e.createTexture(),s.textures++;var o=t instanceof q.WebGLRenderTargetCube,l=u(t);if(o){r.__webglFramebuffer=[];for(var c=0;c<6;c++)r.__webglFramebuffer[c]=e.createFramebuffer()}else r.__webglFramebuffer=e.createFramebuffer();if(o){i.bindTexture(e.TEXTURE_CUBE_MAP,a.__webglTexture),g(e.TEXTURE_CUBE_MAP,t.texture,l);for(c=0;c<6;c++)_(r.__webglFramebuffer[c],t,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+c);t.texture.generateMipmaps&&l&&e.generateMipmap(e.TEXTURE_CUBE_MAP),i.bindTexture(e.TEXTURE_CUBE_MAP,null)}else i.bindTexture(e.TEXTURE_2D,a.__webglTexture),g(e.TEXTURE_2D,t.texture,l),_(r.__webglFramebuffer,t,e.COLOR_ATTACHMENT0,e.TEXTURE_2D),t.texture.generateMipmaps&&l&&e.generateMipmap(e.TEXTURE_2D),i.bindTexture(e.TEXTURE_2D,null);t.depthBuffer&&v(t)},this.updateRenderTargetMipmap=function(t){var r=t.texture;if(r.generateMipmaps&&u(t)&&r.minFilter!==q.NearestFilter&&r.minFilter!==q.LinearFilter){var a=t instanceof q.WebGLRenderTargetCube?e.TEXTURE_CUBE_MAP:e.TEXTURE_2D,o=n.get(r).__webglTexture;i.bindTexture(a,o),e.generateMipmap(a),i.bindTexture(a,null)}}},q.WebGLUniforms=function(){var e=new q.Texture,t=new q.CubeTexture,i=function(){this.seq=[],this.map={}},n=[],r=[],a=function(e,t,i){var r=e[0];if(r<=0||r>0)return e;var a=t*i,o=n[a];if(void 0===o&&(o=new Float32Array(a),n[a]=o),0!==t){r.toArray(o,0);for(var s=1,l=0;s!==t;++s)l+=i,e[s].toArray(o,l)}return o},o=function(e,t){var i=r[t];void 0===i&&(i=new Int32Array(t),r[t]=i);for(var n=0;n!==t;++n)i[n]=e.allocTextureUnit();return i},s=function(e,t){e.uniform1f(this.addr,t)},l=function(e,t){e.uniform1i(this.addr,t)},c=function(e,t){void 0===t.x?e.uniform2fv(this.addr,t):e.uniform2f(this.addr,t.x,t.y)},u=function(e,t){void 0!==t.x?e.uniform3f(this.addr,t.x,t.y,t.z):void 0!==t.r?e.uniform3f(this.addr,t.r,t.g,t.b):e.uniform3fv(this.addr,t)},h=function(e,t){void 0===t.x?e.uniform4fv(this.addr,t):e.uniform4f(this.addr,t.x,t.y,t.z,t.w)},d=function(e,t){e.uniformMatrix2fv(this.addr,!1,t.elements||t)},p=function(e,t){e.uniformMatrix3fv(this.addr,!1,t.elements||t)},f=function(e,t){e.uniformMatrix4fv(this.addr,!1,t.elements||t)},g=function(t,i,n){var r=n.allocTextureUnit();t.uniform1i(this.addr,r),n.setTexture2D(i||e,r)},_=function(e,i,n){var r=n.allocTextureUnit();e.uniform1i(this.addr,r),n.setTextureCube(i||t,r)},m=function(e,t){e.uniform2iv(this.addr,t)},v=function(e,t){e.uniform3iv(this.addr,t)},y=function(e,t){e.uniform4iv(this.addr,t)},b=function(e,t){e.uniform1fv(this.addr,t)},S=function(e,t){e.uniform1iv(this.addr,t)},E=function(e,t){e.uniform2fv(this.addr,a(t,this.size,2))},w=function(e,t){e.uniform3fv(this.addr,a(t,this.size,3))},T=function(e,t){e.uniform4fv(this.addr,a(t,this.size,4))},M=function(e,t){e.uniformMatrix2fv(this.addr,!1,a(t,this.size,4))},A=function(e,t){e.uniformMatrix3fv(this.addr,!1,a(t,this.size,9))},C=function(e,t){e.uniformMatrix4fv(this.addr,!1,a(t,this.size,16))},x=function(t,i,n){var r=i.length,a=o(n,r);t.uniform1iv(this.addr,a);for(var s=0;s!==r;++s)n.setTexture2D(i[s]||e,a[s])},I=function(e,i,n){var r=i.length,a=o(n,r);e.uniform1iv(this.addr,a);for(var s=0;s!==r;++s)n.setTextureCube(i[s]||t,a[s])},P=function(e,t,i){this.id=e,this.addr=i,this.setValue=function(e){switch(e){case 5126:return s;case 35664:return c;case 35665:return u;case 35666:return h;case 35674:return d;case 35675:return p;case 35676:return f;case 35678:return g;case 35680:return _;case 5124:case 35670:return l;case 35667:case 35671:return m;case 35668:case 35672:return v;case 35669:case 35673:return y}}(t.type)},L=function(e,t,i){this.id=e,this.addr=i,this.size=t.size,this.setValue=function(e){switch(e){case 5126:return b;case 35664:return E;case 35665:return w;case 35666:return T;case 35674:return M;case 35675:return A;case 35676:return C;case 35678:return x;case 35680:return I;case 5124:case 35670:return S;case 35667:case 35671:return m;case 35668:case 35672:return v;case 35669:case 35673:return y}}(t.type)},D=function(e){this.id=e,i.call(this)};D.prototype.setValue=function(e,t){for(var i=this.seq,n=0,r=i.length;n!==r;++n){var a=i[n];a.setValue(e,t[a.id])}};var R=/([\w\d_]+)(\])?(\[|\.)?/g,k=function(e,t){e.seq.push(t),e.map[t.id]=t},O=function(e,t,i){var n=e.name,r=n.length;for(R.lastIndex=0;;){var a=R.exec(n),o=R.lastIndex,s=a[1],l="]"===a[2],c=a[3];if(l&&(s|=0),void 0===c||"["===c&&o+2===r){k(i,void 0===c?new P(s,e,t):new L(s,e,t));break}var u=i.map[s];void 0===u&&(u=new D(s),k(i,u)),i=u}},N=function(e,t,n){i.call(this),this.renderer=n;for(var r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),a=0;a!==r;++a){var o=e.getActiveUniform(t,a),s=o.name,l=e.getUniformLocation(t,s);O(o,l,this)}};return N.prototype.setValue=function(e,t,i){var n=this.map[t];void 0!==n&&n.setValue(e,i,this.renderer)},N.prototype.set=function(e,t,i){var n=this.map[i];void 0!==n&&n.setValue(e,t[i],this.renderer)},N.prototype.setOptional=function(e,t,i){var n=t[i];void 0!==n&&this.setValue(e,i,n)},N.upload=function(e,t,i,n){for(var r=0,a=t.length;r!==a;++r){var o=t[r],s=i[o.id];!1!==s.needsUpdate&&o.setValue(e,s.value,n)}},N.seqWithValue=function(e,t){for(var i=[],n=0,r=e.length;n!==r;++n){var a=e[n];a.id in t&&i.push(a)}return i},N.splitDynamic=function(e,t){for(var i=null,n=e.length,r=0,a=0;a!==n;++a){var o=e[a],s=t[o.id];s&&!0===s.dynamic?(null===i&&(i=[]),i.push(o)):(r<a&&(e[r]=o),++r)}return r<n&&(e.length=r),i},N.evalDynamic=function(e,t,i,n){for(var r=0,a=e.length;r!==a;++r){var o=t[e[r].id],s=o.onUpdateCallback;void 0!==s&&s.call(o,i,n)}},N}(),q.LensFlarePlugin=function(e,t){var i,n,r,a,o,s,l,c,u=e.context,h=e.state;function d(){var t=new Float32Array([-1,-1,0,0,1,-1,1,0,1,1,1,1,-1,1,0,1]),d=new Uint16Array([0,1,2,0,2,3]);i=u.createBuffer(),n=u.createBuffer(),u.bindBuffer(u.ARRAY_BUFFER,i),u.bufferData(u.ARRAY_BUFFER,t,u.STATIC_DRAW),u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,n),u.bufferData(u.ELEMENT_ARRAY_BUFFER,d,u.STATIC_DRAW),l=u.createTexture(),c=u.createTexture(),h.bindTexture(u.TEXTURE_2D,l),u.texImage2D(u.TEXTURE_2D,0,u.RGB,16,16,0,u.RGB,u.UNSIGNED_BYTE,null),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,u.CLAMP_TO_EDGE),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,u.CLAMP_TO_EDGE),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,u.NEAREST),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,u.NEAREST),h.bindTexture(u.TEXTURE_2D,c),u.texImage2D(u.TEXTURE_2D,0,u.RGBA,16,16,0,u.RGBA,u.UNSIGNED_BYTE,null),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,u.CLAMP_TO_EDGE),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,u.CLAMP_TO_EDGE),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,u.NEAREST),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,u.NEAREST),r={vertexShader:["uniform lowp int renderType;","uniform vec3 screenPosition;","uniform vec2 scale;","uniform float rotation;","uniform sampler2D occlusionMap;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","varying float vVisibility;","void main() {","vUV = uv;","vec2 pos = position;","if ( renderType == 2 ) {","vec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );","vVisibility =        visibility.r / 9.0;","vVisibility *= 1.0 - visibility.g / 9.0;","vVisibility *=       visibility.b / 9.0;","vVisibility *= 1.0 - visibility.a / 9.0;","pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;","pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;","}","gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["uniform lowp int renderType;","uniform sampler2D map;","uniform float opacity;","uniform vec3 color;","varying vec2 vUV;","varying float vVisibility;","void main() {","if ( renderType == 0 ) {","gl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );","} else if ( renderType == 1 ) {","gl_FragColor = texture2D( map, vUV );","} else {","vec4 texture = texture2D( map, vUV );","texture.a *= opacity * vVisibility;","gl_FragColor = texture;","gl_FragColor.rgb *= color;","}","}"].join("\n")},a=function(t){var i=u.createProgram(),n=u.createShader(u.FRAGMENT_SHADER),r=u.createShader(u.VERTEX_SHADER),a="precision "+e.getPrecision()+" float;\n";return u.shaderSource(n,a+t.fragmentShader),u.shaderSource(r,a+t.vertexShader),u.compileShader(n),u.compileShader(r),u.attachShader(i,n),u.attachShader(i,r),u.linkProgram(i),i}(r),o={vertex:u.getAttribLocation(a,"position"),uv:u.getAttribLocation(a,"uv")},s={renderType:u.getUniformLocation(a,"renderType"),map:u.getUniformLocation(a,"map"),occlusionMap:u.getUniformLocation(a,"occlusionMap"),opacity:u.getUniformLocation(a,"opacity"),color:u.getUniformLocation(a,"color"),scale:u.getUniformLocation(a,"scale"),rotation:u.getUniformLocation(a,"rotation"),screenPosition:u.getUniformLocation(a,"screenPosition")}}this.render=function(r,p,f){if(0!==t.length){var g=new q.Vector3,_=f.w/f.z,m=.5*f.z,v=.5*f.w,y=16/f.w,b=new q.Vector2(y*_,y),S=new q.Vector3(1,1,0),E=new q.Vector2(1,1),w=new q.Box2;w.min.set(0,0),w.max.set(f.z-16,f.w-16),void 0===a&&d(),u.useProgram(a),h.initAttributes(),h.enableAttribute(o.vertex),h.enableAttribute(o.uv),h.disableUnusedAttributes(),u.uniform1i(s.occlusionMap,0),u.uniform1i(s.map,1),u.bindBuffer(u.ARRAY_BUFFER,i),u.vertexAttribPointer(o.vertex,2,u.FLOAT,!1,16,0),u.vertexAttribPointer(o.uv,2,u.FLOAT,!1,16,8),u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,n),h.disable(u.CULL_FACE),h.setDepthWrite(!1);for(var T=0,M=t.length;T<M;T++){y=16/f.w,b.set(y*_,y);var A=t[T];if(g.set(A.matrixWorld.elements[12],A.matrixWorld.elements[13],A.matrixWorld.elements[14]),g.applyMatrix4(p.matrixWorldInverse),g.applyProjection(p.projectionMatrix),S.copy(g),E.x=f.x+S.x*m+m-8,E.y=f.y+S.y*v+v-8,!0===w.containsPoint(E)){h.activeTexture(u.TEXTURE0),h.bindTexture(u.TEXTURE_2D,null),h.activeTexture(u.TEXTURE1),h.bindTexture(u.TEXTURE_2D,l),u.copyTexImage2D(u.TEXTURE_2D,0,u.RGB,E.x,E.y,16,16,0),u.uniform1i(s.renderType,0),u.uniform2f(s.scale,b.x,b.y),u.uniform3f(s.screenPosition,S.x,S.y,S.z),h.disable(u.BLEND),h.enable(u.DEPTH_TEST),u.drawElements(u.TRIANGLES,6,u.UNSIGNED_SHORT,0),h.activeTexture(u.TEXTURE0),h.bindTexture(u.TEXTURE_2D,c),u.copyTexImage2D(u.TEXTURE_2D,0,u.RGBA,E.x,E.y,16,16,0),u.uniform1i(s.renderType,1),h.disable(u.DEPTH_TEST),h.activeTexture(u.TEXTURE1),h.bindTexture(u.TEXTURE_2D,l),u.drawElements(u.TRIANGLES,6,u.UNSIGNED_SHORT,0),A.positionScreen.copy(S),A.customUpdateCallback?A.customUpdateCallback(A):A.updateLensFlares(),u.uniform1i(s.renderType,2),h.enable(u.BLEND);for(var C=0,x=A.lensFlares.length;C<x;C++){var I=A.lensFlares[C];I.opacity>.001&&I.scale>.001&&(S.x=I.x,S.y=I.y,S.z=I.z,y=I.size*I.scale/f.w,b.x=y*_,b.y=y,u.uniform3f(s.screenPosition,S.x,S.y,S.z),u.uniform2f(s.scale,b.x,b.y),u.uniform1f(s.rotation,I.rotation),u.uniform1f(s.opacity,I.opacity),u.uniform3f(s.color,I.color.r,I.color.g,I.color.b),h.setBlending(I.blending,I.blendEquation,I.blendSrc,I.blendDst),e.setTexture2D(I.texture,1),u.drawElements(u.TRIANGLES,6,u.UNSIGNED_SHORT,0))}}}h.enable(u.CULL_FACE),h.enable(u.DEPTH_TEST),h.setDepthWrite(!0),e.resetGLState()}}},q.SpritePlugin=function(e,t){var i,n,r,a,o,s,l=e.context,c=e.state,u=new q.Vector3,h=new q.Quaternion,d=new q.Vector3;function p(){var t=new Float32Array([-.5,-.5,0,0,.5,-.5,1,0,.5,.5,1,1,-.5,.5,0,1]),c=new Uint16Array([0,1,2,0,2,3]);i=l.createBuffer(),n=l.createBuffer(),l.bindBuffer(l.ARRAY_BUFFER,i),l.bufferData(l.ARRAY_BUFFER,t,l.STATIC_DRAW),l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,n),l.bufferData(l.ELEMENT_ARRAY_BUFFER,c,l.STATIC_DRAW),r=function(){var t=l.createProgram(),i=l.createShader(l.VERTEX_SHADER),n=l.createShader(l.FRAGMENT_SHADER);return l.shaderSource(i,["precision "+e.getPrecision()+" float;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform float rotation;","uniform vec2 scale;","uniform vec2 uvOffset;","uniform vec2 uvScale;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","void main() {","vUV = uvOffset + uv * uvScale;","vec2 alignedPosition = position * scale;","vec2 rotatedPosition;","rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;","rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;","vec4 finalPosition;","finalPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );","finalPosition.xy += rotatedPosition;","finalPosition = projectionMatrix * finalPosition;","gl_Position = finalPosition;","}"].join("\n")),l.shaderSource(n,["precision "+e.getPrecision()+" float;","uniform vec3 color;","uniform sampler2D map;","uniform float opacity;","uniform int fogType;","uniform vec3 fogColor;","uniform float fogDensity;","uniform float fogNear;","uniform float fogFar;","uniform float alphaTest;","varying vec2 vUV;","void main() {","vec4 texture = texture2D( map, vUV );","if ( texture.a < alphaTest ) discard;","gl_FragColor = vec4( color * texture.xyz, texture.a * opacity );","if ( fogType > 0 ) {","float depth = gl_FragCoord.z / gl_FragCoord.w;","float fogFactor = 0.0;","if ( fogType == 1 ) {","fogFactor = smoothstep( fogNear, fogFar, depth );","} else {","const float LOG2 = 1.442695;","fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );","fogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );","}","gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );","}","}"].join("\n")),l.compileShader(i),l.compileShader(n),l.attachShader(t,i),l.attachShader(t,n),l.linkProgram(t),t}(),a={position:l.getAttribLocation(r,"position"),uv:l.getAttribLocation(r,"uv")},o={uvOffset:l.getUniformLocation(r,"uvOffset"),uvScale:l.getUniformLocation(r,"uvScale"),rotation:l.getUniformLocation(r,"rotation"),scale:l.getUniformLocation(r,"scale"),color:l.getUniformLocation(r,"color"),map:l.getUniformLocation(r,"map"),opacity:l.getUniformLocation(r,"opacity"),modelViewMatrix:l.getUniformLocation(r,"modelViewMatrix"),projectionMatrix:l.getUniformLocation(r,"projectionMatrix"),fogType:l.getUniformLocation(r,"fogType"),fogDensity:l.getUniformLocation(r,"fogDensity"),fogNear:l.getUniformLocation(r,"fogNear"),fogFar:l.getUniformLocation(r,"fogFar"),fogColor:l.getUniformLocation(r,"fogColor"),alphaTest:l.getUniformLocation(r,"alphaTest")};var u=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");u.width=8,u.height=8;var h=u.getContext("2d");h.fillStyle="white",h.fillRect(0,0,8,8),(s=new q.Texture(u)).needsUpdate=!0}function f(e,t){return e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:t.id-e.id}this.render=function(g,_){if(0!==t.length){void 0===r&&p(),l.useProgram(r),c.initAttributes(),c.enableAttribute(a.position),c.enableAttribute(a.uv),c.disableUnusedAttributes(),c.disable(l.CULL_FACE),c.enable(l.BLEND),l.bindBuffer(l.ARRAY_BUFFER,i),l.vertexAttribPointer(a.position,2,l.FLOAT,!1,16,0),l.vertexAttribPointer(a.uv,2,l.FLOAT,!1,16,8),l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,n),l.uniformMatrix4fv(o.projectionMatrix,!1,_.projectionMatrix.elements),c.activeTexture(l.TEXTURE0),l.uniform1i(o.map,0);var m=0,v=0,y=g.fog;y?(l.uniform3f(o.fogColor,y.color.r,y.color.g,y.color.b),y instanceof q.Fog?(l.uniform1f(o.fogNear,y.near),l.uniform1f(o.fogFar,y.far),l.uniform1i(o.fogType,1),m=1,v=1):y instanceof q.FogExp2&&(l.uniform1f(o.fogDensity,y.density),l.uniform1i(o.fogType,2),m=2,v=2)):(l.uniform1i(o.fogType,0),m=0,v=0);for(var b=0,S=t.length;b<S;b++){(w=t[b]).modelViewMatrix.multiplyMatrices(_.matrixWorldInverse,w.matrixWorld),w.z=-w.modelViewMatrix.elements[14]}t.sort(f);var E=[];for(b=0,S=t.length;b<S;b++){var w,T=(w=t[b]).material;l.uniform1f(o.alphaTest,T.alphaTest),l.uniformMatrix4fv(o.modelViewMatrix,!1,w.modelViewMatrix.elements),w.matrixWorld.decompose(u,h,d),E[0]=d.x,E[1]=d.y;var M=0;g.fog&&T.fog&&(M=v),m!==M&&(l.uniform1i(o.fogType,M),m=M),null!==T.map?(l.uniform2f(o.uvOffset,T.map.offset.x,T.map.offset.y),l.uniform2f(o.uvScale,T.map.repeat.x,T.map.repeat.y)):(l.uniform2f(o.uvOffset,0,0),l.uniform2f(o.uvScale,1,1)),l.uniform1f(o.opacity,T.opacity),l.uniform3f(o.color,T.color.r,T.color.g,T.color.b),l.uniform1f(o.rotation,T.rotation),l.uniform2fv(o.scale,E),c.setBlending(T.blending,T.blendEquation,T.blendSrc,T.blendDst),c.setDepthTest(T.depthTest),c.setDepthWrite(T.depthWrite),T.map?e.setTexture2D(T.map,0):e.setTexture2D(s,0),l.drawElements(l.TRIANGLES,6,l.UNSIGNED_SHORT,0)}c.enable(l.CULL_FACE),e.resetGLState()}}},Object.assign(q,{Face4:function(e,t,i,n,r,a,o){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new q.Face3(e,t,i,r,a,o)},LineStrip:0,LinePieces:1,MeshFaceMaterial:q.MultiMaterial,PointCloud:function(e,t){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new q.Points(e,t)},Particle:q.Sprite,ParticleSystem:function(e,t){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new q.Points(e,t)},PointCloudMaterial:function(e){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new q.PointsMaterial(e)},ParticleBasicMaterial:function(e){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new q.PointsMaterial(e)},ParticleSystemMaterial:function(e){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new q.PointsMaterial(e)},Vertex:function(e,t,i){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new q.Vector3(e,t,i)}}),Object.assign(q.Box2.prototype,{empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)}}),Object.assign(q.Box3.prototype,{empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionSphere:function(e){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)}}),Object.assign(q.Matrix3.prototype,{multiplyVector3:function(e){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},multiplyVector3Array:function(e){return console.warn("THREE.Matrix3: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead."),this.applyToVector3Array(e)}}),Object.assign(q.Matrix4.prototype,{extractPosition:function(e){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(e)},setRotationFromQuaternion:function(e){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(e)},multiplyVector3:function(e){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) or vector.applyProjection( matrix ) instead."),e.applyProjection(this)},multiplyVector4:function(e){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector3Array:function(e){return console.warn("THREE.Matrix4: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead."),this.applyToVector3Array(e)},rotateAxis:function(e){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),e.transformDirection(this)},crossVector:function(e){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},translate:function(e){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(e){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(e){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(e){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(e,t){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")}}),Object.assign(q.Plane.prototype,{isIntersectionLine:function(e){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(e)}}),Object.assign(q.Quaternion.prototype,{multiplyVector3:function(e){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),e.applyQuaternion(this)}}),Object.assign(q.Ray.prototype,{isIntersectionBox:function(e){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionPlane:function(e){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(e)},isIntersectionSphere:function(e){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)}}),Object.assign(q.Vector3.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(e){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(e)},getScaleFromMatrix:function(e){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(e)},getColumnFromMatrix:function(e,t){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(t,e)}}),Object.assign(q.Object3D.prototype,{getChildByName:function(e){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(e)},renderDepth:function(e){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(e,t){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(t,e)}}),Object.defineProperties(q.Object3D.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(e){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=e}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(e){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.defineProperties(q.LOD.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),q.PerspectiveCamera.prototype.setLens=function(e,t){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==t&&(this.filmGauge=t),this.setFocalLength(e)},Object.defineProperties(q.Light.prototype,{onlyShadow:{set:function(e){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(e){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=e}},shadowCameraLeft:{set:function(e){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=e}},shadowCameraRight:{set:function(e){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=e}},shadowCameraTop:{set:function(e){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=e}},shadowCameraBottom:{set:function(e){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=e}},shadowCameraNear:{set:function(e){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=e}},shadowCameraFar:{set:function(e){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=e}},shadowCameraVisible:{set:function(e){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(e){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=e}},shadowDarkness:{set:function(e){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(e){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=e}},shadowMapHeight:{set:function(e){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=e}}}),Object.defineProperties(q.BufferAttribute.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Please use .count."),this.array.length}}}),Object.assign(q.BufferGeometry.prototype,{addIndex:function(e){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(e)},addDrawCall:function(e,t,i){void 0!==i&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(e,t)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")}}),Object.defineProperties(q.BufferGeometry.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(q.Material.prototype,{wrapAround:{get:function(){console.warn("THREE."+this.type+": .wrapAround has been removed.")},set:function(e){console.warn("THREE."+this.type+": .wrapAround has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE."+this.type+": .wrapRGB has been removed."),new q.Color}}}),Object.defineProperties(q.MeshPhongMaterial.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(e){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(q.ShaderMaterial.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(e){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=e}}}),q.EventDispatcher.prototype=Object.assign(Object.create({constructor:q.EventDispatcher,apply:function(e){console.warn("THREE.EventDispatcher: .apply is deprecated, just inherit or Object.assign the prototype to mix-in."),Object.assign(e,this)}}),q.EventDispatcher.prototype),Object.assign(q.WebGLRenderer.prototype,{supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(e){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(e)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")}}),Object.defineProperties(q.WebGLRenderer.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=e}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=e}},shadowMapCullFace:{get:function(){return this.shadowMap.cullFace},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapCullFace is now .shadowMap.cullFace."),this.shadowMap.cullFace=e}}}),Object.defineProperties(q.WebGLShadowMap.prototype,{cullFace:{get:function(){return this.renderReverseSided?q.CullFaceFront:q.CullFaceBack},set:function(e){var t=e!==q.CullFaceBack;console.warn("WebGLRenderer: .shadowMap.cullFace is deprecated. Set .shadowMap.renderReverseSided to "+t+"."),this.renderReverseSided=t}}}),Object.defineProperties(q.WebGLRenderTarget.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=e}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=e}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=e}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=e}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(e){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=e}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(e){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=e}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(e){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=e}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(e){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=e}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(e){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=e}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(e){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=e}}}),Object.assign(q.Audio.prototype,{load:function(e){console.warn("THREE.Audio: .load has been deprecated. Please use THREE.AudioLoader.");var t=this;return(new q.AudioLoader).load(e,(function(e){t.setBuffer(e)})),this}}),Object.assign(q.AudioAnalyser.prototype,{getData:function(e){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()}}),q.GeometryUtils={merge:function(e,t,i){var n;console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead."),t instanceof q.Mesh&&(t.matrixAutoUpdate&&t.updateMatrix(),n=t.matrix,t=t.geometry),e.merge(t,n,i)},center:function(e){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),e.center()}},q.ImageUtils={crossOrigin:void 0,loadTexture:function(e,t,i,n){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var r=new q.TextureLoader;r.setCrossOrigin(this.crossOrigin);var a=r.load(e,i,void 0,n);return t&&(a.mapping=t),a},loadTextureCube:function(e,t,i,n){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var r=new q.CubeTextureLoader;r.setCrossOrigin(this.crossOrigin);var a=r.load(e,i,void 0,n);return t&&(a.mapping=t),a},loadCompressedTexture:function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},loadCompressedTextureCube:function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")}},q.Projector=function(){console.error("THREE.Projector has been moved to /examples/js/renderers/Projector.js."),this.projectVector=function(e,t){console.warn("THREE.Projector: .projectVector() is now vector.project()."),e.project(t)},this.unprojectVector=function(e,t){console.warn("THREE.Projector: .unprojectVector() is now vector.unproject()."),e.unproject(t)},this.pickingRay=function(e,t){console.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")}},q.CanvasRenderer=function(){console.error("THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js"),this.domElement=document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),this.clear=function(){},this.render=function(){},this.setClearColor=function(){},this.setSize=function(){}},q.CurveUtils={tangentQuadraticBezier:function(e,t,i,n){return 2*(1-e)*(i-t)+2*e*(n-i)},tangentCubicBezier:function(e,t,i,n,r){return-3*t*(1-e)*(1-e)+3*i*(1-e)*(1-e)-6*e*i*(1-e)+6*e*n*(1-e)-3*e*e*n+3*e*e*r},tangentSpline:function(e,t,i,n,r){return 6*e*e-6*e+(3*e*e-4*e+1)+(-6*e*e+6*e)+(3*e*e-2*e)},interpolate:function(e,t,i,n,r){var a=.5*(i-e),o=.5*(n-t),s=r*r;return(2*t-2*i+a+o)*(r*s)+(-3*t+3*i-2*a-o)*s+a*r+t}},q.SceneUtils={createMultiMaterialObject:function(e,t){for(var i=new q.Group,n=0,r=t.length;n<r;n++)i.add(new q.Mesh(e,t[n]));return i},detach:function(e,t,i){e.applyMatrix(t.matrixWorld),t.remove(e),i.add(e)},attach:function(e,t,i){var n=new q.Matrix4;n.getInverse(i.matrixWorld),e.applyMatrix(n),t.remove(e),i.add(e)}},q.ShapeUtils={area:function(e){for(var t=e.length,i=0,n=t-1,r=0;r<t;n=r++)i+=e[n].x*e[r].y-e[r].x*e[n].y;return.5*i},triangulate:function(){function e(e,t,i,n,r,a){var o,s,l,c,u,h,d,p,f,g,_,m,v,y,b,S,E;if(s=e[a[t]].x,l=e[a[t]].y,c=e[a[i]].x,u=e[a[i]].y,h=e[a[n]].x,d=e[a[n]].y,Number.EPSILON>(c-s)*(d-l)-(u-l)*(h-s))return!1;for(g=h-c,_=d-u,m=s-h,v=l-d,y=c-s,b=u-l,o=0;o<r;o++)if(p=e[a[o]].x,f=e[a[o]].y,!(p===s&&f===l||p===c&&f===u||p===h&&f===d)&&(S=y*(f-l)-b*(p-s),E=m*(f-d)-v*(p-h),g*(f-u)-_*(p-c)>=-Number.EPSILON&&E>=-Number.EPSILON&&S>=-Number.EPSILON))return!1;return!0}return function(t,i){var n=t.length;if(n<3)return null;var r,a,o,s=[],l=[],c=[];if(q.ShapeUtils.area(t)>0)for(a=0;a<n;a++)l[a]=a;else for(a=0;a<n;a++)l[a]=n-1-a;var u=n,h=2*u;for(a=u-1;u>2;){if(h--<=0)return console.warn("THREE.ShapeUtils: Unable to triangulate polygon! in triangulate()"),i?c:s;if(u<=(r=a)&&(r=0),u<=(a=r+1)&&(a=0),u<=(o=a+1)&&(o=0),e(t,r,a,o,u,l)){var d,p,f,g,_;for(d=l[r],p=l[a],f=l[o],s.push([t[d],t[p],t[f]]),c.push([l[r],l[a],l[o]]),g=a,_=a+1;_<u;g++,_++)l[g]=l[_];h=2*--u}}return i?c:s}}(),triangulateShape:function(e,t){function i(e,t,i){return e.x!==t.x?e.x<t.x?e.x<=i.x&&i.x<=t.x:t.x<=i.x&&i.x<=e.x:e.y<t.y?e.y<=i.y&&i.y<=t.y:t.y<=i.y&&i.y<=e.y}function n(e,t,n,r,a){var o=t.x-e.x,s=t.y-e.y,l=r.x-n.x,c=r.y-n.y,u=e.x-n.x,h=e.y-n.y,d=s*l-o*c,p=s*u-o*h;if(Math.abs(d)>Number.EPSILON){var f;if(d>0){if(p<0||p>d)return[];if((f=c*u-l*h)<0||f>d)return[]}else{if(p>0||p<d)return[];if((f=c*u-l*h)>0||f<d)return[]}if(0===f)return!a||0!==p&&p!==d?[e]:[];if(f===d)return!a||0!==p&&p!==d?[t]:[];if(0===p)return[n];if(p===d)return[r];var g=f/d;return[{x:e.x+g*o,y:e.y+g*s}]}if(0!==p||c*u!=l*h)return[];var _,m,v,y,b,S,E,w,T=0===o&&0===s,M=0===l&&0===c;return T&&M?e.x!==n.x||e.y!==n.y?[]:[e]:T?i(n,r,e)?[e]:[]:M?i(e,t,n)?[n]:[]:(0!==o?(e.x<t.x?(_=e,v=e.x,m=t,y=t.x):(_=t,v=t.x,m=e,y=e.x),n.x<r.x?(b=n,E=n.x,S=r,w=r.x):(b=r,E=r.x,S=n,w=n.x)):(e.y<t.y?(_=e,v=e.y,m=t,y=t.y):(_=t,v=t.y,m=e,y=e.y),n.y<r.y?(b=n,E=n.y,S=r,w=r.y):(b=r,E=r.y,S=n,w=n.y)),v<=E?y<E?[]:y===E?a?[]:[b]:y<=w?[b,m]:[b,S]:v>w?[]:v===w?a?[]:[_]:y<=w?[_,m]:[_,S])}function r(e,t,i,n){var r=t.x-e.x,a=t.y-e.y,o=i.x-e.x,s=i.y-e.y,l=n.x-e.x,c=n.y-e.y,u=r*s-a*o,h=r*c-a*l;if(Math.abs(u)>Number.EPSILON){var d=l*s-c*o;return u>0?h>=0&&d>=0:h>=0||d>=0}return h>0}for(var a,o,s,l,c,u,h={},d=e.concat(),p=0,f=t.length;p<f;p++)Array.prototype.push.apply(d,t[p]);for(a=0,o=d.length;a<o;a++)void 0!==h[c=d[a].x+":"+d[a].y]&&console.warn("THREE.Shape: Duplicate point",c),h[c]=a;var g=function(e,t){var i,a=e.concat();function o(e,t){var n=a.length-1,o=e-1;o<0&&(o=n);var s=e+1;s>n&&(s=0);var l=r(a[e],a[o],a[s],i[t]);if(!l)return!1;var c=i.length-1,u=t-1;u<0&&(u=c);var h=t+1;return h>c&&(h=0),!!(l=r(i[t],i[u],i[h],a[e]))}function s(e,t){var i,r;for(i=0;i<a.length;i++)if(r=i+1,r%=a.length,n(e,t,a[i],a[r],!0).length>0)return!0;return!1}var l=[];function c(e,i){var r,a,o,s;for(r=0;r<l.length;r++)for(a=t[l[r]],o=0;o<a.length;o++)if(s=o+1,s%=a.length,n(e,i,a[o],a[s],!0).length>0)return!0;return!1}for(var u,h,d,p,f,g,_,m,v,y,b=[],S=0,E=t.length;S<E;S++)l.push(S);for(var w=0,T=2*l.length;l.length>0;){if(--T<0){console.log("Infinite Loop! Holes left:"+l.length+", Probably Hole outside Shape!");break}for(h=w;h<a.length;h++){d=a[h],u=-1;for(S=0;S<l.length;S++)if(f=l[S],void 0===b[g=d.x+":"+d.y+":"+f]){i=t[f];for(var M=0;M<i.length;M++)if(p=i[M],o(h,M)&&!s(d,p)&&!c(d,p)){u=M,l.splice(S,1),_=a.slice(0,h+1),m=a.slice(h),v=i.slice(u),y=i.slice(0,u+1),a=_.concat(v).concat(y).concat(m),w=h;break}if(u>=0)break;b[g]=!0}if(u>=0)break}}return a}(e,t),_=q.ShapeUtils.triangulate(g,!1);for(a=0,o=_.length;a<o;a++)for(l=_[a],s=0;s<3;s++)void 0!==(u=h[c=l[s].x+":"+l[s].y])&&(l[s]=u);return _.concat()},isClockWise:function(e){return q.ShapeUtils.area(e)<0},b2:function(e,t,i,n){return function(e,t){var i=1-e;return i*i*t}(e,t)+function(e,t){return 2*(1-e)*e*t}(e,i)+function(e,t){return e*e*t}(e,n)},b3:function(e,t,i,n,r){return function(e,t){var i=1-e;return i*i*i*t}(e,t)+function(e,t){var i=1-e;return 3*i*i*e*t}(e,i)+function(e,t){return 3*(1-e)*e*e*t}(e,n)+function(e,t){return e*e*e*t}(e,r)}},q.Curve=function(){},q.Curve.prototype={constructor:q.Curve,getPoint:function(e){return console.warn("THREE.Curve: Warning, getPoint() not implemented!"),null},getPointAt:function(e){var t=this.getUtoTmapping(e);return this.getPoint(t)},getPoints:function(e){e||(e=5);var t,i=[];for(t=0;t<=e;t++)i.push(this.getPoint(t/e));return i},getSpacedPoints:function(e){e||(e=5);var t,i=[];for(t=0;t<=e;t++)i.push(this.getPointAt(t/e));return i},getLength:function(){var e=this.getLengths();return e[e.length-1]},getLengths:function(e){if(e||(e=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var t,i,n=[],r=this.getPoint(0),a=0;for(n.push(0),i=1;i<=e;i++)a+=(t=this.getPoint(i/e)).distanceTo(r),n.push(a),r=t;return this.cacheArcLengths=n,n},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(e,t){var i,n=this.getLengths(),r=0,a=n.length;i=t||e*n[a-1];for(var o,s=0,l=a-1;s<=l;)if((o=n[r=Math.floor(s+(l-s)/2)]-i)<0)s=r+1;else{if(!(o>0)){l=r;break}l=r-1}if(n[r=l]===i)return r/(a-1);var c=n[r];return(r+(i-c)/(n[r+1]-c))/(a-1)},getTangent:function(e){var t=e-1e-4,i=e+1e-4;t<0&&(t=0),i>1&&(i=1);var n=this.getPoint(t);return this.getPoint(i).clone().sub(n).normalize()},getTangentAt:function(e){var t=this.getUtoTmapping(e);return this.getTangent(t)}},q.Curve.create=function(e,t){return e.prototype=Object.create(q.Curve.prototype),e.prototype.constructor=e,e.prototype.getPoint=t,e},q.CurvePath=function(){this.curves=[],this.autoClose=!1},q.CurvePath.prototype=Object.assign(Object.create(q.Curve.prototype),{constructor:q.CurvePath,add:function(e){this.curves.push(e)},closePath:function(){var e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new q.LineCurve(t,e))},getPoint:function(e){for(var t=e*this.getLength(),i=this.getCurveLengths(),n=0;n<i.length;){if(i[n]>=t){var r=i[n]-t,a=this.curves[n],o=1-r/a.getLength();return a.getPointAt(o)}n++}return null},getLength:function(){var e=this.getCurveLengths();return e[e.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var e=[],t=0,i=0,n=this.curves.length;i<n;i++)t+=this.curves[i].getLength(),e.push(t);return this.cacheLengths=e,e},createPointsGeometry:function(e){var t=this.getPoints(e);return this.createGeometry(t)},createSpacedPointsGeometry:function(e){var t=this.getSpacedPoints(e);return this.createGeometry(t)},createGeometry:function(e){for(var t=new q.Geometry,i=0,n=e.length;i<n;i++){var r=e[i];t.vertices.push(new q.Vector3(r.x,r.y,r.z||0))}return t}}),q.Font=function(e){this.data=e},Object.assign(q.Font.prototype,{generateShapes:function(e,t,i){function n(e,t,n){var a=r.glyphs[e]||r.glyphs["?"];if(a){var o,s,l,c,u,h,d,p,f,g,_,m=new q.Path,v=[],y=q.ShapeUtils.b2,b=q.ShapeUtils.b3;if(a.o)for(var S=a._cachedOutline||(a._cachedOutline=a.o.split(" ")),E=0,w=S.length;E<w;){switch(S[E++]){case"m":o=S[E++]*t+n,s=S[E++]*t,m.moveTo(o,s);break;case"l":o=S[E++]*t+n,s=S[E++]*t,m.lineTo(o,s);break;case"q":if(l=S[E++]*t+n,c=S[E++]*t,d=S[E++]*t+n,p=S[E++]*t,m.quadraticCurveTo(d,p,l,c),_=v[v.length-1]){u=_.x,h=_.y;for(var T=1;T<=i;T++){y(M=T/i,u,d,l),y(M,h,p,c)}}break;case"b":if(l=S[E++]*t+n,c=S[E++]*t,d=S[E++]*t+n,p=S[E++]*t,f=S[E++]*t+n,g=S[E++]*t,m.bezierCurveTo(d,p,f,g,l,c),_=v[v.length-1]){u=_.x,h=_.y;for(T=1;T<=i;T++){var M;b(M=T/i,u,d,f,l),b(M,h,p,g,c)}}}}return{offset:a.ha*t,path:m}}}void 0===t&&(t=100),void 0===i&&(i=4);for(var r=this.data,a=function(e){for(var i=String(e).split(""),a=t/r.resolution,o=0,s=[],l=0;l<i.length;l++){var c=n(i[l],a,o);o+=c.offset,s.push(c.path)}return s}(e),o=[],s=0,l=a.length;s<l;s++)Array.prototype.push.apply(o,a[s].toShapes());return o}}),q.Path=function(e){q.CurvePath.call(this),this.actions=[],e&&this.fromPoints(e)},q.Path.prototype=Object.assign(Object.create(q.CurvePath.prototype),{constructor:q.Path,fromPoints:function(e){this.moveTo(e[0].x,e[0].y);for(var t=1,i=e.length;t<i;t++)this.lineTo(e[t].x,e[t].y)},moveTo:function(e,t){this.actions.push({action:"moveTo",args:[e,t]})},lineTo:function(e,t){var i=this.actions[this.actions.length-1].args,n=i[i.length-2],r=i[i.length-1],a=new q.LineCurve(new q.Vector2(n,r),new q.Vector2(e,t));this.curves.push(a),this.actions.push({action:"lineTo",args:[e,t]})},quadraticCurveTo:function(e,t,i,n){var r=this.actions[this.actions.length-1].args,a=r[r.length-2],o=r[r.length-1],s=new q.QuadraticBezierCurve(new q.Vector2(a,o),new q.Vector2(e,t),new q.Vector2(i,n));this.curves.push(s),this.actions.push({action:"quadraticCurveTo",args:[e,t,i,n]})},bezierCurveTo:function(e,t,i,n,r,a){var o=this.actions[this.actions.length-1].args,s=o[o.length-2],l=o[o.length-1],c=new q.CubicBezierCurve(new q.Vector2(s,l),new q.Vector2(e,t),new q.Vector2(i,n),new q.Vector2(r,a));this.curves.push(c),this.actions.push({action:"bezierCurveTo",args:[e,t,i,n,r,a]})},splineThru:function(e){var t=Array.prototype.slice.call(arguments),i=this.actions[this.actions.length-1].args,n=i[i.length-2],r=i[i.length-1],a=[new q.Vector2(n,r)];Array.prototype.push.apply(a,e);var o=new q.SplineCurve(a);this.curves.push(o);var s=e[e.length-1];t.push(s.x),t.push(s.y),this.actions.push({action:"splineThru",args:t})},arc:function(e,t,i,n,r,a){var o=this.actions[this.actions.length-1].args,s=o[o.length-2],l=o[o.length-1];this.absarc(e+s,t+l,i,n,r,a)},absarc:function(e,t,i,n,r,a){this.absellipse(e,t,i,i,n,r,a)},ellipse:function(e,t,i,n,r,a,o,s){var l=this.actions[this.actions.length-1].args,c=l[l.length-2],u=l[l.length-1];this.absellipse(e+c,t+u,i,n,r,a,o,s)},absellipse:function(e,t,i,n,r,a,o,s){var l=[e,t,i,n,r,a,o,s||0],c=new q.EllipseCurve(e,t,i,n,r,a,o,s);this.curves.push(c);var u=c.getPoint(1);l.push(u.x),l.push(u.y),this.actions.push({action:"ellipse",args:l})},getSpacedPoints:function(e){e||(e=40);for(var t=[],i=0;i<e;i++)t.push(this.getPoint(i/e));return this.autoClose&&t.push(t[0]),t},getPoints:function(e){e=e||12;for(var t,i,n,r,a,o,s,l,c,u,h,d=q.ShapeUtils.b2,p=q.ShapeUtils.b3,f=[],g=0,_=this.actions.length;g<_;g++){var m=this.actions[g],v=m.action,y=m.args;switch(v){case"moveTo":case"lineTo":f.push(new q.Vector2(y[0],y[1]));break;case"quadraticCurveTo":t=y[2],i=y[3],a=y[0],o=y[1],f.length>0?(s=(c=f[f.length-1]).x,l=c.y):(s=(c=this.actions[g-1].args)[c.length-2],l=c[c.length-1]);for(var b=1;b<=e;b++){u=d(D=b/e,s,a,t),h=d(D,l,o,i),f.push(new q.Vector2(u,h))}break;case"bezierCurveTo":t=y[4],i=y[5],a=y[0],o=y[1],n=y[2],r=y[3],f.length>0?(s=(c=f[f.length-1]).x,l=c.y):(s=(c=this.actions[g-1].args)[c.length-2],l=c[c.length-1]);for(b=1;b<=e;b++){u=p(D=b/e,s,a,n,t),h=p(D,l,o,r,i),f.push(new q.Vector2(u,h))}break;case"splineThru":c=this.actions[g-1].args;var S=[new q.Vector2(c[c.length-2],c[c.length-1])],E=e*y[0].length;S=S.concat(y[0]);var w=new q.SplineCurve(S);for(b=1;b<=E;b++)f.push(w.getPointAt(b/E));break;case"arc":var T=y[0],M=y[1],A=y[2],C=y[3],x=y[4],I=!!y[5],P=x-C,L=2*e;for(b=1;b<=L;b++){var D=b/L;I||(D=1-D),R=C+D*P,u=T+A*Math.cos(R),h=M+A*Math.sin(R),f.push(new q.Vector2(u,h))}break;case"ellipse":T=y[0],M=y[1];var R,k,O,N=y[2],F=y[3],V=(C=y[4],x=y[5],I=!!y[6],y[7]);P=x-C,L=2*e;0!==V&&(k=Math.cos(V),O=Math.sin(V));for(b=1;b<=L;b++){D=b/L;if(I||(D=1-D),R=C+D*P,u=T+N*Math.cos(R),h=M+F*Math.sin(R),0!==V){var B=u;u=(B-T)*k-(h-M)*O+T,h=(B-T)*O+(h-M)*k+M}f.push(new q.Vector2(u,h))}}}var U=f[f.length-1];return Math.abs(U.x-f[0].x)<Number.EPSILON&&Math.abs(U.y-f[0].y)<Number.EPSILON&&f.splice(f.length-1,1),this.autoClose&&f.push(f[0]),f},toShapes:function(e,t){function i(e){for(var t=[],i=0,n=e.length;i<n;i++){var r=e[i],a=new q.Shape;a.actions=r.actions,a.curves=r.curves,t.push(a)}return t}function n(e,t){for(var i=t.length,n=!1,r=i-1,a=0;a<i;r=a++){var o=t[r],s=t[a],l=s.x-o.x,c=s.y-o.y;if(Math.abs(c)>Number.EPSILON){if(c<0&&(o=t[a],l=-l,s=t[r],c=-c),e.y<o.y||e.y>s.y)continue;if(e.y===o.y){if(e.x===o.x)return!0}else{var u=c*(e.x-o.x)-l*(e.y-o.y);if(0===u)return!0;if(u<0)continue;n=!n}}else{if(e.y!==o.y)continue;if(s.x<=e.x&&e.x<=o.x||o.x<=e.x&&e.x<=s.x)return!0}}return n}var r=q.ShapeUtils.isClockWise,a=function(e){for(var t=[],i=new q.Path,n=0,r=e.length;n<r;n++){var a=e[n],o=a.args,s=a.action;"moveTo"===s&&0!==i.actions.length&&(t.push(i),i=new q.Path),i[s].apply(i,o)}return 0!==i.actions.length&&t.push(i),t}(this.actions);if(0===a.length)return[];if(!0===t)return i(a);var o,s,l,c=[];if(1===a.length)return s=a[0],(l=new q.Shape).actions=s.actions,l.curves=s.curves,c.push(l),c;var u=!r(a[0].getPoints());u=e?!u:u;var h,d,p=[],f=[],g=[],_=0;f[_]=void 0,g[_]=[];for(var m=0,v=a.length;m<v;m++)o=r(h=(s=a[m]).getPoints()),(o=e?!o:o)?(!u&&f[_]&&_++,f[_]={s:new q.Shape,p:h},f[_].s.actions=s.actions,f[_].s.curves=s.curves,u&&_++,g[_]=[]):g[_].push({h:s,p:h[0]});if(!f[0])return i(a);if(f.length>1){for(var y=!1,b=[],S=0,E=f.length;S<E;S++)p[S]=[];for(S=0,E=f.length;S<E;S++)for(var w=g[S],T=0;T<w.length;T++){for(var M=w[T],A=!0,C=0;C<f.length;C++)n(M.p,f[C].p)&&(S!==C&&b.push({froms:S,tos:C,hole:T}),A?(A=!1,p[C].push(M)):y=!0);A&&p[S].push(M)}b.length>0&&(y||(g=p))}m=0;for(var x=f.length;m<x;m++){l=f[m].s,c.push(l);for(var I=0,P=(d=g[m]).length;I<P;I++)l.holes.push(d[I].h)}return c}}),q.Shape=function(){q.Path.apply(this,arguments),this.holes=[]},q.Shape.prototype=Object.assign(Object.create(q.Path.prototype),{constructor:q.Shape,extrude:function(e){return new q.ExtrudeGeometry(this,e)},makeGeometry:function(e){return new q.ShapeGeometry(this,e)},getPointsHoles:function(e){for(var t=[],i=0,n=this.holes.length;i<n;i++)t[i]=this.holes[i].getPoints(e);return t},extractAllPoints:function(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}},extractPoints:function(e){return this.extractAllPoints(e)}}),q.LineCurve=function(e,t){this.v1=e,this.v2=t},q.LineCurve.prototype=Object.create(q.Curve.prototype),q.LineCurve.prototype.constructor=q.LineCurve,q.LineCurve.prototype.getPoint=function(e){var t=this.v2.clone().sub(this.v1);return t.multiplyScalar(e).add(this.v1),t},q.LineCurve.prototype.getPointAt=function(e){return this.getPoint(e)},q.LineCurve.prototype.getTangent=function(e){return this.v2.clone().sub(this.v1).normalize()},q.QuadraticBezierCurve=function(e,t,i){this.v0=e,this.v1=t,this.v2=i},q.QuadraticBezierCurve.prototype=Object.create(q.Curve.prototype),q.QuadraticBezierCurve.prototype.constructor=q.QuadraticBezierCurve,q.QuadraticBezierCurve.prototype.getPoint=function(e){var t=q.ShapeUtils.b2;return new q.Vector2(t(e,this.v0.x,this.v1.x,this.v2.x),t(e,this.v0.y,this.v1.y,this.v2.y))},q.QuadraticBezierCurve.prototype.getTangent=function(e){var t=q.CurveUtils.tangentQuadraticBezier;return new q.Vector2(t(e,this.v0.x,this.v1.x,this.v2.x),t(e,this.v0.y,this.v1.y,this.v2.y)).normalize()},q.CubicBezierCurve=function(e,t,i,n){this.v0=e,this.v1=t,this.v2=i,this.v3=n},q.CubicBezierCurve.prototype=Object.create(q.Curve.prototype),q.CubicBezierCurve.prototype.constructor=q.CubicBezierCurve,q.CubicBezierCurve.prototype.getPoint=function(e){var t=q.ShapeUtils.b3;return new q.Vector2(t(e,this.v0.x,this.v1.x,this.v2.x,this.v3.x),t(e,this.v0.y,this.v1.y,this.v2.y,this.v3.y))},q.CubicBezierCurve.prototype.getTangent=function(e){var t=q.CurveUtils.tangentCubicBezier;return new q.Vector2(t(e,this.v0.x,this.v1.x,this.v2.x,this.v3.x),t(e,this.v0.y,this.v1.y,this.v2.y,this.v3.y)).normalize()},q.SplineCurve=function(e){this.points=null==e?[]:e},q.SplineCurve.prototype=Object.create(q.Curve.prototype),q.SplineCurve.prototype.constructor=q.SplineCurve,q.SplineCurve.prototype.getPoint=function(e){var t=this.points,i=(t.length-1)*e,n=Math.floor(i),r=i-n,a=t[0===n?n:n-1],o=t[n],s=t[n>t.length-2?t.length-1:n+1],l=t[n>t.length-3?t.length-1:n+2],c=q.CurveUtils.interpolate;return new q.Vector2(c(a.x,o.x,s.x,l.x,r),c(a.y,o.y,s.y,l.y,r))},q.EllipseCurve=function(e,t,i,n,r,a,o,s){this.aX=e,this.aY=t,this.xRadius=i,this.yRadius=n,this.aStartAngle=r,this.aEndAngle=a,this.aClockwise=o,this.aRotation=s||0},q.EllipseCurve.prototype=Object.create(q.Curve.prototype),q.EllipseCurve.prototype.constructor=q.EllipseCurve,q.EllipseCurve.prototype.getPoint=function(e){var t,i=this.aEndAngle-this.aStartAngle;i<0&&(i+=2*Math.PI),i>2*Math.PI&&(i-=2*Math.PI),t=!0===this.aClockwise?this.aEndAngle+(1-e)*(2*Math.PI-i):this.aStartAngle+e*i;var n=this.aX+this.xRadius*Math.cos(t),r=this.aY+this.yRadius*Math.sin(t);if(0!==this.aRotation){var a=Math.cos(this.aRotation),o=Math.sin(this.aRotation),s=n,l=r;n=(s-this.aX)*a-(l-this.aY)*o+this.aX,r=(s-this.aX)*o+(l-this.aY)*a+this.aY}return new q.Vector2(n,r)},q.ArcCurve=function(e,t,i,n,r,a){q.EllipseCurve.call(this,e,t,i,i,n,r,a)},q.ArcCurve.prototype=Object.create(q.EllipseCurve.prototype),q.ArcCurve.prototype.constructor=q.ArcCurve,q.LineCurve3=q.Curve.create((function(e,t){this.v1=e,this.v2=t}),(function(e){var t=new q.Vector3;return t.subVectors(this.v2,this.v1),t.multiplyScalar(e),t.add(this.v1),t})),q.QuadraticBezierCurve3=q.Curve.create((function(e,t,i){this.v0=e,this.v1=t,this.v2=i}),(function(e){var t=q.ShapeUtils.b2;return new q.Vector3(t(e,this.v0.x,this.v1.x,this.v2.x),t(e,this.v0.y,this.v1.y,this.v2.y),t(e,this.v0.z,this.v1.z,this.v2.z))})),q.CubicBezierCurve3=q.Curve.create((function(e,t,i,n){this.v0=e,this.v1=t,this.v2=i,this.v3=n}),(function(e){var t=q.ShapeUtils.b3;return new q.Vector3(t(e,this.v0.x,this.v1.x,this.v2.x,this.v3.x),t(e,this.v0.y,this.v1.y,this.v2.y,this.v3.y),t(e,this.v0.z,this.v1.z,this.v2.z,this.v3.z))})),q.SplineCurve3=q.Curve.create((function(e){console.warn("THREE.SplineCurve3 will be deprecated. Please use THREE.CatmullRomCurve3"),this.points=null==e?[]:e}),(function(e){var t=this.points,i=(t.length-1)*e,n=Math.floor(i),r=i-n,a=t[0==n?n:n-1],o=t[n],s=t[n>t.length-2?t.length-1:n+1],l=t[n>t.length-3?t.length-1:n+2],c=q.CurveUtils.interpolate;return new q.Vector3(c(a.x,o.x,s.x,l.x,r),c(a.y,o.y,s.y,l.y,r),c(a.z,o.z,s.z,l.z,r))})),q.CatmullRomCurve3=function(){var e=new q.Vector3,t=new r,i=new r,n=new r;function r(){}return r.prototype.init=function(e,t,i,n){this.c0=e,this.c1=i,this.c2=-3*e+3*t-2*i-n,this.c3=2*e-2*t+i+n},r.prototype.initNonuniformCatmullRom=function(e,t,i,n,r,a,o){var s=(t-e)/r-(i-e)/(r+a)+(i-t)/a,l=(i-t)/a-(n-t)/(a+o)+(n-i)/o;s*=a,l*=a,this.init(t,i,s,l)},r.prototype.initCatmullRom=function(e,t,i,n,r){this.init(t,i,r*(i-e),r*(n-t))},r.prototype.calc=function(e){var t=e*e,i=t*e;return this.c0+this.c1*e+this.c2*t+this.c3*i},q.Curve.create((function(e){this.points=e||[],this.closed=!1}),(function(r){var a,o,s,l,c,u,h,d,p=this.points;if((l=p.length)<2&&console.log("duh, you need at least 2 points"),s=(a=(l-(this.closed?0:1))*r)-(o=Math.floor(a)),this.closed?o+=o>0?0:(Math.floor(Math.abs(o)/p.length)+1)*p.length:0===s&&o===l-1&&(o=l-2,s=1),this.closed||o>0?c=p[(o-1)%l]:(e.subVectors(p[0],p[1]).add(p[0]),c=e),u=p[o%l],h=p[(o+1)%l],this.closed||o+2<l?d=p[(o+2)%l]:(e.subVectors(p[l-1],p[l-2]).add(p[l-1]),d=e),void 0===this.type||"centripetal"===this.type||"chordal"===this.type){var f="chordal"===this.type?.5:.25,g=Math.pow(c.distanceToSquared(u),f),_=Math.pow(u.distanceToSquared(h),f),m=Math.pow(h.distanceToSquared(d),f);_<1e-4&&(_=1),g<1e-4&&(g=_),m<1e-4&&(m=_),t.initNonuniformCatmullRom(c.x,u.x,h.x,d.x,g,_,m),i.initNonuniformCatmullRom(c.y,u.y,h.y,d.y,g,_,m),n.initNonuniformCatmullRom(c.z,u.z,h.z,d.z,g,_,m)}else if("catmullrom"===this.type){var v=void 0!==this.tension?this.tension:.5;t.initCatmullRom(c.x,u.x,h.x,d.x,v),i.initCatmullRom(c.y,u.y,h.y,d.y,v),n.initCatmullRom(c.z,u.z,h.z,d.z,v)}return new q.Vector3(t.calc(s),i.calc(s),n.calc(s))}))}(),q.ClosedSplineCurve3=function(e){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Please use THREE.CatmullRomCurve3."),q.CatmullRomCurve3.call(this,e),this.type="catmullrom",this.closed=!0},q.ClosedSplineCurve3.prototype=Object.create(q.CatmullRomCurve3.prototype),q.BoxGeometry=function(e,t,i,n,r,a){q.Geometry.call(this),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:n,heightSegments:r,depthSegments:a},this.fromBufferGeometry(new q.BoxBufferGeometry(e,t,i,n,r,a)),this.mergeVertices()},q.BoxGeometry.prototype=Object.create(q.Geometry.prototype),q.BoxGeometry.prototype.constructor=q.BoxGeometry,q.CubeGeometry=q.BoxGeometry,q.BoxBufferGeometry=function(e,t,i,n,r,a){q.BufferGeometry.call(this),this.type="BoxBufferGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:n,heightSegments:r,depthSegments:a};var o=this,s=function(e,t,i){var n=0;return n+=(e+1)*(t+1)*2,n+=(e+1)*(i+1)*2,n+=(i+1)*(t+1)*2}(n=Math.floor(n)||1,r=Math.floor(r)||1,a=Math.floor(a)||1),l=function(e,t,i){var n=0;return n+=e*t*2,n+=e*i*2,6*(n+=i*t*2)}(n,r,a),c=new(l>65535?Uint32Array:Uint16Array)(l),u=new Float32Array(3*s),h=new Float32Array(3*s),d=new Float32Array(2*s),p=0,f=0,g=0,_=0,m=0;function v(e,t,i,n,r,a,s,l,v,y,b){for(var S=a/v,E=s/y,w=a/2,T=s/2,M=l/2,A=v+1,C=y+1,x=0,I=0,P=new q.Vector3,L=0;L<C;L++)for(var D=L*E-T,R=0;R<A;R++){var k=R*S-w;P[e]=k*n,P[t]=D*r,P[i]=M,u[p]=P.x,u[p+1]=P.y,u[p+2]=P.z,P[e]=0,P[t]=0,P[i]=l>0?1:-1,h[p]=P.x,h[p+1]=P.y,h[p+2]=P.z,d[f]=R/v,d[f+1]=1-L/y,p+=3,f+=2,x+=1}for(L=0;L<y;L++)for(R=0;R<v;R++){var O=_+R+A*L,N=_+R+A*(L+1),F=_+(R+1)+A*(L+1),V=_+(R+1)+A*L;c[g]=O,c[g+1]=N,c[g+2]=V,c[g+3]=N,c[g+4]=F,c[g+5]=V,g+=6,I+=6}o.addGroup(m,I,b),m+=I,_+=x}v("z","y","x",-1,-1,i,t,e,a,r,0),v("z","y","x",1,-1,i,t,-e,a,r,1),v("x","z","y",1,1,e,i,t,n,a,2),v("x","z","y",1,-1,e,i,-t,n,a,3),v("x","y","z",1,-1,e,t,i,n,r,4),v("x","y","z",-1,-1,e,t,-i,n,r,5),this.setIndex(new q.BufferAttribute(c,1)),this.addAttribute("position",new q.BufferAttribute(u,3)),this.addAttribute("normal",new q.BufferAttribute(h,3)),this.addAttribute("uv",new q.BufferAttribute(d,2))},q.BoxBufferGeometry.prototype=Object.create(q.BufferGeometry.prototype),q.BoxBufferGeometry.prototype.constructor=q.BoxBufferGeometry,q.CircleGeometry=function(e,t,i,n){q.Geometry.call(this),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:i,thetaLength:n},this.fromBufferGeometry(new q.CircleBufferGeometry(e,t,i,n))},q.CircleGeometry.prototype=Object.create(q.Geometry.prototype),q.CircleGeometry.prototype.constructor=q.CircleGeometry,q.CircleBufferGeometry=function(e,t,i,n){q.BufferGeometry.call(this),this.type="CircleBufferGeometry",this.parameters={radius:e,segments:t,thetaStart:i,thetaLength:n},e=e||50,t=void 0!==t?Math.max(3,t):8,i=void 0!==i?i:0,n=void 0!==n?n:2*Math.PI;var r=t+2,a=new Float32Array(3*r),o=new Float32Array(3*r),s=new Float32Array(2*r);o[2]=1,s[0]=.5,s[1]=.5;for(var l=0,c=3,u=2;l<=t;l++,c+=3,u+=2){var h=i+l/t*n;a[c]=e*Math.cos(h),a[c+1]=e*Math.sin(h),o[c+2]=1,s[u]=(a[c]/e+1)/2,s[u+1]=(a[c+1]/e+1)/2}var d=[];for(c=1;c<=t;c++)d.push(c,c+1,0);this.setIndex(new q.BufferAttribute(new Uint16Array(d),1)),this.addAttribute("position",new q.BufferAttribute(a,3)),this.addAttribute("normal",new q.BufferAttribute(o,3)),this.addAttribute("uv",new q.BufferAttribute(s,2)),this.boundingSphere=new q.Sphere(new q.Vector3,e)},q.CircleBufferGeometry.prototype=Object.create(q.BufferGeometry.prototype),q.CircleBufferGeometry.prototype.constructor=q.CircleBufferGeometry,q.CylinderBufferGeometry=function(e,t,i,n,r,a,o,s){q.BufferGeometry.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:i,radialSegments:n,heightSegments:r,openEnded:a,thetaStart:o,thetaLength:s};var l=this;e=void 0!==e?e:20,t=void 0!==t?t:20,i=void 0!==i?i:100,n=Math.floor(n)||8,r=Math.floor(r)||1,a=void 0!==a&&a,o=void 0!==o?o:0,s=void 0!==s?s:2*Math.PI;var c=0;!1===a&&(e>0&&c++,t>0&&c++);var u=function(){var e=(n+1)*(r+1);!1===a&&(e+=(n+1)*c+n*c);return e}(),h=function(){var e=n*r*2*3;!1===a&&(e+=n*c*3);return e}(),d=new q.BufferAttribute(new(h>65535?Uint32Array:Uint16Array)(h),1),p=new q.BufferAttribute(new Float32Array(3*u),3),f=new q.BufferAttribute(new Float32Array(3*u),3),g=new q.BufferAttribute(new Float32Array(2*u),2),_=0,m=0,v=[],y=i/2,b=0;function S(i){var r,a,c,u=new q.Vector2,h=new q.Vector3,v=0,S=!0===i?e:t,E=!0===i?1:-1;for(a=_,r=1;r<=n;r++)p.setXYZ(_,0,y*E,0),f.setXYZ(_,0,E,0),u.x=.5,u.y=.5,g.setXY(_,u.x,u.y),_++;for(c=_,r=0;r<=n;r++){var w=r/n*s+o,T=Math.cos(w),M=Math.sin(w);h.x=S*M,h.y=y*E,h.z=S*T,p.setXYZ(_,h.x,h.y,h.z),f.setXYZ(_,0,E,0),u.x=.5*T+.5,u.y=.5*M*E+.5,g.setXY(_,u.x,u.y),_++}for(r=0;r<n;r++){var A=a+r,C=c+r;!0===i?(d.setX(m,C),m++,d.setX(m,C+1),m++,d.setX(m,A),m++):(d.setX(m,C+1),m++,d.setX(m,C),m++,d.setX(m,A),m++),v+=3}l.addGroup(b,v,!0===i?1:2),b+=v}!function(){var a,c,u=new q.Vector3,h=new q.Vector3,S=0,E=(t-e)/i;for(c=0;c<=r;c++){var w=[],T=c/r,M=T*(t-e)+e;for(a=0;a<=n;a++){var A=a/n;h.x=M*Math.sin(A*s+o),h.y=-T*i+y,h.z=M*Math.cos(A*s+o),p.setXYZ(_,h.x,h.y,h.z),u.copy(h),(0===e&&0===c||0===t&&c===r)&&(u.x=Math.sin(A*s+o),u.z=Math.cos(A*s+o)),u.setY(Math.sqrt(u.x*u.x+u.z*u.z)*E).normalize(),f.setXYZ(_,u.x,u.y,u.z),g.setXY(_,A,1-T),w.push(_),_++}v.push(w)}for(a=0;a<n;a++)for(c=0;c<r;c++){var C=v[c][a],x=v[c+1][a],I=v[c+1][a+1],P=v[c][a+1];d.setX(m,C),m++,d.setX(m,x),m++,d.setX(m,P),m++,d.setX(m,x),m++,d.setX(m,I),m++,d.setX(m,P),m++,S+=6}l.addGroup(b,S,0),b+=S}(),!1===a&&(e>0&&S(!0),t>0&&S(!1)),this.setIndex(d),this.addAttribute("position",p),this.addAttribute("normal",f),this.addAttribute("uv",g)},q.CylinderBufferGeometry.prototype=Object.create(q.BufferGeometry.prototype),q.CylinderBufferGeometry.prototype.constructor=q.CylinderBufferGeometry,q.CylinderGeometry=function(e,t,i,n,r,a,o,s){q.Geometry.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:i,radialSegments:n,heightSegments:r,openEnded:a,thetaStart:o,thetaLength:s},this.fromBufferGeometry(new q.CylinderBufferGeometry(e,t,i,n,r,a,o,s)),this.mergeVertices()},q.CylinderGeometry.prototype=Object.create(q.Geometry.prototype),q.CylinderGeometry.prototype.constructor=q.CylinderGeometry,q.ConeBufferGeometry=function(e,t,i,n,r,a,o){q.CylinderBufferGeometry.call(this,0,e,t,i,n,r,a,o),this.type="ConeBufferGeometry",this.parameters={radius:e,height:t,radialSegments:i,heightSegments:n,thetaStart:a,thetaLength:o}},q.ConeBufferGeometry.prototype=Object.create(q.BufferGeometry.prototype),q.ConeBufferGeometry.prototype.constructor=q.ConeBufferGeometry,q.ConeGeometry=function(e,t,i,n,r,a,o){q.CylinderGeometry.call(this,0,e,t,i,n,r,a,o),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:i,heightSegments:n,openEnded:r,thetaStart:a,thetaLength:o}},q.ConeGeometry.prototype=Object.create(q.CylinderGeometry.prototype),q.ConeGeometry.prototype.constructor=q.ConeGeometry,q.EdgesGeometry=function(e,t){q.BufferGeometry.call(this),t=void 0!==t?t:1;var i=Math.cos(q.Math.DEG2RAD*t),n=[0,0],r={};function a(e,t){return e-t}var o,s=["a","b","c"];e instanceof q.BufferGeometry?(o=new q.Geometry).fromBufferGeometry(e):o=e.clone(),o.mergeVertices(),o.computeFaceNormals();for(var l=o.vertices,c=o.faces,u=0,h=c.length;u<h;u++)for(var d=c[u],p=0;p<3;p++){n[0]=d[s[p]],n[1]=d[s[(p+1)%3]],n.sort(a),void 0===r[g=n.toString()]?r[g]={vert1:n[0],vert2:n[1],face1:u,face2:void 0}:r[g].face2=u}var f=[];for(var g in r){var _=r[g];if(void 0===_.face2||c[_.face1].normal.dot(c[_.face2].normal)<=i){var m=l[_.vert1];f.push(m.x),f.push(m.y),f.push(m.z),m=l[_.vert2],f.push(m.x),f.push(m.y),f.push(m.z)}}this.addAttribute("position",new q.BufferAttribute(new Float32Array(f),3))},q.EdgesGeometry.prototype=Object.create(q.BufferGeometry.prototype),q.EdgesGeometry.prototype.constructor=q.EdgesGeometry,q.ExtrudeGeometry=function(e,t){void 0!==e?(q.Geometry.call(this),this.type="ExtrudeGeometry",e=Array.isArray(e)?e:[e],this.addShapeList(e,t),this.computeFaceNormals()):e=[]},q.ExtrudeGeometry.prototype=Object.create(q.Geometry.prototype),q.ExtrudeGeometry.prototype.constructor=q.ExtrudeGeometry,q.ExtrudeGeometry.prototype.addShapeList=function(e,t){for(var i=e.length,n=0;n<i;n++){var r=e[n];this.addShape(r,t)}},q.ExtrudeGeometry.prototype.addShape=function(e,t){var i,n,r,a,o,s,l,c,u=void 0!==t.amount?t.amount:100,h=void 0!==t.bevelThickness?t.bevelThickness:6,d=void 0!==t.bevelSize?t.bevelSize:h-2,p=void 0!==t.bevelSegments?t.bevelSegments:3,f=void 0===t.bevelEnabled||t.bevelEnabled,g=void 0!==t.curveSegments?t.curveSegments:12,_=void 0!==t.steps?t.steps:1,m=t.extrudePath,v=!1,y=void 0!==t.UVGenerator?t.UVGenerator:q.ExtrudeGeometry.WorldUVGenerator;m&&(i=m.getSpacedPoints(_),v=!0,f=!1,n=void 0!==t.frames?t.frames:new q.TubeGeometry.FrenetFrames(m,_,!1),r=new q.Vector3,a=new q.Vector3,o=new q.Vector3),f||(p=0,h=0,d=0);var b=this,S=this.vertices.length,E=e.extractPoints(g),w=E.shape,T=E.holes,M=!q.ShapeUtils.isClockWise(w);if(M){for(w=w.reverse(),l=0,c=T.length;l<c;l++)s=T[l],q.ShapeUtils.isClockWise(s)&&(T[l]=s.reverse());M=!1}var A=q.ShapeUtils.triangulateShape(w,T),C=w;for(l=0,c=T.length;l<c;l++)s=T[l],w=w.concat(s);function x(e,t,i){return t||console.error("THREE.ExtrudeGeometry: vec does not exist"),t.clone().multiplyScalar(i).add(e)}var I,P,L,D,R,k,O=w.length,N=A.length;function F(e,t,i){var n,r,a=1,o=e.x-t.x,s=e.y-t.y,l=i.x-e.x,c=i.y-e.y,u=o*o+s*s,h=o*c-s*l;if(Math.abs(h)>Number.EPSILON){var d=Math.sqrt(u),p=Math.sqrt(l*l+c*c),f=t.x-s/d,g=t.y+o/d,_=((i.x-c/p-f)*c-(i.y+l/p-g)*l)/(o*c-s*l),m=(n=f+o*_-e.x)*n+(r=g+s*_-e.y)*r;if(m<=2)return new q.Vector2(n,r);a=Math.sqrt(m/2)}else{var v=!1;o>Number.EPSILON?l>Number.EPSILON&&(v=!0):o<-Number.EPSILON?l<-Number.EPSILON&&(v=!0):Math.sign(s)===Math.sign(c)&&(v=!0),v?(n=-s,r=o,a=Math.sqrt(u)):(n=o,r=s,a=Math.sqrt(u/2))}return new q.Vector2(n/a,r/a)}for(var V=[],B=0,U=C.length,H=U-1,G=B+1;B<U;B++,H++,G++)H===U&&(H=0),G===U&&(G=0),V[B]=F(C[B],C[H],C[G]);var j,z,W=[],Y=V.concat();for(l=0,c=T.length;l<c;l++){for(s=T[l],j=[],B=0,H=(U=s.length)-1,G=B+1;B<U;B++,H++,G++)H===U&&(H=0),G===U&&(G=0),j[B]=F(s[B],s[H],s[G]);W.push(j),Y=Y.concat(j)}for(I=0;I<p;I++){for(D=h*(1-(L=I/p)),P=d*Math.sin(L*Math.PI/2),B=0,U=C.length;B<U;B++)X((R=x(C[B],V[B],P)).x,R.y,-D);for(l=0,c=T.length;l<c;l++)for(s=T[l],j=W[l],B=0,U=s.length;B<U;B++)X((R=x(s[B],j[B],P)).x,R.y,-D)}for(P=d,B=0;B<O;B++)R=f?x(w[B],Y[B],P):w[B],v?(a.copy(n.normals[0]).multiplyScalar(R.x),r.copy(n.binormals[0]).multiplyScalar(R.y),o.copy(i[0]).add(a).add(r),X(o.x,o.y,o.z)):X(R.x,R.y,0);for(z=1;z<=_;z++)for(B=0;B<O;B++)R=f?x(w[B],Y[B],P):w[B],v?(a.copy(n.normals[z]).multiplyScalar(R.x),r.copy(n.binormals[z]).multiplyScalar(R.y),o.copy(i[z]).add(a).add(r),X(o.x,o.y,o.z)):X(R.x,R.y,u/_*z);for(I=p-1;I>=0;I--){for(D=h*(1-(L=I/p)),P=d*Math.sin(L*Math.PI/2),B=0,U=C.length;B<U;B++)X((R=x(C[B],V[B],P)).x,R.y,u+D);for(l=0,c=T.length;l<c;l++)for(s=T[l],j=W[l],B=0,U=s.length;B<U;B++)R=x(s[B],j[B],P),v?X(R.x,R.y+i[_-1].y,i[_-1].x+D):X(R.x,R.y,u+D)}function K(e,t){var i,n;for(B=e.length;--B>=0;){i=B,(n=B-1)<0&&(n=e.length-1);var r=0,a=_+2*p;for(r=0;r<a;r++){var o=O*r,s=O*(r+1);Z(t+i+o,t+n+o,t+n+s,t+i+s,e,r,a,i,n)}}}function X(e,t,i){b.vertices.push(new q.Vector3(e,t,i))}function Q(e,t,i){e+=S,t+=S,i+=S,b.faces.push(new q.Face3(e,t,i,null,null,0));var n=y.generateTopUV(b,e,t,i);b.faceVertexUvs[0].push(n)}function Z(e,t,i,n,r,a,o,s,l){e+=S,t+=S,i+=S,n+=S,b.faces.push(new q.Face3(e,t,n,null,null,1)),b.faces.push(new q.Face3(t,i,n,null,null,1));var c=y.generateSideWallUV(b,e,t,i,n);b.faceVertexUvs[0].push([c[0],c[1],c[3]]),b.faceVertexUvs[0].push([c[1],c[2],c[3]])}!function(){if(f){var e=0,t=O*e;for(B=0;B<N;B++)Q((k=A[B])[2]+t,k[1]+t,k[0]+t);for(t=O*(e=_+2*p),B=0;B<N;B++)Q((k=A[B])[0]+t,k[1]+t,k[2]+t)}else{for(B=0;B<N;B++)Q((k=A[B])[2],k[1],k[0]);for(B=0;B<N;B++)Q((k=A[B])[0]+O*_,k[1]+O*_,k[2]+O*_)}}(),function(){var e=0;for(K(C,e),e+=C.length,l=0,c=T.length;l<c;l++)K(s=T[l],e),e+=s.length}()},q.ExtrudeGeometry.WorldUVGenerator={generateTopUV:function(e,t,i,n){var r=e.vertices,a=r[t],o=r[i],s=r[n];return[new q.Vector2(a.x,a.y),new q.Vector2(o.x,o.y),new q.Vector2(s.x,s.y)]},generateSideWallUV:function(e,t,i,n,r){var a=e.vertices,o=a[t],s=a[i],l=a[n],c=a[r];return Math.abs(o.y-s.y)<.01?[new q.Vector2(o.x,1-o.z),new q.Vector2(s.x,1-s.z),new q.Vector2(l.x,1-l.z),new q.Vector2(c.x,1-c.z)]:[new q.Vector2(o.y,1-o.z),new q.Vector2(s.y,1-s.z),new q.Vector2(l.y,1-l.z),new q.Vector2(c.y,1-c.z)]}},q.ShapeGeometry=function(e,t){q.Geometry.call(this),this.type="ShapeGeometry",!1===Array.isArray(e)&&(e=[e]),this.addShapeList(e,t),this.computeFaceNormals()},q.ShapeGeometry.prototype=Object.create(q.Geometry.prototype),q.ShapeGeometry.prototype.constructor=q.ShapeGeometry,q.ShapeGeometry.prototype.addShapeList=function(e,t){for(var i=0,n=e.length;i<n;i++)this.addShape(e[i],t);return this},q.ShapeGeometry.prototype.addShape=function(e,t){void 0===t&&(t={});var i,n,r,a=void 0!==t.curveSegments?t.curveSegments:12,o=t.material,s=void 0===t.UVGenerator?q.ExtrudeGeometry.WorldUVGenerator:t.UVGenerator,l=this.vertices.length,c=e.extractPoints(a),u=c.shape,h=c.holes,d=!q.ShapeUtils.isClockWise(u);if(d){for(u=u.reverse(),i=0,n=h.length;i<n;i++)r=h[i],q.ShapeUtils.isClockWise(r)&&(h[i]=r.reverse());d=!1}var p=q.ShapeUtils.triangulateShape(u,h);for(i=0,n=h.length;i<n;i++)r=h[i],u=u.concat(r);var f,g,_=u.length,m=p.length;for(i=0;i<_;i++)f=u[i],this.vertices.push(new q.Vector3(f.x,f.y,0));for(i=0;i<m;i++){var v=(g=p[i])[0]+l,y=g[1]+l,b=g[2]+l;this.faces.push(new q.Face3(v,y,b,null,null,o)),this.faceVertexUvs[0].push(s.generateTopUV(this,v,y,b))}},q.LatheBufferGeometry=function(e,t,i,n){q.BufferGeometry.call(this),this.type="LatheBufferGeometry",this.parameters={points:e,segments:t,phiStart:i,phiLength:n},t=Math.floor(t)||12,i=i||0,n=n||2*Math.PI,n=q.Math.clamp(n,0,2*Math.PI);var r,a,o,s=(t+1)*e.length,l=t*e.length*2*3,c=new q.BufferAttribute(new(l>65535?Uint32Array:Uint16Array)(l),1),u=new q.BufferAttribute(new Float32Array(3*s),3),h=new q.BufferAttribute(new Float32Array(2*s),2),d=0,p=0,f=(e.length,1/t),g=new q.Vector3,_=new q.Vector2;for(a=0;a<=t;a++){var m=i+a*f*n,v=Math.sin(m),y=Math.cos(m);for(o=0;o<=e.length-1;o++)g.x=e[o].x*v,g.y=e[o].y,g.z=e[o].x*y,u.setXYZ(d,g.x,g.y,g.z),_.x=a/t,_.y=o/(e.length-1),h.setXY(d,_.x,_.y),d++}for(a=0;a<t;a++)for(o=0;o<e.length-1;o++){var b=r=o+a*e.length,S=r+e.length,E=r+e.length+1,w=r+1;c.setX(p,b),p++,c.setX(p,S),p++,c.setX(p,w),p++,c.setX(p,S),p++,c.setX(p,E),p++,c.setX(p,w),p++}if(this.setIndex(c),this.addAttribute("position",u),this.addAttribute("uv",h),this.computeVertexNormals(),n===2*Math.PI){var T=this.attributes.normal.array,M=new q.Vector3,A=new q.Vector3,C=new q.Vector3;for(r=t*e.length*3,a=0,o=0;a<e.length;a++,o+=3)M.x=T[o+0],M.y=T[o+1],M.z=T[o+2],A.x=T[r+o+0],A.y=T[r+o+1],A.z=T[r+o+2],C.addVectors(M,A).normalize(),T[o+0]=T[r+o+0]=C.x,T[o+1]=T[r+o+1]=C.y,T[o+2]=T[r+o+2]=C.z}},q.LatheBufferGeometry.prototype=Object.create(q.BufferGeometry.prototype),q.LatheBufferGeometry.prototype.constructor=q.LatheBufferGeometry,q.LatheGeometry=function(e,t,i,n){q.Geometry.call(this),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:i,phiLength:n},this.fromBufferGeometry(new q.LatheBufferGeometry(e,t,i,n)),this.mergeVertices()},q.LatheGeometry.prototype=Object.create(q.Geometry.prototype),q.LatheGeometry.prototype.constructor=q.LatheGeometry,q.PlaneGeometry=function(e,t,i,n){q.Geometry.call(this),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:n},this.fromBufferGeometry(new q.PlaneBufferGeometry(e,t,i,n))},q.PlaneGeometry.prototype=Object.create(q.Geometry.prototype),q.PlaneGeometry.prototype.constructor=q.PlaneGeometry,q.PlaneBufferGeometry=function(e,t,i,n){q.BufferGeometry.call(this),this.type="PlaneBufferGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:n};for(var r=e/2,a=t/2,o=Math.floor(i)||1,s=Math.floor(n)||1,l=o+1,c=s+1,u=e/o,h=t/s,d=new Float32Array(l*c*3),p=new Float32Array(l*c*3),f=new Float32Array(l*c*2),g=0,_=0,m=0;m<c;m++)for(var v=m*h-a,y=0;y<l;y++){var b=y*u-r;d[g]=b,d[g+1]=-v,p[g+2]=1,f[_]=y/o,f[_+1]=1-m/s,g+=3,_+=2}g=0;var S=new(d.length/3>65535?Uint32Array:Uint16Array)(o*s*6);for(m=0;m<s;m++)for(y=0;y<o;y++){var E=y+l*m,w=y+l*(m+1),T=y+1+l*(m+1),M=y+1+l*m;S[g]=E,S[g+1]=w,S[g+2]=M,S[g+3]=w,S[g+4]=T,S[g+5]=M,g+=6}this.setIndex(new q.BufferAttribute(S,1)),this.addAttribute("position",new q.BufferAttribute(d,3)),this.addAttribute("normal",new q.BufferAttribute(p,3)),this.addAttribute("uv",new q.BufferAttribute(f,2))},q.PlaneBufferGeometry.prototype=Object.create(q.BufferGeometry.prototype),q.PlaneBufferGeometry.prototype.constructor=q.PlaneBufferGeometry,q.RingBufferGeometry=function(e,t,i,n,r,a){q.BufferGeometry.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:i,phiSegments:n,thetaStart:r,thetaLength:a},e=e||20,t=t||50,r=void 0!==r?r:0,a=void 0!==a?a:2*Math.PI;var o,s,l,c=((i=void 0!==i?Math.max(3,i):8)+1)*((n=void 0!==n?Math.max(1,n):1)+1),u=i*n*2*3,h=new q.BufferAttribute(new(u>65535?Uint32Array:Uint16Array)(u),1),d=new q.BufferAttribute(new Float32Array(3*c),3),p=new q.BufferAttribute(new Float32Array(3*c),3),f=new q.BufferAttribute(new Float32Array(2*c),2),g=0,_=0,m=e,v=(t-e)/n,y=new q.Vector3,b=new q.Vector2;for(s=0;s<=n;s++){for(l=0;l<=i;l++)o=r+l/i*a,y.x=m*Math.cos(o),y.y=m*Math.sin(o),d.setXYZ(g,y.x,y.y,y.z),p.setXYZ(g,0,0,1),b.x=(y.x/t+1)/2,b.y=(y.y/t+1)/2,f.setXY(g,b.x,b.y),g++;m+=v}for(s=0;s<n;s++){var S=s*(i+1);for(l=0;l<i;l++){var E=o=l+S,w=o+i+1,T=o+i+2,M=o+1;h.setX(_,E),_++,h.setX(_,w),_++,h.setX(_,T),_++,h.setX(_,E),_++,h.setX(_,T),_++,h.setX(_,M),_++}}this.setIndex(h),this.addAttribute("position",d),this.addAttribute("normal",p),this.addAttribute("uv",f)},q.RingBufferGeometry.prototype=Object.create(q.BufferGeometry.prototype),q.RingBufferGeometry.prototype.constructor=q.RingBufferGeometry,q.RingGeometry=function(e,t,i,n,r,a){q.Geometry.call(this),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:i,phiSegments:n,thetaStart:r,thetaLength:a},this.fromBufferGeometry(new q.RingBufferGeometry(e,t,i,n,r,a))},q.RingGeometry.prototype=Object.create(q.Geometry.prototype),q.RingGeometry.prototype.constructor=q.RingGeometry,q.SphereGeometry=function(e,t,i,n,r,a,o){q.Geometry.call(this),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:i,phiStart:n,phiLength:r,thetaStart:a,thetaLength:o},this.fromBufferGeometry(new q.SphereBufferGeometry(e,t,i,n,r,a,o))},q.SphereGeometry.prototype=Object.create(q.Geometry.prototype),q.SphereGeometry.prototype.constructor=q.SphereGeometry,q.SphereBufferGeometry=function(e,t,i,n,r,a,o){q.BufferGeometry.call(this),this.type="SphereBufferGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:i,phiStart:n,phiLength:r,thetaStart:a,thetaLength:o},e=e||50,t=Math.max(3,Math.floor(t)||8),i=Math.max(2,Math.floor(i)||6),n=void 0!==n?n:0,r=void 0!==r?r:2*Math.PI;for(var s=(a=void 0!==a?a:0)+(o=void 0!==o?o:Math.PI),l=(t+1)*(i+1),c=new q.BufferAttribute(new Float32Array(3*l),3),u=new q.BufferAttribute(new Float32Array(3*l),3),h=new q.BufferAttribute(new Float32Array(2*l),2),d=0,p=[],f=new q.Vector3,g=0;g<=i;g++){for(var _=[],m=g/i,v=0;v<=t;v++){var y=v/t,b=-e*Math.cos(n+y*r)*Math.sin(a+m*o),S=e*Math.cos(a+m*o),E=e*Math.sin(n+y*r)*Math.sin(a+m*o);f.set(b,S,E).normalize(),c.setXYZ(d,b,S,E),u.setXYZ(d,f.x,f.y,f.z),h.setXY(d,y,1-m),_.push(d),d++}p.push(_)}var w=[];for(g=0;g<i;g++)for(v=0;v<t;v++){var T=p[g][v+1],M=p[g][v],A=p[g+1][v],C=p[g+1][v+1];(0!==g||a>0)&&w.push(T,M,C),(g!==i-1||s<Math.PI)&&w.push(M,A,C)}this.setIndex(new(c.count>65535?q.Uint32Attribute:q.Uint16Attribute)(w,1)),this.addAttribute("position",c),this.addAttribute("normal",u),this.addAttribute("uv",h),this.boundingSphere=new q.Sphere(new q.Vector3,e)},q.SphereBufferGeometry.prototype=Object.create(q.BufferGeometry.prototype),q.SphereBufferGeometry.prototype.constructor=q.SphereBufferGeometry,q.TextGeometry=function(e,t){var i=(t=t||{}).font;if(i instanceof q.Font==!1)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new q.Geometry;var n=i.generateShapes(e,t.size,t.curveSegments);t.amount=void 0!==t.height?t.height:50,void 0===t.bevelThickness&&(t.bevelThickness=10),void 0===t.bevelSize&&(t.bevelSize=8),void 0===t.bevelEnabled&&(t.bevelEnabled=!1),q.ExtrudeGeometry.call(this,n,t),this.type="TextGeometry"},q.TextGeometry.prototype=Object.create(q.ExtrudeGeometry.prototype),q.TextGeometry.prototype.constructor=q.TextGeometry,q.TorusBufferGeometry=function(e,t,i,n,r){q.BufferGeometry.call(this),this.type="TorusBufferGeometry",this.parameters={radius:e,tube:t,radialSegments:i,tubularSegments:n,arc:r},e=e||100,t=t||40,i=Math.floor(i)||8,n=Math.floor(n)||6,r=r||2*Math.PI;var a,o,s=(i+1)*(n+1),l=i*n*2*3,c=new(l>65535?Uint32Array:Uint16Array)(l),u=new Float32Array(3*s),h=new Float32Array(3*s),d=new Float32Array(2*s),p=0,f=0,g=0,_=new q.Vector3,m=new q.Vector3,v=new q.Vector3;for(a=0;a<=i;a++)for(o=0;o<=n;o++){var y=o/n*r,b=a/i*Math.PI*2;m.x=(e+t*Math.cos(b))*Math.cos(y),m.y=(e+t*Math.cos(b))*Math.sin(y),m.z=t*Math.sin(b),u[p]=m.x,u[p+1]=m.y,u[p+2]=m.z,_.x=e*Math.cos(y),_.y=e*Math.sin(y),v.subVectors(m,_).normalize(),h[p]=v.x,h[p+1]=v.y,h[p+2]=v.z,d[f]=o/n,d[f+1]=a/i,p+=3,f+=2}for(a=1;a<=i;a++)for(o=1;o<=n;o++){var S=(n+1)*a+o-1,E=(n+1)*(a-1)+o-1,w=(n+1)*(a-1)+o,T=(n+1)*a+o;c[g]=S,c[g+1]=E,c[g+2]=T,c[g+3]=E,c[g+4]=w,c[g+5]=T,g+=6}this.setIndex(new q.BufferAttribute(c,1)),this.addAttribute("position",new q.BufferAttribute(u,3)),this.addAttribute("normal",new q.BufferAttribute(h,3)),this.addAttribute("uv",new q.BufferAttribute(d,2))},q.TorusBufferGeometry.prototype=Object.create(q.BufferGeometry.prototype),q.TorusBufferGeometry.prototype.constructor=q.TorusBufferGeometry,q.TorusGeometry=function(e,t,i,n,r){q.Geometry.call(this),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:i,tubularSegments:n,arc:r},this.fromBufferGeometry(new q.TorusBufferGeometry(e,t,i,n,r))},q.TorusGeometry.prototype=Object.create(q.Geometry.prototype),q.TorusGeometry.prototype.constructor=q.TorusGeometry,q.TorusKnotBufferGeometry=function(e,t,i,n,r,a){q.BufferGeometry.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:e,tube:t,tubularSegments:i,radialSegments:n,p:r,q:a},e=e||100,t=t||40,i=Math.floor(i)||64,r=r||2,a=a||3;var o,s,l=((n=Math.floor(n)||8)+1)*(i+1),c=n*i*2*3,u=new q.BufferAttribute(new(c>65535?Uint32Array:Uint16Array)(c),1),h=new q.BufferAttribute(new Float32Array(3*l),3),d=new q.BufferAttribute(new Float32Array(3*l),3),p=new q.BufferAttribute(new Float32Array(2*l),2),f=0,g=0,_=new q.Vector3,m=new q.Vector3,v=new q.Vector2,y=new q.Vector3,b=new q.Vector3,S=new q.Vector3,E=new q.Vector3,w=new q.Vector3;for(o=0;o<=i;++o){var T=o/i*r*Math.PI*2;for(D(T,r,a,e,y),D(T+.01,r,a,e,b),E.subVectors(b,y),w.addVectors(b,y),S.crossVectors(E,w),w.crossVectors(S,E),S.normalize(),w.normalize(),s=0;s<=n;++s){var M=s/n*Math.PI*2,A=-t*Math.cos(M),C=t*Math.sin(M);_.x=y.x+(A*w.x+C*S.x),_.y=y.y+(A*w.y+C*S.y),_.z=y.z+(A*w.z+C*S.z),h.setXYZ(f,_.x,_.y,_.z),m.subVectors(_,y).normalize(),d.setXYZ(f,m.x,m.y,m.z),v.x=o/i,v.y=s/n,p.setXY(f,v.x,v.y),f++}}for(s=1;s<=i;s++)for(o=1;o<=n;o++){var x=(n+1)*(s-1)+(o-1),I=(n+1)*s+(o-1),P=(n+1)*s+o,L=(n+1)*(s-1)+o;u.setX(g,x),g++,u.setX(g,I),g++,u.setX(g,L),g++,u.setX(g,I),g++,u.setX(g,P),g++,u.setX(g,L),g++}function D(e,t,i,n,r){var a=Math.cos(e),o=Math.sin(e),s=i/t*e,l=Math.cos(s);r.x=n*(2+l)*.5*a,r.y=n*(2+l)*o*.5,r.z=n*Math.sin(s)*.5}this.setIndex(u),this.addAttribute("position",h),this.addAttribute("normal",d),this.addAttribute("uv",p)},q.TorusKnotBufferGeometry.prototype=Object.create(q.BufferGeometry.prototype),q.TorusKnotBufferGeometry.prototype.constructor=q.TorusKnotBufferGeometry,q.TorusKnotGeometry=function(e,t,i,n,r,a,o){q.Geometry.call(this),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:i,radialSegments:n,p:r,q:a},void 0!==o&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new q.TorusKnotBufferGeometry(e,t,i,n,r,a)),this.mergeVertices()},q.TorusKnotGeometry.prototype=Object.create(q.Geometry.prototype),q.TorusKnotGeometry.prototype.constructor=q.TorusKnotGeometry,q.TubeGeometry=function(e,t,i,n,r,a){q.Geometry.call(this),this.type="TubeGeometry",this.parameters={path:e,segments:t,radius:i,radialSegments:n,closed:r,taper:a},t=t||64,i=i||1,n=n||8,r=r||!1,a=a||q.TubeGeometry.NoTaper;var o,s,l,c,u,h,d,p,f,g,_,m,v,y,b,S,E,w,T,M,A=[],C=this,x=t+1,I=new q.Vector3,P=new q.TubeGeometry.FrenetFrames(e,t,r),L=P.tangents,D=P.normals,R=P.binormals;function k(e,t,i){return C.vertices.push(new q.Vector3(e,t,i))-1}for(this.tangents=L,this.normals=D,this.binormals=R,f=0;f<x;f++)for(A[f]=[],l=f/(x-1),p=e.getPointAt(l),L[f],o=D[f],s=R[f],u=i*a(l),g=0;g<n;g++)c=g/n*2*Math.PI,h=-u*Math.cos(c),d=u*Math.sin(c),I.copy(p),I.x+=h*o.x+d*s.x,I.y+=h*o.y+d*s.y,I.z+=h*o.z+d*s.z,A[f][g]=k(I.x,I.y,I.z);for(f=0;f<t;f++)for(g=0;g<n;g++)_=r?(f+1)%t:f+1,m=(g+1)%n,v=A[f][g],y=A[_][g],b=A[_][m],S=A[f][m],E=new q.Vector2(f/t,g/n),w=new q.Vector2((f+1)/t,g/n),T=new q.Vector2((f+1)/t,(g+1)/n),M=new q.Vector2(f/t,(g+1)/n),this.faces.push(new q.Face3(v,y,S)),this.faceVertexUvs[0].push([E,w,M]),this.faces.push(new q.Face3(y,b,S)),this.faceVertexUvs[0].push([w.clone(),T,M.clone()]);this.computeFaceNormals(),this.computeVertexNormals()},q.TubeGeometry.prototype=Object.create(q.Geometry.prototype),q.TubeGeometry.prototype.constructor=q.TubeGeometry,q.TubeGeometry.NoTaper=function(e){return 1},q.TubeGeometry.SinusoidalTaper=function(e){return Math.sin(Math.PI*e)},q.TubeGeometry.FrenetFrames=function(e,t,i){var n,r,a,o,s,l,c,u=new q.Vector3,h=[],d=[],p=[],f=new q.Vector3,g=new q.Matrix4,_=t+1;for(this.tangents=h,this.normals=d,this.binormals=p,l=0;l<_;l++)c=l/(_-1),h[l]=e.getTangentAt(c),h[l].normalize();for(function(){d[0]=new q.Vector3,p[0]=new q.Vector3,r=Number.MAX_VALUE,a=Math.abs(h[0].x),o=Math.abs(h[0].y),s=Math.abs(h[0].z),a<=r&&(r=a,u.set(1,0,0));o<=r&&(r=o,u.set(0,1,0));s<=r&&u.set(0,0,1);f.crossVectors(h[0],u).normalize(),d[0].crossVectors(h[0],f),p[0].crossVectors(h[0],d[0])}(),l=1;l<_;l++)d[l]=d[l-1].clone(),p[l]=p[l-1].clone(),f.crossVectors(h[l-1],h[l]),f.length()>Number.EPSILON&&(f.normalize(),n=Math.acos(q.Math.clamp(h[l-1].dot(h[l]),-1,1)),d[l].applyMatrix4(g.makeRotationAxis(f,n))),p[l].crossVectors(h[l],d[l]);if(i)for(n=Math.acos(q.Math.clamp(d[0].dot(d[_-1]),-1,1)),n/=_-1,h[0].dot(f.crossVectors(d[0],d[_-1]))>0&&(n=-n),l=1;l<_;l++)d[l].applyMatrix4(g.makeRotationAxis(h[l],n*l)),p[l].crossVectors(h[l],d[l])},q.PolyhedronGeometry=function(e,t,i,n){q.Geometry.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:i,detail:n},i=i||1,n=n||0;for(var r=this,a=0,o=e.length;a<o;a+=3)b(new q.Vector3(e[a],e[a+1],e[a+2]));var s=this.vertices,l=[],c=(a=0,0);for(o=t.length;a<o;a+=3,c++){var u=s[t[a]],h=s[t[a+1]],d=s[t[a+2]];l[c]=new q.Face3(u.index,h.index,d.index,[u.clone(),h.clone(),d.clone()])}var p=new q.Vector3;for(a=0,o=l.length;a<o;a++)E(l[a],n);for(a=0,o=this.faceVertexUvs[0].length;a<o;a++){var f=this.faceVertexUvs[0][a],g=f[0].x,_=f[1].x,m=f[2].x,v=Math.max(g,_,m),y=Math.min(g,_,m);v>.9&&y<.1&&(g<.2&&(f[0].x+=1),_<.2&&(f[1].x+=1),m<.2&&(f[2].x+=1))}for(a=0,o=this.vertices.length;a<o;a++)this.vertices[a].multiplyScalar(i);function b(e){var t=e.normalize().clone();t.index=r.vertices.push(t)-1;var i=w(e)/2/Math.PI+.5,n=function(e){return Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))}(e)/Math.PI+.5;return t.uv=new q.Vector2(i,1-n),t}function S(e,t,i){var n=new q.Face3(e.index,t.index,i.index,[e.clone(),t.clone(),i.clone()]);r.faces.push(n),p.copy(e).add(t).add(i).divideScalar(3);var a=w(p);r.faceVertexUvs[0].push([T(e.uv,e,a),T(t.uv,t,a),T(i.uv,i,a)])}function E(e,t){for(var i=Math.pow(2,t),n=b(r.vertices[e.a]),a=b(r.vertices[e.b]),o=b(r.vertices[e.c]),s=[],l=0;l<=i;l++){s[l]=[];for(var c=b(n.clone().lerp(o,l/i)),u=b(a.clone().lerp(o,l/i)),h=i-l,d=0;d<=h;d++)s[l][d]=0===d&&l===i?c:b(c.clone().lerp(u,d/h))}for(l=0;l<i;l++)for(d=0;d<2*(i-l)-1;d++){var p=Math.floor(d/2);d%2==0?S(s[l][p+1],s[l+1][p],s[l][p]):S(s[l][p+1],s[l+1][p+1],s[l+1][p])}}function w(e){return Math.atan2(e.z,-e.x)}function T(e,t,i){return i<0&&1===e.x&&(e=new q.Vector2(e.x-1,e.y)),0===t.x&&0===t.z&&(e=new q.Vector2(i/2/Math.PI+.5,e.y)),e.clone()}this.mergeVertices(),this.computeFaceNormals(),this.boundingSphere=new q.Sphere(new q.Vector3,i)},q.PolyhedronGeometry.prototype=Object.create(q.Geometry.prototype),q.PolyhedronGeometry.prototype.constructor=q.PolyhedronGeometry,q.DodecahedronGeometry=function(e,t){var i=(1+Math.sqrt(5))/2,n=1/i,r=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-n,-i,0,-n,i,0,n,-i,0,n,i,-n,-i,0,-n,i,0,n,-i,0,n,i,0,-i,0,-n,i,0,-n,-i,0,n,i,0,n];q.PolyhedronGeometry.call(this,r,[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}},q.DodecahedronGeometry.prototype=Object.create(q.PolyhedronGeometry.prototype),q.DodecahedronGeometry.prototype.constructor=q.DodecahedronGeometry,q.IcosahedronGeometry=function(e,t){var i=(1+Math.sqrt(5))/2,n=[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1];q.PolyhedronGeometry.call(this,n,[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}},q.IcosahedronGeometry.prototype=Object.create(q.PolyhedronGeometry.prototype),q.IcosahedronGeometry.prototype.constructor=q.IcosahedronGeometry,q.OctahedronGeometry=function(e,t){q.PolyhedronGeometry.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}},q.OctahedronGeometry.prototype=Object.create(q.PolyhedronGeometry.prototype),q.OctahedronGeometry.prototype.constructor=q.OctahedronGeometry,q.TetrahedronGeometry=function(e,t){q.PolyhedronGeometry.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}},q.TetrahedronGeometry.prototype=Object.create(q.PolyhedronGeometry.prototype),q.TetrahedronGeometry.prototype.constructor=q.TetrahedronGeometry,q.ParametricGeometry=function(e,t,i){q.Geometry.call(this),this.type="ParametricGeometry",this.parameters={func:e,slices:t,stacks:i};var n,r,a,o,s,l,c,u,h,d,p,f,g=this.vertices,_=this.faces,m=this.faceVertexUvs[0],v=t+1;for(n=0;n<=i;n++)for(o=n/i,r=0;r<=t;r++)a=e(r/t,o),g.push(a);for(n=0;n<i;n++)for(r=0;r<t;r++)s=n*v+r,l=n*v+r+1,c=(n+1)*v+r+1,u=(n+1)*v+r,h=new q.Vector2(r/t,n/i),d=new q.Vector2((r+1)/t,n/i),p=new q.Vector2((r+1)/t,(n+1)/i),f=new q.Vector2(r/t,(n+1)/i),_.push(new q.Face3(s,l,u)),m.push([h,d,f]),_.push(new q.Face3(l,c,u)),m.push([d.clone(),p,f.clone()]);this.computeFaceNormals(),this.computeVertexNormals()},q.ParametricGeometry.prototype=Object.create(q.Geometry.prototype),q.ParametricGeometry.prototype.constructor=q.ParametricGeometry,q.WireframeGeometry=function(e){q.BufferGeometry.call(this);var t=[0,0],i={};function n(e,t){return e-t}var r=["a","b","c"];if(e instanceof q.Geometry){for(var a=e.vertices,o=e.faces,s=0,l=new Uint32Array(6*o.length),c=0,u=o.length;c<u;c++)for(var h=o[c],d=0;d<3;d++){t[0]=h[r[d]],t[1]=h[r[(d+1)%3]],t.sort(n),void 0===i[E=t.toString()]&&(l[2*s]=t[0],l[2*s+1]=t[1],i[E]=!0,s++)}var p=new Float32Array(2*s*3);for(c=0,u=s;c<u;c++)for(d=0;d<2;d++){var f=a[l[2*c+d]];p[(w=6*c+3*d)+0]=f.x,p[w+1]=f.y,p[w+2]=f.z}this.addAttribute("position",new q.BufferAttribute(p,3))}else if(e instanceof q.BufferGeometry)if(null!==e.index){var g=e.index.array,_=(a=e.attributes.position,e.groups);s=0;0===_.length&&e.addGroup(0,g.length);l=new Uint32Array(2*g.length);for(var m=0,v=_.length;m<v;++m)for(var y=_[m],b=y.start,S=(c=b,b+y.count);c<S;c+=3)for(d=0;d<3;d++){var E;t[0]=g[c+d],t[1]=g[c+(d+1)%3],t.sort(n),void 0===i[E=t.toString()]&&(l[2*s]=t[0],l[2*s+1]=t[1],i[E]=!0,s++)}for(p=new Float32Array(2*s*3),c=0,u=s;c<u;c++)for(d=0;d<2;d++){var w=6*c+3*d,T=l[2*c+d];p[w+0]=a.getX(T),p[w+1]=a.getY(T),p[w+2]=a.getZ(T)}this.addAttribute("position",new q.BufferAttribute(p,3))}else{var M=(s=(a=e.attributes.position.array).length/3)/3;for(p=new Float32Array(2*s*3),c=0,u=M;c<u;c++)for(d=0;d<3;d++){var A=9*c+3*d;p[(w=18*c+6*d)+0]=a[A],p[w+1]=a[A+1],p[w+2]=a[A+2];T=9*c+(d+1)%3*3;p[w+3]=a[T],p[w+4]=a[T+1],p[w+5]=a[T+2]}this.addAttribute("position",new q.BufferAttribute(p,3))}},q.WireframeGeometry.prototype=Object.create(q.BufferGeometry.prototype),q.WireframeGeometry.prototype.constructor=q.WireframeGeometry,q.AxisHelper=function(e){e=e||1;var t=new Float32Array([0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e]),i=new Float32Array([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1]),n=new q.BufferGeometry;n.addAttribute("position",new q.BufferAttribute(t,3)),n.addAttribute("color",new q.BufferAttribute(i,3));var r=new q.LineBasicMaterial({vertexColors:q.VertexColors});q.LineSegments.call(this,n,r)},q.AxisHelper.prototype=Object.create(q.LineSegments.prototype),q.AxisHelper.prototype.constructor=q.AxisHelper,q.ArrowHelper=function(){var e=new q.BufferGeometry;e.addAttribute("position",new q.Float32Attribute([0,0,0,0,1,0],3));var t=new q.CylinderBufferGeometry(0,.5,1,5,1);return t.translate(0,-.5,0),function(i,n,r,a,o,s){q.Object3D.call(this),void 0===a&&(a=16776960),void 0===r&&(r=1),void 0===o&&(o=.2*r),void 0===s&&(s=.2*o),this.position.copy(n),this.line=new q.Line(e,new q.LineBasicMaterial({color:a})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new q.Mesh(t,new q.MeshBasicMaterial({color:a})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(i),this.setLength(r,o,s)}}(),q.ArrowHelper.prototype=Object.create(q.Object3D.prototype),q.ArrowHelper.prototype.constructor=q.ArrowHelper,q.ArrowHelper.prototype.setDirection=(Y=new q.Vector3,function(e){e.y>.99999?this.quaternion.set(0,0,0,1):e.y<-.99999?this.quaternion.set(1,0,0,0):(Y.set(e.z,0,-e.x).normalize(),W=Math.acos(e.y),this.quaternion.setFromAxisAngle(Y,W))}),q.ArrowHelper.prototype.setLength=function(e,t,i){void 0===t&&(t=.2*e),void 0===i&&(i=.2*t),this.line.scale.set(1,Math.max(0,e-t),1),this.line.updateMatrix(),this.cone.scale.set(i,t,i),this.cone.position.y=e,this.cone.updateMatrix()},q.ArrowHelper.prototype.setColor=function(e){this.line.material.color.copy(e),this.cone.material.color.copy(e)},q.BoxHelper=function(e,t){void 0===t&&(t=16776960);var i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),n=new Float32Array(24),r=new q.BufferGeometry;r.setIndex(new q.BufferAttribute(i,1)),r.addAttribute("position",new q.BufferAttribute(n,3)),q.LineSegments.call(this,r,new q.LineBasicMaterial({color:t})),void 0!==e&&this.update(e)},q.BoxHelper.prototype=Object.create(q.LineSegments.prototype),q.BoxHelper.prototype.constructor=q.BoxHelper,q.BoxHelper.prototype.update=function(){var e=new q.Box3;return function(t){if(t instanceof q.Box3?e.copy(t):e.setFromObject(t),!e.isEmpty()){var i=e.min,n=e.max,r=this.geometry.attributes.position,a=r.array;a[0]=n.x,a[1]=n.y,a[2]=n.z,a[3]=i.x,a[4]=n.y,a[5]=n.z,a[6]=i.x,a[7]=i.y,a[8]=n.z,a[9]=n.x,a[10]=i.y,a[11]=n.z,a[12]=n.x,a[13]=n.y,a[14]=i.z,a[15]=i.x,a[16]=n.y,a[17]=i.z,a[18]=i.x,a[19]=i.y,a[20]=i.z,a[21]=n.x,a[22]=i.y,a[23]=i.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}}}(),q.BoundingBoxHelper=function(e,t){var i=void 0!==t?t:8947848;this.object=e,this.box=new q.Box3,q.Mesh.call(this,new q.BoxGeometry(1,1,1),new q.MeshBasicMaterial({color:i,wireframe:!0}))},q.BoundingBoxHelper.prototype=Object.create(q.Mesh.prototype),q.BoundingBoxHelper.prototype.constructor=q.BoundingBoxHelper,q.BoundingBoxHelper.prototype.update=function(){this.box.setFromObject(this.object),this.box.size(this.scale),this.box.center(this.position)},q.CameraHelper=function(e){var t=new q.Geometry,i=new q.LineBasicMaterial({color:16777215,vertexColors:q.FaceColors}),n={};function r(e,t,i){a(e,i),a(t,i)}function a(e,i){t.vertices.push(new q.Vector3),t.colors.push(new q.Color(i)),void 0===n[e]&&(n[e]=[]),n[e].push(t.vertices.length-1)}r("n1","n2",16755200),r("n2","n4",16755200),r("n4","n3",16755200),r("n3","n1",16755200),r("f1","f2",16755200),r("f2","f4",16755200),r("f4","f3",16755200),r("f3","f1",16755200),r("n1","f1",16755200),r("n2","f2",16755200),r("n3","f3",16755200),r("n4","f4",16755200),r("p","n1",16711680),r("p","n2",16711680),r("p","n3",16711680),r("p","n4",16711680),r("u1","u2",43775),r("u2","u3",43775),r("u3","u1",43775),r("c","t",16777215),r("p","c",3355443),r("cn1","cn2",3355443),r("cn3","cn4",3355443),r("cf1","cf2",3355443),r("cf3","cf4",3355443),q.LineSegments.call(this,t,i),this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=n,this.update()},q.CameraHelper.prototype=Object.create(q.LineSegments.prototype),q.CameraHelper.prototype.constructor=q.CameraHelper,q.CameraHelper.prototype.update=function(){var e,t,i=new q.Vector3,n=new q.Camera;function r(r,a,o,s){i.set(a,o,s).unproject(n);var l=t[r];if(void 0!==l)for(var c=0,u=l.length;c<u;c++)e.vertices[l[c]].copy(i)}return function(){e=this.geometry,t=this.pointMap;n.projectionMatrix.copy(this.camera.projectionMatrix),r("c",0,0,-1),r("t",0,0,1),r("n1",-1,-1,-1),r("n2",1,-1,-1),r("n3",-1,1,-1),r("n4",1,1,-1),r("f1",-1,-1,1),r("f2",1,-1,1),r("f3",-1,1,1),r("f4",1,1,1),r("u1",.7,1.1,-1),r("u2",-.7,1.1,-1),r("u3",0,2,-1),r("cf1",-1,0,1),r("cf2",1,0,1),r("cf3",0,-1,1),r("cf4",0,1,1),r("cn1",-1,0,-1),r("cn2",1,0,-1),r("cn3",0,-1,-1),r("cn4",0,1,-1),e.verticesNeedUpdate=!0}}(),q.DirectionalLightHelper=function(e,t){q.Object3D.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,void 0===t&&(t=1);var i=new q.BufferGeometry;i.addAttribute("position",new q.Float32Attribute([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));var n=new q.LineBasicMaterial({fog:!1});this.add(new q.Line(i,n)),(i=new q.BufferGeometry).addAttribute("position",new q.Float32Attribute([0,0,0,0,0,1],3)),this.add(new q.Line(i,n)),this.update()},q.DirectionalLightHelper.prototype=Object.create(q.Object3D.prototype),q.DirectionalLightHelper.prototype.constructor=q.DirectionalLightHelper,q.DirectionalLightHelper.prototype.dispose=function(){var e=this.children[0],t=this.children[1];e.geometry.dispose(),e.material.dispose(),t.geometry.dispose(),t.material.dispose()},q.DirectionalLightHelper.prototype.update=function(){var e=new q.Vector3,t=new q.Vector3,i=new q.Vector3;return function(){e.setFromMatrixPosition(this.light.matrixWorld),t.setFromMatrixPosition(this.light.target.matrixWorld),i.subVectors(t,e);var n=this.children[0],r=this.children[1];n.lookAt(i),n.material.color.copy(this.light.color).multiplyScalar(this.light.intensity),r.lookAt(i),r.scale.z=i.length()}}(),q.EdgesHelper=function(e,t,i){var n=void 0!==t?t:16777215;q.LineSegments.call(this,new q.EdgesGeometry(e.geometry,i),new q.LineBasicMaterial({color:n})),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1},q.EdgesHelper.prototype=Object.create(q.LineSegments.prototype),q.EdgesHelper.prototype.constructor=q.EdgesHelper,q.FaceNormalsHelper=function(e,t,i,n){this.object=e,this.size=void 0!==t?t:1;var r=void 0!==i?i:16776960,a=void 0!==n?n:1,o=0,s=this.object.geometry;s instanceof q.Geometry?o=s.faces.length:console.warn("THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead.");var l=new q.BufferGeometry,c=new q.Float32Attribute(2*o*3,3);l.addAttribute("position",c),q.LineSegments.call(this,l,new q.LineBasicMaterial({color:r,linewidth:a})),this.matrixAutoUpdate=!1,this.update()},q.FaceNormalsHelper.prototype=Object.create(q.LineSegments.prototype),q.FaceNormalsHelper.prototype.constructor=q.FaceNormalsHelper,q.FaceNormalsHelper.prototype.update=function(){var e=new q.Vector3,t=new q.Vector3,i=new q.Matrix3;return function(){this.object.updateMatrixWorld(!0),i.getNormalMatrix(this.object.matrixWorld);for(var n=this.object.matrixWorld,r=this.geometry.attributes.position,a=this.object.geometry,o=a.vertices,s=a.faces,l=0,c=0,u=s.length;c<u;c++){var h=s[c],d=h.normal;e.copy(o[h.a]).add(o[h.b]).add(o[h.c]).divideScalar(3).applyMatrix4(n),t.copy(d).applyMatrix3(i).normalize().multiplyScalar(this.size).add(e),r.setXYZ(l,e.x,e.y,e.z),l+=1,r.setXYZ(l,t.x,t.y,t.z),l+=1}return r.needsUpdate=!0,this}}(),q.GridHelper=function(e,t,i,n){i=new q.Color(void 0!==i?i:4473924),n=new q.Color(void 0!==n?n:8947848);for(var r=[],a=[],o=-e,s=0;o<=e;o+=t){r.push(-e,0,o,e,0,o),r.push(o,0,-e,o,0,e);var l=0===o?i:n;l.toArray(a,s),s+=3,l.toArray(a,s),s+=3,l.toArray(a,s),s+=3,l.toArray(a,s),s+=3}var c=new q.BufferGeometry;c.addAttribute("position",new q.Float32Attribute(r,3)),c.addAttribute("color",new q.Float32Attribute(a,3));var u=new q.LineBasicMaterial({vertexColors:q.VertexColors});q.LineSegments.call(this,c,u)},q.GridHelper.prototype=Object.create(q.LineSegments.prototype),q.GridHelper.prototype.constructor=q.GridHelper,q.GridHelper.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},q.HemisphereLightHelper=function(e,t){q.Object3D.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.colors=[new q.Color,new q.Color];var i=new q.SphereGeometry(t,4,2);i.rotateX(-Math.PI/2);for(var n=0;n<8;n++)i.faces[n].color=this.colors[n<4?0:1];var r=new q.MeshBasicMaterial({vertexColors:q.FaceColors,wireframe:!0});this.lightSphere=new q.Mesh(i,r),this.add(this.lightSphere),this.update()},q.HemisphereLightHelper.prototype=Object.create(q.Object3D.prototype),q.HemisphereLightHelper.prototype.constructor=q.HemisphereLightHelper,q.HemisphereLightHelper.prototype.dispose=function(){this.lightSphere.geometry.dispose(),this.lightSphere.material.dispose()},q.HemisphereLightHelper.prototype.update=(K=new q.Vector3,function(){this.colors[0].copy(this.light.color).multiplyScalar(this.light.intensity),this.colors[1].copy(this.light.groundColor).multiplyScalar(this.light.intensity),this.lightSphere.lookAt(K.setFromMatrixPosition(this.light.matrixWorld).negate()),this.lightSphere.geometry.colorsNeedUpdate=!0}),q.PointLightHelper=function(e,t){this.light=e,this.light.updateMatrixWorld();var i=new q.SphereBufferGeometry(t,4,2),n=new q.MeshBasicMaterial({wireframe:!0,fog:!1});n.color.copy(this.light.color).multiplyScalar(this.light.intensity),q.Mesh.call(this,i,n),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1},q.PointLightHelper.prototype=Object.create(q.Mesh.prototype),q.PointLightHelper.prototype.constructor=q.PointLightHelper,q.PointLightHelper.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},q.PointLightHelper.prototype.update=function(){this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)},q.SkeletonHelper=function(e){this.bones=this.getBoneList(e);for(var t=new q.Geometry,i=0;i<this.bones.length;i++){this.bones[i].parent instanceof q.Bone&&(t.vertices.push(new q.Vector3),t.vertices.push(new q.Vector3),t.colors.push(new q.Color(0,0,1)),t.colors.push(new q.Color(0,1,0)))}t.dynamic=!0;var n=new q.LineBasicMaterial({vertexColors:q.VertexColors,depthTest:!1,depthWrite:!1,transparent:!0});q.LineSegments.call(this,t,n),this.root=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.update()},q.SkeletonHelper.prototype=Object.create(q.LineSegments.prototype),q.SkeletonHelper.prototype.constructor=q.SkeletonHelper,q.SkeletonHelper.prototype.getBoneList=function(e){var t=[];e instanceof q.Bone&&t.push(e);for(var i=0;i<e.children.length;i++)t.push.apply(t,this.getBoneList(e.children[i]));return t},q.SkeletonHelper.prototype.update=function(){for(var e=this.geometry,t=(new q.Matrix4).getInverse(this.root.matrixWorld),i=new q.Matrix4,n=0,r=0;r<this.bones.length;r++){var a=this.bones[r];a.parent instanceof q.Bone&&(i.multiplyMatrices(t,a.matrixWorld),e.vertices[n].setFromMatrixPosition(i),i.multiplyMatrices(t,a.parent.matrixWorld),e.vertices[n+1].setFromMatrixPosition(i),n+=2)}e.verticesNeedUpdate=!0,e.computeBoundingSphere()},q.SpotLightHelper=function(e){q.Object3D.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1;for(var t=new q.BufferGeometry,i=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],n=0,r=1;n<32;n++,r++){var a=n/32*Math.PI*2,o=r/32*Math.PI*2;i.push(Math.cos(a),Math.sin(a),1,Math.cos(o),Math.sin(o),1)}t.addAttribute("position",new q.Float32Attribute(i,3));var s=new q.LineBasicMaterial({fog:!1});this.cone=new q.LineSegments(t,s),this.add(this.cone),this.update()},q.SpotLightHelper.prototype=Object.create(q.Object3D.prototype),q.SpotLightHelper.prototype.constructor=q.SpotLightHelper,q.SpotLightHelper.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},q.SpotLightHelper.prototype.update=function(){var e=new q.Vector3,t=new q.Vector3;return function(){var i=this.light.distance?this.light.distance:1e3,n=i*Math.tan(this.light.angle);this.cone.scale.set(n,n,i),e.setFromMatrixPosition(this.light.matrixWorld),t.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(t.sub(e)),this.cone.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)}}(),q.VertexNormalsHelper=function(e,t,i,n){this.object=e,this.size=void 0!==t?t:1;var r=void 0!==i?i:16711680,a=void 0!==n?n:1,o=0,s=this.object.geometry;s instanceof q.Geometry?o=3*s.faces.length:s instanceof q.BufferGeometry&&(o=s.attributes.normal.count);var l=new q.BufferGeometry,c=new q.Float32Attribute(2*o*3,3);l.addAttribute("position",c),q.LineSegments.call(this,l,new q.LineBasicMaterial({color:r,linewidth:a})),this.matrixAutoUpdate=!1,this.update()},q.VertexNormalsHelper.prototype=Object.create(q.LineSegments.prototype),q.VertexNormalsHelper.prototype.constructor=q.VertexNormalsHelper,q.VertexNormalsHelper.prototype.update=function(){var e=new q.Vector3,t=new q.Vector3,i=new q.Matrix3;return function(){var n=["a","b","c"];this.object.updateMatrixWorld(!0),i.getNormalMatrix(this.object.matrixWorld);var r=this.object.matrixWorld,a=this.geometry.attributes.position,o=this.object.geometry;if(o instanceof q.Geometry)for(var s=o.vertices,l=o.faces,c=0,u=0,h=l.length;u<h;u++)for(var d=l[u],p=0,f=d.vertexNormals.length;p<f;p++){var g=s[d[n[p]]],_=d.vertexNormals[p];e.copy(g).applyMatrix4(r),t.copy(_).applyMatrix3(i).normalize().multiplyScalar(this.size).add(e),a.setXYZ(c,e.x,e.y,e.z),c+=1,a.setXYZ(c,t.x,t.y,t.z),c+=1}else if(o instanceof q.BufferGeometry){var m=o.attributes.position,v=o.attributes.normal;for(c=0,p=0,f=m.count;p<f;p++)e.set(m.getX(p),m.getY(p),m.getZ(p)).applyMatrix4(r),t.set(v.getX(p),v.getY(p),v.getZ(p)),t.applyMatrix3(i).normalize().multiplyScalar(this.size).add(e),a.setXYZ(c,e.x,e.y,e.z),c+=1,a.setXYZ(c,t.x,t.y,t.z),c+=1}return a.needsUpdate=!0,this}}(),q.WireframeHelper=function(e,t){var i=void 0!==t?t:16777215;q.LineSegments.call(this,new q.WireframeGeometry(e.geometry),new q.LineBasicMaterial({color:i})),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1},q.WireframeHelper.prototype=Object.create(q.LineSegments.prototype),q.WireframeHelper.prototype.constructor=q.WireframeHelper,q.ImmediateRenderObject=function(e){q.Object3D.call(this),this.material=e,this.render=function(e){}},q.ImmediateRenderObject.prototype=Object.create(q.Object3D.prototype),q.ImmediateRenderObject.prototype.constructor=q.ImmediateRenderObject,q.MorphBlendMesh=function(e,t){q.Mesh.call(this,e,t),this.animationsMap={},this.animationsList=[];var i=this.geometry.morphTargets.length,n=i-1,r=i/1;this.createAnimation("__default",0,n,r),this.setAnimationWeight("__default",1)},q.MorphBlendMesh.prototype=Object.create(q.Mesh.prototype),q.MorphBlendMesh.prototype.constructor=q.MorphBlendMesh,q.MorphBlendMesh.prototype.createAnimation=function(e,t,i,n){var r={start:t,end:i,length:i-t+1,fps:n,duration:(i-t)/n,lastFrame:0,currentFrame:0,active:!1,time:0,direction:1,weight:1,directionBackwards:!1,mirroredLoop:!1};this.animationsMap[e]=r,this.animationsList.push(r)},q.MorphBlendMesh.prototype.autoCreateAnimations=function(e){for(var t,i=/([a-z]+)_?(\d+)/i,n={},r=this.geometry,a=0,o=r.morphTargets.length;a<o;a++){var s=r.morphTargets[a].name.match(i);if(s&&s.length>1)n[l=s[1]]||(n[l]={start:1/0,end:-1/0}),a<(c=n[l]).start&&(c.start=a),a>c.end&&(c.end=a),t||(t=l)}for(var l in n){var c=n[l];this.createAnimation(l,c.start,c.end,e)}this.firstAnimation=t},q.MorphBlendMesh.prototype.setAnimationDirectionForward=function(e){var t=this.animationsMap[e];t&&(t.direction=1,t.directionBackwards=!1)},q.MorphBlendMesh.prototype.setAnimationDirectionBackward=function(e){var t=this.animationsMap[e];t&&(t.direction=-1,t.directionBackwards=!0)},q.MorphBlendMesh.prototype.setAnimationFPS=function(e,t){var i=this.animationsMap[e];i&&(i.fps=t,i.duration=(i.end-i.start)/i.fps)},q.MorphBlendMesh.prototype.setAnimationDuration=function(e,t){var i=this.animationsMap[e];i&&(i.duration=t,i.fps=(i.end-i.start)/i.duration)},q.MorphBlendMesh.prototype.setAnimationWeight=function(e,t){var i=this.animationsMap[e];i&&(i.weight=t)},q.MorphBlendMesh.prototype.setAnimationTime=function(e,t){var i=this.animationsMap[e];i&&(i.time=t)},q.MorphBlendMesh.prototype.getAnimationTime=function(e){var t=0,i=this.animationsMap[e];return i&&(t=i.time),t},q.MorphBlendMesh.prototype.getAnimationDuration=function(e){var t=-1,i=this.animationsMap[e];return i&&(t=i.duration),t},q.MorphBlendMesh.prototype.playAnimation=function(e){var t=this.animationsMap[e];t?(t.time=0,t.active=!0):console.warn("THREE.MorphBlendMesh: animation["+e+"] undefined in .playAnimation()")},q.MorphBlendMesh.prototype.stopAnimation=function(e){var t=this.animationsMap[e];t&&(t.active=!1)},q.MorphBlendMesh.prototype.update=function(e){for(var t=0,i=this.animationsList.length;t<i;t++){var n=this.animationsList[t];if(n.active){var r=n.duration/n.length;n.time+=n.direction*e,n.mirroredLoop?(n.time>n.duration||n.time<0)&&(n.direction*=-1,n.time>n.duration&&(n.time=n.duration,n.directionBackwards=!0),n.time<0&&(n.time=0,n.directionBackwards=!1)):(n.time=n.time%n.duration,n.time<0&&(n.time+=n.duration));var a=n.start+q.Math.clamp(Math.floor(n.time/r),0,n.length-1),o=n.weight;a!==n.currentFrame&&(this.morphTargetInfluences[n.lastFrame]=0,this.morphTargetInfluences[n.currentFrame]=1*o,this.morphTargetInfluences[a]=0,n.lastFrame=n.currentFrame,n.currentFrame=a);var s=n.time%r/r;n.directionBackwards&&(s=1-s),n.currentFrame!==n.lastFrame?(this.morphTargetInfluences[n.currentFrame]=s*o,this.morphTargetInfluences[n.lastFrame]=(1-s)*o):this.morphTargetInfluences[n.currentFrame]=o}}}},function(e,t,i){"use strict";i.r(t),i.d(t,"saveContent",(function(){return r})),i.d(t,"deleteContent",(function(){return a})),i.d(t,"isContentSaved",(function(){return o})),i.d(t,"getProgress",(function(){return s})),i.d(t,"saveProgress",(function(){return l}));const n="https://www.wsj.com/user/personalization/svc/saved-content";function r(e){return fetch(n,{method:"POST",body:JSON.stringify({...e,contentType:"video"}),headers:{"content-type":"application/json"},credentials:"include"}).then(e=>{if(!e.ok)throw new Error("Failed to save video")})}function a(e,t){return fetch("".concat(n,"?id=").concat(e,"&pub=").concat(t),{method:"DELETE",headers:{"content-type":"application/json"},credentials:"include"}).then(e=>{if(!e.ok)throw new Error("Failed to delete video")})}function o(e,t){return fetch("".concat(n,"/").concat(e,"/count?pub=").concat(t),{credentials:"include"}).then(e=>{if(e.ok)return e.json();throw Error("Cannot receive save status")}).then(e=>{let{count:t}=e;return t>0})}function s(e,t){return fetch("".concat(n,"/").concat(e,"/progress?pub=").concat(t),{credentials:"include"}).then(e=>{if(e.ok)return e.json();throw Error("Cannot receive progress")})}function l(e,t,i){return fetch("".concat(n,"/progress"),{method:"POST",body:JSON.stringify({contentId:e,pub:t,progress:i}),headers:{"content-type":"application/json"},credentials:"include"}).then(e=>{if(!e.ok)throw new Error("Failed to save progress")})}},function(e,t,i){e.exports={container:"styles__container_14BbdRwp0rjtmY2SthKjYh",controlsVisible:"styles__controlsVisible_3YNMpna1eItRmruuU0l4Lr",fullscreen:"styles__fullscreen_2V5MixlxseUqztCkUlknr2",fadeIn:"styles__fadeIn_1XaYC5qFhwgUnRH03aUJRp",headerText:"styles__headerText_1IpJBkAZ3G-AcDLxNohTw",row:"styles__row_25TPSCHO9j2o1qNt_F8L7A",thumbnail:"styles__thumbnail_3AQZry0uMDphvHRkATJgSv",textContainer:"styles__textContainer_3po31nE30Je29SLuNRRWWW",videoTitle:"styles__videoTitle_ejWhXhNRCLIhAxgZKXPWv",countdownText:"styles__countdownText_tQ5pKo-5lQQV3De64SQuj"}},function(e,t,i){var n=i(89),r=i(8),a={easeIn:"easeInCubic",easeOut:"easeOutCubic",easeInOut:"easeInOutCubic"},o=function e(t,i){if(!(this instanceof e))throw new Error("Constructor was called without new keyword");var n;i=r.extend({duration:800,easing:"linear",from:{},to:{},step:function(){}},i),n=r.isString(t)?document.querySelector(t):t,this.path=n,this._opts=i,this._tweenable=null;var a=this.path.getTotalLength();this.path.style.strokeDasharray=a+" "+a,this.set(0)};o.prototype.value=function(){var e=this._getComputedDashOffset(),t=this.path.getTotalLength();return parseFloat((1-e/t).toFixed(6),10)},o.prototype.set=function(e){this.stop(),this.path.style.strokeDashoffset=this._progressToOffset(e);var t=this._opts.step;if(r.isFunction(t)){var i=this._easing(this._opts.easing);t(this._calculateTo(e,i),this._opts.shape||this,this._opts.attachment)}},o.prototype.stop=function(){this._stopTween(),this.path.style.strokeDashoffset=this._getComputedDashOffset()},o.prototype.animate=function(e,t,i){t=t||{},r.isFunction(t)&&(i=t,t={});var a=r.extend({},t),o=r.extend({},this._opts);t=r.extend(o,t);var s=this._easing(t.easing),l=this._resolveFromAndTo(e,s,a);this.stop(),this.path.getBoundingClientRect();var c=this._getComputedDashOffset(),u=this._progressToOffset(e),h=this;this._tweenable=new n,this._tweenable.tween({from:r.extend({offset:c},l.from),to:r.extend({offset:u},l.to),duration:t.duration,easing:s,step:function(e){h.path.style.strokeDashoffset=e.offset;var i=t.shape||h;t.step(e,i,t.attachment)},finish:function(e){r.isFunction(i)&&i()}})},o.prototype._getComputedDashOffset=function(){var e=window.getComputedStyle(this.path,null);return parseFloat(e.getPropertyValue("stroke-dashoffset"),10)},o.prototype._progressToOffset=function(e){var t=this.path.getTotalLength();return t-e*t},o.prototype._resolveFromAndTo=function(e,t,i){return i.from&&i.to?{from:i.from,to:i.to}:{from:this._calculateFrom(t),to:this._calculateTo(e,t)}},o.prototype._calculateFrom=function(e){return n.interpolate(this._opts.from,this._opts.to,this.value(),e)},o.prototype._calculateTo=function(e,t){return n.interpolate(this._opts.from,this._opts.to,e,t)},o.prototype._stopTween=function(){null!==this._tweenable&&(this._tweenable.stop(),this._tweenable=null)},o.prototype._easing=function(e){return a.hasOwnProperty(e)?a[e]:e},e.exports=o},function(e,t,i){var n=i(12),r=i(8),a=function(e,t){this._pathTemplate="M 50,50 m 0,-{radius} a {radius},{radius} 0 1 1 0,{2radius} a {radius},{radius} 0 1 1 0,-{2radius}",this.containerAspectRatio=1,n.apply(this,arguments)};(a.prototype=new n).constructor=a,a.prototype._pathString=function(e){var t=e.strokeWidth;e.trailWidth&&e.trailWidth>e.strokeWidth&&(t=e.trailWidth);var i=50-t/2;return r.render(this._pathTemplate,{radius:i,"2radius":2*i})},a.prototype._trailString=function(e){return this._pathString(e)},e.exports=a},function(e,t,i){"use strict";function n(e){var t,i=e.Symbol;return"function"==typeof i?i.observable?t=i.observable:(t=i("observable"),i.observable=t):t="@@observable",t}i.d(t,"a",(function(){return n}))},function(e,t,i){(function(e){!function(t){"use strict";function i(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}function n(e,t){Object.defineProperty(this,"kind",{value:e,enumerable:!0}),t&&t.length&&Object.defineProperty(this,"path",{value:t,enumerable:!0})}function r(e,t,i){r.super_.call(this,"E",e),Object.defineProperty(this,"lhs",{value:t,enumerable:!0}),Object.defineProperty(this,"rhs",{value:i,enumerable:!0})}function a(e,t){a.super_.call(this,"N",e),Object.defineProperty(this,"rhs",{value:t,enumerable:!0})}function o(e,t){o.super_.call(this,"D",e),Object.defineProperty(this,"lhs",{value:t,enumerable:!0})}function s(e,t,i){s.super_.call(this,"A",e),Object.defineProperty(this,"index",{value:t,enumerable:!0}),Object.defineProperty(this,"item",{value:i,enumerable:!0})}function l(e,t,i){var n=e.slice((i||t)+1||e.length);return e.length=t<0?e.length+t:t,e.push.apply(e,n),e}function c(e){var t=void 0===e?"undefined":w(e);return"object"!==t?t:e===Math?"math":null===e?"null":Array.isArray(e)?"array":"[object Date]"===Object.prototype.toString.call(e)?"date":"function"==typeof e.toString&&/^\/.*\//.test(e.toString())?"regexp":"object"}function u(e,t,i,n,h,d,p){p=p||[];var f=(h=h||[]).slice(0);if(void 0!==d){if(n){if("function"==typeof n&&n(f,d))return;if("object"===(void 0===n?"undefined":w(n))){if(n.prefilter&&n.prefilter(f,d))return;if(n.normalize){var g=n.normalize(f,d,e,t);g&&(e=g[0],t=g[1])}}}f.push(d)}"regexp"===c(e)&&"regexp"===c(t)&&(e=e.toString(),t=t.toString());var _=void 0===e?"undefined":w(e),m=void 0===t?"undefined":w(t),v="undefined"!==_||p&&p[p.length-1].lhs&&p[p.length-1].lhs.hasOwnProperty(d),y="undefined"!==m||p&&p[p.length-1].rhs&&p[p.length-1].rhs.hasOwnProperty(d);if(!v&&y)i(new a(f,t));else if(!y&&v)i(new o(f,e));else if(c(e)!==c(t))i(new r(f,e,t));else if("date"===c(e)&&e-t!=0)i(new r(f,e,t));else if("object"===_&&null!==e&&null!==t)if(p.filter((function(t){return t.lhs===e})).length)e!==t&&i(new r(f,e,t));else{if(p.push({lhs:e,rhs:t}),Array.isArray(e)){var b;for(e.length,b=0;b<e.length;b++)b>=t.length?i(new s(f,b,new o(void 0,e[b]))):u(e[b],t[b],i,n,f,b,p);for(;b<t.length;)i(new s(f,b,new a(void 0,t[b++])))}else{var S=Object.keys(e),E=Object.keys(t);S.forEach((function(r,a){var o=E.indexOf(r);o>=0?(u(e[r],t[r],i,n,f,r,p),E=l(E,o)):u(e[r],void 0,i,n,f,r,p)})),E.forEach((function(e){u(void 0,t[e],i,n,f,e,p)}))}p.length=p.length-1}else e!==t&&("number"===_&&isNaN(e)&&isNaN(t)||i(new r(f,e,t)))}function h(e,t,i,n){return n=n||[],u(e,t,(function(e){e&&n.push(e)}),i),n.length?n:void 0}function d(e,t,i){if(e&&t&&i&&i.kind){for(var n=e,r=-1,a=i.path?i.path.length-1:0;++r<a;)void 0===n[i.path[r]]&&(n[i.path[r]]="number"==typeof i.path[r]?[]:{}),n=n[i.path[r]];switch(i.kind){case"A":!function e(t,i,n){if(n.path&&n.path.length){var r,a=t[i],o=n.path.length-1;for(r=0;r<o;r++)a=a[n.path[r]];switch(n.kind){case"A":e(a[n.path[r]],n.index,n.item);break;case"D":delete a[n.path[r]];break;case"E":case"N":a[n.path[r]]=n.rhs}}else switch(n.kind){case"A":e(t[i],n.index,n.item);break;case"D":t=l(t,i);break;case"E":case"N":t[i]=n.rhs}return t}(i.path?n[i.path[r]]:n,i.index,i.item);break;case"D":delete n[i.path[r]];break;case"E":case"N":n[i.path[r]]=i.rhs}}}function p(e){return"color: "+A[e].color+"; font-weight: bold"}function f(e,t,i,n){var r=h(e,t);try{n?i.groupCollapsed("diff"):i.group("diff")}catch(e){i.log("diff")}r?r.forEach((function(e){var t=e.kind,n=function(e){var t=e.kind,i=e.path,n=e.lhs,r=e.rhs,a=e.index,o=e.item;switch(t){case"E":return[i.join("."),n,"→",r];case"N":return[i.join("."),r];case"D":return[i.join(".")];case"A":return[i.join(".")+"["+a+"]",o];default:return[]}}(e);i.log.apply(i,["%c "+A[t].text,p(t)].concat(T(n)))})):i.log("—— no diff ——");try{i.groupEnd()}catch(e){i.log("—— diff end —— ")}}function g(e,t,i,n){switch(void 0===e?"undefined":w(e)){case"object":return"function"==typeof e[n]?e[n].apply(e,T(i)):e[n];case"function":return e(t);default:return e}}function _(e,t){var i=t.logger,n=t.actionTransformer,r=t.titleFormatter,a=void 0===r?function(e){var t=e.timestamp,i=e.duration;return function(e,n,r){var a=["action"];return a.push("%c"+String(e.type)),t&&a.push("%c@ "+n),i&&a.push("%c(in "+r.toFixed(2)+" ms)"),a.join(" ")}}(t):r,o=t.collapsed,s=t.colors,l=t.level,c=t.diff,u=void 0===t.titleFormatter;e.forEach((function(r,h){var d=r.started,p=r.startedTime,_=r.action,m=r.prevState,v=r.error,y=r.took,b=r.nextState,E=e[h+1];E&&(b=E.prevState,y=E.started-d);var w=n(_),T="function"==typeof o?o((function(){return b}),_,r):o,M=S(p),A=s.title?"color: "+s.title(w)+";":"",C=["color: gray; font-weight: lighter;"];C.push(A),t.timestamp&&C.push("color: gray; font-weight: lighter;"),t.duration&&C.push("color: gray; font-weight: lighter;");var x=a(w,M,y);try{T?s.title&&u?i.groupCollapsed.apply(i,["%c "+x].concat(C)):i.groupCollapsed(x):s.title&&u?i.group.apply(i,["%c "+x].concat(C)):i.group(x)}catch(e){i.log(x)}var I=g(l,w,[m],"prevState"),P=g(l,w,[w],"action"),L=g(l,w,[v,m],"error"),D=g(l,w,[b],"nextState");if(I)if(s.prevState){var R="color: "+s.prevState(m)+"; font-weight: bold";i[I]("%c prev state",R,m)}else i[I]("prev state",m);if(P)if(s.action){var k="color: "+s.action(w)+"; font-weight: bold";i[P]("%c action    ",k,w)}else i[P]("action    ",w);if(v&&L)if(s.error){var O="color: "+s.error(v,m)+"; font-weight: bold;";i[L]("%c error     ",O,v)}else i[L]("error     ",v);if(D)if(s.nextState){var N="color: "+s.nextState(b)+"; font-weight: bold";i[D]("%c next state",N,b)}else i[D]("next state",b);c&&f(m,b,i,T);try{i.groupEnd()}catch(e){i.log("—— log end ——")}}))}function m(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object.assign({},C,e),i=t.logger,n=t.stateTransformer,r=t.errorTransformer,a=t.predicate,o=t.logErrors,s=t.diffPredicate;if(void 0===i)return function(){return function(e){return function(t){return e(t)}}};if(e.getState&&e.dispatch)return console.error("[redux-logger] redux-logger not installed. Make sure to pass logger instance as middleware:\n// Logger with default options\nimport { logger } from 'redux-logger'\nconst store = createStore(\n  reducer,\n  applyMiddleware(logger)\n)\n// Or you can create your own logger with custom options http://bit.ly/redux-logger-options\nimport createLogger from 'redux-logger'\nconst logger = createLogger({\n  // ...options\n});\nconst store = createStore(\n  reducer,\n  applyMiddleware(logger)\n)\n"),function(){return function(e){return function(t){return e(t)}}};var l=[];return function(e){var i=e.getState;return function(e){return function(c){if("function"==typeof a&&!a(i,c))return e(c);var u={};l.push(u),u.started=E.now(),u.startedTime=new Date,u.prevState=n(i()),u.action=c;var h=void 0;if(o)try{h=e(c)}catch(e){u.error=r(e)}else h=e(c);u.took=E.now()-u.started,u.nextState=n(i());var d=t.diff&&"function"==typeof s?s(i,c):t.diff;if(_(l,Object.assign({},t,{diff:d})),l.length=0,u.error)throw u.error;return h}}}}var v,y,b=function(e,t){return function(e,t){return new Array(t+1).join(e)}("0",t-e.toString().length)+e},S=function(e){return b(e.getHours(),2)+":"+b(e.getMinutes(),2)+":"+b(e.getSeconds(),2)+"."+b(e.getMilliseconds(),3)},E="undefined"!=typeof performance&&null!==performance&&"function"==typeof performance.now?performance:Date,w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},T=function(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)},M=[];v="object"===(void 0===e?"undefined":w(e))&&e?e:"undefined"!=typeof window?window:{},(y=v.DeepDiff)&&M.push((function(){void 0!==y&&v.DeepDiff===h&&(v.DeepDiff=y,y=void 0)})),i(r,n),i(a,n),i(o,n),i(s,n),Object.defineProperties(h,{diff:{value:h,enumerable:!0},observableDiff:{value:u,enumerable:!0},applyDiff:{value:function(e,t,i){e&&t&&u(e,t,(function(n){i&&!i(e,t,n)||d(e,t,n)}))},enumerable:!0},applyChange:{value:d,enumerable:!0},revertChange:{value:function(e,t,i){if(e&&t&&i&&i.kind){var n,r,a=e;for(r=i.path.length-1,n=0;n<r;n++)void 0===a[i.path[n]]&&(a[i.path[n]]={}),a=a[i.path[n]];switch(i.kind){case"A":!function e(t,i,n){if(n.path&&n.path.length){var r,a=t[i],o=n.path.length-1;for(r=0;r<o;r++)a=a[n.path[r]];switch(n.kind){case"A":e(a[n.path[r]],n.index,n.item);break;case"D":case"E":a[n.path[r]]=n.lhs;break;case"N":delete a[n.path[r]]}}else switch(n.kind){case"A":e(t[i],n.index,n.item);break;case"D":case"E":t[i]=n.lhs;break;case"N":t=l(t,i)}return t}(a[i.path[n]],i.index,i.item);break;case"D":case"E":a[i.path[n]]=i.lhs;break;case"N":delete a[i.path[n]]}}},enumerable:!0},isConflict:{value:function(){return void 0!==y},enumerable:!0},noConflict:{value:function(){return M&&(M.forEach((function(e){e()})),M=null),h},enumerable:!0}});var A={E:{color:"#2196F3",text:"CHANGED:"},N:{color:"#4CAF50",text:"ADDED:"},D:{color:"#F44336",text:"DELETED:"},A:{color:"#2196F3",text:"ARRAY:"}},C={level:"log",logger:console,logErrors:!0,collapsed:void 0,predicate:void 0,duration:!1,timestamp:!0,stateTransformer:function(e){return e},actionTransformer:function(e){return e},errorTransformer:function(e){return e},colors:{title:function(){return"inherit"},prevState:function(){return"#9E9E9E"},action:function(){return"#03A9F4"},nextState:function(){return"#4CAF50"},error:function(){return"#F20404"}},diff:!1,diffPredicate:void 0,transformer:void 0},x=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.dispatch,i=e.getState;return"function"==typeof t||"function"==typeof i?m()({dispatch:t,getState:i}):void console.error("\n[redux-logger v3] BREAKING CHANGE\n[redux-logger v3] Since 3.0.0 redux-logger exports by default logger with default settings.\n[redux-logger v3] Change\n[redux-logger v3] import createLogger from 'redux-logger'\n[redux-logger v3] to\n[redux-logger v3] import { createLogger } from 'redux-logger'\n")};t.defaults=C,t.createLogger=m,t.logger=x,t.default=x,Object.defineProperty(t,"__esModule",{value:!0})}(t)}).call(this,i(9))},function(e,t,n){n(25),n(26),n(27);var r,a,o=n(28),c=n(29),u=n(30),h=n(31),d=n(32),p=n(33),f=n(34),g=f.s_gi,_=f.Visitor,m=f.AppMeasurement;const{bindActionCreators:y}=n(4),b=n(36),S=n(5),{renderUI:E}=n(37),T=n(87),{createStore:M}=n(91),A=n(7),C=n(92).default,x=n(6),{getProgress:I,saveProgress:P}=n(18);var L=function(e,t){this._time=Date.now(),this._adPlaybackTime=0,this._store=M(),this._store.subscribe(this.updateBreakpointClass.bind(this)),this._actions=y(A,this._store.dispatch),this._self=this,this._version="3.46.3.231",this.createMark("playerLoadStart"),this._container=e,this._container.setAttribute("aria-label","video player"),this._height=this._container.offsetHeight,this._width=this._container.offsetWidth,this._isVertical=this._width/this._height<1,this._videoId=this._container.getAttribute("id"),this._video,this._captionsShowing=!1,this._vrWrapper,this._vrComponents,this._hlsPlayer,this._wrapper,this._controls,this._context,this._videodata,this._hlsAvailable=!1,this._isFullScreen=!1,this._currentTime=0,this._sizeTimer,this._volume=1,this._hlsLoadAttempted=!1,this.parseXml,this._availableCaptions=[],this._setMuted=!1,this._fields="fields=isQAEvent,type,video174kMP4Url,video320kMP4Url,video664kMP4Url,video1264kMP4Url,video1864kMP4Url,video2564kMP4Url,hls,videoMP4List,adZone,thumbnailList,guid,state,secondsUntilStartTime,author,description,name,linkURL,videoStillURL,duration,videoURL,adCategory,adsAllowed,chapterTimes,catastrophic,linkShortURL,doctypeID,youtubeID,titletag,rssURL,wsj-section,wsj-subsection,allthingsd-section,allthingsd-subsection,sm-section,sm-subsection,provider,formattedCreationDate,iso8601CreationDate,keywords,keywordsOmni,column,editor,emailURL,emailPartnerID,showName,omniProgramName,omniVideoFormat,linkRelativeURL,touchCastID,omniPublishDate,adTagParams,gptCustParams,format,forceClosedCaptions,captionsVTT,hlsNoCaptions,episodeNumber,seriesName,thumbstripURL,thumbnailImageManager,ads_allowed,mediaLiveChannelId",this._isIpad,this._isIphone,this._isAndroid,this._isIE,this._isMobile=!1,this._androidV,this._isTwitter,this._isOperaMini,this._isChrome,this._safariV=-1,this._safariInit=!1,this._safariHandler;var i=window.navigator.userAgent.toLowerCase(),n=navigator.userAgent.toLowerCase();this._isIpad=i.match(/(iPad)/i)||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1,this._isIphone=i.match(/(iphone)/i),this._isIphone=null!=this._isIphone,this._isAndroid=i.match(/(android)/i),this._isAndroid=null!==this._isAndroid&&null!=typeof this._isAndroid,this._androidV=parseFloat(i.slice(i.indexOf("android")+8)),this._isIE=-1!=n.indexOf("msie")&&parseInt(n.split("msie")[1]),this._isOperaMini=i.match(/(Android; Opera Mini)/i),this._isChrome=i.match(/(Chrome)/i),this._iOS=(/iPad|iPhone|iPod/.test(navigator.platform)||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1)&&!window.MSStream,this._isIE||navigator.userAgent.match(/Trident/)&&!navigator.userAgent.match(/MSIE/)&&(this._isIE=11),this._isSafariMac=-1!=navigator.userAgent.indexOf("Safari")&&-1!=navigator.userAgent.indexOf("Mac")&&-1==navigator.userAgent.indexOf("Chrome");try{this._isSafariMac&&(this._safariV=parseInt(i.match("version[ /]+[0-9]*")[0].split("/")[1]))}catch(e){this._safariV=-1}if(this._isSafari=-1!=navigator.userAgent.indexOf("Safari")&&-1==navigator.userAgent.indexOf("Chrome"),this._isMobile=Boolean(this._isAndroid||n.match(/webos/i)||this._isIphone||this._isIpad||n.match(/ipod/i)||n.match(/blackberry/i)||n.match(/windows phone/i)),"mozilla/5.0 (x11; linux x86_64; rv:45.0) gecko/20100101 firefox/45.0"==i)return void(this._container.innerHTML='<div class="videoErrorMsg"><div>Playback on your browser is not currently supported.</div></div>');this._playOverlay,this._timeDisplay,this._fullscreenBtn,this._ccBtn,this._ccList,this._langSelected="",this._currentTrack,this._bitList,this._volumeSlider,this._adLoadingScreen,this._adsSkipButton,this._startClick,this._shareScreen,this._endScreen,this._endScreenStatus,this._ajax={},this._configLoaded=!("playerid"in t),this._futureTimer,this._startTime,this._videoMsg,this._isStalled=!1,this._endScreenShowing=!1,this._endScreenLoading=!1,this._adMarkerContainer,this._currentThumbstripURL,this._adStarted=!1,this._adsManager,this._adsLoader,this._adContainer,this._adDisplayContainer,this._adDuration=0,this._adPlayNumber=1,this._adTimer,this._adTimeoutTimer,this._adTimeoutFail=!1,this._adResponseTimeout=8e3,this._currentAd,this._midRolls=[],this._midrollRequested=!1,this._adInfo,this._adId,this._adTagUsed="none",this._captionsLangs={eng:"English",spa:"Spanish",jap:"Japanese",por:"Portuguese"},this.BUCKET_HASH_MAP=["2qgQ1WCa3A","ixi4E5ylqa","830nwKog3K","K8ZnHJ5Uyn","91GjW1q7Zg","rGgki1wrhs","q85AaJVP78","1p6sdUNJWD","63L1D4y2F9","HY0f8Of9M1"],this._skipAvailable=!1,this._adCountdownText,this._videoSkipIcon,this._skipToTime=0,this._saveProgressEnabled=S.isUserLoggedIn()&&Math.random()<.5,this._lastSaveProgressTimestamp=0,this._formatOverride="",this._trackingMilestones=[!1,!1,!1,!1],this._mediaHeartbeat,this._mediaHeartbeatConfig,this._mediaHeartbeatDelegate,this._mediaObjectHeartbeat,this._pingMilestone=-1,this._isChained=!1,this._isLive=!1,this._contentStartTracked=!1,this._sessionStarted=!1,this._comscoreC3="13047035",this._comscoreMeta={ns_st_ci:"",c3:this._comscoreC3,c4:"*null",c6:"*null"},this._comscoreTag=new d.StreamingTag({customerC2:"6035148"}),this._retryLoadAttempts=0,this._trackInViewListenerReference,this._autoplayed,this._adErrorTracked=!0,this._adErrorEvent=!1,this._tObject={},this._pageEvents="",this._currentEvents=["event136","event40","event41","event42","event46","event67","event73","event74","event96","event97","event98","event99","event100","event113","event115","event116","event117","event141"],this._larsUrl="https://video-api.wsj.com/enf/wsjdn-video.asp",this._convivaTestCustomerKey="896e280ea92df939a292df56edeb57ab25ecaecf",this._convivaProdCustomerKey="445b2eba1211f043d37dc4994c50112384f41204",this._convivaServiceURL="https://wallstreetjournal-test.testonly.conviva.com",this._testingEnvironment=!0,this._convivaClient,this._convivaAdSessionKey=null,this._convivaContentMetadata,this._convivaContentSessionKey=null,this._convivaPlayerStateManager,this._convivaAdStateManager,this._convivaClientInterfaceObject,this._convivaHtml5PlayerInterface,this._convivaTestMode=!1,this._convivaSystemFactory,this._contentInitialized=!1,this._adsRequestPending=!1,this._playRequested=!1,this._flash,this._flashContainer,this._flashInit=!1,this._flashEvents,this._fPlaying=!1,this._bucket="";var r={autoplay:!1,loop:!1,adsEnabled:!0,vpaidEnabled:!0,shareEnabled:!0,allowPlayerPopup:!1,chainVideos:!1,disableHtmlControls:!1,enableLiveButton:!1,shareDomain:null,useAllesseh:!1,api:"https://video-api.wsj.com/api-video/",api2:"https://video-api.shdsvc.dowjones.io/api/",saveApi:"https://www.wsj.com/user/personalization/svc/saved-content",saveApiPublication:null,clickForSound:!1,resetOnComplete:!0,type:"",query:"",contentType:"article",enableEndScreen:!1,enableMoreVideosSlide:!1,disableTitle:!1,noThumb:!1,thumbFlashLine:!1,thumbLayout:"",larsId:"91",larsAdId:"1259",trackInView:!1,channel:null,enableScrubPreview:!0,allowFullScreen:!0,adTag:"",useHttps:!0,count:1,moduleId:"",adZone:"",lnid:"",plid:"",msrc:null,collapseable:!1,disableDVR:null,maxBitrateIndex:null,enableCaptions:!0,loaderThumb:!1,adSkipTime:15,playlist:{},suggestionsType:"wsj-section",suggestionsQuery:"",suggestionsGroupId:"",sAccount:!1,imaLibrary:"https://imasdk.googleapis.com/js/sdkloader/ima3.js",site:"",directLinks:!1,playlistQuery:"",touchCastID:null,relativeLinks:!1,disableChainPlay:!1,thumb:null,callback:null,fireTv:!1,useHLS:!0,startFullScreen:!1,playInline:!this._isVertical&&this._isIphone,suppressHeadline:!1,startLevel:!1,startPosition:-1};try{this._domain=window.location!=window.parent.location?document.referrer:document.location}catch(e){this._domain=document.domain}this._isIphone&&!r.playInline&&(r.disableHtmlControls=!0),this._settings=this.extend(r,t),this.hlsConfig={autoStartLoad:!0,startPosition:this._settings.startPosition,capLevelToPlayerSize:!1,enableWebVTT:!0,maxMaxBufferLength:30},-1!=navigator.userAgent.indexOf("amazon-fireos")?(this._settings.useHLS=!1,this._isMobile=!1):this._settings.fireTv=!1,!0!==this._settings.clickForSound&&"mobile"!=this._settings.autoplay||(this._settings.autoplay="muted"),this._isMobile&&("muted"==this._settings.autoplay?this._settings.playInline=!0:this._settings.autoplay=!1),this._isMobile||(this._settings.startFullScreen=!1),(this._iOS||this._isSafariMac)&&(this._settings.useHLS=!1),this._isIE&&(this._settings.enableCaptions=!1);this._isMobile&&(this._settings.vpaidEnabled=!1),"https://video-api.wsj.com/api-video/"!==this._settings.api&&this._settings.api.split("/api-video/").length>1&&(this._larsUrl=this._settings.api.split("/api-video/")[0]+"/enf/wsjdn-video.asp"),!1!==this._settings.startLevel&&(this.hlsConfig.startLevel=this._settings.startLevel),this._settings.hasCMPConsent="undefined"==typeof djcmp||void 0===djcmp.customVendorIsEnabled||djcmp.customVendorIsEnabled("5fa5a010e954e249a3afd700");const a=S.getApiUrlOverride();if(a&&(this._settings.api2=a),this._graphics={},this._graphics.pause='<svg width="16px" height="22px" viewBox="0 0 20 28" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>Pause</title><g id="Icons" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="Icons/Play/Pause" fill="#FFFFFF" fill-rule="nonzero"><path d="M0,25 L0,3 L6,3 L6,25 L0,25 Z M11,25 L11,3 L17,3 L17,25 L11,25 Z" id="Combined-Shape"></path></g></g></svg>',this._graphics.play='<svg width="16px" height="22px" viewBox="0 0 20 28" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>Play</title><desc>Created with sketchtool.</desc><g id="Icons" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="Icons/Play/Play" fill="#FFFFFF" fill-rule="nonzero"><polyline id="Play" points="0 2 0 26 20 13.4528 0 2"></polyline></g></g></svg>',this._graphics.cc='<svg width="22px" height="22px" viewBox="0 0 28 28" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g id="Icons" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="Icons/CC/Inactive" fill="#FFFFFF" fill-rule="nonzero"><path d="M26,4 L2,4 L2,22 L7,22 L7,26 L12,22 L26,22 L26,4 Z M24,20 L4,20 L4,6 L24,6 L24,20 Z M20,17 C19.77858,17 19.4452467,17 19,17 C16,17 15,15 15,13 C15,11 16,9 19,9 C19.5054152,9 19.8387485,9 20,9 L20,11 C19,11 17,11 17,13 C17,15 19,15 20,15 L20,17 Z M13,17 C12.77858,17 12.4452467,17 12,17 C9,17 8,15 8,13 C8,11 9,9 12,9 C12.5054152,9 12.8387485,9 13,9 L13,11 C12,11 10,11 10,13 C10,15 12,15 13,15 L13,17 Z" id="CC"></path></g></g></svg>',this._graphics["cc-active"]='<svg width="22px" height="22px" viewBox="0 0 28 28" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g id="Icons" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="Icons/CC/Active" fill="#FFFFFF" fill-rule="nonzero"><path d="M26,4 L2,4 L2,22 L7,22 L7,26 L12,22 L26,22 L26,4 Z M20,17 C19.77858,17 19.4452467,17 19,17 C16,17 15,15 15,13 C15,11 16,9 19,9 C19.5054152,9 19.8387485,9 20,9 L20,11 C19,11 17,11 17,13 C17,15 19,15 20,15 L20,17 Z M13,17 C12.77858,17 12.4452467,17 12,17 C9,17 8,15 8,13 C8,11 9,9 12,9 C12.5054152,9 12.8387485,9 13,9 L13,11 C12,11 10,11 10,13 C10,15 12,15 13,15 L13,17 Z" id="CC"></path></g></g></svg>',this._graphics["share-fb"]='<a id="share-link-fb-'+this._videoId+'"><svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="100%" height="100%" viewBox="-19.5 60.5 32 32" enable-background="new -19.5 60.5 32 32" xml:space="preserve"><g id="Page-1"><g id="facebook"><path id="Path" fill="#FFFFFF" d="M1.166,76.504h-2.714V86h-4.034v-9.496H-7.5v-3.349h1.918v-2.176c0-1.551,0.758-3.979,4.064-3.979h2.987v3.267h-2.183c-0.452-0.024-0.838,0.313-0.864,0.755c-0.003,0.055,0,0.107,0.008,0.158v1.976H1.5L1.166,76.504z"/></g></g></svg></a>',this._graphics["share-twitter"]='<a id="share-link-twitter-'+this._videoId+'" target="_blank"><svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="100%" height="100%" viewBox="0 0 32 32" enable-background="new 0 0 32 32" xml:space="preserve"><g id="Logo__x2014__FIXED"><g><path fill="#FFFFFF" d="M12.837,25.5c7.613,0,11.776-7.313,11.776-13.642c0-0.206,0-0.411-0.006-0.618c0.807-0.673,1.51-1.523,2.065-2.486c-0.742,0.384-1.542,0.635-2.382,0.757c0.855-0.59,1.511-1.533,1.824-2.655c-0.799,0.553-1.687,0.944-2.632,1.159C22.726,7.08,21.652,6.5,20.464,6.5c-2.284,0-4.141,2.15-4.141,4.796c0,0.375,0.042,0.739,0.106,1.095c-3.439-0.196-6.49-2.113-8.533-5.011C7.542,8.09,7.34,8.912,7.34,9.792c0,1.664,0.734,3.132,1.841,3.991c-0.679-0.027-1.315-0.243-1.874-0.598c0,0.019,0,0.038,0,0.065c0,2.318,1.429,4.264,3.318,4.703c-0.347,0.111-0.71,0.168-1.089,0.168c-0.266,0-0.525-0.025-0.775-0.084c0.525,1.908,2.059,3.292,3.867,3.33c-1.421,1.29-3.206,2.056-5.142,2.056c-0.331,0-0.663-0.021-0.985-0.065C8.324,24.705,10.504,25.5,12.837,25.5"/></g></g></svg></a>',this._graphics["share-email"]='<a id="share-link-twitter-'+this._videoId+'" target="_blank"><svg version="1.1" id="svg2439" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="100%" height="100%" viewBox="0 0 439.371 331.469" enable-background="new 0 0 439.371 331.469" xml:space="preserve"><g id="g2449" transform="translate(-145.3305,-145.3305)"><path fill="#FFFFFF" d="M516.516,426.799H216.331V200.334h300.186V426.799z M237.275,405.856h258.298V221.279H237.275V405.856z"/><path id="path2453" fill="#FFFFFF" stroke="#000000" stroke-width="30.655" d="M226.803,210.807"/><path fill="#FFFFFF" d="M366.882,352.684c-9.349,0.001-18.261-3.576-24.451-9.815L221.946,220.78l14.907-14.711l120.465,122.068c2.265,2.283,5.757,3.603,9.563,3.603c3.784,0,7.233-1.29,9.466-3.54l120.388-121.173l14.857,14.761L391.209,342.956C385.079,349.135,376.209,352.684,366.882,352.684z"/><rect x="269.215" y="296.385" transform="matrix(0.7149 0.6993 -0.6993 0.7149 333.1573 -92.2456)" fill="#FFFFFF" width="20.944" height="131.993"/><rect x="389.075" y="352.02" transform="matrix(0.6987 0.7154 -0.7154 0.6987 395.928 -215.1116)" fill="#FFFFFF" width="128.542" height="20.945"/></g></svg></a>',"undefined"==typeof SVGRect?this._graphics["play-overlay"]='<img style="margin:0 auto;" height="50" width="50" src="'+this._settings.api+'player/v3/css/play-overlay.png" />':this._graphics["play-overlay"]='<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="100%" height="100%" viewBox="0 0 52 52" enable-background="new 0 0 52 52" xml:space="preserve"><g id="XMLID_2_" opacity="1"><path fill="#FFFFFF" d="M26,51.5C11.9,51.5,0.5,40.1,0.5,26C0.5,11.9,11.9,0.5,26,0.5c14.1,0,25.5,11.4,25.5,25.5C51.5,40.1,40.1,51.5,26,51.5z"/><path fill="#FFFFFF" d="M26,1c13.8,0,25,11.2,25,25S39.8,51,26,51S1,39.8,1,26S12.2,1,26,1 M26,0C11.7,0,0,11.7,0,26s11.7,26,26,26 s26-11.7,26-26S40.3,0,26,0L26,0z"/></g><polygon id="XMLID_1_" fill="#333333" points="19.6,37.5 19.6,14.5 37.8,25.5 "/></svg>',this._ajax.x=function(){if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;for(var e,t=["MSXML2.XmlHttp.6.0","MSXML2.XmlHttp.5.0","MSXML2.XmlHttp.4.0","MSXML2.XmlHttp.3.0","MSXML2.XmlHttp.2.0","Microsoft.XmlHttp"],i=0;i<t.length;i++)try{e=new ActiveXObject(t[i]);break}catch(e){}return e},this._ajax.send=function(e,t,i,n,r,a){try{var o=this.x();o.open(n,e,a),o.data=r,o.onerror=function(){i(),console.log("Error loading config.")},o.onreadystatechange=function(){200==o.status?4==o.readyState&&t&&(t(o.responseText,o.data),o.onreadystatechange=null,o=null):0!=o.status&&i&&(o.onreadystatechange=null,o=null,i())},o.send(r)}catch(e){i&&(o&&(o.onreadystatechange=null),i())}},this._ajax.get=function(e,t,i,n){this.send(e,t,i,"GET",n,!0)},this.base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){var t,i,n,r,a,o,s,l="",c=0;for(e=this._utf8_encode(e);c<e.length;)r=(t=e.charCodeAt(c++))>>2,a=(3&t)<<4|(i=e.charCodeAt(c++))>>4,o=(15&i)<<2|(n=e.charCodeAt(c++))>>6,s=63&n,isNaN(i)?o=s=64:isNaN(n)&&(s=64),l=l+this._keyStr.charAt(r)+this._keyStr.charAt(a)+this._keyStr.charAt(o)+this._keyStr.charAt(s);return l},decode:function(e){var t,i,n,r,a,o,s="",l=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");l<e.length;)t=this._keyStr.indexOf(e.charAt(l++))<<2|(r=this._keyStr.indexOf(e.charAt(l++)))>>4,i=(15&r)<<4|(a=this._keyStr.indexOf(e.charAt(l++)))>>2,n=(3&a)<<6|(o=this._keyStr.indexOf(e.charAt(l++))),s+=String.fromCharCode(t),64!=a&&(s+=String.fromCharCode(i)),64!=o&&(s+=String.fromCharCode(n));return this._utf8_decode(s)},_utf8_encode:function(e){e=e.replace(/\r\n/g,"\n");for(var t="",i=0;i<e.length;i++){var n=e.charCodeAt(i);128>n?t+=String.fromCharCode(n):n>127&&2048>n?(t+=String.fromCharCode(n>>6|192),t+=String.fromCharCode(63&n|128)):(t+=String.fromCharCode(n>>12|224),t+=String.fromCharCode(n>>6&63|128),t+=String.fromCharCode(63&n|128))}return t},_utf8_decode:function(e){for(var t="",i=0,n=c1=c2=0;i<e.length;)128>(n=e.charCodeAt(i))?(t+=String.fromCharCode(n),i++):n>191&&224>n?(c2=e.charCodeAt(i+1),t+=String.fromCharCode((31&n)<<6|63&c2),i+=2):(c2=e.charCodeAt(i+1),c3=e.charCodeAt(i+2),t+=String.fromCharCode((15&n)<<12|(63&c2)<<6|63&c3),i+=3);return t}},void 0!==window.DOMParser)this.parseXml=function(e){return(new window.DOMParser).parseFromString(e,"text/xml")};else{if(void 0===window.ActiveXObject||!new window.ActiveXObject("Microsoft.XMLDOM"))throw new Error("No XML parser found");this.parseXml=function(e){var t=new window.ActiveXObject("Microsoft.XMLDOM");return t.async="false",t.loadXML(e),t}}};L.prototype={log:function(){this._store.getState().enableLogging&&console.log(...arguments)},init:function(){var e=this;if(this._configLoaded){this._bucket="",console.log("v "+this._version+this._bucket),1==this._settings.clickForSound&&(this._actions.mute(),this._actions.showClickForSound()),this.setupPlayer();var t=S.getCookie("djadplaynum");""!=t&&(this._adPlayNumber=parseInt(t),isNaN(this._adPlayNumber)&&(this._adPlayNumber=0));var i=S.getCookie("djvideovol");""!=i&&this.setVolume(i,!1);var n=S.getCookie("djvideolang");""!=n&&(this._langSelected=n),this._iOS&&(this._langSelected="");var r=S.getCookie("djvideomute");return""!=r&&1==r&&this._actions.mute(),"function"==typeof this._settings.callback&&this._settings.callback(),this._flashEvents={ready:function(t){e._flash=h("flash"+e._videoId),e._fPlaying=!1,e._flashInit=!0,e.startVideo({fetchAds:!0})},manifest:function(t,i,n){e._flash.playerPlay(-1),e._controls.style.display="block"},complete:function(e,t,i){},state:function(t,i,n){"PAUSED"==t?(e._fPlaying=!1,e.onPaused(t),e._actions.hideLoadingSpinner()):"PLAYING"==t?(e._fPlaying=!0,e.onPlaying(t),e._actions.hideLoadingSpinner()):"PAUSED_BUFFERING"==t?(e._fPlaying=!1,e.onPaused(t),e._actions.showLoadingSpinner()):"PLAYING_BUFFERING"==t&&(e._fPlaying=!0,e.onPlaying(t),e._actions.showLoadingSpinner())},position:function(t,i,n){e.onProgress(t)},error:function(e,t,i){}},this.onHLSMediaAttached=this.onHLSMediaAttached.bind(this),this.onHlsError=this.onHlsError.bind(this),this.onHLSLevelLoaded=this.onHLSLevelLoaded.bind(this),this.onBitrateChange=this.onBitrateChange.bind(this),this.onHLSPlayerBitrateChange=this.onHLSPlayerBitrateChange.bind(this),window.onbeforeunload=this.onPageUnload.bind(this),window["flashlsCallback"+this._videoId]=function(t,i){e._flashEvents[t].apply(null,i)},this}try{var a=this._settings.api+"player/v3/config/"+this._settings.playerid+".json?callback=cbfn";this._ajax.get(a,(function(t){e._configLoaded=!0;var i=JSON.parse(t);e._externalConfig=i.items[0];try{e._settings=e.extend(e._settings,e._externalConfig)}catch(e){}e.init()}),(function(t){e._configLoaded=!0,e.init()}),null)}catch(t){e._configLoaded=!0}},setupPlayer:function(){var e=this;this._container.className=this._container.className+" video-player"+(this._isMobile?" mobile-player":"");const t={videoId:this._videoId,videoProps:{},thumbProps:{layout:this._settings.thumbLayout,showFlashLine:this._settings.thumbFlashLine,suppressHeadline:this._settings.suppressHeadline,thumbnailOverride:this._settings.thumb,onClick(){e._autoplayed=!1,e.startVideo(),e.muteUnMute(!1,!1,!1),e._isAndroid&&e._settings.startFullScreen&&!e._isFullScreen&&e.toggleFullScreen()},graphics:this._graphics},countdownProps:{videoApiUrl:this._settings.api2,onCountdownComplete(){e._videodata.state,e.handleLiveUpdates(),e.startVideo()}},liveButtonEnabled:this._settings.enableLiveButton,saveToQueueEnabled:"string"==typeof this._settings.saveApiPublication&&S.isUserLoggedIn()};this._settings.enableMoreVideosSlide&&(t.moreVideosSlideProps={hasCMPConsent:this._settings.hasCMPConsent,videoApiUrl:this._settings.api,onSlideShowing:this.trackMoreVideosSlide.bind(this),playVideo:e=>{this._formatOverride="user initiated recommendation",this._settings.guid=e,this.loadVideo(!0)}}),this._settings.clickForSound&&(t.clickForSoundProps={onClicked:this.clickForSoundHandler.bind(this),isCountdownVisible:!0,isLiveButtonVisible:this._settings.enableLiveButton}),this._settings.enableEndScreen&&(t.endscreenProps={videoApiUrl:this._settings.api,fields:this._fields,playerSettings:this._settings,playVideo:this.playSuggestion.bind(this),onEndsceenShown:this.trackEndscreenSlide.bind(this)}),(this._settings.disableTitle||this._settings.disableHtmlControls)&&(t.disableTitle=!0),this._settings.disableHtmlControls?t.controlsProps=null:t.controlsProps={enableScrubPreview:this._settings.enableScrubPreview,isMobile:this._isMobile,onPlayPause:this.playPause.bind(this),onMuteUnMute:this.muteUnMute.bind(this,null,!0,!0),onSetVolume:this.onSetVolume.bind(this),onVolumeControlVisible:this.onVolumeControlVisible.bind(this),onToggleFullScreen:this.toggleFullScreen.bind(this),onSeek:this.onSeek.bind(this),saveApi:this._settings.saveApi,saveApiPublication:this._settings.saveApiPublication,showControls:this.showControls.bind(this,3e3),showShareScreen:this.showHideShareScreen.bind(this),saveToQueueEnabled:"string"==typeof this._settings.saveApiPublication&&S.isUserLoggedIn(),onSaveChange:this.onSaveChange.bind(this)},"muted"!=this._settings.autoplay||!this._isMobile&&1!=this._settings.clickForSound||(t.videoProps.autoplay=!0,t.videoProps.muted=!0),this._settings.playInline&&(t.videoProps.playsinline=!0),this._settings.loop&&(t.videoProps.loop=!0),this._store.getState().isMuted&&(t.videoProps.muted=!0),E(this._container,this._store,t),Object.defineProperties(this,{_video:{get:()=>{const e=document.getElementById("videoplayer-"+this._videoId);return e&&!e.scope&&(e.scope=this),e}},_wrapper:{get:()=>{const e=document.getElementById("wrapper-"+this._videoId);return e&&!e.scope&&(e.scope=this),e}},_pauseSlate:{get:()=>document.getElementById("video-pause-slate-"+this._videoId)},_adContainer:{get:()=>document.getElementById("adContainer-"+this._videoId)},_vrWrapper:{get:()=>document.getElementById("vrWrapper_"+this._videoId)},_flashContainer:{get:()=>document.getElementById("flashContainer-"+this._videoId)},_pauseScreen:{get:()=>document.getElementById("video-pause-slate-"+this._videoId)},_adCircleDiv:{get:()=>document.getElementById("ad-circle-"+this._videoId)}}),this._countdownTxt,this._adLowerCircleComponent=new T.Circle("#ad-circle-"+this._videoId,{color:"rgba(255, 255, 255, 0.50)",strokeWidth:7}),this._adCircleComponent=new T.Circle("#ad-circle-"+this._videoId,{color:"#ffffff",strokeWidth:7}),this._adContainer.style.display="none",this.setupListeners(!0),this._settings.disableHtmlControls?(document.getElementById("video-controls-container-"+this._videoId).style.display="none",this._settings.fireTv?this._video.controls=!1:this._video.controls=!0):(Object.defineProperties(this,{_adCountdownText:{get:()=>document.getElementById("video-ad-countdown-"+this._videoId)},_adMarkerContainer:{get:()=>document.getElementById("video-ad-marker-container-"+this._videoId)},_adsSkipButton:{get:()=>document.getElementById("video-ad-skip-"+this._videoId)},_ccBtn:{get:()=>document.getElementById("video-cc-"+this._videoId)},_ccList:{get:()=>document.getElementById("captions-list-"+this._videoId)},_controls:{get:()=>{const e=document.getElementById("video-controls-container-"+this._videoId);return e&&!e.hideTime&&(e.hideTime=0),e}},_fullscreenBtn:{get:()=>document.getElementById("video-fullscreen-"+this._videoId)},_playOverlay:{get:()=>document.getElementById("video-play-overlay-"+this._videoId)},_shareBtn:{get:()=>document.getElementById("video-share-b-"+this._videoId)},_shareScreen:{get:()=>document.getElementById("video-share-"+this._videoId)},_timeDisplay:{get:()=>document.getElementById("video-time-"+this._videoId)},_videoSkipIcon:{get:()=>document.getElementById("videoSkipIcon-"+this._videoId)},_volumeSlider:{get:()=>document.getElementById("video-volume-slider-"+this._videoId)}}),this._ccBtn.style.display="none",this._settings.shareEnabled||(this._shareBtn.style.display="none"),this._adsSkipButton.style.display="none",this.addUserEventListeners(),this._video.controls=!1),this._height=this._wrapper.offsetHeight,this._width=this._wrapper.offsetWidth,this._container._self=this,this._container.tabIndex="-1",this._container.resumeVideo=this.eResumeVideo.bind(this),this._container.pauseVideo=this.ePauseVideo,this._container.playVideo=this.ePlayVideo.bind(this),this._container.playPauseVideo=this.ePlayPauseVideo,this._container.killVideo=this.eKillVideo,this._container.loadVideo=this.eLoadVideo,this._container.setMute=this.eMute,this._container.updatePlaylist=this.eUpdatePlaylist,this._container.isPlaying=this.eIsPlaying,this._container.getStatus=this.eGetStatus,this._container.vidoraShownList=this.eVidoraShownList,this._container.seek=this.eSeek.bind(this),(this._settings.guid||""!==this._settings.type&&""!==this._settings.query)&&this.loadVideo(!1),this._iOS?(this._video.addEventListener("webkitendfullscreen",(function(t){e.onScreenChange(t)})),this._video.addEventListener("webkitbeginfullscreen",(function(t){e.onScreenChange(t)}))):this._wrapper.addEventListener(p.raw.fullscreenchange,(function(t){e.onScreenChange(t)})),this._settings.trackInView&&(this._trackInViewListenerReference=this.trackInView.bind(this),window.addEventListener("scroll",this._trackInViewListenerReference)),this._video.style.display="none",this.onResize()},initVideo:function(){var e=this;this._contentInitialized=!1;const{isAdsBlocked:t}=this._store.getState();if(this._settings.adsEnabled&&!t){if("undefined"==typeof google)return this._actions.setIMALoadState(x.STARTED),void this.loadScript(this._settings.imaLibrary,(function(){e._actions.setIMALoadState(x.FINISHED),e.initVideo()}),(function(){e._actions.setIMALoadState(x.FAILED),e.initVideo()}))}else this._adContainer.style.display="none";if(this._settings.useHLS&&void 0===r)return this._hlsLoadAttempted=!0,this._actions.setHlsJsLoadState(x.STARTED),void n.e(2).then(function(t){e._actions.setHlsJsLoadState(x.FINISHED),r=n(98),e._settings.useHLS=r.isSupported(),e.initVideo()}.bind(null,n)).catch((function(t){console.error(t),e._actions.setHlsJsLoadState(x.FAILED),e._settings.useHLS=!1,e.initVideo()}));this._mediaHeartbeat||this.setupTracking(),this._resizeObserver=new ResizeObserver(this.onResize.bind(this)),this._resizeObserver.observe(this._container),"469"==this._videodata.doctypeID&&(this._settings.chainVideos=!1),"future"!==this._videodata.state&&"live"!==this._videodata.state||Promise.all([n.e(3),n.e(0)]).then((e=>{const t=n(99).default;this._liveStateController=new t,"live"!==this._videodata.state||this._store.getState().isCountdownVisible||this.handleLiveUpdates()}).bind(null,n)).catch(e=>{console.error(e)}),this._settings.adsEnabled&&!t&&this.initAds(),this.trigger(this._wrapper,"onInitialize",this._videodata),this.createMark("playerReady"),this._settings.autoplay?this.startVideo():"future"!==this._videodata.state&&this.setupThumbnail()},initAds(){try{this._adDisplayContainer=new google.ima.AdDisplayContainer(this._adContainer,this._video),this._adsLoader=new google.ima.AdsLoader(this._adDisplayContainer),this._settings.vpaidEnabled?google.ima.settings.setVpaidMode(google.ima.ImaSdkSettings.VpaidMode.ENABLED):google.ima.settings.setVpaidMode(google.ima.ImaSdkSettings.VpaidMode.DISABLED),this._adsLoader.addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,e=>{this.onAdsManagerLoaded(e)},!1),this._adsLoader.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,e=>{this.onAdError(e)},!1),this.requestAds(!1)}catch(e){console.error("Failed to init ads",e),this._settings.adsEnabled=!1}},addHLSEventListeners:function(){this._hlsPlayer.off(r.Events.MANIFEST_LOADED,this.onHLSManifestParsed.bind(this)),this._hlsPlayer.off(r.Events.MEDIA_ATTACHED,this.onHLSMediaAttached),this._hlsPlayer.off(r.Events.ERROR,this.onHlsError),this._hlsPlayer.off(r.Events.LEVEL_LOADED,this.onHLSLevelLoaded),this._hlsPlayer.off(r.Events.LEVEL_SWITCHED,this.onBitrateChange),this._hlsPlayer.on(r.Events.MANIFEST_LOADED,this.onHLSManifestParsed.bind(this)),this._hlsPlayer.on(r.Events.MEDIA_ATTACHED,this.onHLSMediaAttached),this._hlsPlayer.on(r.Events.ERROR,this.onHlsError),this._hlsPlayer.on(r.Events.LEVEL_LOADED,this.onHLSLevelLoaded),this._hlsPlayer.on(r.Events.LEVEL_SWITCHED,this.onHLSPlayerBitrateChange)},onHLSMediaAttached:function(e,t){this._hlsPlayer.loadSource(this._videodata.hlsNoCaptions)},onHLSManifestParsed:function(e,t){this._embeddedCaptions=t.subtitles?t.subtitles:[]},onHLSLevelLoaded:function(e,t){const i=t.details.totalduration;i>0&&i!==this._store.getState().duration&&"live"!==this._store.getState().videoData.state&&this._actions.updateDuration(i)},onHLSPlayerBitrateChange:function(e,t){this.onBitrateChange(e,t)},onHlsError:function(e,t){if(t.fatal||"bufferAppendingError"==t.details)switch(this._retryLoadAttempts>2&&(t.type=r.ErrorTypes.OTHER_ERROR),this._retryLoadAttempts++,t.type){case r.ErrorTypes.MEDIA_ERROR:this._hlsPlayer.recoverMediaError();break;case r.ErrorTypes.NETWORK_ERROR:this._hlsPlayer.loadSource(this._videodata.hlsNoCaptions),this._hlsPlayer.startLoad();break;default:this.onVideoError(this._videodata.guid+" Fatal: "+t.fatal+" - "+t.details),this._hlsPlayer.destroy()}},setupTracking:function(){var e=this;this._account=this.getTrackingAccount();var t=o.va.MediaHeartbeat,i=o.va.MediaHeartbeatConfig,n=o.va.MediaHeartbeatDelegate,r=_.getInstance("CB68E4BA55144CAA0A4C98A5@AdobeOrg",{trackingServer:"om.dowjoneson.com",trackingServerSecure:"oms.dowjoneson.com",marketingCloudServer:"om.dowjoneson.com",marketingCloudServerSecure:"oms.dowjoneson.com"});svid=g(this._account),svid.visitor=r,svid.expectSupplementalData=!1,this._appMeasurement=new m,this._appMeasurement.visitor=r,this._appMeasurement.trackingServer=svid.trackingServer="om.dowjoneson.com",this._appMeasurement.trackingServerSecure=svid.trackingServerSecure="oms.dowjoneson.com",this._appMeasurement.account=this._account,this._appMeasurement.expectSupplementalData=!1,this._mediaHeartbeatConfig=new i,this._mediaHeartbeatConfig.trackingServer="dowjones.hb.omtrdc.net",this._mediaHeartbeatConfig.playerName="Web",this._settings.fireTv&&(this._mediaHeartbeatConfig.playerName="Amazon Fire TV"),this._mediaHeartbeatConfig.channel=this.getChannel(),this._mediaHeartbeatConfig.debugLogging=!1,this._mediaHeartbeatConfig.appVersion="v "+this._version,this._mediaHeartbeatConfig.ssl=!0,this._mediaHeartbeatConfig.ovp="Custom Html Player",this._appMeasurement.pageName=this.getPageName(),this._mediaHeartbeatDelegate=new n,this._mediaHeartbeatDelegate.getCurrentPlaybackTime=function(){return e._currentTime},this._mediaHeartbeatDelegate.getQoSObject=function(){var i=e.getQOSData();return t.createQoSObject(i.bitrate,i.startuptime,i.fps,i.droppedframes)},this._mediaHeartbeat=new t(this._mediaHeartbeatDelegate,this._mediaHeartbeatConfig,this._appMeasurement);var a=this._convivaTestMode?this.getTestingSystemSettings():this.getProductionSystemSettings(),s=new Conviva.SystemInterface(new c.Html5Time,new c.Html5Timer,new c.Html5Http,new c.Html5Storage,new c.Html5Metadata,new c.Html5Logging);if(this._convivaSystemFactory=new Conviva.SystemFactory(s,a),this._convivaTestMode)(l=new Conviva.ClientSettings(this._convivaTestCustomerKey)).gatewayUrl=this._convivaServiceURL;else var l=new Conviva.ClientSettings(this._convivaProdCustomerKey);this._convivaClient=new Conviva.Client(l,this._convivaSystemFactory),this._settings.trackInView&&this.trackInView()},getTrackingAccount:function(){let e="djglobal";try{-1!==(window.location!=window.parent.location?document.referrer:document.location.href).indexOf("mansionglobal.com")&&(e="djmansionglobal")}catch(e){}return e},onCCSelected:function(e,t,i){var n,r=this;if(this._langSelected=e,i&&(document.cookie="djvideolang="+this._langSelected+"; path=/"),this._videodata){var a=""===e?"CC OFF":"CC ON "+e;svid.linkTrackVars="contextData.a.media.friendlyName,contextData.a.media.name,contextData.video.closed.captioning,contextData.action,eVar15",svid.contextData["a.media.friendlyName"]=this._videodata.name,svid.contextData["a.media.name"]=this._videodata.guid,svid.contextData["video.closed.captioning"]=a,svid.contextData.action="video.closed.captioned",svid.eVar15=a,svid.tl(!0,"o",""===e?"heartbeat_video closed captioned off":"heartbeat_video closed captioned on")}for(;this._video.firstChild;)this._video.removeChild(this._video.firstChild);for(var o=0;o<this._video.textTracks.length;o++)this._video.textTracks[o].mode=""!==e?"showing":"disabled";""===e?this._actions.hideClosedCaptions():this._actions.showClosedCaptions(),(n=document.createElement("track")).embeded=!1,n.kind="subtitles",n.label="English",n.srclang="en",n.id=t,this._video.appendChild(n),this._video.tTrack=n,n.addEventListener("load",(function(){for(var t=0;t<r._video.textTracks.length;t++)r._video.textTracks[t].label===e&&""!==r._video.textTracks[t].id?r._video.textTracks[t].mode="showing":r._video.textTracks[t].mode="disabled";try{var i=r._video.textTracks[0].cues;for(v in i)"auto"==i[v].line&&(i[v].line=-5)}catch(e){}})),n.addEventListener("error",(function(e,t){console.log("Captions failed to load.")}));try{for(o=0;o<r._video.textTracks.length;o++)""!==this._video.textTracks[o].id&&(this._video.textTracks[o].mode="showing")}catch(e){}n.src=t,this.onCloseCC()},loadCaptions:function(){var e=this;for(this._availableCaptions=[];this._video.firstChild;)this._video.removeChild(this._video.firstChild);this._ccBtn.style.display="none",this._ccBtn&&this._video.textTracks.length>0&&(this._ccBtn.style.display="block"),this._videodata.forceClosedCaptions?""==this._langSelected&&(this._langSelected="English"):this._langSelected=S.getCookie("djvideolang"),this.onCCSelected(this._langSelected,"",!1);var t=function(t,i){e._ccBtn&&(e._ccBtn.style.display="block");var n={id:i.url,lang:i.label};e._availableCaptions.push(n),e._availableCaptions.length<2&&""!=e._langSelected&&(e._ccBtn.innerHTML=e._graphics["cc-active"]),n.lang==e._langSelected&&e.onCCSelected(n.lang,n.id,!1)},i=function(e,t){console.log("Captions failed to load.")};if(this._videodata.captionsVTT)for(var n=this._videodata.captionsVTT,r=0;r<n.length;r++)this._ajax.get(n[r].url,t,i,n[r])},eVidoraShownList:function(e){for(gid in e)try{this._settings.hasCMPConsent&&window.vidora.push(["send","shown",e[gid]])}catch(e){}},waitForAd(){return new Promise((e,t)=>{const{adInitState:i}=this._store.getState();if(i!==x.STARTED||this._adInitUnsubscribe)i===x.FAILED?t():e();else{const i=()=>{const{adInitState:i}=this._store.getState();i!==x.STARTED&&(this._adInitUnsubscribe(),this._adInitUnsubscribe=null,i===x.FINISHED?e():t())};this._adInitUnsubscribe=this._store.subscribe(i)}})},startAd:function(){this._actions.startAdMode(),this._adsManager.start()},startVideo:function(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{fetchAds:i=!1}=t;if("future"==this._videodata.state)return;const{adInitState:n,isAdsBlocked:r}=this._store.getState();this._settings.adsEnabled&&!r&&i&&(n===x.FINISHED?this.requestAds(!1):this.initAds()),this.createNewConvivaSession();var a=this;if(this._playRequested=!0,this._isIE&&("live"==this._videodata.state||"processing"==this._videodata.state)&&(this._controls.style.display="none",!this._flashInit))return this._actions.hideLoadingSpinner(),this._flashContainer.innerHTML='<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="" id="flash'+this._videoId+'" width="100%" height="100%"><param name="movie"  value="'+this._settings.api+'player/v3/flashlsChromeless.swf?inline=1" /><param name="quality" value="autohigh" /><param name="swliveconnect" value="true" /><param name="allowScriptAccess" value="always" /><param name="bgcolor" value="#0" /><param name="allowFullScreen" value="false" /><param name="wmode" value="opaque" /><param name="FlashVars" value="callback=flashlsCallback'+this._videoId+'" /><embed src="'+this._settings.api+'player/v3/flashlsChromeless.swf?inline=1" width="100%" height="100%" style="position:absolute; z-index:1;" name="flash'+this._videoId+'" quality="autohigh" bgcolor="#0" align="middle" allowFullScreen="false" allowScriptAccess="always" type="application/x-shockwave-flash" swliveconnect="true" wmode="opaque" FlashVars="callback=flashlsCallback'+this._videoId+'" pluginspage="https://www.macromedia.com/go/getflashplayer" ></embed></object><div class="getFlash"><strong>Live video is not supported on IE wihtout Flash enabled.</strong><p>Install and enable Flash or use Chrome / Firefox</p><p><a href="https://get.adobe.com/flashplayer/">Get Flash Player</a></p></div>',void(this._flashContainer.style.display="block");if("live"==this._videodata.state&&this._controls&&(this._shareBtn.style.display="none"),this.setVideoSource(),this.setupListeners(!0),this._video.load(),"muted"==a._settings.autoplay&&(a._video.volume=0,a._video.muted=!0,a._actions.mute(),a.onMuteUnMute(this)),a._settings.adsEnabled&&!r&&a._adDisplayContainer.initialize(),"vr"==this._videodata.format){if(!(this._isIE||this._isSafariMac&&window==window.top))return this.initVrPlayback(this._vrWrapper),void console.log("Loading VR Libs..");this.displayVrMsg()}else this._vrWrapper.style.display="none";this._sizeTimer||(this._sizeTimer=setInterval((function(){a.checkStatus()}),500)),r&&this.onAdError(null),a._actions.hideThumbnail(),a._video.autoplay="autoplay",a._actions.startVideoPlaybackInit(),a._video.style.display="none";const o=null!==(e=a._video.play())&&void 0!==e?e:Promise.resolve();o.then((function(){a._settings.autoplay&&void 0===a._autoplayed&&(a._autoplayed=!0),a._controls&&(a._controls.style.display="block"),a._actions.setFocus("play-button"),a.onNewVideo(),!a._settings.adsEnabled||r||a._settings.clickForSound||"1"===a._videodata.catastrophic||"catastrophic"===a._videodata.adCategory||!1===a._videodata.adsAllowed||!1!==a._store.getState().imaAdErrorState?(a._actions.endVideoPlaybackInit(),a._actions.setAdError(!1),a._video.style.display="block"):(a._adDisplayContainer.initialize(),a._video.pause(),a.waitForAd().then(()=>a.startAd()).catch(()=>{a._actions.endVideoPlaybackInit(),a._actions.setAdError(!1),a._video.style.display="block",a._video.play()}))})).catch((function(e){"AbortError"!=e.name&&(a._actions.endVideoPlaybackInit(),a._autoplayed=!1,"NotSupportedError"==e.name?a.onVideoError():a.setupThumbnail())}));try{this._comscoreTag.stop(),this._comscoreTag.playContentPart(this._comscoreMeta)}catch(e){}},setVideoSource:function(){var e=this;if(this._flash)return this._video.setAttribute("src",""),void this._flash.playerLoad(this._videodata.hlsNoCaptions);if(this._hlsAvailable=!1,this._isSafariMac&&"vr"==this._videodata.format){var t=this._videodata.videoMP4List[3].url.replace(/^https?\:\/\//i,"");this._video.setAttribute("src","//"+window.location.hostname+"/"+t)}else if(this._iOS||this._settings.fireTv||this._isSafariMac)-1!==this._settings.startPosition?this._video.setAttribute("src",this._videodata.hlsNoCaptions+"#t="+this._settings.startPosition):this._video.setAttribute("src",this._videodata.hlsNoCaptions),this._settings.startPosition=-1;else if(this._settings.useHLS)if(this._hlsPlayer){var i=function(){e._hlsPlayer.off(r.Events.MEDIA_DETACHED,i),e._video.src=e._videodata.hlsNoCaptions,e._hlsPlayer=new r(e.hlsConfig),e.addHLSEventListeners(),e._hlsPlayer.attachMedia(e._video)};this._hlsPlayer.on(r.Events.MEDIA_DETACHED,i),this._hlsPlayer.destroy()}else this.hlsConfig.startPosition=this._settings.startPosition,this._hlsPlayer=new r(this.hlsConfig),this._settings.startPosition=-1,this.addHLSEventListeners(),this._hlsPlayer.attachMedia(this._video);else this._videodata.video664kMP4Url?this._video.setAttribute("src",this._videodata.video664kMP4Url):this._videodata.videoMP4List[2]?this._video.setAttribute("src",this._videodata.videoMP4List[2].url):this._video.setAttribute("src",this._videodata.videoMP4List[0].url);this.onResize()},getQOSData:function(){var e={};if(this._hlsPlayer){if(-1!=this._hlsPlayer.currentLevel)e={bitrate:this._hlsPlayer.levelController._levels[this._hlsPlayer.currentLevel].bitrate,startuptime:this._startupTime,fps:30,droppedframes:this._hlsDroppedFrames}}else if(this._video.videoWidth){var t=[{w:416,b:464},{w:640,b:1264},{w:960,b:1864},{w:1280,b:2564},{w:1920,b:5064}],i=0;for(var n in t)t[n].w<=this._video.videoWidth&&(i=t[n].b);e={bitrate:i,startuptime:this._startupTime,fps:30,droppedframes:0}}return e},convivaClientMeasureInterface:function(e){this.getPHT=function(){return parseInt(e._currentTime)},this.getBufferLength=function(){return e._video.buffered.length},this.getSignalStrength=function(){return 1e3},this.getRenderedFrameRate=function(){return 30}},onLiveStateChanged:function(e){this._videodata.state=e,this._actions.updateVideoData(this._videodata),this.initVideo(),this.trigger(this._wrapper,"onLiveStateChanged",this._videodata)},trackAdsDisabled:function(e,t){var i=o.va.MediaHeartbeat,n=i.createAdBreakObject("pre-roll",1,0),r={"ad.blank.start":"false","a.media.ad.podFriendlyName":"pre-roll","ad.catastrophic.blocker":e,"ad.disabled":"true"},a=i.createAdObject("Catastrophic","Catastrophic",1,0),s={};s[i.AdMetadataKeys.ADVERTISER]="",s[i.AdMetadataKeys.CAMPAIGN_ID]="",a.setValue(i.MediaObjectKey.StandardAdMetadata,s),this._mediaHeartbeat.trackError("Ad_catastrophic: "+e),this._mediaHeartbeat.trackEvent(i.Event.AdBreakStart,n),this._mediaHeartbeat.trackEvent(i.Event.AdStart,a,r),this._mediaHeartbeat.trackEvent(i.Event.AdComplete),this._mediaHeartbeat.trackEvent(i.Event.AdBreakComplete)},checkStatus:function(){this._controls&&this._wrapper.parentElement&&this._wrapper.parentElement.querySelector(":hover")!==this._wrapper&&this.onCloseCC()},loadVideo:function(e){const t=new Promise((e,t)=>{const i=this._settings.useHttps?"&https=1":"";try{var n=this._self;this._video.pause(),this._actions.setVideoApiLoadState(x.STARTED),this._adsManager&&this._adsManager.stop();var r=function(i){var r=JSON.parse(i);n._videodata=r.items&&r.items[0]||r[0],n._actions.updateVideoData(n._videodata),n._container.setAttribute("aria-label",n._videodata.name);try{n._settings.guid=n._videodata.guid}catch(e){}n._settings.msrc&&(n._videodata.msrc=n._settings.msrc),n._videodata.error?(n.showError(n._videodata.error),n.onVideoError(n._videodata.error),n._actions.setVideoApiLoadState(x.FAILED),t(n._videodata.error)):(n._actions.setVideoApiLoadState(x.FINISHED),e())},a=function(e){n.showError(""),n.onVideoError("guid load error"),n._actions.setVideoApiLoadState(x.FAILED),t(new Error("guid load error"))}}catch(e){}this._ajax.get((()=>this._settings.guid?this._settings.useAllesseh?"".concat(this._settings.api2,"media?type=guid&query=").concat(this._settings.guid,"&").concat(this._fields,"&allesseh=1"):"".concat(this._settings.api2,"legacy/find-all-videos?type=guid&count=1&https=1&query=").concat(this._settings.guid,"&").concat(this._fields):""!==this._settings.type&&""!==this._settings.query?""!==this._settings.groupId?this._settings.api+"find_all_videos.asp?type="+this._settings.type+"&count=1"+i+"&query="+this._settings.query+"&"+this._fields:this._settings.api+"find_all_videos.asp?type="+this._settings.type+"&count=1"+i+"&query="+this._settings.query+"&"+this._fields+"&groupid="+this._settings.groupId:void 0)(),r,a,null)});let i=Promise.resolve();return this._saveProgressEnabled&&(this.log("Fetching current progress"),i=I(this._settings.guid,"video_history").then(e=>{let{progress:t}=e;this.log("Current progress = ",t),this._lastSaveProgressTimestamp=t}).catch(e=>this.log("Failed to load progress",e))),Promise.all([t,i]).then(()=>{e?this.startVideo({fetchAds:!0}):this.initVideo()})},getAdTag:function(e){var t=new google.ima.AdsRequest;if(this._settings.adTag)t.adTagUrl=this._settings.adTag;else{var i=[];""!=this._settings.site&&void 0!==this._settings.site?i.site=this._settings.site:i.site="video.wsj.com",this._settings.plid?i.plid=this._settings.plid:this._videodata.plid?i.plid=this._videodata.plid:i.plid="video_articleembed",i.gptParams=this._videodata.gptCustParams,this._settings.lnid&&(i.gptParams=i.gptParams.replace(/lnid.*%26/,"lnid%3D"+this._settings.lnid+"%26")),i.gptParams+="string"==typeof this.getParameterByName("mod")?"%26mod%3D"+this.getParameterByName("mod"):"",i.gptParams+=this.getAdData();var n="%26sub%3Dno";try{S.getCookie("REMOTE_USER")&&(n="%26sub%3Dyes")}catch(e){}var r="";this._settings.msrc&&(r="%26msrc%3D"+this._settings.msrc);var a="Cheddar"==this._videodata.column?"/Cheddar":"",o=((new Date).getTime(),encodeURIComponent(this._videodata.linkURL)),s="&vpos=preroll";e&&(s="&vpos=midroll",i.gptParams+="%26mrtimeindex%3D"+parseInt(this._currentTime)),t.adTagUrl="https://pubads.g.doubleclick.net/gampad/ads?sz=4x4&gdfp_req=1&iu=/2/"+i.site+a+"&ciu_szs=300x50,300x600,300x250&url=[referrer_url]&correlator=[timestamp]&env=vp&unviewed_position_start=1&output=vast&description_url="+o+"&impl=s&hl=en"+s+"&cust_params="+i.gptParams+r+"%26adview%3D"+this._adPlayNumber+n+"%26flash%3Dno%26plid%3D"+i.plid}return"muted"==this._settings.autoplay&&(t.setAdWillAutoPlay(!0),t.setAdWillPlayMuted(!0)),t.adType="video",t},getParameterByName:function(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var i=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return i?i[2]?decodeURIComponent(i[2].replace(/\+/g," ")):"":null},getThumbnail:function(){return this._settings.thumb?this._settings.thumb:this._videodata.thumbnailList?S.pickBestThumbnail(this._videodata.thumbnailList,this._width,this._height):this._videodata.thumbnailURL},setupThumbnail:function(e){this._store.getState().isThumbnailVisible||this._actions.showThumbnail(),this._playOverlay&&(this._playOverlay.style.display="none"),this.onResize()},showError:function(e){this._wrapper.innerHTML='<div class="videoErrorMsg"><div>We are sorry, we are unable to load this video.<br />'+e+"</div></div>"},requestAds:function(e){var t=this.getAdTag(e);this._adTagUsed=t.adTagUrl,t.linearAdSlotWidth=this._width,t.linearAdSlotHeight=this._height-40,t.nonLinearAdSlotWidth=this._width,t.nonLinearAdSlotHeight=this._height-40,this._adsLoader.requestAds(t),this.startAdTimeoutTimer(),this.trigger(this._wrapper,"adRequested"),this._actions.setAdInitState(x.STARTED)},onAdsManagerLoaded:function(e){if(this._actions.setAdInitState(x.FINISHED),this._adTimeoutTimer&&(clearInterval(this._adTimeoutTimer),1==this._adTimeoutFail))return void(this._adTimeoutFail=!1);var t=new google.ima.AdsRenderingSettings;t.enablePreloading=!0,t.loadVideoTimeout=5e3,t.mimeTypes=["video/mp4"],t.restoreCustomPlaybackStateOnAdBreakComplete=!0,t.uiElements=[google.ima.UiElements.AD_ATTRIBUTION],this._adsManager=e.getAdsManager(this._video,t),this._store.getState().isMuted?this._adsManager.setVolume(0):this._adsManager.setVolume(this._volume),this._adsManager.setVolume(0),this.addListeners();const i={adsManager:this._adsManager,reduxStore:this._store,onAdDisconnect:()=>{console.warn("Ad disconnect"),this._adsManager.destroy(),this._adsLoader.destroy(),this._adDisplayContainer.destroy(),this.onAdRemoved(),this._video.play(),this.initAds()}};this._adHealthObserver=new C(i),this._adsManager.init(this._width,this._height,google.ima.ViewMode.NORMAL)},onBuffering:function(e){var t=this;t._mediaHeartbeat||(t=t.scope),t._store.getState().isBuffering||t._actions.buffering(),"stalled"==e.type&&(t._isStalled=!0,t._mediaHeartbeat.trackEvent(o.va.MediaHeartbeat.Event.BufferStart))},onAdBuffering:function(e){this._actions.adBuffering(),this._convivaAdStateManager&&this._convivaAdStateManager.setPlayerState(Conviva.PlayerStateManager.PlayerState.BUFFERING)},onVideoResize:function(e){if(this._convivaPlayerStateManager){var t=this.getQOSData();t.bitrate&&this._convivaPlayerStateManager.setBitrateKbps(t.bitrate)}},async saveProgress(e){this._lastSaveProgressTimestamp=e;const{guid:t,state:i}=this._store.getState().videoData;if(this._saveProgressEnabled&&"vod"===i)try{this.log("Saving progress",e),await P(t,"video_history",e)}catch(e){this.log("Failed to save progress",e)}},onProgress:function(e){if(this.scope||(this.scope=this),this.scope._isStalled&&this.scope._mediaHeartbeat.trackEvent(o.va.MediaHeartbeat.Event.BufferComplete),this.scope._isStalled=!1,!this.scope._store.getState().isAdMode){this.scope._store.getState().isBuffering&&4===this.readyState&&this.scope._actions.canPlay();var t=this.scope._store.getState().duration,n=this.scope._video.currentTime;this.scope._flash&&(t=e.duration,n=e.position),this.scope._currentTime=n;var r=this.scope._currentTime/t*100;if(this.scope.trackProgress(r,this.scope._currentTime),this.scope._actions.updateProgress(this.scope._currentTime),this.scope._lastSaveProgressTimestamp+10<n&&this.scope.saveProgress(n),("live"==this.scope._videodata.state||"flive"==this.scope._videodata.state)&&this.scope._controls)return void(this.scope._shareBtn.style.display="none");const{isAdsBlocked:a}=this.scope._store.getState();if(this.scope._settings.adsEnabled&&!a)for(i in this.scope._midRolls)if(this.scope._currentTime>=this.scope._midRolls[i]){this.scope._midRolls.splice(i,1),this.scope._midrollRequested||(this.scope._midrollRequested=!0,this.scope._video.paused,this.scope.createAdLoadingScreen(),this.scope.requestAds(!0),this.scope.waitForAd().then(()=>{this.scope.startAd()}).catch(()=>{this.scope._actions.endVideoPlaybackInit(),this.scope._actions.setAdError(!1),this.scope._video.style.display="block",this.scope._video.play()}));break}}},generateMidrollMarkers:function(){const{duration:e}=this._store.getState();for(i in this._midRolls){var t=parseInt(this._midRolls[i]/e*this._width);this._adMarkerContainer.insertAdjacentHTML("afterbegin",'<div class="ad-midroll-marker" style="left:'+t+'px;" data-adTime="'+this._midRolls[i]+'"></div>')}},createAdLoadingScreen:function(){this._adContainer.insertAdjacentHTML("beforeBegin",'<div class="ad-loading-screen" id="ad-loading-screen-'+this._videoId+'"><div class="video-loading"><div class="video-loading-inner"></div></div><span>Advertisement loading.  Please Wait.</span></div>'),this._adLoadingScreen=document.getElementById("ad-loading-screen-"+this._videoId)},onLoadedMetadata:function(e){this.onDurationChange(e),-1!==this._settings.startPosition&&(this._video.currentTime=this._settings.startPosition,this._settings.startPosition=-1)},onDurationChange:function(e){this._video.duration>0&&this._video.duration!==this._store.getState().duration&&this._actions.updateDuration(this._video.duration)},createNewConvivaSession:function(){if(null!==this._convivaContentSessionKey&&(this._convivaClient.cleanupSession(this._convivaContentSessionKey),this._convivaContentSessionKey=null),this._convivaPlayerStateManager?this._convivaPlayerStateManager.reset():this._convivaPlayerStateManager=this._convivaClient.getPlayerStateManager(),this.setConvivaMetaData(),this._convivaContentSessionKey=this._convivaClient.createSession(this._convivaContentMetadata),this._convivaPlayerStateManager){this._convivaPlayerStateManager.setPlayerType("Universal Player"),this._convivaPlayerStateManager.setPlayerVersion(this._version);var e=this.getQOSData();this._convivaPlayerStateManager.setBitrateKbps(Math.round(parseInt(e.bitrate)/1e3))}this._convivaHtml5PlayerInterface=new c.Html5PlayerInterface(this._convivaPlayerStateManager,this._video,this._convivaSystemFactory);var t=new this.convivaClientMeasureInterface(this);this._convivaPlayerStateManager.setClientMeasureInterface(t)},onNewVideo:function(){if(this._contentStartTracked&&this._mediaHeartbeat&&this._mediaHeartbeat.trackSessionEnd(),this._completeCalled=!1,this._contentStartTracked=!1,this._sessionStarted=!1,this._contentInitialized=!0,this._adErrorTracked=!1,this._adStarted=!1,this._retryLoadAttempts=0,this.trigger(this._wrapper,"newVideo",this._videodata),this.trigger(this._wrapper,"onNewVideo",this._videodata),this.trackInit(),"1"===this._videodata.catastrophic&&(this._adContainer.style.display="none",this._video.style.display="block"),"string"==typeof this._videodata.chapterTimes&&this._videodata.chapterTimes.length>0&&this._settings.adsEnabled){var e=this._videodata.chapterTimes.split(",");for(i in e)this._midRolls[i]=parseInt(e[i]);this.generateMidrollMarkers()}!1!==this._adErrorEvent&&(this._adErrorEvent=!1,this.onAdError(this._adErrorEvent)),this._trackingMilestones=[!1,!1,!1,!1],this._pingMilestone=-1,this._settings.thumb=!1,this._controls&&(this._controls.hideTime=0,S.emptyElement(this._adMarkerContainer)),this._settings.enableCaptions&&!this._flash?this.loadCaptions():this._ccBtn&&(this._ccBtn.style.display="none")},setupListeners:function(e){this._video.removeEventListener("durationchange",this.onDurationChange.bind(this)),this._video.removeEventListener("loadedmetadata",this.onLoadedMetadata.bind(this)),this._video.removeEventListener("timeupdate",this.onProgress),this._video.removeEventListener("error ",this.onVideoError),this._video.removeEventListener("waiting",this.onBuffering),this._video.removeEventListener("playing",this.onPlaying),this._video.removeEventListener("play",this.onPlay),this._video.removeEventListener("canplay",this.onCanPlay),this._video.removeEventListener("canplaythrough",this.onCanPlay),this._video.removeEventListener("pause",this.onPaused),this._video.removeEventListener("ended",this.onVideoComplete),this._video.removeEventListener("resize",this.onVideoResize),window.document.removeEventListener("visibilitychange",this.onVisibilityChanged.bind(this)),this._isMobile?this._video.addEventListener("resize",this.onVideoResize):(this._wrapper.addEventListener("mouseleave",this.onRollOut),this._wrapper.addEventListener("mousemove",this.onMouseMove)),e&&(this._video.addEventListener("durationchange",this.onDurationChange.bind(this)),this._video.addEventListener("loadedmetadata",this.onLoadedMetadata.bind(this)),this._video.addEventListener("timeupdate",this.onProgress),this._video.addEventListener("error ",this.onVideoError),this._video.addEventListener("waiting",this.onBuffering),this._video.addEventListener("playing",this.onPlaying),this._video.addEventListener("play",this.onPlay),this._video.addEventListener("pause",this.onPaused),this._video.addEventListener("ended",this.onVideoComplete),this._video.addEventListener("canplay",this.onCanPlay),this._video.addEventListener("canplaythrough",this.onCanPlay),window.document.addEventListener("visibilitychange",this.onVisibilityChanged.bind(this)))},videoClickEvent:function(e){this.scope._settings.startFullScreen&&!this.scope._isFullScreen&&this.scope._isAndroid&&this.scope.toggleFullScreen(),this.scope.playPause(e)},checkSpaceInteraction:function(e){return"false"!==e.target.dataset.space},addUserEventListeners:function(){var e=this;e._container.onkeydown=function(t){switch((t=t||window.event).key){case"Escape":this.onEscapeKey();break;case"ArrowLeft":this.onLeftKey(t);break;case"ArrowRight":this.onRightKey(t);break;case" ":this.checkSpaceInteraction(t)&&(t.preventDefault(),this.playPause());break;case"ArrowUp":t.preventDefault(),e.setVolume(e._volume+.1,!0);break;case"ArrowDown":t.preventDefault(),e.setVolume(e._volume-.1,!0)}}.bind(this),this._shareBtn.addEventListener("click",(function(t){e.showSharing(t)})),this._controls&&(this._isMobile?(this._video.addEventListener("click",this.mobileClick.bind(this),!1),this._adContainer.addEventListener("click touchstart touchmove touchend",this.mobileAdContainerClick.bind(this),!1)):(this._iOS&&this._adContainer.addEventListener("click touchstart touchmove touchend",this.mobileAdContainerClick.bind(this),!1),this._video.addEventListener("click",this.videoClickEvent,!1),this._video.addEventListener("dblclick",this.toggleFullScreen.bind(this),!1))),document.addEventListener("mousedown",(function(t){e._container.classList.add("remove-focus")})),document.addEventListener("keydown",(function(t){e._container.classList.remove("remove-focus")})),this._container.addEventListener("keyup",function(e){this.showControls(4e3)}.bind(this)),this._container.addEventListener("onMuteUnMute",(function(t){e.onMuteUnMute(e)})),this._ccBtn.addEventListener("click",(function(t){e.onCC(e)})),this._adsSkipButton.addEventListener("click",(function(t){e._skipAvailable&&e.skipAd()})),this._adContainer.addEventListener("click",(function(t){return e._settings.startFullScreen&&!e._isFullScreen&&e._isAndroid&&e.toggleFullScreen(),!1}));try{document.addEventListener(p.raw.fullscreenchange,(function(){e.onResize()}))}catch(e){}},mobileClick:function(e){if(this._controls){const{isControlsVisible:e}=this._store.getState();e?(this.playPause(),this._actions.hideControls()):this.showControls(3e3)}},mobileAdContainerClick:function(e){return e.preventDefault(),!1},onSetVolume:function(e){this.setVolume(e,!0)},onVolumeControlVisible:function(e){this._actions.setVolumeControlVisibility(e)},onCloseCC:function(){this._ccList.active=!1,this._ccList.style.maxHeight="0",this._ccList.innerHTML=""},onCC:function(e){if(this._availableCaptions.length>1){if(this._ccList.active)return void this.onCloseCC();this._ccList.active=!0;var t=this;this._ccList.innerHTML="";var n='<ul class="ccList">',r="";for(""==this._langSelected&&(r="selected"),n+='<li class="captionBtn '+r+'"><a data-lang="" data-id="" class="clink">No Captions</a></li>',i=0;i<this._availableCaptions.length;i++)r="",this._langSelected==this._availableCaptions[i].lang&&(r="selected"),n+='<li class="captionBtn '+r+'"><a data-lang="'+this._availableCaptions[i].lang+'" data-id="'+this._availableCaptions[i].id+'" class="clink">'+this._availableCaptions[i].lang+"</a></li>";n+="</ul>",this._ccList.innerHTML=n,this._ccList.style.maxHeight=30*this._availableCaptions.length+30+"px",this._ccList.hasListener||(this._ccList.hasListener=!0,this._ccList.addEventListener("click",(function(e){e.target.classList.contains("clink")&&t.onCCSelected(e.target.getAttribute("data-lang"),e.target.getAttribute("data-id"),!0)})))}else""!=this._langSelected?(this._ccBtn.style.opacity=.8,this.onCCSelected("","",!0),this._ccBtn.innerHTML=this._graphics.cc):(this._ccBtn.style.opacity=1,this._availableCaptions[0]?this.onCCSelected(this._availableCaptions[0].lang,this._availableCaptions[0].id,!0):this._embeddedCaptions[0]&&this.onCCSelected(this._embeddedCaptions[0].lang,"",!0),this._ccBtn.innerHTML=this._graphics["cc-active"])},onEscapeKey:function(e){this._shareScreen&&(this.showHideShareScreen(!1),this._shareBtn.focus())},onLeftKey:function(e){var t=0;t=e.shiftKey?this._video.currentTime-15<=0?0:this._video.currentTime-15:this._video.currentTime-5<=0?0:this._video.currentTime-15,this.eSeek(t)},onRightKey:function(e){var t=0;t=e.shiftKey?this._video.currentTime+15>=this._video.duration?this._video.duration-5:this._video.currentTime+15:this._video.currentTime+5<=this._video.duration?this._video.currentTime+5:this._video.duration,this.eSeek(t)},onSpaceBarKey:function(e){this.playPause(),e.preventDefault()},onPlay(){this.scope._actions.playVideo()},onCanPlay(){this.scope._store.getState().isBuffering&&this.scope._actions.canPlay()},showControls:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;clearTimeout(this._hideControlsTimer);const{isControlsVisible:t,isCountdownVisible:i,isClickForSoundVisible:n}=this._store.getState();t||i||n||this._actions.showControls();const r=()=>{const{isPlaying:e,isAdMode:t,isAdPlaying:i}=this._store.getState();!e||t&&!i||(this._actions.hideControls(),this._wrapper.classList.add("nocursor"))};0!==e?this._hideControlsTimer=setTimeout(r,e):r()},onMouseMove:function(e){this.scope.showControls(3e3),this.scope._wrapper.classList.remove("nocursor")},onRollOut:function(e){clearTimeout(this.scope._hideControlsTimer);const{isPlaying:t,isAdMode:i,isAdPlaying:n}=this.scope._store.getState();(t||i&&n)&&this.scope._actions.hideControls()},onVideoComplete:function(e){try{this.scope._comscoreTag.stop()}catch(e){}this.scope._adsLoader&&this.scope._adsLoader.contentComplete(),this.scope._mediaHeartbeat&&this.scope._mediaHeartbeat.trackComplete(),this.scope.sendOptimizelyBeacon("complete"),this.scope.sendPermutiveTracking("complete"),this.scope._convivaClient&&(this.scope._convivaClient.cleanupSession(this.scope._convivaContentSessionKey),this.scope._convivaContentSessionKey=null,this.scope._convivaPlayerStateManager.reset());try{this._moatManager.dispatchEvent({type:"AdStopped",adVolume:this._volume})}catch(e){}this.scope._store.getState().isAdMode||(this.scope.saveProgress(0),this.scope._settings.chainVideos?(this.scope._video.pause(),this.scope._iOS&&this.scope._video.webkitExitFullScreen(),this.scope.chainVideo()):this.scope._settings.resetOnComplete?(this.scope.setupThumbnail(),this.scope._iOS&&this.scope._video.webkitExitFullScreen(),this.scope._contentInitialized=!1):(this.scope._video.currentTime=0,this.scope._video.pause())),this.scope.trigger(this.scope._wrapper,"videoComplete",{guid:this.scope._videodata.guid}),this.scope.trigger(this.scope._wrapper,"onVideoComplete",{guid:this.scope._videodata.guid})},chainVideo:function(){this._isChained=!0;const{playlist:e}=this._store.getState();e.length>0?(this._videodata=e[0],this._container.setAttribute("aria-label",this._videodata.name),this._settings.guid=this._videodata.guid,this._settings.disableChainPlay?this.trigger(this._wrapper,"onSuggestionPlay",this._videodata):this.loadVideo(!0).then(this._actions.dequeuePlaylist).catch(console.error)):S.getNewPlaylist(this._settings.api,this._settings,this._store.getState().videoData,this._fields).then(e=>{e&&e.length>0&&(this._actions.replacePlaylist(e),this.chainVideo())}).catch(console.error)},onVisibilityChanged:function(e){this._isMobile&&("hidden"==window.document.visibilityState&&this._convivaContentSessionKey!==Conviva.Client.NO_SESSION_KEY&&null!==this._convivaContentSessionKey?(this._convivaClient.cleanupSession(this._convivaContentSessionKey),this._convivaContentSessionKey=null):"visible"==window.document.visibilityState&&null==this._convivaContentSessionKey&&this._contentInitialized&&this._convivaContentSessionKey&&(this._convivaContentSessionKey=this._convivaClient.createSession(this._convivaContentMetadata),this._convivaPlayerStateManager.reset(),this._convivaClient.isPlayerAttached(this._convivaContentSessionKey)||this._convivaClient.attachPlayer(this._convivaContentSessionKey,this._convivaPlayerStateManager)))},onPlaying:function(e){if("live"!==this.scope._store.getState().videoData.state&&this.scope._actions.updateDuration(this.duration),this.scope._actions.playVideo(),this.scope._isStalled=!1,!this.scope._playRequested)return this.scope._video.pause(),void(this.scope._playRequested=!0);this.scope._controls&&this.scope._isMobile&&this.scope.showControls(3e3),this.scope._playOverlay&&(this.scope._playOverlay.style.display="none"),this.scope._settings.startFullScreen&&!this.scope._isFullScreen&&this.scope.toggleFullScreen(),this.scope._isSeeking&&(this.scope._isSeeking=!1,this.scope._mediaHeartbeat&&this.scope._mediaHeartbeat.trackEvent(o.va.MediaHeartbeat.Event.SeekComplete),this.scope._convivaPlayerStateManager&&this.scope.debounce(this.scope._convivaPlayerStateManager.setPlayerSeekEnd(),100)),this.scope._contentStartTracked&&this.scope._mediaHeartbeat.trackPlay();try{this._comscoreTag.playContentPart(this._comscoreMeta)}catch(e){}try{this.scope.trigger(this.scope._wrapper,"onPlayerStateChange",{isPlaying:this.scope.eIsPlaying(),isFullscreen:this.scope._isFullScreen})}catch(e){}try{if(PARSELY){var t=window!=window.top?this.scope._videodata.linkURL:document.location.href;PARSELY.video.trackPlay(this.scope._videodata.guid,{title:this.scope._videodata.name,section:this.scope._tObject.eVar20,pub_date_tmsp:Date.now(),authors:this.scope._videodata.author.toString(),image_url:this.scope._videodata.videoStillURL,tags:[this.scope._tObject.eVar70,this.scope._store.getState().duration]},t)}}catch(e){}},onBitrateChange:function(e,t){try{var i,n;if(null!==(i=this._hlsPlayer)&&void 0!==i&&null!==(n=i.levels)&&void 0!==n&&n[t.level]){if(this._mediaHeartbeat&&this._sessionStarted){var r=this.getQOSData();this._mediaHeartbeat.trackEvent(o.va.MediaHeartbeat.Event.BitrateChange,r)}this._convivaPlayerStateManager&&this._convivaPlayerStateManager.setBitrateKbps(Math.round(parseInt(r.bitrate)/1e3))}}catch(e){}},onPageUnload:function(e,t){try{this._convivaClient.cleanupSession(this._convivaContentSessionKey),this._convivaClient.releasePlayerStateManager(playerStateManager)}catch(e){}},onPaused:function(e){this.scope||(this.scope=this),this.scope._actions.pauseVideo(),this.scope._controls&&this.scope._isMobile&&this.scope._actions.showControls(),this.scope._timePaused=new Date,this.scope._playOverlay&&(this.scope._playOverlay.style.display="block");try{this._comscoreTag.stop()}catch(e){}try{this.scope.trigger(this.scope._wrapper,"onPlayerStateChange",{isPlaying:this.scope.eIsPlaying(),isFullscreen:this.scope._isFullScreen})}catch(e){}try{if(PARSELY){var t=window!=window.top?this.scope._videodata.linkURL:document.location.href;PARSELY.video.trackPause(this.scope._videodata.guid,{title:this.scope._videodata.name,urlOverride:window.location!=window.parent.location?document.referrer:document.location.href,section:this.scope._tObject.eVar20,pub_date_tmsp:Date.now(),authors:this.scope._videodata.author.toString(),image_url:this.scope._videodata.videoStillURL,tags:[this.scope._tObject.eVar70,this.scope._store.getState().duration]},t)}}catch(e){}},onSeek:function(e){this._isSeeking=!0;var t=Math.round(this._store.getState().duration*e);t>this._store.getState().duration-10&&(t=this._store.getState().duration-5),this._convivaPlayerStateManager&&this.debounce(this._convivaPlayerStateManager.setPlayerSeekStart(t),100),this._actions.updateProgress(t),this._lastSaveProgressTimestamp=t,this._flash?this._flash.playerSeek(t):this._video.currentTime=t},onVideoError:function(e){this.displayErrorScreen("An error occurred.  Please try again later."),this._mediaHeartbeat&&("string"==typeof e?this._mediaHeartbeat.trackError("Content_"+e):this._mediaHeartbeat.trackError("Content_"+this._videodata.guid)),this._convivaClient&&null!==this._convivaContentSessionKey&&("string"!=typeof e&&(e="error: "+this._videodata.guid),this._convivaPlayerStateManager&&this._convivaPlayerStateManager.sendError("Playback Error: "+e,Conviva.Client.ErrorSeverity.FATAL),this._convivaClient.reportError(this._convivaContentSessionKey,e,Conviva.Client.ErrorSeverity.FATAL),this._convivaClient.cleanupSession(this._convivaContentSessionKey),this._convivaContentSessionKey=null)},displayErrorScreen(e){this._container.innerHTML='<div class="videoErrorMsg"><div>'.concat(e,"</div></div>")},updateBreakpointClass(){if(!this._wrapper)return;const{currentBreakpoint:e}=this._store.getState();this._wrapper.classList.contains("player-".concat(e))||(this._wrapper.classList.remove("player-full"),this._wrapper.classList.remove("player-16U"),this._wrapper.classList.remove("player-12U"),this._wrapper.classList.remove("player-8U"),this._wrapper.classList.remove("player-4U"),this._wrapper.classList.remove("player-tiny"),this._wrapper.classList.add("player-".concat(e)))},onResize:function(){this._height=this._wrapper.offsetHeight,this._width=this._wrapper.offsetWidth;const{width:e,height:t}=this._store.getState();if(this._hlsPlayer&&this._hlsPlayer.levels){var i=0,n=this._hlsPlayer.currentLevel;if(this._height>=this._hlsPlayer.levels[this._hlsPlayer.levels.length-1].height&&this._width>=this._hlsPlayer.levels[this._hlsPlayer.levels.length-1].width)this._hlsPlayer.autoLevelCapping=-1;else for(l=0;l<this._hlsPlayer.levels.length;l++){var r=this._hlsPlayer.levels[l];if(this._height<=r.height&&this._width<=r.width){i=l,this._hlsPlayer.levels[l+1]&&this._hlsPlayer.levels[l+1].height==this._hlsPlayer.levels[l].height&&this._hlsPlayer.levels[l+1].width==this._hlsPlayer.levels[l].width&&(i=l+1),i!=n&&(this._hlsPlayer.autoLevelCapping=i);break}}}if(this._adContainer&&this._adsManager){var a=google.ima.ViewMode.NORMAL;p&&p.isFullscreen&&(a=google.ima.ViewMode.FULLSCREEN),this._adsManager.resize(this._width,this._height,a)}if(this._adMarkerContainer)for(var o=this._adMarkerContainer.firstChild;null!==o;o=o.nextSibling){var s=parseInt(o.getAttribute("data-adTime")),c=parseInt(s/this._store.getState().duration*this._width);o.style.left=c+"px"}this._width===e&&this._height===t||this._actions.resize(this._width,this._height)},onScreenChange:function(e){let t;t=this._iOS?this._video.webkitDisplayingFullscreen:p.isFullscreen,t?this._actions.enterFullScreen():(this._actions.exitFullScreen(),this._store.getState().isMuted!==this._video.muted&&(this._video.muted?this._actions.mute():this._actions.unmute())),this._settings.startFullScreen&&(t?this._isAndroid&&(this._controls.style.display="block"):(this._adsManager&&(this._adsManager.pause(),this._adsSkipButton.style.display="none",this._actions.hideLoadingSpinner()),this._video.pause(),this._controls&&(this._controls.style.display="none",this._actions.hideLoadingSpinner(),this._video.controls=!1)));try{this.trigger(this._wrapper,"onPlayerStateChange",{isPlaying:this.eIsPlaying(),isFullscreen:t})}catch(e){}},onSaveChange:function(e){this._appMeasurement&&(svid.contextData["a.media.friendlyName"]=this._videodata.name,svid.contextData["a.media.name"]=this._videodata.guid,svid.contextData.action="video.save",svid.linkTrackVars="contextData.a.media.friendlyName,contextData.a.media.name,contextData.action",svid.tl(!0,"o",e?"video_save_add":"video_save_remove"))},muteUnMute:function(e,t,i){(null==e?!this._store.getState().isMuted:e)?(this._actions.mute(),this._flash&&this._flash.playerVolume(0),this._video.muted=!0,this._adsManager&&this._adsManager.setVolume(0),t&&(document.cookie="djvideomute=1; path=/")):(this._actions.unmute(),this._flash&&this._flash.playerVolume(100*parseFloat(this._volume)),this._video.muted=!1,this._video.volume=this._volume,this._adsManager&&this._adsManager.setVolume(this._volume),t&&(document.cookie="djvideomute=0; path=/"));const{isMuted:n}=this._store.getState();if(this._videodata&&i){svid.contextData["a.media.friendlyName"]=this._videodata.name,svid.contextData["a.media.name"]=this._videodata.guid,svid.contextData["video.mute"]=n?"Mute ON":"Mute OFF",svid.contextData.action="video.muted",svid.linkTrackVars="contextData.a.media.friendlyName,contextData.a.media.name,contextData.video.mute,contextData.action";let e=n?"heartbeat_video muted":"heartbeat_video unmuted";this._settings.clickForSound&&(e="heartbeat_tapped unmute"),svid.tl(!0,"o",e)}this.trigger(this._wrapper,"onMuteUnMute",{})},onMuteUnMute:function(e){},setVolume:function(e,t){try{e=(e=e<0?0:e)>1?1:e,e=Math.min(Math.max(parseFloat(e),0),1),this._flash&&this._flash.playerVolume(100*parseFloat(this._volume)),this._adsManager&&this._adsManager.setVolume(e),this._volume=e,this._video.volume=e,this._actions.setVolume(e),t&&(this._volume=e,document.cookie="djvideovol="+e+"; path=/",document.cookie="djvideovol="+e+";",this._store.getState().isMuted&&this.muteUnMute(!1,!0,!0))}catch(e){}},showPauseScreen:function(){var e=this.getShareLinkUrl(),t="";t+='<div class="video-pause-text"><div class="video-pause-title"  id="video-pause-title-'+this._videoId+'">'+this._videodata.name+'</div><div class="video-pause-description"  id="video-pause-title-'+this._videoId+'">'+this._videodata.description+'</div><div class="video-pause-share-icons"  id="video-share-icons-'+this._videoId+'"><ul class="share-buttons"><li><a href="https://www.facebook.com/sharer/sharer.php?u='+e+"&t="+this._videodata.name+'" title="Share on Facebook" data-space="false" target="_blank" id="sshare-fb-'+this._videoId+'" data-share="Facebook">'+this._graphics["share-fb"]+'</a></li><li><a href="https://twitter.com/intent/tweet?url='+e+"&text="+this._videodata.name+'" target="_blank" data-space="false" title="Tweet" id="sshare-twitter-'+this._videoId+'" data-share="Twitter">'+this._graphics["share-twitter"]+'</a></li><li><a href="mailto:?subject='+this._videodata.name+"&body=Description:"+e+'" target="_blank" data-space="false" title="Email" id="sshare-email-'+this._videoId+'" data-share="Email">'+this._graphics["share-email"]+'</a></li></ul></div></div><div class="video-pause-play-button"  id="video-pause-play-button-'+this._videoId+'"></div>',this._pauseScreen.innerHTML=t,this._pauseScreen.style.display="block"},hidePauseScreen:function(){this._pauseScreen.style.display="none",this._pauseScreen.innerHTML=""},playSuggestion:function(e){this._formatOverride="user initiated next",this._settings.disableChainPlay?this.trigger(this._wrapper,"onSuggestionPlay",e):this.ePlayVideo(e)},clickForSoundHandler:function(e){this.muteUnMute(!1,!0,!0),this.setVolume(this._volume,!1),this._settings.clickForSound=!1,this._controls&&(this._controls.style.display="block"),this._settings.adsEnabled&&this._adDisplayContainer.initialize(),this._actions.unmute(),this._settings.autoplay=!0},getShareLinkUrl:function(){var e=window.location!=window.parent.location?document.referrer:document.location.href,t=this._videodata.linkURL;return null!==this._settings.shareDomain?t=this._settings.shareDomain+this._videodata.linkRelativeURL:-1!==e.indexOf("marketwatch.com")?(this._settings.shareDomain="http://www.marketwatch.com",shareSite="&site=video.marketwatch.com",t="http://www.marketwatch.com"+this._videodata.linkRelativeURL):-1!==e.indexOf("barrons.com")&&(this._settings.shareDomain="http://www.barrons.com",shareSite="&site=video.barrons.com",t="http://www.barrons.com"+this._videodata.linkRelativeURL),t},showHideShareScreen:function(e){try{if(e){this._shareScreen.tabIndex=0,this._shareScreen.style.display="block",this._shareScreen.classList.add("video-show-share"),document.getElementById("video-share-b-".concat(this._videoId)).style.opacity=1,this._actions.showShareScreen()}else{this._shareScreen.tabIndex=-1,this._shareScreen.style.display="none",this._shareScreen.classList.remove("video-show-share"),document.getElementById("video-share-b-".concat(this._videoId)).style.opacity=.8,this._shareScreen.innerHTML="",this._actions.hideShareScreen()}}catch(e){}},showSharing:function(){if(this._shareScreen.classList.contains("video-show-share"))return void this.showHideShareScreen(!1);var e=this.getShareLinkUrl(),t=this._videodata,i=this._settings;function r(e,t){if(!document||!window)return null;const i=navigator&&navigator.userAgent.match(/ipad|iphone/i),n=document.createElement("textarea");if(n.value=e,n.setAttribute("readonly",""),n.style.position="fixed",n.style.left="-9999px",document.body.appendChild(n),i){let e=document.createRange();e.selectNodeContents(n);let t=window.getSelection();t.removeAllRanges(),t.addRange(e),n.setSelectionRange(0,999999)}else n.select();document.execCommand("copy")}var a=function(){var e='<iframe allowfullscreen="true" webkitallowfullscreen="true" mozallowfullscreen="true" frameborder="0" scrolling="no" marginheight="0" marginwidth="0" width="512" height="288" src="https://video-api.wsj.com/api-video/player/v3/iframe.html?guid='.concat(t.guid).concat(i.shareDomain?"&shareDomain=".concat(i.shareDomain):"",'"></iframe>');document.getElementById("copied-prompt").innerHTML='<span aria-live="polite">Embed copied to clipboard</span>',r(e),o(),document.getElementById("copy-embed").focus()};function o(){document.getElementById("copy-to-clipboard-notification").style.display="block"}a.bind(this);const s='\n            <span id="copy-to-clipboard-notification">\n                <div>\n                    <svg width="18px" height="18px" viewBox="0 0 18 18" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M11,19.6428571 C6.22668181,19.6428571 2.35714286,15.7733182 2.35714286,11 C2.35714286,6.22668181 6.22668181,2.35714286 11,2.35714286 C15.7733182,2.35714286 19.6428571,6.22668181 19.6428571,11 C19.6428571,15.7733182 15.7733182,19.6428571 11,19.6428571 Z M14.9938835,7.85744843 L9.95229041,12.8990415 L7.79155915,10.7383103 L7.07142857,11.4587804 L9.23215983,13.6191721 L9.95229041,14.3393027 L10.672421,13.6191721 L15.7140141,8.57757901 L14.9938835,7.85744843 Z" id="path-1"></path></defs><g id="Players" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="Sharing_8U" transform="translate(-230.000000, -59.000000)"><g id="-icons-/-shapes-/-actions-/-check-active" transform="translate(228.000000, 57.000000)"><mask id="mask-2" fill="white"><use xlink:href="#path-1"></use></mask><use id="Icon_Light_Plus_Active" fill="#000000" fill-rule="evenodd" xlink:href="#path-1"></use><g id="fills-/-white" mask="url(#mask-2)" fill="#FFFFFF" fill-rule="evenodd"><rect id="fill" x="0" y="0" width="22" height="22"></rect></g></g></g></g></svg>\n                    <p id="copied-prompt"></p>\n                </div>\n            </span>\n            <table class="share-wrapper">\n                <tr>\n                    <td valign="middle">\n                        <table class="shareTable">\n                                <tr>\n                                    <td>\n                                        <ul class="share-buttons">\n                                            <li>\n                                                <button title="Copy Link" aria-label="Copy Link" id="copy-link-url-image" data-space="false">\n                                                    '.concat(n(93),'\n                                                    <input id="copy-link-url" type="hidden" value="').concat(e,'" /></input>\n                                                </button>\n                                                <p class="share-button-text">Copy Link</p>\n                                            </li>\n                                            <li>\n                                                <button id="copy-embed" data-space="false">\n                                                    ').concat(n(94),'\n                                                </button>\n                                                <p>Copy Embed</p>\n                                            </li>\n                                            <li>\n                                                <button href="https://www.facebook.com/sharer/sharer.php?u=').concat(e,"&t=").concat(this._videodata.name,'" title="Share on Facebook" target="_blank" id="sshare-fb-').concat(this._videoId,'" data-share="Facebook" data-space="false">\n                                                    ').concat(n(95),'\n                                                </button>\n                                                <p>Facebook</p>\n                                            </li>\n                                            <li>\n                                                <button href="https://twitter.com/intent/tweet?url=').concat(e,"&text=").concat(this._videodata.name,'" target="_blank" title="Tweet" id="sshare-twitter-').concat(this._videoId,'" data-share="Twitter" data-space="false">\n                                                    ').concat(n(96),'\n                                                </button>\n                                                <p>Twitter</p>\n                                            </li>\n                                        </ul>\n                                    </td>\n                                </tr>\n                        </table>\n                    </td>\n                </tr>\n            </table>\n            <button class="closeBtn" id="closeBtn-share" data-space="false">\n                <?xml version="1.0" encoding="UTF-8"?><svg width="11px" height="11px" viewBox="0 0 21 21" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g id="Icons" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" fill-opacity="0.7"><g id="close" fill="#FFFFFF"><polygon id="Path" points="10.5 8.75 19.25 0 21 1.75 12.25 10.5 21 19.25 19.25 21 10.5 12.25 1.75 21 0 19.25 8.75 10.5 0 1.75 1.75 1.51121399e-15"></polygon></g></g></svg>\n            </button>');this._shareScreen.innerHTML=s,this.showHideShareScreen(!0),document.getElementById("closeBtn-share").addEventListener("click",function(e){this.showHideShareScreen(!1),this._shareBtn.focus()}.bind(this)),document.getElementById("closeBtn-share").addEventListener("keydown",function(e){"Tab"===e.key&&(this._volumeSlider.focus(),this.showHideShareScreen(!1))}.bind(this)),document.getElementById("copy-link-url-image").addEventListener("click",function(){document.getElementById("copied-prompt").innerHTML='<span aria-live="polite">Link copied to clipboard</span>',r(e),o(),document.getElementById("copy-link-url-image").focus()}.bind(this)),document.getElementById("copy-link-url-image").focus(),document.getElementById("copy-link-url-image").addEventListener("keydown",function(e){"Tab"===e.key&&e.shiftKey&&(this._shareBtn.nextSibling.focus(),this.showHideShareScreen(!1))}.bind(this)),document.getElementById("copy-embed").addEventListener("click",a),document.getElementById("sshare-fb-"+this._videoId).scope=this,document.getElementById("sshare-twitter-"+this._videoId).scope=this,document.getElementById("sshare-fb-"+this._videoId).addEventListener("click",this.trackShare),document.getElementById("sshare-twitter-"+this._videoId).addEventListener("click",this.trackShare)},addListeners:function(){var e=this;this._adsManager.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,(function(t){e.onAdError(t,e)})),this._adsManager.addEventListener(google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED,(function(t){e.onContentPauseRequested(t)})),this._adsManager.addEventListener(google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,(function(t){e.onContentResumeRequested(t)})),this._adsManager.addEventListener(google.ima.AdEvent.Type.ALL_ADS_COMPLETED,(function(t){e.onAdRemoved(t)})),this._adsManager.addEventListener(google.ima.AdEvent.Type.COMPLETE,(function(t){e.onAdComplete(t,e)})),this._adsManager.addEventListener(google.ima.AdEvent.Type.LOADED,(function(t){e.onAdLoaded(t)})),this._adsManager.addEventListener(google.ima.AdEvent.Type.AD_BUFFERING,(function(t){e.onAdBuffering(t)})),this._adsManager.addEventListener(google.ima.AdEvent.Type.STARTED,(function(t){e.onAdStarted(t,e)})),this._adsManager.addEventListener(google.ima.AdEvent.Type.PAUSED,(function(t){e.onAdPaused(t,e)})),this._adsManager.addEventListener(google.ima.AdEvent.Type.RESUMED,(function(t){e.onAdResumed(t,e)})),this._adsManager.addEventListener(google.ima.AdEvent.Type.SKIPPED,(function(t){e.onAdSkipped(t,e)})),this._adsManager.addEventListener(google.ima.AdEvent.Type.CLICK,(function(t){e.onAdClicked(t,e)})),this._adsManager.addEventListener(google.ima.AdEvent.Type.SKIPPABLE_STATE_CHANGED,(function(t){e.onSkippableChanged(t)})),this._adsManager.addEventListener(google.ima.AdEvent.Type.AD_PROGRESS,e=>this.onAdProgress(e));for(const e of Object.keys(google.ima.AdEvent.Type))this._adsManager.addEventListener(google.ima.AdEvent.Type[e],t=>this.log("IMA AdEvent ".concat(e,": "),t))},onAdClicked:function(e,t){t.sendPermutiveTracking("adClicked"),t._adsManager.pause()},onAdStarted:function(e){var t;this._actions.endVideoPlaybackInit(),null===(t=this._adHealthObserver)||void 0===t||t.observe(),this._adLowerCircleComponent.set(1),this._adCircleComponent.set(1),this._adCircleComponent.setText(S.gTimeFormat(this._adsManager.getRemainingTime()).slice(1)),this._adStarted=!0,this._skipAvailable=!1,this._currentAd=e.getAd(),this.onResize(),this.setupListeners(!1),this._vrWrapper.style.display="none",this.trigger(this._wrapper,"adStarted");try{this._video.textTracks[0]&&(this._video.textTracks[0].mode="hidden")}catch(e){}this._actions.playAd(),this._adLoadingScreen&&this._adLoadingScreen.parentNode&&this._adLoadingScreen.parentNode.removeChild(this._adLoadingScreen),this._shareBtn&&(this._shareBtn.style.display="none"),this._midrollRequested=!1;try{var i=[],n=new google.ima.CompanionAdSelectionSettings;n.resourceType=google.ima.CompanionAdSelectionSettings.ResourceType.STATIC,n.sizeCriteria=google.ima.CompanionAdSelectionSettings.SizeCriteria.IGNORE;var r=this._currentAd.getCompanionAds(1600,1600,n);if(r.length)for(var a=0;a<r.length;a++)i[a]={url:r[a].h,clickUrl:"",height:r[a].l.height,width:r[a].l.width,type:"html"};try{this.trigger(this._wrapper,"onCompanions",{availableAds:i})}catch(e){}}catch(e){try{this.trigger(this._wrapper,"onCompanions",{availableAds:[]})}catch(e){}}if(this._currentAd.isLinear()){this._controls&&(this._controls.classList.add("video-advertisment"),this._adContainer.style.display="block",this._adsManager.isCustomPlaybackUsed()&&(this._video.style.display="block"),this._settings.startFullScreen||this._store.getState().isAdPlaying||this._actions.playAd());try{this.trigger(this._wrapper,"onPlayerStateChange",{isPlaying:!1,isFullscreen:this._isFullScreen})}catch(e){}this._store.getState().isAdMode||this._actions.startAdMode(),this._store.getState().isMuted?this._adsManager.setVolume(0):this._adsManager.setVolume(this._volume),this._adInfo=this._currentAd.getAdPodInfo(),this._adDuration=this._currentAd.getDuration();var o=!0;try{this._currentAd.getUiElements().indexOf("countdown")>=0&&(o=!1)}catch(e){}this._adsSkipButton&&this._adDuration>16&&o&&(this._adsSkipButton.style.display="block",this._adsSkipButton.focus()),this.startAdTimer(),this._settings.startFullScreen&&!this._isFullScreen&&this._isMobile&&this._adsManager.pause(),this.trackAdStarted(),this.sendPermutiveTracking("adStarted")}else this._video.play()},handleLiveUpdates(){if(!this._liveStateController)return void console.error("liveStateController is not initialized");const e=this._store.getState().videoData.mediaLiveChannelId;e?this._liveStateController.getStatus(e).then(t=>{let i=t.state;"RUNNING"===i&&"future"===this._store.getState().videoData.state&&this.onLiveStateChanged("live"),this._liveStateController.subscribe(e,e=>{const t=e.state,n=this._store.getState().videoData.state;"RUNNING"!==i&&"RUNNING"===t&&"live"!==n?this.onLiveStateChanged("live"):"IDLE"===i||"IDLE"!==t||"processing"===n&&"vod"===n||(this._autoplayed&&(this._settings.autoplay=!1),this.onLiveStateChanged("processing"),this._liveStateController.unsubscribe()),i=t})}):console.error("mediaLiveChannelId was not found")},trackAdStarted:function(){var e=o.va.MediaHeartbeat,t=e.createAdBreakObject("pre-roll",1,0),i=e.createAdObject(this._currentAd.getTitle(),this._adId,1,this._adDuration),n={};n[e.AdMetadataKeys.ADVERTISER]=this._currentAd.getAdvertiserName(),n[e.AdMetadataKeys.CAMPAIGN_ID]=this._currentAd.getCreativeId(),i.setValue(e.MediaObjectKey.StandardAdMetadata,n),this._mediaHeartbeat.trackEvent(e.Event.AdBreakStart,t),this._mediaHeartbeat.trackEvent(e.Event.AdStart,i,{"ad.blank.start":"false","ad.catastrophic.blocker":"false","ad.disabled":"false"}),this._adPlaybackTime=Date.now()-this._time,this._currentAd&&this.convivaAdStart(this._currentAd),null!==this._convivaAdSessionKey&&this._convivaAdStateManager.setPlayerState(Conviva.PlayerStateManager.PlayerState.PLAYING);try{this._comscoreTag.stop()}catch(e){}try{this._comscoreTag.playAdvertisement()}catch(e){}},convivaAdStart:function(e){this._convivaClient.adStart(this._convivaContentSessionKey,Conviva.Client.AdStream.SEPARATE,Conviva.Client.AdPlayer.SEPARATE,Conviva.Client.AdPosition.PREROLL),this._convivaClient.sendCustomEvent(this._convivaContentSessionKey,"Conviva.PodStart",{podPosition:"Pre-roll",podIndex:"1",absoluteIndex:"1",podDuration:this._adDuration+""});var t=this.getConvivaAdMetadata(e);"object"==typeof e&&(this._convivaAdSessionKey=this._convivaClient.createAdSession(this._convivaContentSessionKey,t),this._convivaAdStateManager=this._convivaClient.getPlayerStateManager(),this._convivaClient.attachPlayer(this._convivaAdSessionKey,this._convivaAdStateManager),this._convivaAdStateManager.setVideoResolutionHeight(e.getVastMediaHeight()),this._convivaAdStateManager.setVideoResolutionWidth(e.getVastMediaWidth()),this._convivaAdStateManager.setBitrateKbps(e.getVastMediaBitrate()))},getConvivaAdMetadata:function(e){var t,i,n,r,a=new Conviva.ContentMetadata;if(a.assetName=e.getTitle(),a.streamUrl=e.getMediaUrl(),a.defaultBitrateKbps=0,a.applicationName="WEB V3",a.viewerId=S.getCookie("REMOTE_USER"),a.duration=e.getDuration(),a.isLive=this._isLive,0!==e.getWrapperAdIds().length){let a=e.getWrapperAdIds().length;t=e.getWrapperAdSystems()[a-1],i=e.getWrapperAdIds()[a-1],n=e.getWrapperCreativeIds()[a-1],r=e.getTitle()[a-1],"NA"}else t=e.getAdSystem(),i=e.getAdId(),n=e.getCreativeId(),r=e.getTitle(),"NA";return a.custom={"c3.ad.id":""+e.getAdId(),"c3.ad.creativeId":""+e.getCreativeId(),"c3.ad.technology":"Client Side","c3.ad.system":""+e.getAdSystem(),"c3.ad.sequence":""+e.getAdPodInfo().getAdPosition(),"c3.ad.advertiser":""+e.getAdvertiserName(),"c3.ad.adManagerName":"Google IMA SDK","c3.ad.adManagerVersion":""+google.ima.VERSION,"c3.ad.firstAdSystem":""+t,"c3.ad.firstAdId":""+i,"c3.ad.firstCreativeId":""+n,"c3.ad.position":"Pre-roll","c3.ad.type":"NA","c3.ad.mediaFileApiFramework":e.getApiFramework(),viewerId:S.getCookie("REMOTE_USER"),"c3.ad.advertiser":e.getAdvertiserName(),"c3.creativeName":r,"c3.ad.isSlate":"NA","c3.ad.adStitcher":"NA","c3.ad.unitName":"NA","c3.ad.breakId":"NA","c3.ad.category":"NA","c3.ad.classification":"NA","c3.ad.advertiserCategory":this._videodata.gptCustParams,"c3.ad.advertiserId":"NA","c3.ad.campaignName":"NA","c3.ad.dayPart":"NA","c3.ad.sessionStartEvent":"NA",contentAssetName:this._videodata.name+" - "+this._videodata.guid},a},trackShare:function(e){var t;this.scope._appMeasurement&&("string"==typeof e.share?(this.scope=this,t=e.share):t=this.dataset.share,svid.contextData["a.media.friendlyName"]=this.scope._videodata.name,svid.contextData["a.media.name"]=this.scope._videodata.guid,svid.contextData["social.share.type"]=t,svid.contextData.action="social.share",svid.linkTrackVars="contextData.a.media.friendlyName,contextData.a.media.name,contextData.social.share.type,contextData.action",svid.tl(!0,"o","heartbeat_video share"))},trackMoreVideosSlide:function(e){this._appMeasurement&&(svid.contextData["a.media.friendlyName"]=this._videodata.name,svid.contextData["a.media.name"]=this._videodata.guid,svid.contextData.action="video.slide",svid.linkTrackVars="contextData.a.media.friendlyName,contextData.a.media.name,contextData.action",svid.tl(!0,"o","video_upnext"))},trackEndscreenSlide:function(e){this._appMeasurement&&(svid.contextData["a.media.friendlyName"]=this._videodata.name,svid.contextData["a.media.name"]=this._videodata.guid,svid.contextData.action="video.slide",svid.linkTrackVars="contextData.a.media.friendlyName,contextData.a.media.name,contextData.action",svid.tl(!0,"o","video_instreamrec"))},skipAd:function(e){this._adsManager&&(this._adsManager.skip(),this._adsManager.stop())},onAdSkipped:function(e,t){t._mediaHeartbeat.trackEvent(o.va.MediaHeartbeat.Event.AdSkip),this.onAdRemoved()},onSkippableChanged:function(e){},onAdComplete:function(e,t){this.onAdRemoved(),this._adStarted=!1,t.trigger(t._wrapper,"adComplete"),t._mediaHeartbeat.trackEvent(o.va.MediaHeartbeat.Event.AdComplete),t._mediaHeartbeat.trackEvent(o.va.MediaHeartbeat.Event.AdBreakComplete),this.sendCXevent("ad_complete"),this._ajax.get(t._larsUrl+"?source="+t._settings.larsAdId+"&guid={"+t._settings.guid+"}")},onAdResumed:function(e){const{isAdMode:t,isAdPlaying:i}=this._store.getState();t&&(i||this._actions.playAd(),this._playOverlay&&(this._playOverlay.style.display="none")),this.showControls(3e3),this._settings.startFullScreen&&!this._isFullScreen&&this.toggleFullScreen();try{this._comscoreTag.playAdvertisement()}catch(e){}this._convivaAdStateManager&&this._convivaClient&&this._convivaAdStateManager.setPlayerState(Conviva.PlayerStateManager.PlayerState.PLAYING);try{this.trigger(this._wrapper,"onPlayerStateChange",{isPlaying:!0,isFullscreen:this._isFullScreen})}catch(e){}},onAdPaused:function(e){const{isAdMode:t,isAdPlaying:i}=this._store.getState();if(t){i&&this._actions.pauseAd(),this._playOverlay&&(this._playOverlay.style.display="block");try{this._comscoreTag.stop()}catch(e){}this._convivaAdStateManager&&this._convivaClient&&this._convivaAdStateManager.setPlayerState(Conviva.PlayerStateManager.PlayerState.PAUSED)}this.showControls(3e3);try{this.trigger(this._wrapper,"onPlayerStateChange",{isPlaying:!1,isFullscreen:this._isFullScreen})}catch(e){}},onAdProgress(e){const{currentTime:t}=e.getAdData();this._store.getState().currentAdPosition!==t&&this._actions.updateAdProgress(t)},startAdTimer:function(){var e=this;this._adTime=0,this._adTimer&&clearInterval(this._adTimer),this._adTimer=setInterval((function(){e.adTick()}),500)},startAdTimeoutTimer:function(){var e=this;this._adTimeoutFail=!1,this._adTimeoutTimer&&clearInterval(this._adTimeoutTimer),this._adTimeoutTimer=setInterval((function(){e._adTimeoutFail=!0,e.adResponseTimeout()}),e._adResponseTimeout)},adResponseTimeout:function(e){this.onAdError("timeout"),this._settings.adsEnabled=!1,this._actions.endVideoPlaybackInit()},adTick:function(e){const{isAdPlaying:t}=this._store.getState();if(t&&this._adsManager.getRemainingTime()>0){const e=(this._adDuration-this._adsManager.getRemainingTime())/this._adDuration;try{this.trigger(this._wrapper,"onAdTimeUpdate",{percent:e,duration:this._adDuration})}catch(e){}if(this._adTime++,this._adTime>60&&clearInterval(this._adTimer),this._adDuration>15){if(this._adTime>30)this._adCountdownText&&(this._videoSkipIcon.style.display="inline-block",this._adCountdownText.innerHTML="",this._adsSkipButton.focus()),this._skipAvailable=!0;else if(this._adCountdownText)this._videoSkipIcon.style.display="none",0==Math.round(15-Math.floor(this._adTime/2))?(this._adCountdownText.innerHTML="",this._videoSkipIcon.style.display="inline-block"):this._adCountdownText.innerHTML=" in "+Math.round(15-Math.floor(this._adTime/2))}else this._adsSkipButton&&(this._adsSkipButton.style.display="none");this._adsManager&&this._adsManager.getRemainingTime()<1&&clearInterval(this._adTimer);try{e>0&&this._adCircleComponent.animate(Math.abs(1-e),{duration:700}),this._timeDisplay&&this._adCircleComponent.setText(S.gTimeFormat(this._adsManager.getRemainingTime()).slice(1))}catch(e){}}},onAdRemoved:function(){var e;this._video.style.display="block",this._convivaClient&&this._adStarted&&null!=this._convivaAdSessionKey&&(this._convivaClient.adEnd(this._convivaContentSessionKey),this._adPlaybackTime=Date.now()-this._time-this._adPlaybackTime,this._convivaClient.sendCustomEvent(this._convivaContentSessionKey,"Conviva.PodEnd",{podPosition:"Pre-roll",podIndex:"1",absoluteIndex:"1",podDuration:this._adDuration+""}),this._convivaAdStateManager.setPlayerState(Conviva.PlayerStateManager.PlayerState.STOPPED),this._convivaClient.cleanupSession(this._convivaAdSessionKey),this._convivaAdSessionKey=null),!this._contentStartTracked&&this._sessionStarted&&this.trackContentStarted(),this._store.getState().isAdMode&&this._actions.stopAdMode(),this._adStarted=!1,this._skipAvailable=!1,this._adContainer.style.display="block",this.setupListeners(!0),this._adsSkipButton&&(this._adsSkipButton.style.display="none"),this._adContainer&&(this._adContainer.style.display="none"),"vr"==this._videodata.format&&(this._vrWrapper.style.display="block"),this._controls&&(this._controls.classList.remove("video-advertisment"),this._playOverlay.style.display="none",this._settings.shareEnabled&&this._shareBtn&&(this._shareBtn.style.display="block")),clearInterval(this._adTimer);try{this._comscoreTag.stop()}catch(e){}null===(e=this._adHealthObserver)||void 0===e||e.disconnect()},onAdLoaded:function(e){try{this._currentAd=e.getAd();var t="",i=this._currentAd.getWrapperAdIds();for(w in i)t+=i[w]+",";this._currentAd.getAdId()?this._adId=t+this._currentAd.getAdId():this._adId="none"}catch(e){this._adId="none"}this._convivaContentMetadata&&(this._convivaContentMetadata.adId=this._adId),this.trigger(this._wrapper,"adLoaded",this._currentAd)},onContentPauseRequested:function(){this._video.pause()},onContentResumeRequested:function(){var e=this;this.onAdRemoved(),this._playOverlay&&(this._playOverlay.style.display="none");var t=this._video.play();void 0!==t&&t.catch((function(t){e._video.play()}))},getAdContextData:function(){return{}},onAdError:function(e){var t;(this.log("AdError",e),this._adTimeoutTimer&&clearInterval(this._adTimeoutTimer),"object"==typeof e)&&(null!=e&&e.getError()&&null!=e&&null!==(t=e.getError())&&void 0!==t&&t.getErrorCode()&&this._actions.setAdError(e.getError().getErrorCode()));if(this._store.getState().adInitState===x.STARTED&&this._actions.setAdInitState(x.FAILED),this.onAdRemoved(),this.trigger(this._wrapper,"adError",n),this._adErrorTracked)this._adErrorEvent=e;else{this._adErrorTracked=!0;var i=this._adStarted?"Adpost_":"Ad_";try{this._adsLoading=!1;var n={type:"",code:"",msg:""};if(!1===e)n.code="0",n.msg="Ads Blocked";else if("timeout"===e)n.code="1",n.msg="No IMA Loader Response After 5 Seconds";else{var r=e.getError();if(n.code=r.getErrorCode(),n.msg=r.getMessage(),void 0!==n.msg&&null!==n.msg){var a=r.getInnerError();null!=a&&(n.msg=n.msg+" - "+a)}else n.msg="A null was recieved from ima getMessage"}}catch(e){}setTimeout(()=>this._video.play(),0),this.trackConvivaAdError(n),this._mediaHeartbeat.trackError(i+n.msg)}},trackConvivaAdError:function(e){if(this._convivaClient){if(this._currentAd)var t=this.getConvivaAdMetadata(this._currentAd);else t=new Conviva.ContentMetadata;t.assetName="Ad Error",e&&(t.custom.AdErrorType=function(e){if(0==(e=parseInt(e)))return"Ad Blocker";if(1021==e||1==e||301==e||402==e)return"Ad Timeout";if(1007==e||1009==e)return"Fallback no-ad";return"Other Ad Playback Error"}(e.code)),null===this._convivaAdSessionKey&&(this._convivaAdSessionKey=this._convivaClient.createAdSession(this._convivaContentSessionKey,t));var i="Code: "+e.code+", Message: "+e.msg;this._convivaClient.reportError(this._convivaAdSessionKey,i,Conviva.Client.ErrorSeverity.FATAL),this._adStarted&&(this._convivaClient.adEnd(this._convivaContentSessionKey),this._convivaClient.sendCustomEvent(this._convivaContentSessionKey,"Conviva.PodEnd",{podPosition:"Pre-roll",podIndex:"1",absoluteIndex:"1",podDuration:this._adDuration+""}),this._convivaAdStateManager.setPlayerState(Conviva.PlayerStateManager.PlayerState.STOPPED)),this._convivaClient.cleanupSession(this._convivaAdSessionKey),this._convivaAdSessionKey=null}},toggleFullScreen:function(e){this._iOS?this._video.webkitEnterFullscreen():p.toggle(this._wrapper)},playPause:function(e){if(this._flash)return void(this._fPlaying?this._flash.playerPause():this._flash.playerResume());const{isAdMode:t,isAdPlaying:i,currentPosition:n}=this._store.getState();var r;t?this._adsManager&&(i?(this._playRequested=!1,this._adsManager.pause(),this.onAdPaused(),this._adsManager.isCustomPlaybackUsed()&&this._video.pause()):(this._playRequested=!0,this.onAdResumed(),this._adsManager.resume(),this._adsManager.isCustomPlaybackUsed()&&this._video.play())):this._video.paused?(null===(r=this._video.play())||void 0===r||r.catch(()=>""),this._playRequested=!0):(this.saveProgress(n),this._video.pause(),this._playRequested=!1);this._playRequested||this._mediaHeartbeat.trackPause()},eResumeVideo:function(e){this._playRequested=!0,this._contentInitialized?this._store.getState().isAdMode?this._adsManager.resume():this._video.paused&&(this._video.play(),this._playRequested=!0):this.startVideo({fetchAds:!0})},eSeek:function(e,t){var i=e;t&&(i=Math.round(this._store.getState().duration*(e/100))),this._video&&!this._store.getState().isAdMode&&this._contentInitialized?i+5<this._video.duration&&(this._video.currentTime=i):(this._settings.startPosition=parseInt(e),this._contentInitialized||this.startVideo({fetchAds:!0}))},ePauseVideo:function(e){this._self._playRequested=!1,this._self._flash?this.self._flash.playerPause():this._self._store.getState().isAdMode?this._self._adsManager.pause():this._self._video.paused||this._self._video.pause()},ePlayPauseVideo:function(e){this._self._contentInitialized||this._self._playRequested?this._self.playPause(e):this._self.startVideo({fetchAds:!0})},eKillVideo:function(e){this._self._adsManager&&this._self._adsManager.stop()},eIsPlaying:function(){const{isAdMode:e,isAdPlaying:t}=this._self._store.getState();return!!(!this._self._video.paused||this._self._video.seeking||e&&t)||!(!e||!this._self._playRequested)},ePlayVideo:function(e){if(!isNaN(parseInt(e,10)))return this._settings.startPosition=parseInt(e),void this.eResumeVideo();"string"==typeof(null==e?void 0:e.guid)?("string"==typeof(null==e?void 0:e.startAction)&&(this._formatOverride=e.startAction),this._video.style.display="none",this._settings.guid=e.guid,this._actions.updateVideoData({...this._store.getState().videoData,guid:e.guid}),this.loadVideo(!0)):this.log("Cannot play video without a guid")},eLoadVideo:function(e){this._self._settings.guid=e.guid,e.vidora&&(this._self._isChained=!1),!this._self._contentInitialized&&this._self._isMobile&&-1!==document.location.href.indexOf("wsj.com/video")?window.location.href=e.linkURL:(this._self.loadVideo(!0),this._self._shareScreen&&this._self.showHideShareScreen(!1))},eUpdatePlaylist:function(e){let t;try{t=e.items&&void 0!==e.items?e.items:e}catch(i){t=e}this._self._actions.replacePlaylist(t)},eMute:function(e){this._self.muteUnMute(e,!1,!0)},eGetStatus:function(){return{isPlaying:this._self.eIsPlaying(),isFullscreen:this._self._isFullScreen}},initVrPlayback:function(){var e=this;if(void 0!==a){var t;this._vrWrapper.style.display="block",this._vrComponents={},this._vrComponents.isUserInteracting=!1,onMouseDownMouseX=0,onMouseDownMouseY=0,lon=180,onMouseDownLon=0,lat=0,onMouseDownLat=0,phi=0,theta=0,this._vrComponents.camera=new a.PerspectiveCamera(75,parseInt(getComputedStyle(this._vrWrapper).width)/parseInt(getComputedStyle(this._vrWrapper).height),1,1100),this._isAndroid&&(this._vrComponents.controls=new a.DeviceOrientationControls(this._vrComponents.camera)),this._vrComponents.camera.target=new a.Vector3(0,0,0),this._vrComponents.scene=new a.Scene;var i=new a.SphereGeometry(500,60,40);i.scale(-1,1,1),this._video.crossOrigin="anonymous";var r=new a.VideoTexture(this._video);r.minFilter=a.LinearFilter,r.generateMipmaps=!1;var o=new a.MeshBasicMaterial({map:r});return t=new a.Mesh(i,o),this._vrComponents.scene.add(t),this._vrComponents.renderer=new a.WebGLRenderer,this._vrComponents.renderer.getContext().getExtension("OES_texture_half_float_linear"),this._vrComponents.renderer.setPixelRatio(this._vrWrapper.devicePixelRatio),this._vrComponents.renderer.setSize(parseInt(getComputedStyle(this._vrWrapper).width),parseInt(getComputedStyle(this._vrWrapper).height)),this._vrWrapper.appendChild(this._vrComponents.renderer.domElement),this._video.style.display="none",e._vrComponents.camera.aspect=e._vrWrapper.clientWidth/e._vrWrapper.clientHeight,e._vrComponents.camera.updateProjectionMatrix(),e._vrComponents.renderer.setSize(e._vrWrapper.clientWidth,e._vrWrapper.clientHeight),this._video.play(),function t(){requestAnimationFrame(t),function(){lat=Math.max(-85,Math.min(85,lat)),phi=a.Math.degToRad(90-lat),theta=a.Math.degToRad(lon),e._vrComponents.camera.target.x=500*Math.sin(phi)*Math.cos(theta),e._vrComponents.camera.target.y=500*Math.cos(phi),e._vrComponents.camera.target.z=500*Math.sin(phi)*Math.sin(theta),e._vrComponents.camera.lookAt(e._vrComponents.camera.target),e._vrComponents.controls&&e._vrComponents.controls.update();e._vrComponents.renderer.render(e._vrComponents.scene,e._vrComponents.camera)}()}(),this._isMobile?(this._vrWrapper.addEventListener("touchstart",s,!1),this._vrWrapper.addEventListener("touchmove",l,!1),this._vrWrapper.addEventListener("touchend",c,!1)):(document.addEventListener("mousedown",s,!1),document.addEventListener("mousemove",l,!1),document.addEventListener("mouseup",c,!1)),!0}function s(t){t.preventDefault(),void 0!==t.touches&&(t.clientX=t.touches[0].clientX,t.clientY=t.touches[0].clientY),e._vrComponents.isUserInteracting=!0,e._vrComponents.controls&&e._vrComponents.controls.disconnect(),onMouseDownMouseX=t.clientX,onMouseDownMouseY=t.clientY,onMouseDownLon=lon,onMouseDownLat=lat,e._isMobile&&("none"!=e._controls.style.display&&e.playPause(t),e._controls.style.display="block",e._controls.style.bottom="0px",e._controls.hideTime=e._video.currentTime)}function l(t){!0===e._vrComponents.isUserInteracting&&(void 0!==t.touches&&(t.clientX=t.touches[0].clientX,t.clientY=t.touches[0].clientY),t.target.width&&(lon=.15*(onMouseDownMouseX-t.clientX)+onMouseDownLon,lat=.15*(t.clientY-onMouseDownMouseY)+onMouseDownLat,e._vrComponents.controls&&e._vrComponents.controls.update()))}function c(t){e._vrComponents.isUserInteracting=!1,e._vrComponents.controls&&e._vrComponents.controls.connect()}Promise.resolve().then(function(t){a=n(17),e.initVrPlayback()}.bind(null,n)).catch((function(t){console.error(t),e.startVideo({fetchAds:!0})}))},displayVrMsg:function(){var e=this;this._vrWrapper.style.display="none",this._controls&&(this._controls.style.display="none"),this._actions.hideLoadingSpinner();var t=document.createElement("div");t.className="vr-alert",t.innerHTML='<span class="closebtn">&times;</span>360 videos are not available in this browser.<br />Please try with the Chrome browser',this._wrapper.appendChild(t),setTimeout((function(){t.classList.add("vr-down")}),500),t.onclick=function(){t.style.display="none",e.chainVideo()},document.getElementById("vrLearnMore").onclick=function(){e._video.pause()}},getTestingSystemSettings:function(){var e=new Conviva.SystemSettings;return e.logLevel=Conviva.SystemSettings.LogLevel.DEBUG,e.allowUncaughtExceptions=!0,e},getProductionSystemSettings:function(){var e=new Conviva.SystemSettings;return e.logLevel=Conviva.SystemSettings.LogLevel.ERROR,e},trackInit:function(){try{var e=o.va.MediaHeartbeat,t=this._videodata;this._ajax.get(this._larsUrl+"?source="+this._settings.larsId+"&guid={"+this._settings.guid+"}");var i="vod"===t.state?e.StreamType.VOD:e.StreamType.LIVE;this._mediaObjectHeartbeat=e.createMediaObject(t.name,t.guid,this._store.getState().duration,i),this._mediaObjectHeartbeat.setValue(e.MediaObjectKey.StandardVideoMetadata,this.getStandardMetaData())}catch(e){}this._formatOverride="",this._mediaHeartbeat._config.channel=this.getChannel(),this._mediaHeartbeat.trackSessionStart(this._mediaObjectHeartbeat,this.getContextData()),this._sessionStarted=!0;try{this._comscoreTag.playContentPart(this._comscoreMeta)}catch(e){}try{var n={level1:this._videodata["wsj-section"],level2:this._videodata["wsj-subsection"],level3:this._videodata.guid,slicer1:S.getChannelFromDomain(this._domain)};this._moatManager=u(this._video,n,this._store.getState().duration,"dowjonesjsvideocontent394324437046",this._videodata.hls),this._moatManager.dispatchEvent({type:"AdVideoStart",adVolume:this._volume})}catch(e){}try{this._settings.hasCMPConsent&&window.vidora.push(["send","play",this._videodata.guid])}catch(e){}this.sendOptimizelyBeacon("init"),this.sendPermutiveTracking("VideoPlay"),void 0!==window.cX&&"function"==typeof window.cX.sendPageViewEvent&&window.cX.sendPageViewEvent({location:this._videodata.linkURL})},sendCXevent:function(e){try{if(void 0!==window.cX&&"object"==typeof window.cX.callQueue)switch(e){case"play":window.cX.callQueue.push(["sendEvent","videoPlay"]);break;case"ad_complete":window.cX.callQueue.push(["sendEvent","videoAdComplete"])}}catch(e){}},sendOptimizelyBeacon:function(e){try{if("object"!=typeof window.optimizely)return;const n={init:["wsj-video_initiates","14369530301"],start:["wsj-video_content-start","14377780073"],complete:["wsj-video_content-completes","14350000105"],percent:["wsj-video_percentage-of-video-watched","14355670366"],percent25:["wsj-video_percentage-25","14819120481"],percent50:["wsj-video_percentage-50","14793070766"],percent75:["wsj-video_percentage-75","14805100688"],percent95:["wsj-video_percentage-95","14799330489"]};var t="";try{t=window.optimizely.get("visitor").visitorId}catch(e){}var i={account_id:"5090114122",visitors:[{visitor_id:t,session_id:"AUTO",attributes:{},snapshots:this.buildSnapshots(n[e])}],anonymize_ip:!0,client_name:"wsj-video-api",client_version:"1.0.0",enrich_decisions:!0};fetch("https://logx.optimizely.com/v1/events",{method:"post",body:JSON.stringify(i)})}catch(e){}},sendPermutiveTracking:function(e){},buildSnapshots:function(e){try{var t=[];return t.push({decisions:[],events:[{entity_id:e[1],key:e[0],timestamp:Date.now(),uuid:this.createUUIDv4()}]}),t}catch(e){return[]}},createUUIDv4:function(){try{return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))}catch(e){return""}},getTrackingDateString:function(e){try{var t=new Date(e.formattedCreationDate),i=e.omniPublishDate.split("video_")[1],n=new Date(i);return"original_"+t.getFullYear()+"-"+(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-"+t.getDate()+" "+t.getHours()+":"+(t.getMinutes()<10?"0":"")+t.getMinutes()+"_current_"+n.getFullYear()+"-"+(n.getMonth()+1<10?"0"+(n.getMonth()+1):n.getMonth()+1)+"-"+n.getDate()+" "+n.getHours()+":"+(n.getMinutes()<10?"0":"")+n.getMinutes()}catch(t){return e.formattedCreationDate}return e.formattedCreationDate},getSectionSubsection:function(e){var t=[],i="wsj",n="";try{n=window.s?s.channel:S.getChannelFromDomain(this._domain)}catch(e){n=S.getChannelFromDomain(document.domain)}return"AllThingsD"==n?i="allthingsd":"SmartMoney"==n&&(i="sm"),"string"==typeof e[i+"-section"]&&t.push(e[i+"-section"]),"string"==typeof e[i+"-subsection"]&&t.push(e[i+"-subsection"]),t},getContentTypes:function(){var e=["video embedded offsite","video embedded offsite"];if(!1!==this.getChannel()){var t=this.getVideoContent();e[0]=void 0!==t.prop1?t.prop1:"Embedded Onsite",e[1]=void 0!==t.prop19?t.prop19:void 0!==t.prop1?t.prop1:"Embedded Onsite"}return e},getContextData:function(){var e=o.va.MediaHeartbeat,t={};this.getVideoContent(),document.location.href;this._settings.shareDomain&&this._settings.shareDomain,t["a.media.friendlyName"]=this._videodata.name,t["a.media.length"]=this._store.getState().duration,t["a.media.name"]=this._videodata.guid,t["a.contentType"]="vod"===this._videodata.state?e.StreamType.VOD:e.StreamType.LIVE,this._settings.fireTv?t["a.media.playerName"]="Amazon Fire TV":t["a.media.playerName"]="Web";var i=this._settings.parentUrl||window.location.href;if(t["user.ref"]=S.getCookie("TR"),t["user.type"]=this.getUserTypeVar(),t["page.content.type"]=this.getContentTypes()[0],t["page.content.type.detail"]=this.getContentTypes()[1],t["page.driver"]=this.getParameterByName("mod"),t["video.player.type"]="Web",t["page.full.url"]=i,t["video.keywords"]=this._videodata.keywordsOmni?this._videodata.keywordsOmni:"",t["page.name"]="",t["page.site"]="",t["a.media.channel"]=this.getChannel(),window.s&&(t["page.section"]=s.prop2?s.prop2:"",t["page.subsection"]=s.prop26?s.prop26:"",t["article.type"]=s.prop3?s.prop3:"",t["article.headline"]=s.prop4?s.prop4:"",t["article.id"]=s.prop20?s.prop20:"",t["article.author"]=s.prop21?s.prop21:"",t["article.publish"]=s.prop23?s.prop23:"",t["page.full.url"]=s.prop6?s.prop6:"",t["page.name"]=s.PageName?s.PageName:"",t["page.site"]=s.eVar11?s.eVar11:""),window.utag_data){if(t["page.name"]=window.utag_data.page_name?window.utag_data.page_name:"",t["page.site"]=window.utag_data.page_site?window.utag_data.page_site:"",t["user.ref"]=window.utag_data.user_ref?window.utag_data.user_ref:"",t["user.tags"]=window.utag_data.user_tags?window.utag_data.user_tags:"",t["user.type"]=window.utag_data.user_type_post?window.utag_data.user_type_post:"",t["page.content.type"]=window.utag_data.page_content_type?window.utag_data.page_content_type:"",t["page.content.type.detail"]=window.utag_data.page_content_type_detail_post?window.utag_data.page_content_type_detail_post:"",window.utag_data.qp){const{mod:e,reflink:i}=window.utag_data.qp;t["page.driver"]=e||"",t["page.driver.internal"]=e||"",t["page.driver.external"]=i||""}t["page.section"]=window.utag_data.page_section_post?window.utag_data.page_section_post:"",t["page.subsection"]=window.utag_data.page_subsection_post?window.utag_data.page_subsection_post:"",t["article.type"]=window.utag_data.article_type_post||"",t["article.headline"]=window.utag_data.article_headline_orig_post?window.utag_data.article_headline_orig_post:"",t["article.headline.orig"]=window.utag_data.article_headline_orig_post?window.utag_data.article_headline_orig_post:"",t["article.id"]=window.utag_data.article_id?window.utag_data.article_id:"",t["article.author"]=window.utag_data.article_author?window.utag_data.article_author:"",t["article.publish"]=window.utag_data.article_publish?window.utag_data.article_publish:"",t["article.publish.post"]=window.utag_data.article_publish_post||"",t["article.publish.orig"]=window.utag_data.article_publish_orig?window.utag_data.article_publish_orig:""}return t["video.base.url"]=i.split("?")[0],t["video.player.technology"]="html "+this._version,t["ad.blank.start"]="false",this._settings.adsEnabled?"1"===this._videodata.catastrophic&&(t["ad.catastrophic.blocker"]="true",t["ad.disabled"]="false"):(t["ad.disabled"]="true",t["ad.catastrophic.blocker"]="false"),t},getStandardMetaData:function(){var e={},t=this._videodata,i=o.va.MediaHeartbeat;e[i.VideoMetadataKeys.SHOW]=null==typeof t.column?"":t.column,e[i.VideoMetadataKeys.SEASON]="",e[i.VideoMetadataKeys.EPISODE]=t.episodeNumber,e[i.VideoMetadataKeys.ORIGINATOR]=t.author,e[i.VideoMetadataKeys.GENRE]="WSJ_"+this.getSectionSubsection(t).join("_"),e[i.VideoMetadataKeys.FIRST_DIGITAL_DATE]=this.getTrackingDateString(t),e[i.VideoMetadataKeys.FEED]=this._videodata.type,e[i.VideoMetadataKeys.NETWORK]=t.doctypeID;const{isMuted:n}=this._store.getState();return""!=this._formatOverride?e[i.VideoMetadataKeys.STREAM_FORMAT]=this._formatOverride:this._videodata.startAction?e[i.VideoMetadataKeys.STREAM_FORMAT]=this._video.muted||n?this._videodata.startAction+" muted":this._videodata.startAction:this._isChained?e[i.VideoMetadataKeys.STREAM_FORMAT]=this._video.muted||n?"autochain muted":"autochain":this._autoplayed?e[i.VideoMetadataKeys.STREAM_FORMAT]=this._video.muted||n?"autoplay muted":"autoplay":e[i.VideoMetadataKeys.STREAM_FORMAT]="user initiated",e},getPermutiveMetaData:function(){var e,t;this.getAdData();console.log(this.getVideoContent());var i={autoplay:this._settings.autoplay,theme:this._settings.thumbLayout,userId:null!==(e=window)&&void 0!==e&&null!==(t=e.utag_data)&&void 0!==t&&t.user_ref?window.utag_data.user_ref:S.getCookie("TR"),video:{id:this._videodata.guid,length:this._videodata.duration?this._videodata.duration:"",title:this._videodata.name?this._videodata.name:"",column:this._videodata.column?this._videodata.column:"",lnid:this._settings.lnid,adcat:this._videodata.adCategory?this._videodata.adCategory:"",videoformat:this._videodata.videoformat?this._videodata.videoformat:""},video_player:{plid:this._settings.plid?this._settings.plid:this._videodata.plid,playerformat:this._videodata.videoformat,sub:this.getUserTypeVar(),adview:this._adPlayNumber}};if(window.utag_data){var n,r,a=window.utag_data;i.page={usertype:a.user_type?a.user_type:"",id:a.article_id?a.article_id:"",description_url:null!=a&&null!==(n=a.meta)&&void 0!==n&&n.description?a.meta.description:"",env:null!=a&&null!==(r=a.ut)&&void 0!==r&&r.env?a.ut.env:"",hl:a.article_headline?a.article_headline:"",iu:a.article_headline?a.article_headline:"",url:window.location!=window.parent.location?document.referrer:document.location.href,section:"undefined"!==this.getSectionSubsection(data)[0]?this.getSectionSubsection(data)[0]:"",subsection:"undefined"!==this.getSectionSubsection(data)[1]?this.getSectionSubsection(data)[1]:"",keywords:a.article_keywords?a.article_keywords:""}}return i},trackContentStarted:function(){this._contentStartTracked=!0,this._adPlayNumber=this._adPlayNumber>3?1:this._adPlayNumber+1,document.cookie="djadplaynum="+this._adPlayNumber.toString()+"; path=/",this._convivaContentSessionKey!==Conviva.Client.NO_SESSION_KEY?this._convivaClient.isPlayerAttached(this._convivaContentSessionKey)||this._convivaClient.attachPlayer(this._convivaContentSessionKey,this._convivaPlayerStateManager):console.log("Conviva Failed"),this._mediaHeartbeat&&this._mediaHeartbeat.trackPlay();try{this.sendCXevent("play")}catch(e){}try{this._comscoreTag.playContentPart(this._comscoreMeta)}catch(e){}},trackProgress:function(e,t){if(!this._store.getState().isAdMode&&this._sessionStarted&&(t>1&&!this._contentStartTracked&&(this.trackContentStarted(),this.sendOptimizelyBeacon("start"),this.sendPermutiveTracking("VideoPlay")),e>25&&!this._trackingMilestones[0]&&(this.sendOptimizelyBeacon("percent25"),this.sendPermutiveTracking("percent25"),this._trackingMilestones[0]=!0),e>50&&!this._trackingMilestones[1]&&(this.sendOptimizelyBeacon("percent50"),this.sendPermutiveTracking("percent50"),this._trackingMilestones[1]=!0),e>75&&!this._trackingMilestones[2]&&(this.sendOptimizelyBeacon("percent75"),this.sendPermutiveTracking("percent75"),this._trackingMilestones[2]=!0),e>95&&!this._trackingMilestones[3]&&(this.sendOptimizelyBeacon("percent95"),this.sendPermutiveTracking("percent95"),this._trackingMilestones[3]=!0)),Math.floor(t/15)>this._pingMilestone){this._pingMilestone=Math.floor(t/15);try{this._settings.hasCMPConsent&&window.vidora.push(["send","playhead_update",this._videodata.guid,{params:{playhead_time:t,duration:this._store.getState().duration}}])}catch(e){}}this.trigger(this._wrapper,"onTimeUpdate",{percent:e,time:t,duration:this._store.getState().duration})},getPageName:function(e){var t=this.getVideoContent();if(t.pageName)return t.pageName;{const{duration:e}=this._store.getState();return"WSJLive_Video_"+this._videodata.name+"_"+e}},setConvivaMetaData:function(){var e=this._videodata;this._convivaContentMetadata=new Conviva.ContentMetadata,this._convivaContentMetadata.streamUrl=e.hlsNoCaptions,this._convivaContentMetadata.assetName=e.name+" - "+e.guid,this._convivaContentMetadata.streamType="vod"===e.state?Conviva.ContentMetadata.StreamType.VOD:Conviva.ContentMetadata.StreamType.LIVE,this._convivaContentMetadata.applicationName="WEB V3",this._convivaContentMetadata.viewerId=S.getCookie("REMOTE_USER"),this._convivaContentMetadata.defaultResource="Akamai",this._convivaContentMetadata.encodedFrameRate=30,this._convivaContentMetadata.duration=this._store.getState().duration,this._convivaContentMetadata.isLive=this._isLive,this._adId&&(this._convivaContentMetadata.adId=this._adId);var t={};t.isLive=e.state,t.section=void 0!==this.getSectionSubsection(e)[0]?this.getSectionSubsection(e)[0]:"",t.subsection=void 0!==this.getSectionSubsection(e)[1]?this.getSectionSubsection(e)[1]:"",t.column=e.column,t.package=e.column,t.doctype=e.doctypeID,t.guid=e.guid,t.episodeNumber=e.episodeNumber,t.seriesName=e.seriesName,t.pubDate=e.publishedDate,t.site=window.location.hostname,t.page=window.location.hostname+window.location.pathname,t.streamProtocol="HLS",t.playerVendor="Internal",t.playerVersion=this._version,t.adLibraryVersion="09099",t.accessType=S.getCookie("REMOTE_USER")?"WSJ_sub_yes":"WSJ_free",t.channel=this.getChannel(),t.genre=this._videodata.showName?this._videodata.showName:this._videodata.name,this._convivaContentMetadata.custom=t,null!==this._convivaContentSessionKey&&this._convivaClient.updateContentMetadata(this._convivaContentSessionKey,this._convivaContentMetadata)},getUserTypeVar(){var e,t;let i=null;if(window.utag_data&&window.utag_data.user_type)i=window.utag_data.user_type;else{const e=document.querySelector('meta[name="user.type"]');null!==e&&(i=e.getAttribute("content"))}let n;i?(n={nonsubscriber:"free",subscriber:"sub_yes",freeregister:"mem_yes",procbsubscriber:"sub_yes",prosubscriber:"sub_yes",reguser:"mem_yes",member:"mem_yes"}[i.toLowerCase()],void 0===n?n="free":"free"===n&&S.getCookie("TR")&&(n="reg_yes")):n="free";const r=null!==(e=null===(t=window.utag_data)||void 0===t?void 0:t.page_site_product)&&void 0!==e?e:"WSJ";return"".concat(r,"_").concat(n)},getChannel:function(){var e="";try{e=null!==this._settings.channel?this._settings.channel:window.s?s.channel:S.getChannelFromDomain(document.domain)}catch(t){e=S.getChannelFromDomain(document.domain)}return e},getHostName:function(e){var t=e.match(/:\/\/(www[0-9]?\.)?(.[^/:]+)/i);return null!=t&&t.length>2&&"string"==typeof t[2]&&t[2].length>0?t[2]:null},getVideoContent:function(){try{if(window!=window.top){if(void 0!==window.parent.s)return window.parent.s}else if(void 0!==window.s)return window.s;return!1}catch(e){return!1}},debounce:function(e,t,i){var n;return function(){var r=this,a=arguments,o=function(){n=null,i||e.apply(r,a)},s=i&&!n;clearTimeout(n),n=setTimeout(o,t),s&&e.apply(r,a)}},trackInView:function(){if(this._mediaHeartbeat){var e=this._container.getBoundingClientRect(),t=e.top>=0&&e.left>=0&&e.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&e.right<=(window.innerWidth||document.documentElement.clientWidth);return t&&(window.removeEventListener("scroll",this._trackInViewListenerReference),svid.linkTrackEvents=svid.events="event141",svid.linkTrackVars="pageName,events,eVar4,eVar11,eVar3,eVar32,eVar26,channel,prop1,prop19,prop2,prop26,prop4,prop20,eVar72,eVar73,eVar38,eVar114,list3",window.utag_data&&(svid.pageName=window.utag_data.article_headline_orig_post?window.utag_data.article_headline_orig_post:"WSJ_Article_"+window.utag_data.article_type+"_"+window.utag_data.article_headline,svid.eVar11=window.utag_data.page_site?window.utag_data.page_site:"D=ch",svid.eVar3=window.utag_data.user_ref?window.utag_data.user_ref:S.getCookie("TR"),svid.eVar32=window.utag_data.user_tag?window.utag_data.user_tag:"",svid.eVar26=window.utag_data.user_type_post?window.utag_data.user_type_post:"",svid.prop1=window.utag_data.page_content_type?window.utag_data.page_content_type:"",svid.prop19=window.utag_data.page_content_type_detail_post?window.utag_data.page_content_type_detail_post:"",svid.prop2=window.utag_data.page_section_post?window.utag_data.page_section_post:"",svid.prop26=window.utag_data.page_subsection_post?window.utag_data.page_subsection_post:"",svid.prop4=window.utag_data.article_headline_orig_post?window.utag_data.article_headline_orig_post:"",svid.prop20=window.utag_data.article_id?window.utag_data.article_id:"",svid.eVar72=window.location!=window.parent.location?document.referrer:document.location.href,svid.eVar73=window.utag_data.article_id?window.utag_data.article_id:"",svid.eVar38=svid.prop19),svid.eVar114=this._videodata.name,svid.list3="video_"+this._videodata.guid,svid.tl(!0,"o","Video in View")),t}return!1},hasFlashVersionOrBetter:function(e,t){var i;if(t=t||0,navigator.plugins&&navigator.plugins.length>0){var n="application/x-shockwave-flash",r=navigator.mimeTypes;r&&r[n]&&r[n].enabledPlugin&&r[n].enabledPlugin.description&&(i=r[n].enabledPlugin.description.replace(/^.*?([0-9]+)\.([0-9])+.*$/,"$1,$2").split(","))}else{var a=null;try{a=new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(e){return!1}if(null!=a){var o;try{o=a.GetVariable("$version")}catch(e){return!1}i=o.replace(/^.*?([0-9]+,[0-9]+).*$/,"$1").split(",")}}if(i){var s=parseInt(i[0],10);return e>s||e==s&&t>=parseInt(i[1],10)}return!1},getAdData:function(){var e="",t={};"string"==typeof this.getMeta("user.type")&&""!==this.getMeta("user.type")&&(t.usertype=this.getMeta("user.type")),"string"==typeof this.getMeta("page.id")&&""!==this.getMeta("page.id")&&(t.pageid=this.getMeta("page.id")),"string"==typeof this.getMeta("article.section")&&""!==this.getMeta("article.section")&&(t.articlesection=this.getMeta("article.section")),"string"==typeof this.getMeta("article.type")&&""!==this.getMeta("article.type")&&(t.articletype=this.getMeta("article.type")),"string"==typeof this.getMeta("page.content.type")&&""!==this.getMeta("page.content.type")&&(t.pagecontenttype=this.getMeta("page.content.type")),t.refsec=encodeURIComponent(b.getRefsecKeyValue()),"object"==typeof window.utag_data&&(window.utag_data.user_type&&(t.usertype=window.utag_data.user_type),window.utag_data.article_id&&(t.articleid=window.utag_data.article_id),window.utag_data.article_type&&(t.articletype=window.utag_data.article_type),window.utag_data.page_section&&(t.articlesection=window.utag_data.page_section),window.utag_data.page_subsection&&(t.articlepage=window.utag_data.page_subsection));try{return Object.keys(t).forEach((function(i,n){e+="%26"+i+"%3D"+t[i]})),e}catch(e){return""}return""},getMeta:function(e){try{for(var t=document.getElementsByTagName("meta"),i=0;i<t.length;i++)if(t[i].getAttribute("name")==e)return"_"+t[i].getAttribute("content");return""}catch(e){return""}},extend:function(e,t){var i,n={};for(i in e)Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i]);for(i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i]);return n},loadScript:function(e,t,i){var n=this,r=document.createElement("script");r.type="text/javascript",r.readyState?r.onreadystatechange=function(){"loaded"!=r.readyState&&"complete"!=r.readyState||(r.onreadystatechange=null,t())}:(r.onload=function(){t(n)},r.onerror=function(){i(n)}),r.src=e,document.getElementsByTagName("head")[0].appendChild(r)},trigger:function(e,t,i){var n=e;if(document.createEvent)(r=new CustomEvent("build",i)).data=i,r.initEvent(t,!0,!0),n.dispatchEvent(r);else if(document.createEventObject){var r;(r=document.createEventObject()).data=i,n.fireEvent("on"+t,r)}},createMark:function(e){S.createMark(e)}};e.exports=function(e){if(this.length=1,"string"===(typeof e).toLowerCase()){var t=document.querySelectorAll(e);t.length>0&&(this.element=t[0])}else this.element=e;this.WSJVideo=function(e){new L(this.element,e).init();return this.element.data=function(){return this.element},this.element};try{this.data=this.element.data}catch(t){}return this},function(){function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var i=document.createEvent("CustomEvent");return i.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),i}e.prototype=window.Event.prototype,window.CustomEvent=e}()},function(e,t,i){void 0===window.ResizeObserver&&(window.ResizeObserver=i(97).ResizeObserver)},function(e,t,i){},function(e,t){
/*! vidora-client 1.2.7 10-01-2015 */
try{!function(e,t,i){function n(e){oe.console&&console.log&&console.log(e)}function r(e){oe.console&&console.error&&console.error(e)}function a(e){throw new Error(e)}function o(e,t){return e.forEach(t)}function s(e,t){return e.map(t)}function l(e){return String(e)}function c(e){return void 0===e}function u(e){return null===e}function h(e){return c(e)||u(e)}function d(e){return!u(e)&&"object"==typeof e}function p(e){return!h(e)&&e.constructor===Array}function f(e,t){return h(e)?t:e}function g(e,t){var i=f(e,{}),n=f(t,{});for(var r in n)i[r]=n[r];return i}function _(e){var t=f(e,{});return d(t)||a("Options should be an object."),t}function m(e){return JSON.parse(e)}function v(e){return JSON.stringify(e)}function y(e){return encodeURIComponent(e).replace(/!/g,"%21").replace(/\*/g,"%2A").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29")}function b(e){var t=[];for(var i in e){var n=e[i],r=c(n)?[i]:[i,n];t.push(r)}return t.sort((function(e,t){return function(e,t){return t>e?-1:e>t?1:0}(e,t)})),s(t,(function(e){return s(e,y).join("=")})).join("&")}function S(){return(new Date).getTime()}function E(e,t){return e.indexOf(t)>=0}function w(){return Math.random()}function T(){return Math.floor(65536*w())}function M(){return s(ue(10),(function(e){var t=(e>>1).toString(32);return he.slice(t.length)+t})).join("")}function A(e,t){return function(e,t,i){try{return e.setItem(t,v(i)),!0}catch(e){return r(e),!1}}(de,e,t)}function C(e){return function(e,t){var i=e.getItem(t);return h(i)?null:m(i)}(de,e)}function x(e){!function(e,t){e.removeItem(t)}(de,e)}function I(e){!function(e,t){for(var i=0;i<e.length;i++){t(e.key(i))}}(de,e)}function P(){return S()+":"+w()}function L(e){return e+ye}function D(e){return C(e)}function R(e){x(e),setTimeout((function(){x(e)}),100)}function k(e){return C(e)}function O(e){var t=L(e);x(e),R(t)}function N(e,t,i){var n=ve+P(),r=function(e){var t=L(e),i=0;return setInterval((function(){A(t,i+=1)}),_e)}(n);return function(e,t){A(e,t)}(n,{data:e,guid:i,retry:0}),{key:n,guid:i,clock:r}}function F(){var e={};return I((function(t){(function(e){return 0===e.indexOf(ve)&&-1!==e.indexOf(ye)})(t)&&(e[t]=D(t))})),e}function V(){var e=[];return I((function(t){(function(e){return 0===e.indexOf(ve)&&-1===e.indexOf(ye)})(t)&&e.push(t)})),e}function B(e,t,i){n("XHR Request Succeded: "+i.url)}function U(e,t,i){r("XHR Request Failed: "+i.url+" "+e)}function H(e,t,i){r("XHR Timeout: "+i.url)}function G(e){return e}function j(e){return e}function z(e,t){var i=function(e,t,i){var n=new XMLHttpRequest;n.open(e,t.url,i);var r="onSuccess"in t?t.onSuccess:B,a="onError"in t?t.onError:U,o="onTimeout"in t?t.onTimeout:H,s="unmarshall"in t?t.unmarshall:G;return"crossDomainCredentials"in t&&(n.withCredentials=!0===t.crossDomainCredentials),"timeoutMs"in t&&(n.timeout=t.timeoutMs,n.ontimeout=function(){o.call({},t)}),n.onload=function(){n.readyState===Se&&200===n.status?r.call({},s(n.responseText),n.status,t):a.call({},n.statusText,n.status,n.readyState,t)},n.onerror=function(){var e="Unknown Error.";h(n.status)&&h(n.statusText)?e="Unknown Error.":"statusText"in n&&(e=n.statusText),a.call({},e,n.status,n.readyState,t)},n}(e,t,!0);if("data"in t){var n="marshall"in t?t.marshall:j;"dataType"in t&&i.setRequestHeader("Content-type",t.dataType),i.send(n(t.data))}else i.send();return i}function W(e){z("GET",e)}function Y(e,t){delete oe[we][t],Te.removeChild(e)}function K(e){var t="cb_"+S().toString(16)+"_"+w().toString(16),i=se.createElement("script");oe[we][t]=function(n){Y(i,t),e.onSuccess.call({},n,Me,e)};var n=function(){t in oe[we]&&(Y(i,t),e.onError.call({},"jsonp error",Ae,0,Ee,e))};i.onerror=n,i.onload=n,i.onreadystatechange=function(){("loaded"===i.readyState||"complete"===i.readyState)&&n()},i.type="text/javascript",i.src=e.url+"&format=jsonp&callback="+encodeURIComponent(t),Te.appendChild(i)}function q(){}function X(e,t){if(g(t,Pe),t.data.guid=e.guid,!h(le[Ce])&&h(t.onSuccess)){(function(e,t){return le[Ce](e,t)})(t.url,t.marshall(t.data))&&ke(e)}else{var i=t.onSuccess||q;t.onSuccess=function(){ke(e),i()},function(e){z("POST",e)}(t)}}function Q(e,t,i){var n=_(i),r={url:function(e,t,i){var n=h(i._baseURI)?e._apiHost:i._baseURI,r=g(g({api_key:e.token},i.query),i._params),a=y(e.getUserId()),o=t.replace("%user_id%",a);return n+"/"+e.apiVersion+o+"?"+b(r)}(e,t,n)};g(r,Le),"success"in n&&(r.onSuccess=n.success),"error"in n&&(r.onError=n.error),(function(){var e=le.userAgent;return E(e,"MSIE ")||E(e,"Trident/")||E(e,"Edge/")}()?K:W)(r)}function Z(e,t){return function(e){return"string"==typeof e}(e)?e:t(e)}function J(e,t){!function(e,t,i){var n=_(i),r=g({api_key:e.token},n._params),a={url:f(n._baseURI,e._analyticsHost)+"/"+e.apiVersion+"/validate?"+b(r),data:{data:t}},o=Re(a);"success"in n&&(a.onSuccess=n.success),X(o,a)}(e,s(t,(function(e){return e[0]})))}function $(e,t,i,n){n.query=function(e,t){if(h(e))return e;for(var i={},n=0;n<t.length;n++)t[n]in e&&(i[t[n]]=e[t[n]]);return i}(n.query,i),Q(e,t,n)}function ee(e,t,i){e in i&&(t[e]=i[e])}function te(e){h(e)?a("Vidora API constructed without any options."):d(e)?"apiKey"in e||a("Vidora API constructed without an API Key"):a("Vidora API should be constructed with an option object.");var t=g({},e);this.token=t.apiKey,this.apiVersion="v1";var i=this;this._queue=function(e,t,i){function n(){e(r),r=[]}var r=[],a=setTimeout((function(){}),0);return{add:function(e){clearTimeout(a),r.push(e),r.length>=i?n():a=setTimeout(n,t)},flush:function(){clearTimeout(a),n()}}}((function(e){J(i,e)}),500,30),this._analyticsHost=xe,this._apiHost=Ie,this._sendMode=De,this._build=ae,this._userId=null,Oe(X)}function ie(e){e.call({},je,ze)}function ne(e){var t=e[0],i=e.slice(1);t in je||a("Invalid api call '"+t+"'"),je[t].apply(je,i)}function re(e){p(e)?ne(e):function(e){return"function"==typeof e}(e)?ie(e):a("typeof call item '"+typeof e+"' not supported.")}var ae={version:"1.2.7",rev:"70defd4dcf46f60d01ad6075900d8e0381a4299b"},oe=window,se=document,le=navigator,ce=1,ue=!c(oe.Uint16Array)&&!c(oe.crypto)?function(e){var t=new Uint16Array(e);crypto.getRandomValues(t);for(var i=[],n=0;n<t.length;n++)i.push(t[n]);return i}:function(e){for(var t=[],i=0;ce>i&&e>i;i++)t.push(65535&(T()^S()));for(;e>i;i++)t.push(T());return t},he="000",de=(oe.sessionStorage,oe.localStorage),pe=50,fe=pe,ge=3,_e=5,me=3*_e,ve="vidoraRequest:",ye=".clock",be=!1,Se=4,Ee=2,we="_vidora_jsonp";oe[we]=oe[we]||{};var Te=se.head||se.body||se,Me=-200,Ae=-400,Ce="sendBeacon",xe="https://a.vidora.com",Ie="//api.vidora.com",Pe={marshall:v,dataType:"text/plain"},Le={unmarshall:m},De=0,Re=q,ke=q,Oe=q;(function(e){var t="string"==typeof e.setItem;return!h(e)&&!t})(de)&&(Re=function(e){return N(e,0,P())},ke=function(e){var t=e.key;(function(e,t){var i=L(e);t&&clearInterval(t),R(i)})(t,e.clock),O(t)},Oe=function(e,t){if(!be){be=!0;var i=V(),n=F();!function(e){if(e.length>pe){e.sort();for(var t=e.length-fe,i=0;t>i;i++){O(e.shift())}}}(i);setTimeout((function(){!function(e){!function(e,t){for(var i in e)t(i)}(e,(function(t){var i=e[t],n=D(t);(h(n)||n===i)&&(delete e[t],R(t))}))}(n),function(e,t){var i=[];o(e,(function(e){var t=k(e);if(h(t));else{var n=t.retry+1;if(ge>n){var r=N(t.data,0,t.guid);i.push(r)}}O(e)})),o(i,(function(e){var i=k(e.key);t(e,i.data,i.guid)}))}(function(e,t){var i=[];return o(t,(function(t){L(t)in e||i.push(t)})),i}(n,i),e),be=!1,t&&t()}),me)}}),te.prototype.config=function(e){var t=_(e);"analyticsHost"in t&&(this._analyticsHost=t.analyticsHost),"apiHost"in t&&(this._apiHost=t.apiHost)},te.prototype.send=function(e,t,i){for(var n=p(t)?t:[t],r=this.getUserId(),o=this.getSessionId(),s=0;s<n.length;s++){var c=n[s],u=_(i),d={type:Z(e,l),user_id:Z(r,l),session_id:Z(o,l)};h(c)||(d.content_id=Z(c,l)),g(d,u.params);var f={};ee("success",f,u),ee("error",f,u),ee("timeout",f,u);var m=this._sendMode;switch(("click"===d.type||u.quicksend)&&(m=1),m){case 1:this._queue.add([d,f]),this._queue.flush();break;case De:this._queue.add([d,f]);break;default:a()}}};var Ne="/users/%user_id%",Fe="/groups";te.prototype.getItems=function(e){$(this,Ne+"/recommendations",["category","type","limit"],e)};var Ve=["group_ids"];te.prototype.getGroupRankings=function(e){$(this,Ne+Fe+"/rankings",Ve,e)},te.prototype._pncItems=function(e){Q(this,"/pnc"+Ne+Fe+"/items",e)};var Be="vidoraUserId";te.prototype.getUUID=function(){var e=function(e){for(var t=se.cookie.split("; "),i=0;i<t.length;i++){var n=t[i],r=n.indexOf("=");if(-1!==r)if(n.slice(0,r)===e){var a=n.slice(r+1);return decodeURIComponent(a)}}return null}(Be);return u(e)&&(e=M(),function(e,t,i,n){var r=[];if(r.push(e+"="+encodeURIComponent(t)),i){var a=new Date;a.setTime(a.getTime()+1e3*i);var o="expires="+a.toUTCString();r.push(o)}r.push("path=/"),n&&r.push("domain="+n);var s=r.join("; ");se.cookie=s}(Be,e,5256e3)),e};var Ue=M().slice(0,10);te.prototype.getSessionId=function(){return Ue},te.prototype.setUserId=function(e){this._userId=e},te.prototype.getUserId=function(){return u(this._userId)&&(this._userId=this.getUUID()),this._userId};var He="vidora-client",Ge=te,je=null,ze={_i:function(e,t){var i=g({apiKey:e},t);je=new Ge(i),n(He+" "+je._build.version+" "+je._build.rev)},_create:function(e){return new Ge(e)}};(function(e,t,i){if(e[i]&&!0===e[i]._init)r(He+" included twice!");else{oe=e,se=t;var n=e[i];i in e||(e[i]={}),e[i]._init=!0,e[i].push=ne,e[i].ready=ie,n&&(n.ready=ie,n.push=ne,o(n._q,re),n=null)}})(e,t,"vidora")}(window,document),i=window,document,n="vidora",(r={_q:[]}).ready=r.push=function(e){r._q.push(e)},n in i||(i[n]=r),i[n].ready((function(e,t){t._i("wsj.E4B14D56D6D304BA4A96A94B14D11AA9",void 0)})),window.vidora.ready((function(e){console.log("Vidora API finished initializing!")}))}catch(e){}var i,n,r},function(e,t){e.exports=function(){var e={};return function(){var e;!function(e){if(void 0===t)var t={};if(void 0===i)var i={};if(void 0===n)var n={};if(n.radio||(n.radio={}),n.plugin||(n.plugin={}),void 0===r)var r={};r.clock||(r.clock={}),function(e){"use strict";function t(e,t){var i=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(i>>16)<<16|65535&i}function i(e,i,n,r,a,o){return t(function(e,t){return e<<t|e>>>32-t}(t(t(i,e),t(r,o)),a),n)}function n(e,t,n,r,a,o,s){return i(t&n|~t&r,e,t,a,o,s)}function r(e,t,n,r,a,o,s){return i(t&r|n&~r,e,t,a,o,s)}function a(e,t,n,r,a,o,s){return i(t^n^r,e,t,a,o,s)}function o(e,t,n,r,a,o,s){return i(n^(t|~r),e,t,a,o,s)}function s(e,i){e[i>>5]|=128<<i%32,e[14+(i+64>>>9<<4)]=i;var s,l,c,u,h,d=1732584193,p=-271733879,f=-1732584194,g=271733878;for(s=0;s<e.length;s+=16)l=d,c=p,u=f,h=g,d=n(d,p,f,g,e[s],7,-680876936),g=n(g,d,p,f,e[s+1],12,-389564586),f=n(f,g,d,p,e[s+2],17,606105819),p=n(p,f,g,d,e[s+3],22,-1044525330),d=n(d,p,f,g,e[s+4],7,-176418897),g=n(g,d,p,f,e[s+5],12,1200080426),f=n(f,g,d,p,e[s+6],17,-1473231341),p=n(p,f,g,d,e[s+7],22,-45705983),d=n(d,p,f,g,e[s+8],7,1770035416),g=n(g,d,p,f,e[s+9],12,-1958414417),f=n(f,g,d,p,e[s+10],17,-42063),p=n(p,f,g,d,e[s+11],22,-1990404162),d=n(d,p,f,g,e[s+12],7,1804603682),g=n(g,d,p,f,e[s+13],12,-40341101),f=n(f,g,d,p,e[s+14],17,-1502002290),d=r(d,p=n(p,f,g,d,e[s+15],22,1236535329),f,g,e[s+1],5,-165796510),g=r(g,d,p,f,e[s+6],9,-1069501632),f=r(f,g,d,p,e[s+11],14,643717713),p=r(p,f,g,d,e[s],20,-373897302),d=r(d,p,f,g,e[s+5],5,-701558691),g=r(g,d,p,f,e[s+10],9,38016083),f=r(f,g,d,p,e[s+15],14,-660478335),p=r(p,f,g,d,e[s+4],20,-405537848),d=r(d,p,f,g,e[s+9],5,568446438),g=r(g,d,p,f,e[s+14],9,-1019803690),f=r(f,g,d,p,e[s+3],14,-187363961),p=r(p,f,g,d,e[s+8],20,1163531501),d=r(d,p,f,g,e[s+13],5,-1444681467),g=r(g,d,p,f,e[s+2],9,-51403784),f=r(f,g,d,p,e[s+7],14,1735328473),d=a(d,p=r(p,f,g,d,e[s+12],20,-1926607734),f,g,e[s+5],4,-378558),g=a(g,d,p,f,e[s+8],11,-2022574463),f=a(f,g,d,p,e[s+11],16,1839030562),p=a(p,f,g,d,e[s+14],23,-35309556),d=a(d,p,f,g,e[s+1],4,-1530992060),g=a(g,d,p,f,e[s+4],11,1272893353),f=a(f,g,d,p,e[s+7],16,-155497632),p=a(p,f,g,d,e[s+10],23,-1094730640),d=a(d,p,f,g,e[s+13],4,681279174),g=a(g,d,p,f,e[s],11,-358537222),f=a(f,g,d,p,e[s+3],16,-722521979),p=a(p,f,g,d,e[s+6],23,76029189),d=a(d,p,f,g,e[s+9],4,-640364487),g=a(g,d,p,f,e[s+12],11,-421815835),f=a(f,g,d,p,e[s+15],16,530742520),d=o(d,p=a(p,f,g,d,e[s+2],23,-995338651),f,g,e[s],6,-198630844),g=o(g,d,p,f,e[s+7],10,1126891415),f=o(f,g,d,p,e[s+14],15,-1416354905),p=o(p,f,g,d,e[s+5],21,-57434055),d=o(d,p,f,g,e[s+12],6,1700485571),g=o(g,d,p,f,e[s+3],10,-1894986606),f=o(f,g,d,p,e[s+10],15,-1051523),p=o(p,f,g,d,e[s+1],21,-2054922799),d=o(d,p,f,g,e[s+8],6,1873313359),g=o(g,d,p,f,e[s+15],10,-30611744),f=o(f,g,d,p,e[s+6],15,-1560198380),p=o(p,f,g,d,e[s+13],21,1309151649),d=o(d,p,f,g,e[s+4],6,-145523070),g=o(g,d,p,f,e[s+11],10,-1120210379),f=o(f,g,d,p,e[s+2],15,718787259),p=o(p,f,g,d,e[s+9],21,-343485551),d=t(d,l),p=t(p,c),f=t(f,u),g=t(g,h);return[d,p,f,g]}function l(e){var t,i="";for(t=0;t<32*e.length;t+=8)i+=String.fromCharCode(e[t>>5]>>>t%32&255);return i}function c(e){var t,i=[];for(i[(e.length>>2)-1]=void 0,t=0;t<i.length;t+=1)i[t]=0;for(t=0;t<8*e.length;t+=8)i[t>>5]|=(255&e.charCodeAt(t/8))<<t%32;return i}function u(e){var t,i,n="0123456789abcdef",r="";for(i=0;i<e.length;i+=1)t=e.charCodeAt(i),r+=n.charAt(t>>>4&15)+n.charAt(15&t);return r}function h(e){return unescape(encodeURIComponent(e))}function d(e){return function(e){return l(s(c(e),8*e.length))}(h(e))}function p(e,t){return function(e,t){var i,n,r=c(e),a=[],o=[];for(a[15]=o[15]=void 0,r.length>16&&(r=s(r,8*e.length)),i=0;i<16;i+=1)a[i]=909522486^r[i],o[i]=1549556828^r[i];return n=s(a.concat(c(t)),512+8*t.length),l(s(o.concat(n),640))}(h(e),h(t))}e.md5=function(e,t,i){return t?i?p(t,e):function(e,t){return u(p(e,t))}(t,e):i?d(e):function(e){return u(d(e))}(e)}}(t),function(e){"use strict";var t={startsWith:function(e,t){return 0==e.indexOf(t)}};e.StringUtils=t}(t),function(e){"use strict";var t={clone:function(e){var t={};for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t},merge:function(e,i){var n=t.clone(e);for(var r in i)i.hasOwnProperty(r)&&(n[r]=i[r]);return n},append:function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])}};e.ObjectUtils=t}(t),function(e){"use strict";function t(e){if(null==e)return!0;for(var t=0;t<e.length;++t)if(isNaN(e[t]))return!1;return!0}function i(e,i){if("string"!=typeof e||"string"!=typeof i)return NaN;var n=e.split("."),r=i.split(".");if(!t(n)||!t(r))return NaN;for(var a=Math.max(n.length,r.length),o=0;o<a;++o){var s=null!=n[o]?n[o]:"0",l=null!=r[o]?r[o]:"0";if((s=Number(s))>(l=Number(l)))return 1;if(s<l)return-1}return 0}var n={isGreaterThan:function(e,t){return i(e,t)>0},isGreaterThanEqual:function(e,t){return i(e,t)>=0},isLessThan:function(e,t){return i(e,t)<0},isLessThanEqual:function(e,t){return i(e,t)<=0},isSame:function(e,t){return 0===i(e,t)},isDifferent:function(e,t){return 0!==i(e,t)}};e.VersionUtils=n}(t),function(e){"use strict";function t(e,t,i){this.fn=e,this.ctx=t,this.params=i}t.prototype.run=function(){this.params?this.fn.apply(this.ctx,this.params):this.fn.apply(this.ctx)},e.radio.Command=t}(n),function(e){"use strict";function t(e,t){this._queue=[],this._lastTs=0,this._isSuspended=void 0!==e&&e,this._delay=void 0!==t?t:0}t.prototype.addCommand=function(e){this._queue.push(e),this._drain()},t.prototype.cancelAllCommands=function(){this._queue=[]},t.prototype.isEmpty=function(){return 0===this._queue.length},t.prototype.suspend=function(){this._isSuspended=!0},t.prototype.resume=function(){this._isSuspended=!1,this._drain()},t.prototype.flush=function(){this._isSuspended=!1;for(var e=0;e<this._queue.length;e++)this._queue[e].run();this._queue=[]},t.prototype._drain=function(){if(!this._isSuspended&&!this._drainInProgress){this._drainInProgress=!0;var e=this;!function t(){var i=e._queue.shift();i?e._runCommand(i,(function(){e._isSuspended||t()})):e._drainInProgress=!1}()}},t.prototype._runCommand=function(e,t){function i(){e.run(),null!=t&&t.call(n)}var n=this;if(0==this._lastTs)i();else{var r=(new Date).getTime(),a=r-this._lastTs;this._lastTs=r,a<this._delay?setTimeout(i,this._delay-a):i()}},e.radio.CommandQueue=t}(n),function(e){"use strict";function t(e,t){if(this._name=e,!t)throw new Error("Reference to the logger object cannot be NULL");this._logger=t,this._listeners={},this._requests={},this._commands={},this._isShutDown=!1}function i(e,i){if(e===i)return!0;for(var n=(e||"").split(t.SEPARATOR),r=(i||"").split(t.SEPARATOR),a=!0,o=0;o<n.length;o++)a=a&&(n[o]===t.WILDCARD||n[o]===r[o]);return a}t.WILDCARD="*",t.SEPARATOR=":",t.prototype.toString=function(){return"<channel: "+this._name+">"},t.prototype.shutdown=function(){this._isShutDown||(this._logger.debug(n,"#shutdown > Shutting down"),this.off(),this._requests={},this._commands={},this._isShutDown=!0)},t.prototype.on=function(e,t,i){this._isShutDown||(this._listeners[e]||(this._listeners[e]=[]),this._listeners[e].push({fn:t,ctx:i}))},t.prototype.off=function(e,t,i){if(!this._isShutDown){if(t="function"==typeof t?t:null,!e&&null==t&&!i)return void(this._listeners={});if(e)this._removeListener(e,t,i);else for(e in this._listeners)this._listeners.hasOwnProperty(e)&&this._removeListener(e,t,i)}},t.prototype.trigger=function(e){if(!this._isShutDown)for(var t in this._listeners)if(this._listeners.hasOwnProperty(t)&&i(t,e.name))for(var n=this._listeners[t].slice(0),r=0;r<n.length;r++){var a=n[r];a.fn.call(a.ctx,e)}},t.prototype.comply=function(e,t,i){this._isShutDown||(this._commands[e]={cmd:t,ctx:i})},t.prototype.command=function(e,t){if(!this._isShutDown){var i=this._commands[e];if(!i)return void this._logger.warn(n,"#command > No command handler for: "+e);i.cmd.call(i.ctx,t)}},t.prototype.reply=function(e,t,i){this._isShutDown||(this._requests[e]={fn:t,ctx:i})},t.prototype.request=function(e){if(!this._isShutDown){var t=this._requests[e];return t?t.fn.call(t.ctx):(this._logger.warn(n,"#request > No request handler for: "+e),null)}},t.prototype._removeListener=function(e,t,i){t="function"==typeof t?t:null;var n=this._listeners[e];if(n){if(!n.length||null==t&&!i)return void delete this._listeners[e];for(var r=0;r<n.length;r++){var a=n[r];null!==t&&t!==a.fn||i&&i!==a.ctx||this._listeners[e].splice(r,1)}}};var n="radio::Channel";e.radio.Channel=t}(n),function(e){"use strict";function t(e){if(!e)throw new Error("Reference to the logger object cannot be NULL");this._logger=e,this._channels={}}var i=e.radio.Channel;t.prototype.channel=function(e){return this._channels[e]||(this._channels[e]=new i(e,this._logger)),this._channels[e]},t.prototype.shutdown=function(){for(var e in this._channels)this._channels.hasOwnProperty(e)&&this._channels[e].shutdown()},e.radio.Radio=t}(n),function(e){"use strict";e.extend=function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e}}(n),function(e){"use strict";function t(){}t.prototype.write=function(e){throw new Error("Implementation error: Method must be overridden.")},e.ILogWriter=t}(n),function(e){"use strict";function t(){}t.prototype.write=function(e){window.console&&window.console.log&&window.console.log(e)},e.LogWriter=t}(n),function(e){"use strict";function t(){}t.prototype.setLogWriter=function(e){throw new Error("Implementation error: Method must be overridden.")},t.prototype.getLogWriter=function(){throw new Error("Implementation error: Method must be overridden.")},t.prototype.getEnabled=function(){throw new Error("Implementation error: Method must be overridden.")},t.prototype.enable=function(){throw new Error("Implementation error: Method must be overridden.")},t.prototype.disable=function(){throw new Error("Implementation error: Method must be overridden.")},t.prototype.debug=function(e,t){throw new Error("Implementation error: Method must be overridden.")},t.prototype.info=function(e,t){throw new Error("Implementation error: Method must be overridden.")},t.prototype.warn=function(e,t){throw new Error("Implementation error: Method must be overridden.")},t.prototype.error=function(e,t){throw new Error("Implementation error: Method must be overridden.")},e.ILogger=t}(n),function(e){"use strict";function t(){this._logWriter=new i}var i=e.LogWriter;t.prototype.setLogWriter=function(e){if(!e)throw new Error("Reference to the ILogWriter object cannot be NULL");this._logWriter=e,this._enabled=!1},t.prototype.getLogWriter=function(){return this._logWriter},t.prototype.getEnabled=function(){return this._enabled},t.prototype.enable=function(){this._enabled=!0},t.prototype.disable=function(){this._enabled=!1},t.prototype.debug=function(e,t){this._log(e,r,t)},t.prototype.info=function(e,t){this._log(e,n,t)},t.prototype.warn=function(e,t){this._log(e,a,t)},t.prototype.error=function(e,t){this._log(e,o,t)},t.prototype._log=function(e,t,i){if(t==o||this._enabled){var n="",r=new Date;n+="["+r.toTimeString()+"."+function(e){return e<10?"00"+e:e<100?"0"+e:""+e}(r.getMilliseconds())+"] ["+t+"] ",n+="["+e+"] "+i,this._logWriter.write(n)}};var n="INFO",r="DEBUG",a="WARN",o="ERROR";e.Logger=t}(n),function(e){"use strict";function t(e,t){this._pluginName=e,this._eventName=t}var i=e.radio.Channel;t.prototype.getPluginName=function(){return this._pluginName},t.prototype.getEventName=function(){return this._eventName},t.prototype.getName=function(){return this._pluginName+i.SEPARATOR+this._eventName},e.Trigger=t}(n),function(e){"use strict";function t(e,t){this.name=e,this.data=t}t.SUCCESS="success",t.ERROR="error",t.createFromTrigger=function(e){return new t(e.getName())},e.Event=t}(n),function(e){"use strict";function t(){this._events={}}t.prototype.addEventListener=function(e,t,i){e&&t&&(i=i||window,this._events[e]=this._events[e]||[],this._events[e].push({cb:t,ctx:i}))},t.prototype.removeEventListener=function(e,t,i){if(e&&t){i=i||window;var n,r,a=!1;for(r in this._events)if(e===r){a=!0;break}if(a){for(n=this._events[r].length-1;n>=0;n--){var o=this._events[r][n];t===o.cb&&i===o.ctx&&this._events[r].splice(n,1)}this._events[r].length||delete this._events[r]}}},t.prototype.dispatchEvent=function(e){var t,i;if(e.name)for(t in this._events)if(this._events.hasOwnProperty(t)&&e.name===t){var n=this._events[t].slice(0),r=n.length;for(i=0;i<r;i++)n[i].cb.call(n[i].ctx,e);break}},t.prototype.removeAllListeners=function(e){var t,i;if(e){for(i in this._events)if(this._events.hasOwnProperty(i)){for(t=this._events[i].length-1;t>=0;t--){this._events[i][t].ctx===e&&this._events[i].splice(t,1)}this._events[i].length||delete this._events[i]}}else this._events={}},e.EventDispatcher=t}(n),function(e){"use strict";function t(){}function i(){i.__super__.constructor.call(this),this._connection=null}var n=e.Event,r=e.EventDispatcher;t.GET="GET",i.RESPONSE="response",i.INSTANCE="instance",e.extend(i,r),i.prototype.close=function(){this.removeAllListeners(null)},i.prototype.load=function(e){e&&e.method&&e.url&&(e._xmlhttp=this._createCORSRequest(e),e._xmlhttp?e._xmlhttp.send():this._loadImage(e))},i.prototype._createCORSRequest=function(e){var t=null;if(void 0!==window.XMLHttpRequest){var r=new window.XMLHttpRequest;"withCredentials"in r&&(t=r).open(e.method,e.url,!0)}if(null==t&&void 0!==window.XDomainRequest&&(t=new window.XDomainRequest).open(e.method,e.url),t){var a={};a[i.INSTANCE]=this;var o=this;t.onload=function(){if(t.status&&parseInt(t.status,10)>=400)return this.onerror();a[i.RESPONSE]=t.responseText,o.dispatchEvent(new n(n.SUCCESS,a))},t.onerror=function(){o.dispatchEvent(new n(n.ERROR,a))}}return t},i.prototype._loadImage=function(e){this._connection||(this._connection=new Image,this._connection.alt=""),this._connection.src=e.url;var t={};t[i.RESPONSE]="",t[i.INSTANCE]=this,this.dispatchEvent(new n(n.SUCCESS,t))},e.URLRequestMethod=t,e.URLRequest=function(e,t){this.url=e||null,this.method=t,this._xmlhttp=null},e.URLLoader=i}(n),function(e){"use strict";var t="2.2.0.223",i="05c3c4",n={getVersion:function(){return"js-"+t+"-"+i},getMajor:function(){return n.getNumberAtPosition(0)},getMinor:function(){return n.getNumberAtPosition(1)},getMicro:function(){return n.getNumberAtPosition(2)},getPatch:function(){return n.getNumberAtPosition(3)},getBuild:function(){return i},getApiLevel:function(){return 4},getNumberAtPosition:function(e){return t.split(".")[e]}};e.Version=n}(i),function(e){"use strict";function t(e,t){this._message=e,this._details=t}t.prototype.getMessage=function(){return this._message},t.prototype.getDetails=function(){return this._details},e.ErrorInfo=t}(i),function(e){"use strict";e.HeartbeatConfig=function(){this.debugLogging=!1}}(i),function(e){"use strict";function t(){}t.prototype.onError=function(e){},e.HeartbeatDelegate=t}(i),function(e){"use strict";function t(){}t.prototype.configure=function(e){throw new Error("Implementation error: Method must be overridden.")},t.prototype.bootstrap=function(e){throw new Error("Implementation error: Method must be overridden.")},t.prototype.setup=function(){throw new Error("Implementation error: Method must be overridden.")},t.prototype.destroy=function(){throw new Error("Implementation error: Method must be overridden.")},t.prototype.enable=function(){throw new Error("Implementation error: Method must be overridden.")},t.prototype.disable=function(){throw new Error("Implementation error: Method must be overridden.")},t.prototype.getName=function(){throw new Error("Implementation error: Method must be overridden.")},t.prototype.isInitialized=function(){throw new Error("Implementation error: Method must be overridden.")},t.prototype.resolveData=function(e){throw new Error("Implementation error: Method must be overridden.")},e.plugin.IPlugin=t}(n),function(e){"use strict";function t(e,t,i,n){this.trigger=e,this.action=i,this.plugin=t,this._paramMappings={},this.mergeParams(n)}var i=e.plugin.ParamMapping;t.prototype.mergeParams=function(e){if(e)for(var t=0;t<e.length;t++){var i=e[t];this._paramMappings[i.getKeyName()]=i}},t.prototype.getParams=function(){var e=[];for(var t in this._paramMappings)this._paramMappings.hasOwnProperty(t)&&e.push(this._paramMappings[t]);return e},t.prototype.addParam=function(e){this._paramMappings[e.getKeyName()]=e},t.prototype.removeParam=function(e,t){var n=new i(e,t);this._paramMappings.hasOwnProperty(n.getKeyName())&&delete this._paramMappings[n.getKeyName()]},e.plugin.Behaviour=t}(n),function(e){"use strict";function t(e,t,n){this._pluginName=e,this._key=t,this._paramName=n||e+i.SEPARATOR+t}var i=e.radio.Channel;t.prototype.getPluginName=function(){return this._pluginName},t.prototype.getKey=function(){return this._key},t.prototype.getKeyName=function(){return this._pluginName+i.SEPARATOR+this._key},t.prototype.getParamName=function(){return this._paramName},e.plugin.ParamMapping=t}(n),function(e){"use strict";function t(e){if(!e)throw new Error("Reference to the logger object cannot be NULL");this._logger=e,this._plugins={},this._behaviours={},this._radio=new n(this._logger),this._dataChannel=this._radio.channel(o),this._ctrlChannel=this._radio.channel(s)}var i=e.Event,n=e.radio.Radio,r=e.radio.Channel,a=e.plugin.Behaviour;t.ERROR="error",t.prototype.addPlugin=function(e){var t=e.getName();this._plugins[t]&&this._logger.warn(l,"#addPlugin > Replacing plugin: "+t),this._plugins[t]=e,e.bootstrap(this)},t.prototype.setupPlugins=function(){for(var e in this._plugins)this._plugins.hasOwnProperty(e)&&this._plugins[e].setup()},t.prototype.pluginExists=function(e){return!!this._plugins[e]},t.prototype.isPluginInitialized=function(e){return this._plugins[e]&&this._plugins[e].isInitialized()},t.prototype.on=function(e,t,i,n){this._dataChannel.on(e+r.SEPARATOR+t,i,n)},t.prototype.off=function(e,t,i,n){var a=e&&t?e+r.SEPARATOR+t:null;this._dataChannel.off(a,i,n)},t.prototype.trigger=function(e){var t=e.name,i=this._behaviours[t];if(i){var n,r,a,o,s,l={},c={};for(n=0;n<i.length;n++)if(o=(a=i[n]).getParams())for(r=0;r<o.length;r++)l[(s=o[r]).getPluginName()]=l[s.getPluginName()]||[],s.key in l[s.getPluginName()]||l[s.getPluginName()].push(s.getKey());for(var u in l)l.hasOwnProperty(u)&&(c[u]=this.request(u,l[u]));for(n=0;n<i.length;n++){var h={_behaviour:a=i[n],_eventData:e.data||{}};if(o=a.getParams()){for(r=0;r<o.length;r++)h[(s=o[r]).getParamName()]=c[s.getPluginName()]?c[s.getPluginName()][s.getKey()]:null;this.command(a.plugin.getName(),a.action,h)}}}this._dataChannel.trigger(e)},t.prototype.request=function(e,t){var i=this._plugins[e];return i&&t&&0!=t.length?i.resolveData(t):null},t.prototype.raise=function(e){this._errorInfo=e;var n=new i(t.ERROR,e);this._ctrlChannel.trigger(n)},t.prototype.getErrorInfo=function(){return this._errorInfo},t.prototype.destroy=function(){for(var e in this._radio.shutdown(),this._plugins)this._plugins.hasOwnProperty(e)&&this._plugins[e].destroy()},t.prototype.comply=function(e,t,i){this._dataChannel.comply(e.getName()+r.SEPARATOR+t,i,e)},t.prototype.command=function(e,t,i){this._dataChannel.command(e+r.SEPARATOR+t,i)},t.prototype.registerBehaviour=function(e,t,i,n){var r=e.getName(),o=new a(e,t,i,n);this._behaviours[r]=this._behaviours[r]||[],this._behaviours[r].push(o)};var o="data_channel",s="ctrl_channel",l="plugin::PluginManager";e.plugin.PluginManager=t}(n),function(e,t){"use strict";function i(e){this._name=e,this._isInitialized=!1,this._isDestroyed=!1,this._isEnabled=!0,this._dataResolver={},this._logTag="plugin::"+this.getName(),this._logger=new n}var n=e.Logger,r=e.Trigger,a=e.Event,o=t.ErrorInfo;i.INITIALIZED="initialized",i.prototype.configure=function(e){},i.prototype.bootstrap=function(e){this._pluginManager=e,this._isDestroyed&&this._pluginManager.raise(new o("Invalid state.","Plugin already destroyed."))},i.prototype.setup=function(){this._trigger(i.INITIALIZED),this._isInitialized=!0},i.prototype.destroy=function(){this._isDestroyed||(this._isDestroyed=!0,this._teardown())},i.prototype.enable=function(){this._isEnabled=!0,this._enabled()},i.prototype.disable=function(){this._isEnabled=!1,this._disabled()},i.prototype.getName=function(){return this._name},i.prototype.getLogger=function(){return this._logger},i.prototype.isInitialized=function(){return this._isInitialized},i.prototype.resolveData=function(e){if(!this._isEnabled||!this._isInitialized)return this._logger.warn(this._logTag,"Unable to retrieve plugin data. Plugin: "+this._name+". Enabled: "+this._isEnabled+". Initialized: "+this._isInitialized+"."),null;if("function"==typeof this._dataResolver)return this._dataResolver.call(this,e);var t=null;if(e)for(var i=0;i<e.length;i++){var n=e[i];this._dataResolver.hasOwnProperty(n)&&(t=t||{},"function"==typeof this._dataResolver[n]?t[n]=this._dataResolver[n].call(this):t[n]=this._dataResolver[n])}return t},i.prototype.toString=function(){return"<plugin: "+this._name+">"},i.prototype._enabled=function(){},i.prototype._disabled=function(){},i.prototype._teardown=function(){},i.prototype._canProcess=function(){return this._isEnabled?!this._isDestroyed||(this._logger.error(this._logTag,"Plugin destroyed."),!1):(this._logger.error(this._logTag,"Plugin disabled."),!1)},i.prototype._trigger=function(e,t){var i=a.createFromTrigger(new r(this.getName(),e));i.data=t,this._pluginManager.trigger(i)},e.plugin.BasePlugin=i}(n,i),function(e){"use strict";function t(e,t,i){this.name=e,this.interval=t,this.isActive=!1,this.repeatCount=void 0!==i?i:r,this._nextTickTimestamp=0,this.reset()}function i(e,t){if(!e)throw new Error("Reference to the ClockService object cannot be NULL");if(this._service=e,!t)throw new Error("Reference to the logger object cannot be NULL");this._logger=t,this._isDestroyed=!1,this._timers={};var i=this;this._clock=window.setInterval((function(){i._onTick()}),1e3*a)}t.prototype.reset=function(){this.tick=0,this._createdTimestamp=(new Date).getTime(),this._updateNextTickTimestamp()},t.prototype.shouldTick=function(){return(new Date).getTime()>this._nextTickTimestamp-o/2&&(this.tick++,this._updateNextTickTimestamp(),!0)},t.prototype._updateNextTickTimestamp=function(){var e=(new Date).getTime();this._nextTickTimestamp=e+1e3*this.interval-1},i.prototype.createTimer=function(e,i,n){this._timers[e]=new t(e,i,n)},i.prototype.destroyTimer=function(e){delete this._timers[e]},i.prototype.resumeTimer=function(e,t){t=void 0!==t&&t,this._logger.debug(n,"#resumeTimer(name="+e+", reset="+t+")");var i=this._timers[e];i&&(i.isActive=!0,t&&i.reset())},i.prototype.pauseTimer=function(e,t){t=void 0!==t&&t,this._logger.debug(n,"#pauseTimer(name="+e+", reset="+t+")");var i=this._timers[e];i&&(i.isActive=!1,t&&i.reset())},i.prototype.isTimerPaused=function(e){var t=this._timers[e];return!!t&&!t.isActive},i.prototype.destroy=function(){this._isDestroyed||(this._isDestroyed=!0,this._timers={},window.clearInterval(this._clock))},i.prototype._onTick=function(){for(var e in this._timers)if(this._timers.hasOwnProperty(e)){var t=this._timers[e];t.isActive&&t.shouldTick()&&(t.interval>1&&this._logger.debug(n,"#_onTick() > "+t.name+"("+t.tick+" | "+t.repeatCount+")"),0!=t.repeatCount?(this._service.onTick(t.name,t.interval,t.tick),t.repeatCount!=r&&t.repeatCount--):this.destroyTimer(t.name))}};var n="service.clock::TimerManager",r=-1,a=.25,o=1e3*a;e.clock.TimerDescriptor=t,e.clock.TimerManager=i}(r),function(e,t,i){"use strict";function n(e){if(n.__super__.constructor.call(this,s),!e)throw new Error("Reference to the logger object cannot be NULL");this._logger=e,this._timerManager=new r(this,this._logger),this._setupDataResolver()}var r=i.clock.TimerManager,a=t.StringUtils,o=e.plugin.BasePlugin;e.extend(n,o),n.prototype.bootstrap=function(e){n.__super__.bootstrap.call(this,e),this._pluginManager.comply(this,l,this._cmdCreate),this._pluginManager.comply(this,u,this._cmdResume),this._pluginManager.comply(this,c,this._cmdPause),this._pluginManager.comply(this,h,this._cmdDestroy)},n.prototype._teardown=function(){this._timerManager.destroy()},n.prototype._cmdCreate=function(e){var t=e[f]||v;this._timerManager.createTimer(e[d],e[p],t)},n.prototype._cmdPause=function(e){this._timerManager.pauseTimer(e[d],!!e[_])},n.prototype._cmdResume=function(e){this._timerManager.resumeTimer(e[d],!!e[_])},n.prototype._cmdDestroy=function(e){this._timerManager.destroyTimer(e[d])},n.prototype.onTick=function(e,t,i){e+=".tick";var n={};n[d]=e,n[p]=t,n[g]=i,this._trigger(e,n)},n.prototype._setupDataResolver=function(){var e={},t=this._timerManager;e[m]=function(e){return t.isTimerPaused(e)},this._dataResolver=function(t){if(!t||0==t.length)return null;for(var i=null,n=0;n<t.length;n++){var r=t[n];if(i=i||{},a.startsWith(r,m)){var o=r.split(m+".");o.length>0&&(i[r]=e[m].call(this,o[1]))}}return i}};var s="service.clock",l="create",c="pause",u="resume",h="destroy",d="name",p="interval",f="repeat_count",g="tick",_="reset",m="is_paused",v=-1;i.clock.ClockService=n}(n,t,r),function(e,t,i){"use strict";function n(e,t){if(this._logger=new r,this._pluginManager=new a(this._logger),this._pluginManager.addPlugin(new o(this._logger)),t)for(var i=0;i<t.length;i++)this._pluginManager.addPlugin(t[i]);this._pluginManager.setupPlugins(),this._isDestroyed=!1}var r=e.Logger,a=e.plugin.PluginManager,o=t.clock.ClockService;n.prototype.configure=function(e){if(!e)throw new Error("Configuration object cannot be NULL.");e.debugLogging?this._logger.enable():this._logger.disable(),this._isDestroyed&&this._logger.error(s,"Instance is destroyed.")},n.prototype.destroy=function(){this._isDestroyed||(this._pluginManager.destroy(),this._isDestroyed=!0)};var s="Heartbeat";i.Heartbeat=n}(n,r,i),e.ADB||(e.ADB={}),e.ADB.core||(e.ADB.core=n),e.ADB.va||(e.ADB.va=i),e.ADB.va.utils||(e.ADB.va.utils=t),e.ADB.va.plugins||(e.ADB.va.plugins={})}(this),function(e){if(void 0===t)var t={};!function(e){"use strict";var t={ASSET_TYPE_VOD:"vod",ASSET_TYPE_LIVE:"live",ASSET_TYPE_LINEAR:"linear"};e.AssetType=t}(t),function(e){"use strict";function t(){this.playerName=null,this.name=null,this.position=null,this.startTime=null}t.prototype.toString=function(){return"playerName="+this.playerName+", name="+this.name+", position="+this.position+", startTime="+this.startTime},e.AdBreakInfo=t}(t),function(e){"use strict";function t(){this.id=null,this.name=null,this.length=null,this.position=null,this.granularTracking=!0}t.prototype.toString=function(){return"id="+this.id+", name="+this.name+", length="+this.length+", position="+this.position+", granularTracking="+this.granularTracking},e.AdInfo=t}(t),function(e){"use strict";function t(){this.name=null,this.length=null,this.position=null,this.startTime=null}t.prototype.toString=function(){return"name="+this.name+", length="+this.length+", position="+this.position+", startTime="+this.startTime},e.ChapterInfo=t}(t),function(e){"use strict";function t(){this.bitrate=null,this.fps=null,this.droppedFrames=null,this.startupTime=null}t.prototype.toString=function(){return"bitrate="+this.bitrate+", fps="+this.fps+", droppedFrames="+this.droppedFrames+", startupTime="+this.startupTime},e.QoSInfo=t}(t),function(e){"use strict";function t(){this.playerName=null,this.id=null,this.name=null,this.length=null,this.playhead=null,this.mediaType=null,this.streamType=null,this.resumed=!1}t.prototype.toString=function(){return"playerName="+this.playerName+", id="+this.id+", name="+this.name+", length="+this.length+", playhead="+this.playhead+", mediaType="+this.mediaType+", streamType="+this.streamType+", resumed="+this.resumed},e.VideoInfo=t}(t),function(e){"use strict";e.VideoPlayerPluginConfig=function(){this.debugLogging=!1}}(t),function(e){"use strict";function t(){}t.prototype.getVideoInfo=function(){throw new Error("Implementation error: Method must be overridden.")},t.prototype.getAdBreakInfo=function(){return null},t.prototype.getAdInfo=function(){return null},t.prototype.getChapterInfo=function(){return null},t.prototype.getQoSInfo=function(){return null},e.VideoPlayerPluginDelegate=t}(t),function(e,t){"use strict";function i(e){if(i.__super__.constructor.call(this,s),!e)throw new Error("PlayerPlugin delegate cannot be NULL.");this._delegate=e,this._isTrackingSessionActive=!1,this._isTrackingSessionStarted=!1,this._setupDataResolver()}var n=e.plugin.ParamMapping,r=e.Trigger,a=e.plugin.BasePlugin,o=t.VideoPlayerPluginConfig;e.extend(i,a),i.prototype.configure=function(e){if(!e)throw new Error("Reference to the configuration data cannot be NULL.");if(!(e instanceof o))throw new Error("Expected config data to be instance of VideoPlayerPluginConfig.");e.debugLogging?this._logger.enable():this._logger.disable(),this._logger.debug(this._logTag,"#configure(debugLogging="+e.debugLogging+")")},i.prototype.bootstrap=function(e){i.__super__.bootstrap.call(this,e),this._registerCommands(),this._registerBehaviours()},i.prototype._cmdVideoIdleStart=function(e){this._logger.info(this._logTag,"#_cmdVideoIdleStart()"),this._videoIdle=!0},i.prototype._cmdVideoIdleResume=function(e){this._logger.info(this._logTag,"#_cmdVideoIdleResume()"),this._videoIdle&&(this._trigger(g),this._trigger(_),e.isInAd&&(this._trigger(w),this._isTrackingAdBreak=!0),e.isInAd&&(this._trigger(M),this._isTrackingAd=!0),e.isInChapter&&this._trigger(D),this._trigger(b)),this._videoIdle=!1},i.prototype.trackSessionStart=function(){if(this._logger.info(this._logTag,"#trackSessionStart()"),this._canProcess()){if(!this._isTrackingSessionActive)return void this._logger.warn(this._logTag,"#trackSessionStart() > No active tracking session.");if(this._isTrackingSessionStarted)return void this._logger.info(this._logTag,"#trackSessionStart() > Tracking session already started.");this._trigger(g),this._isTrackingSessionStarted=!0;var e=this._dataResolver(["video.resumed"]);e.hasOwnProperty("video.resumed")&&e["video.resumed"]&&this._trigger(_)}},i.prototype.trackVideoLoad=function(){this._logger.info(this._logTag,"#trackVideoLoad()"),this._canProcess()&&(this._isTrackingAdBreak=!1,this._isTrackingAd=!1,this._contentStarted=!1,this._isPaused=!0,this._isBuffering=!1,this._isSeeking=!1,this._playheadTimer=null,this._previousPlayhead=-1,this._stalledPlayheadCount=0,this._playheadStalled=!1,this._videoIdle=!1,this._trigger(d),this._isTrackingSessionActive=!0,this._isTrackingSessionStarted=!1)},i.prototype.trackVideoUnload=function(){if(this._logger.info(this._logTag,"#trackVideoUnload()"),this._canProcess()){if(!this._isTrackingSessionActive)return void this._logger.warn(this._logTag,"#trackVideoUnload() > No active tracking session.");this._stopPlayheadTimer(),this._trigger(p),this._isTrackingSessionActive=!1,this._isTrackingSessionStarted=!1,this._contentStarted=!1}},i.prototype.trackPlay=function(){this._logger.info(this._logTag,"#trackPlay()"),this._canProcess()&&this._startSessionIfNeeded("trackPlay")&&this._allowPlayerStateChange()&&(this._isPaused=!1,this._trigger(b),this._startPlayheadTimer())},i.prototype.trackPause=function(){if(this._logger.info(this._logTag,"#trackPause()"),this._canProcess()&&this._startSessionIfNeeded("trackPause")&&this._allowPlayerStateChange()){this._stopPlayheadTimer();var e={};e[U]=!1,this._isPaused=!0,this._trigger(S,e)}},i.prototype.trackBufferStart=function(){this._logger.info(this._logTag,"#trackBufferStart()"),this._canProcess()&&this._startSessionIfNeeded("trackBufferStart")&&this._allowPlayerStateChange()&&(this._stopPlayheadTimer(),this._isBuffering=!0,this._trigger(x))},i.prototype.trackBufferComplete=function(){this._logger.info(this._logTag,"#trackBufferComplete()"),this._canProcess()&&this._startSessionIfNeeded("trackBufferComplete")&&this._allowPlayerStateChange()&&(this._isBuffering=!1,this._trigger(I),this._startPlayheadTimer())},i.prototype.trackSeekStart=function(){this._logger.info(this._logTag,"#trackSeekStart()"),this._canProcess()&&this._startSessionIfNeeded("trackSeekStart")&&this._allowPlayerStateChange()&&(this._stopPlayheadTimer(),this._isSeeking=!0,this._trigger(P))},i.prototype.trackSeekComplete=function(){this._logger.info(this._logTag,"#trackSeekComplete()"),this._canProcess()&&this._startSessionIfNeeded("trackSeekComplete")&&this._allowPlayerStateChange()&&(this._isSeeking=!1,this._trigger(L),this._startPlayheadTimer())},i.prototype.trackComplete=function(e,t){if(this._logger.info(this._logTag,"#trackComplete()"),this._canProcess()&&this._startSessionIfNeeded("trackComplete")){if(this._stopPlayheadTimer(),this._videoIdle)return this._logger.info(this._logTag,"#trackComplete() > Video session is already in Idle State."),void(e&&e());var i={};i[B]=e,(t=void 0===t||!!t)?this._trigger(m,i):(this._trigger(v),this._trigger(f,i))}},i.prototype.trackTimedMetadata=function(e){this._logger.info(this._logTag,"#trackComplete()"),this._canProcess()&&this._startSessionIfNeeded("trackTimedMetadata")&&this._trigger(y,e)},i.prototype.trackChapterStart=function(){this._logger.info(this._logTag,"#trackChapterStart()"),this._canProcess()&&this._startSessionIfNeeded("#trackChapterStart")&&this._trigger(D)},i.prototype.trackChapterComplete=function(){this._logger.info(this._logTag,"#trackChapterComplete()"),this._canProcess()&&this._startSessionIfNeeded("trackChapterComplete")&&this._trigger(R)},i.prototype.trackChapterSkip=function(){this._logger.info(this._logTag,"#trackChapterSkip()"),this._canProcess()&&this._startSessionIfNeeded("trackChapterSkip")&&this._trigger(k)},i.prototype.trackAdBreakStart=function(){this._logger.info(this._logTag,"#trackAdBreakStart()"),this._canProcess()&&this._startSessionIfNeeded("trackAdBreakStart")&&(this._trigger(w),this._isTrackingAdBreak=!0)},i.prototype.trackAdBreakComplete=function(){this._logger.info(this._logTag,"#trackAdBreakComplete()"),this._canProcess()&&this._startSessionIfNeeded("trackAdBreakComplete")&&(this._trigger(T),this._isTrackingAdBreak=!1)},i.prototype.trackAdStart=function(){this._logger.info(this._logTag,"#trackAdStart()"),this._canProcess()&&this._startSessionIfNeeded("trackAdStart")&&(this._trigger(M),this._isTrackingAd=!0)},i.prototype.trackAdComplete=function(){this._logger.info(this._logTag,"#trackAdComplete()"),this._canProcess()&&this._startSessionIfNeeded("trackAdComplete")&&(this._trigger(A),this._isTrackingAd=!1)},i.prototype.trackAdSkip=function(){this._logger.info(this._logTag,"#trackAdSkip()"),this._canProcess()&&this._startSessionIfNeeded("trackAdSkip")&&(this._trigger(C),this._isTrackingAd=!1)},i.prototype.trackBitrateChange=function(){this._logger.info(this._logTag,"#trackBitrateChange()"),this._canProcess()&&this._startSessionIfNeeded("trackBitrateChange")&&this._trigger(O)},i.prototype.trackVideoPlayerError=function(e){if(this._logger.info(this._logTag,"#trackVideoPlayerError(errorId="+e+")"),this._startSessionIfNeeded("trackVideoPlayerError")){var t={};t[H]=h,t[G]=e,this._trigger(N,t)}},i.prototype.trackApplicationError=function(e){if(this._logger.info(this._logTag,"#trackApplicationError(errorId="+e+")"),this._startSessionIfNeeded("trackApplicationError")){var t={};t[H]=u,t[G]=e,this._trigger(N,t)}},i.prototype._registerCommands=function(){this._pluginManager.comply(this,"handleVideoIdleStart",this._cmdVideoIdleStart),this._pluginManager.comply(this,"handleVideoIdleResume",this._cmdVideoIdleResume)},i.prototype._registerBehaviours=function(){this._pluginManager.registerBehaviour(new r(c,F),this,"handleVideoIdleStart"),this._pluginManager.registerBehaviour(new r(c,V),this,"handleVideoIdleResume",[new n(l,"ad.isInAdBreak","isInAdBreak"),new n(l,"ad.isInAd","isInAd"),new n(l,"chapter.isInChapter","isInChapter")])},i.prototype._setupDataResolver=function(){function e(){return o.video||(o.video=s._delegate.getVideoInfo(),s._logger.info(s._logTag,"Data from delegate > VideoInfo: "+o.video)),o.video}function t(){return o.ad||(o.ad=s._delegate.getAdInfo(),s._logger.info(s._logTag,"Data from delegate > AdInfo: "+o.ad)),o.ad}function i(){return o.pod||(o.pod=s._delegate.getAdBreakInfo(),s._logger.info(s._logTag,"Data from delegate > AdBreakInfo: "+o.pod)),o.pod}function n(){return o.chapter||(o.chapter=s._delegate.getChapterInfo(),s._logger.info(s._logTag,"Data from delegate > ChapterInfo: "+o.chapter)),o.chapter}function r(){return o.qos||(o.qos=s._delegate.getQoSInfo(),s._logger.info(s._logTag,"Data from delegate > QoSInfo: "+o.qos)),o.qos}var a={},o={},s=this;a["video.id"]=function(){var t=e(),i=t?t.id:null;return s._logger.debug(s._logTag,"Resolving video.id: "+i),i},a["video.name"]=function(){var t=e(),i=t?t.name:null;return s._logger.debug(s._logTag,"Resolving video.name: "+i),i},a["video.length"]=function(){var t=e(),i=t?t.length:NaN;return s._logger.debug(s._logTag,"Resolving video.length: "+i),i},a["video.playerName"]=function(){var t=e(),i=t?t.playerName:null;return s._logger.debug(s._logTag,"Resolving video.playerName: "+i),i},a["video.mediaType"]=function(){var t=e(),i=t?t.mediaType:null;return s._logger.debug(s._logTag,"Resolving video.mediaType: "+i),i},a["video.streamType"]=function(){var t=e(),i=t?t.streamType:null;return s._logger.debug(s._logTag,"Resolving video.streamType: "+i),i},a["video.playhead"]=function(){var t=e(),i=t?t.playhead:NaN;return s._logger.debug(s._logTag,"Resolving video.playhead: "+i),i},a["video.resumed"]=function(){var t=e(),i=!!t&&t.resumed;return s._logger.debug(s._logTag,"Resolving video.resumed: "+i),i},a["video.playheadStalled"]=function(){return this._playheadStalled},a["pod.name"]=function(){var e=i(),t=e?e.name:null;return s._logger.debug(s._logTag,"Resolving pod.name: "+t),t},a["pod.playerName"]=function(){var e=i(),t=e?e.playerName:null;return s._logger.debug(s._logTag,"Resolving pod.playerName: "+t),t},a["pod.position"]=function(){var e=i(),t=e?e.position:NaN;return s._logger.debug(s._logTag,"Resolving pod.position: "+t),t},a["pod.startTime"]=function(){var e=i(),t=e?e.startTime:NaN;return s._logger.debug(s._logTag,"Resolving pod.startTime: "+t),t},a["ad.isInAd"]=function(){var e=null!=t();return s._logger.debug(s._logTag,"Resolving ad.isInAd: "+e),e},a["ad.isInAdBreak"]=function(){var e=null!=i();return s._logger.debug(s._logTag,"Resolving ad.isInAdBreak: "+e),e},a["ad.id"]=function(){var e=t(),i=e?e.id:null;return s._logger.debug(s._logTag,"Resolving ad.id: "+i),i},a["ad.name"]=function(){var e=t(),i=e?e.name:null;return s._logger.debug(s._logTag,"Resolving ad.name: "+i),i},a["ad.length"]=function(){var e=t(),i=e?e.length:NaN;return s._logger.debug(s._logTag,"Resolving ad.length: "+i),i},a["ad.position"]=function(){var e=t(),i=e?e.position:NaN;return s._logger.debug(s._logTag,"Resolving ad.position: "+i),i},a["ad.granularTracking"]=function(){var e=t(),i=!!e&&e.granularTracking;return s._logger.debug(s._logTag,"Resolving ad.granularTracking: "+i),i},a["ad.trackingInterval"]=function(){var e=z;return s._logger.debug(s._logTag,"Resolving ad.trackingInterval: "+e),e},a["chapter.isInChapter"]=function(){var e=null!=n();return s._logger.debug(s._logTag,"Resolving chapter.isInChapter: "+e),e},a["chapter.name"]=function(){var e=n(),t=e?e.name:null;return s._logger.debug(s._logTag,"Resolving chapter.name: "+t),t},a["chapter.length"]=function(){var e=n(),t=e?e.length:NaN;return s._logger.debug(s._logTag,"Resolving chapter.length: "+t),t},a["chapter.position"]=function(){var e=n(),t=e?e.position:NaN;return s._logger.debug(s._logTag,"Resolving chapter.position: "+t),t},a["chapter.startTime"]=function(){var e=n(),t=e?e.startTime:NaN;return s._logger.debug(s._logTag,"Resolving chapter.startTime: "+t),t},a["qos.bitrate"]=function(){var e=r(),t=e?e.bitrate:NaN;return s._logger.debug(s._logTag,"Resolving qos.bitrate: "+t),t},a["qos.fps"]=function(){var e=r(),t=e?e.fps:NaN;return s._logger.debug(s._logTag,"Resolving qos.fps: "+t),t},a["qos.droppedFrames"]=function(){var e=r(),t=e?e.droppedFrames:NaN;return s._logger.debug(s._logTag,"Resolving qos.droppedFrames: "+t),t},a["qos.startupTime"]=function(){var e=r(),t=e?1e3*e.startupTime:NaN;return s._logger.debug(s._logTag,"Resolving qos.startupTime: "+t),t},this._dataResolver=function(e){if(!e||0==e.length)return null;o={};for(var t=null,i=0;i<e.length;i++){var n=e[i];(t=t||{})[n]=a.hasOwnProperty(n)?a[n].call(this):null}return t}},i.prototype._trackPlayheadStall=function(){this._canProcess()&&(this._playheadStalled||(this._logger.info(this._logTag,"#_trackPlayheadStall()"),this._stalledPlayheadCount=0,this._playheadStalled=!0,this._trigger(S)))},i.prototype._trackExitStall=function(){this._canProcess()&&(this._stalledPlayheadCount=0,!this._playheadStalled||this._isPaused||this._isSeeking||this._isBuffering||(this._logger.info(this._logTag,"#_trackExitStall()"),this._playheadStalled=!1,this._trigger(b)))},i.prototype._startPlayheadTimer=function(){var e=this;this._playheadTimer||this._isPaused||this._isSeeking||this._isBuffering||(this._playheadTimer=setInterval((function(){if(e._canProcess()){var t=e._dataResolver(["ad.isInAd","video.playhead"]);if(e._isTrackingAdBreak)e._playheadStalled&&e._trackExitStall();else{var i=t["video.playhead"];i!=e._previousPlayhead?e._trackExitStall():e._previousPlayhead>=0&&i==e._previousPlayhead&&++e._stalledPlayheadCount==W&&e._trackPlayheadStall(),i!=e._previousPlayhead&&i>0&&!e._contentStarted&&(e._isPaused||e._isBuffering||e._isSeeking||(e._logger.info(e._logTag,"#_playheadTimer playhead progress to: "+i),e._trigger(E),e._contentStarted=!0)),e._previousPlayhead=i}}}),j))},i.prototype._stopPlayheadTimer=function(){this._playheadTimer&&(clearInterval(this._playheadTimer),this._playheadTimer=null),this._trackExitStall()},i.prototype._startSessionIfNeeded=function(e){return this._isTrackingSessionActive?(this._isTrackingSessionStarted||(this._logger.info(this._logTag,"#"+e+"() > Tracking session auto-start."),this.trackSessionStart()),!0):(this._logger.warn(this._logTag,"#"+e+"() > No active tracking session."),!1)},i.prototype._allowPlayerStateChange=function(){return!(this._isTrackingAdBreak&&!this._isTrackingAd&&(this._logger.info(this._logTag,"_allowPlayerStateChange Player plugin does not allow player state changes when in Adbreak and not in Ad."),1))};var s="player",l=s,c="adobe-heartbeat",u="sourceErrorExternal",h="sourceErrorSDK",d="video_load",p="video_unload",f="video_session_end",g="video_start",_="video_resume",m="video_complete",v="video_skip",y="timed_metadata",b="play",S="pause",E="content_start",w="adbreak_start",T="adbreak_complete",M="ad_start",A="ad_complete",C="ad_skip",x="buffer_start",I="buffer_complete",P="seek_start",L="seek_complete",D="chapter_start",R="chapter_complete",k="chapter_skip",O="bitrate_change",N="track_error",F="video_idle_start",V="video_idle_resume",B="callback",U="filter_report",H="source",G="error_id",j=1001,z=1,W=2;t.VideoPlayerPlugin=i}(e.ADB.core,t),e.ADB.va.plugins.videoplayer||(e.ADB.va.plugins.videoplayer=t)}(this),function(e){if(void 0===t)var t={};t.clock||(t.clock={}),t.context||(t.context={}),t.filter||(t.filter={}),t.model||(t.model={}),t.network||(t.network={}),function(e,t){"use strict";function i(e,t,i,n,r){if(!t)throw new Error("Reference to the channel object cannot be NULL");if(this._channel=t,!e)throw new Error("Reference to the pluginManager object cannot be NULL");if(this._pluginManager=e,!r)throw new Error("Reference to the logger object cannot be NULL");this._logTag="ah::Timer."+i,this._logger=r,this._isDestroyed=!1,this._createTimer(i,n),this._installHandlers()}var n=e.Event;i.KEY_NAME="name",i.KEY_INTERVAL="interval",i.KEY_RESET="reset",i.prototype.resume=function(e){this._logger.debug(this._logTag,"Starting timer: "+this._name);var t={};t[i.KEY_NAME]=r+"."+this._name,t[i.KEY_RESET]=e,this._pluginManager.command(a,l,t)},i.prototype.pause=function(e){this._logger.debug(this._logTag,"Stopping timer: "+this._name);var t={};t[i.KEY_NAME]=r+"."+this._name,t[i.KEY_RESET]=e,this._pluginManager.command(a,s,t)},i.prototype.destroy=function(){if(!this._isDestroyed){this._isDestroyed=!0,this._uninstallHandlers();var e={};e[i.KEY_NAME]=r+"."+this._name,this._pluginManager.command(a,c,e)}},i.prototype.setInterval=function(e){var t=u+"."+r+"."+this._name,i=this._pluginManager.request(a,[t])[t];this.pause(!0),this._createTimer(this._name,e),i||this.resume(!0)},i.prototype._cmdResume=function(e){var t=!1;null!=e&&e.hasOwnProperty(i.KEY_RESET)&&(t=e[i.KEY_RESET]),this.resume(t)},i.prototype._cmdPause=function(e){var t=!1;null!=e&&e.hasOwnProperty(i.KEY_RESET)&&(t=e[i.KEY_RESET]),this.pause(t)},i.prototype._onTick=function(e,t){this._channel.trigger(new n("clock:"+this._name+".tick",t))},i.prototype._installHandlers=function(){this._channel.comply("clock:"+this._name+".resume",this._cmdResume,this),this._channel.comply("clock:"+this._name+".pause",this._cmdPause,this),this._pluginManager.on(a,r+"."+this._name+".tick",this._onTick,this)},i.prototype._uninstallHandlers=function(){this._channel.off(null,null,this),this._pluginManager.off(null,null,null,this)},i.prototype._createTimer=function(e,t){this._name=e,this._interval=t;var n={};n[i.KEY_NAME]=r+"."+this._name,n[i.KEY_INTERVAL]=this._interval,this._pluginManager.command(a,o,n)};var r="heartbeat",a="service.clock",o="create",s="pause",l="resume",c="destroy",u="is_paused";t.clock.Timer=i}(e.ADB.core,t),function(e,t){"use strict";function i(e,t,n){i.__super__.constructor.call(this,e,t,a,s,n)}var n=e.Event,r=t.clock.Timer;e.extend(i,r),i.prototype._onCheckStatusComplete=function(e){var t=e.data[h];if(this._logger.debug(this._logTag,"#_onCheckStatusComplete(interval="+t+")"),t){if(t==this._interval)return void this._logger.debug(this._logTag,"#_onCheckStatusComplete() > Interval value not changed.");t>o?(this._logger.warn(this._logTag,"#_onCheckStatusComplete() > Interval value too large: "+t),this.setInterval(o)):(this._logger.debug(this._logTag,"#_onCheckStatusComplete() > Interval changed to: "+t),this.setInterval(t))}else this._logger.warn(this._logTag,"#_onCheckStatusComplete() > Invalid interval value."),this.setInterval(s)},i.prototype._getSettings=function(e){this._logger.debug(this._logTag,"#_getSettings()"),this._channel.trigger(new n(l))},i.prototype._installHandlers=function(){i.__super__._installHandlers.call(this),this._channel.on(c,this._getSettings,this),this._channel.on(u,this._onCheckStatusComplete,this),this._channel.reply(h,(function(){return this._interval}),this)};var a="check_status",o=600,s=180,l="clock:check_status.tick",c="clock:check_status.get_settings",u="net:check_status_complete",h="check_status_interval";t.clock.CheckStatusTimer=i}(e.ADB.core,t),function(e,t){"use strict";function i(e,t,n){i.__super__.constructor.call(this,e,t,r,a,n),this._doNotOverrideInterval=!1}var n=t.clock.Timer;e.extend(i,n),i.prototype._onCheckStatusComplete=function(e){var t=e.data[o];if(this._logger.debug(this._logTag,"#_onCheckStatusComplete(interval="+t+")"),this._doNotOverrideInterval)this._logger.debug(this._logTag,"#_onCheckStatusComplete() > Interval value not changed. (doNotOverrideInterval = true)");else if(t){if(t==this._interval)return void this._logger.debug(this._logTag,"#_onCheckStatusComplete() > Interval value not changed.");this._logger.debug(this._logTag,"#_onCheckStatusComplete() > Interval changed to: "+t),this.setInterval(t)}else this._logger.warn(this._logTag,"#_onCheckStatusComplete() > Invalid interval value."),this.setInterval(a)},i.prototype._onUpdateReportingInterval=function(e){var t=e.data[o];if(this._doNotOverrideInterval=!!e.data[s],this._logger.debug(this._logTag,"#_onUpdateReportingInterval(interval="+t+", doNotOverrideInterval="+this._doNotOverrideInterval+")"),t){if(t==this._interval)return void this._logger.debug(this._logTag,"#_onUpdateReportingInterval() > Interval value not changed.");this._logger.debug(this._logTag,"#_onUpdateReportingInterval() > Interval changed to: "+t),this.setInterval(t)}else this._logger.warn(this._logTag,"#_onUpdateReportingInterval() > Invalid interval value."),this.setInterval(a)},i.prototype._installHandlers=function(){i.__super__._installHandlers.call(this),this._channel.on(c,this._onCheckStatusComplete,this),this._channel.on(l,this._onUpdateReportingInterval,this),this._channel.reply(o,(function(){return this._interval}),this)};var r="reporting",a=10,o="reporting_interval",s="do_not_override_interval",l="reporting:update_interval",c="net:check_status_complete";t.clock.ReportingTimer=i}(e.ADB.core,t),function(e,t){"use strict";function i(e,t,n){i.__super__.constructor.call(this,e,t,r,a,n)}var n=t.clock.Timer;e.extend(i,n);var r="idle",a=1800;t.clock.IdleTimer=i}(e.ADB.core,t),function(e,t){"use strict";function i(e,t,n){i.__super__.constructor.call(this,e,t,r,a,n)}var n=t.clock.Timer;e.extend(i,n);var r="flush_filter",a=.25;t.clock.FlushFilterTimer=i}(e.ADB.core,t),function(e,t){"use strict";function i(e,t,i){if(!e)throw new Error("Reference to the pluginManager object cannot be NULL");if(!t)throw new Error("Reference to the channel object cannot be NULL");if(!i)throw new Error("Reference to the logger object cannot be NULL");this._isDestroyed=!1,this._reportingTimer=new a(e,t,i),this._checkStatusTimer=new n(e,t,i),this._flushFilterTimer=new r(e,t,i),this._idleTimer=new o(e,t,i)}var n=t.clock.CheckStatusTimer,r=t.clock.FlushFilterTimer,a=t.clock.ReportingTimer,o=t.clock.IdleTimer;i.prototype.destroy=function(){this._isDestroyed||(this._isDestroyed=!0,this._reportingTimer.destroy(),this._checkStatusTimer.destroy(),this._flushFilterTimer.destroy(),this._idleTimer.destroy())},t.clock.Clock=i}(e.ADB.core,t),function(e,t){"use strict";function i(e,t){this.value=e,this.hint=t}function n(e){this.realm=e,this.data={}}i.HINT_SHORT="short",n.prototype.setField=function(e,t,n){this.data[e]=new i(t,n)},n.prototype._createAccessor=function(e,t,i){var n=this;return function(){return arguments.length&&(n[e]=arguments[0],n.setField(t,arguments[0],i)),n[e]}},t.model.Dao=n,t.model.DaoField=i}(e.ADB.core,t),function(e,t){"use strict";function i(){if(i.__super__.constructor.call(this,"asset"),this.adId=this._createAccessor("_adId","ad_id",null),this.sid=this._createAccessor("_sid","ad_sid",null),this.resolver=this._createAccessor("_resolver","resolver",null),this.podId=this._createAccessor("_podId","pod_id",null),this.podPosition=this._createAccessor("_podPosition","pod_position",null),this.podOffset=this._createAccessor("_podOffset","pod_offset",null),this.podName=this._createAccessor("_podName","pod_name",null),this.adLength=this._createAccessor("_adLength","ad_length",null),this.adName=this._createAccessor("_adName","ad_name",null),arguments.length&&arguments[0]instanceof i){var e=arguments[0];this.adId(e.adId()),this.sid(e.sid()),this.resolver(e.resolver()),this.podId(e.podId()),this.podPosition(e.podPosition()),this.podOffset(e.podOffset()),this.podName(e.podName()),this.adLength(e.adLength()),this.adName(e.adName())}else this.adId(""),this.sid(""),this.resolver(""),this.podId(""),this.podPosition(""),this.podOffset(0),this.podName(""),this.adLength(0),this.adName("")}var n=t.model.Dao;e.extend(i,n),t.model.AdDao=i}(e.ADB.core,t),function(e,t){"use strict";function i(){if(i.__super__.constructor.call(this,"sc"),this.reportSuiteId=this._createAccessor("_reportSuiteId","rsid",null),this.trackingServer=this._createAccessor("_trackingServer","tracking_server",null),this.ssl=this._createAccessor("_ssl","ssl",r.HINT_SHORT),arguments.length&&arguments[0]instanceof i){var e=arguments[0];this.reportSuiteId(e.reportSuiteId()),this.trackingServer(e.trackingServer()),this.ssl(e.ssl())}else this.reportSuiteId(""),this.trackingServer(""),this.ssl(0)}var n=t.model.Dao,r=t.model.DaoField;e.extend(i,n),t.model.AdobeAnalyticsDao=i}(e.ADB.core,t),function(e,t){"use strict";function i(){if(i.__super__.constructor.call(this,"stream"),this.id=this._createAccessor("_id","chapter_id",null),this.sid=this._createAccessor("_sid","chapter_sid",null),this.name=this._createAccessor("_name","chapter_name",null),this.position=this._createAccessor("_position","chapter_pos",null),this.length=this._createAccessor("_length","chapter_length",null),this.offset=this._createAccessor("_offset","chapter_offset",null),arguments.length&&arguments[0]instanceof i){var e=arguments[0];this.id(e.id()),this.sid(e.sid()),this.name(e.name()),this.position(e.position()),this.length(e.length()),this.offset(e.offset())}else this.id(""),this.sid(""),this.name(""),this.position(0),this.length(0),this.offset(0)}var n=t.model.Dao;e.extend(i,n),t.model.ChapterDao=i}(e.ADB.core,t),function(e,t){"use strict";function i(){if(i.__super__.constructor.call(this,"asset"),this.type=this._createAccessor("_type","type",null),this.videoId=this._createAccessor("_videoId","video_id",null),this.publisher=this._createAccessor("_publisher","publisher",null),this.adData=this._createAccessor("_adData","ad_data",null),this.chapterData=this._createAccessor("_chapterData","chapter_data",null),this.length=this._createAccessor("_length","length",null),this.name=this._createAccessor("_name","name",null),arguments.length&&arguments[0]instanceof i){var e=arguments[0];this.type(e.type()),this.name(e.name()),this.videoId(e.videoId()),this.publisher(e.publisher()),this.length(e.length());var t=e.adData()?new r(e.adData()):null;this.adData(t);var n=e.chapterData()?new a(e.chapterData()):null;this.chapterData(n)}else this.type(""),this.name(""),this.videoId(""),this.publisher(""),this.length(0),this.adData(null),this.chapterData(null)}var n=t.model.Dao,r=t.model.AdDao,a=t.model.ChapterDao;e.extend(i,n),i.TYPE_AD="ad",i.TYPE_MAIN_CONTENT="main",t.model.AssetDao=i}(e.ADB.core,t),function(e,t){"use strict";function i(){if(i.__super__.constructor.call(this,"event"),this.type=this._createAccessor("_type","type",null),this.duration=this._createAccessor("_duration","duration",null),this.playhead=this._createAccessor("_playhead","playhead",null),this.id=this._createAccessor("_id","id",null),this.source=this._createAccessor("_source","source",null),this.ts=this._createAccessor("_ts","ts",null),this.prevTs=this._createAccessor("_prevTs","prev_ts",null),arguments.length&&arguments[0]instanceof i){var e=arguments[0];this.type(e.type()),this.duration(e.duration()),this.playhead(e.playhead()),this.id(e.id()),this.source(e.source()),this.ts(e.ts()),this.prevTs(e.prevTs())}else this.type(""),this.duration(0),this.playhead(0),this.id(""),this.source(""),this.ts(0),this.prevTs(-1)}var n=t.model.Dao;e.extend(i,n),i.EVENT_TYPE_AA_START="aa_start",i.EVENT_TYPE_AA_AD_START="aa_ad_start",i.EVENT_TYPE_START="start",i.EVENT_TYPE_RESUME="resume",i.EVENT_TYPE_CHAPTER_START="chapter_start",i.EVENT_TYPE_CHAPTER_COMPLETE="chapter_complete",i.EVENT_TYPE_CHAPTER_SKIP="chapter_skip",i.EVENT_TYPE_PLAY="play",i.EVENT_TYPE_PAUSE="pause",i.EVENT_TYPE_STALL="stall",i.EVENT_TYPE_BUFFER="buffer",i.EVENT_TYPE_BITRATE_CHANGE="bitrate_change",i.EVENT_TYPE_ERROR="error",i.EVENT_TYPE_COMPLETE="complete",i.EVENT_TYPE_SKIP="skip",i.EVENT_TYPE_END="end",t.model.EventDao=i}(e.ADB.core,t),function(e,t){"use strict";function i(){if(i.__super__.constructor.call(this,"stream"),this.bitrate=this._createAccessor("_bitrate","bitrate",null),this.fps=this._createAccessor("_fps","fps",null),this.droppedFrames=this._createAccessor("_droppedFrames","dropped_frames",null),this.startupTime=this._createAccessor("_startup_time","startup_time",null),arguments.length&&arguments[0]instanceof i){var e=arguments[0];this.bitrate(e.bitrate()),this.fps(e.fps()),this.droppedFrames(e.droppedFrames()),this.startupTime(e.startupTime()),this.isStartupTimeOverridden=e.isStartupTimeOverridden}else this.bitrate(0),this.fps(0),this.droppedFrames(0),this.startupTime(0),this.isStartupTimeOverridden=!1}var n=t.model.Dao;e.extend(i,n),t.model.QoSDao=i}(e.ADB.core,t),function(e,t){"use strict";function i(){if(i.__super__.constructor.call(this,"sp"),this.ovp=this._createAccessor("_ovp","ovp",null),this.sdk=this._createAccessor("_sdk","sdk",null),this.channel=this._createAccessor("_channel","channel",null),this.playerName=this._createAccessor("_playerName","player_name",null),this.libVersion=this._createAccessor("_libVersion","hb_version",null),this.apiLevel=this._createAccessor("_apiLevel","hb_api_lvl",null),arguments.length&&arguments[0]instanceof i){var e=arguments[0];this.ovp(e.ovp()),this.sdk(e.sdk()),this.channel(e.channel()),this.playerName(e.playerName()),this.libVersion(e.libVersion()),this.apiLevel(e.apiLevel())}else this.ovp(r),this.sdk(r),this.channel(r),this.playerName(""),this.libVersion(""),this.apiLevel(0)}var n=t.model.Dao;e.extend(i,n);var r="unknown";t.model.ServiceProviderDao=i}(e.ADB.core,t),function(e,t){"use strict";function i(){if(i.__super__.constructor.call(this,"event"),this.sessionId=this._createAccessor("_sessionId","sid",null),arguments.length&&arguments[0]instanceof i){var e=arguments[0];this.sessionId(e.sessionId())}else this.sessionId(null)}var n=t.model.Dao;e.extend(i,n),t.model.SessionDao=i}(e.ADB.core,t),function(e,t){"use strict";function i(){if(i.__super__.constructor.call(this,"stream"),this.type=this._createAccessor("_type","type",null),arguments.length&&arguments[0]instanceof i){var e=arguments[0];this.type(e.type())}else this.type(null)}var n=t.model.Dao;e.extend(i,n),t.model.StreamDao=i}(e.ADB.core,t),function(e,t){"use strict";function i(){if(i.__super__.constructor.call(this,"user"),this.analyticsVisitorId=this._createAccessor("_analyticsVisitorId","aid",null),this.marketingCloudVisitorId=this._createAccessor("_marketingCloudVisitorId","mid",null),this.visitorId=this._createAccessor("_visitorId","id",null),arguments.length&&arguments[0]instanceof i){var e=arguments[0];this.analyticsVisitorId(e.analyticsVisitorId()),this.marketingCloudVisitorId(e.marketingCloudVisitorId()),this.visitorId(e.visitorId())}else this.analyticsVisitorId(null),this.marketingCloudVisitorId(null),this.visitorId(null)}var n=t.model.Dao;e.extend(i,n),t.model.UserDao=i}(e.ADB.core,t),function(e,t){"use strict";function i(){if(i.__super__.constructor.call(this,"aam"),this.audienceManagerBlob=this._createAccessor("_audienceManagerBlob","blob",null),this.audienceManagerLocationHint=this._createAccessor("_audienceManagerLocationHint","loc_hint",null),arguments.length&&arguments[0]instanceof i){var e=arguments[0];this.audienceManagerBlob(e.audienceManagerBlob()),this.audienceManagerLocationHint(e.audienceManagerLocationHint())}else this.audienceManagerBlob(null),this.audienceManagerLocationHint(null)}var n=t.model.Dao;e.extend(i,n),t.model.AudienceManagerDao=i}(e.ADB.core,t),function(e,t){"use strict";var i=e.ObjectUtils,n=t.model.EventDao,r=t.model.AssetDao,a=t.model.StreamDao,o=t.model.QoSDao;t.model.TrackItem=function(e,t,s,l,c){this.eventData=new n,this.eventData.type(t),this.eventData.duration(0),this.eventData.ts((new Date).getTime()),this.eventData.playhead(s),this.assetData=new r(e._assetData),this.streamData=new a(e._streamData),this.qosData=new o(e._qosData),this.cuserData=i.clone(e._cuserData),this.meta=l,this.callback=c,this.filterReport=!0}}(e.ADB.va.utils,t),function(e,t){"use strict";var i=e.ObjectUtils,n=t.model.EventDao,r=t.model.AssetDao,a=t.model.StreamDao,o=t.model.QoSDao;t.model.CUserDao,t.model.Report=function(e,t,s,l,c,u){this.adobeAnalyticsData=e,this.userData=t,this.aamData=s,this.serviceProviderData=l,this.sessionData=c,this.eventData=new n(u.eventData),this.assetData=new r(u.assetData),this.streamData=new a(u.streamData),this.qosData=new o(u.qosData),this.cuserData=i.clone(u.cuserData),this.meta=i.clone(u.meta),this.callback=u.callback,this.filterReport=u.filterReport}}(e.ADB.va.utils,t),function(e){"use strict";function t(){}t.prototype.serializeReport=function(e){},t.prototype.serializeDao=function(e){},t.prototype.serializeMap=function(e){},t.prototype.serializeNumber=function(e,t,i,n){},t.prototype.serializeString=function(e,t,i,n){},e.model.ISerializer=t}(t),function(e,t){"use strict";function i(e){if(!e)throw new Error("Reference to the logger object cannot be NULL");this._logger=e}var n=t.model.Dao,r=t.model.DaoField,a=t.model.ISerializer;e.extend(i,a),i.prototype.serializeReport=function(e){var t=[];return t.push(this.serializeDao(e.adobeAnalyticsData)),t.push(this.serializeDao(e.userData)),t.push(this.serializeDao(e.aamData)),t.push(this.serializeMap(e.cuserData,"cuser")),t.push(this.serializeDao(e.serviceProviderData)),t.push(this.serializeDao(e.sessionData)),t.push(this.serializeDao(e.eventData)),t.push(this.serializeDao(e.assetData)),t.push(this.serializeDao(e.streamData)),t.push(this.serializeDao(e.qosData)),t.push(this.serializeMap(e.meta,"meta")),{serializedOutput:t.filter((function(e){return!!e})).join("&"),callback:e.callback}},i.prototype.serializeDao=function(e){return this._processDao(e).filter((function(e){return!!e})).join("&")},i.prototype.serializeMap=function(e,t){var i=[],n=t||"meta";for(var r in e)e.hasOwnProperty(r)&&e[r]&&i.push("s:"+n+":"+r+"="+window.encodeURIComponent(e[r]));return i.join("&")},i.prototype.serializeNumber=function(e,t,i,n){var a=s;return null==t||isNaN(t)?null:(n===r.HINT_SHORT&&(a=l),a+":"+i+":"+e+"="+Math.floor(t))},i.prototype.serializeString=function(e,t,i,n){return t?c+":"+i+":"+e+"="+window.encodeURIComponent(t):null},i.prototype._processDao=function(e){var t=[];for(var i in e.data)if(e.data.hasOwnProperty(i)){var r=e.data[i],a=r.value,s=r.hint,l=null,c=e.realm;if(null==a)continue;"number"==typeof a?l=this.serializeNumber(i,a,c,s):"string"==typeof a?l=this.serializeString(i,a,c,s):a instanceof n?l=this.serializeDao(a):this._logger.warn(o,"#_processDao() > Unable to serialize DAO. Field: "+i+". Value: "+a+"."),l&&t.push(l)}return t};var o="ah::QuerystringSerializer",s="l",l="h",c="s";t.model.QuerystringSerializer=i}(e.ADB.core,t),function(e,t){"use strict";function i(e,t){if(!e)throw new Error("Reference to the data object cannot be NULL");if(this._data=e,!t)throw new Error("Reference to the logger object cannot be NULL");this._logger=t}i.prototype.parse=function(){var e,t,i,c,u,h,d;window.DOMParser?h=(new window.DOMParser).parseFromString(this._data,"text/xml"):((h=new window.ActiveXObject("Microsoft.XMLDOM")).async=!1,h.loadXML(this._data)),(d=parseInt(h.getElementsByTagName("trackingInterval")[0].childNodes[0].nodeValue,10))&&(e=d),(d=parseInt(h.getElementsByTagName("setupCheckInterval")[0].childNodes[0].nodeValue,10))&&(t=d),(d=parseInt(h.getElementsByTagName("trackExternalErrors")[0].childNodes[0].nodeValue,10))&&(i=1==d),h.getElementsByTagName("trackingDisabled")[0]&&(c=1==(d=parseInt(h.getElementsByTagName("trackingDisabled")[0].childNodes[0].nodeValue,10))),h.getElementsByTagName("nielsenEnabled")[0]?u=1==(d=parseInt(h.getElementsByTagName("nielsenEnabled")[0].childNodes[0].nodeValue,10)):u=!0;var p={};return p[r]=e,p[a]=t,p[o]=i,p[l]=c,p[s]=u,this._logger.debug(n,"#parse() > Obtained configuration settings."),p};var n="ah::SettingsParser",r="reporting_interval",a="check_status_interval",o="track_external_errors",s="nielsen_enabled",l="tracking_disabled";t.network.SettingsParser=i}(e.ADB.core,t),function(e,t){"use strict";function i(e,t){if(this._trackingServer=null,this._checkStatusServer=null,this._publisher=null,this._isConfigured=!1,this._isDestroyed=!1,this._quietMode=!1,this._visitorOptedOut=!1,this._prevReportSent=null,!e)throw new Error("Reference to the channel object cannot be NULL");if(this._channel=e,!t)throw new Error("Reference to the logger object cannot be NULL");this._logger=t,this._serializer=new l(t),this._installEventListeners()}var n=e.Event,r=e.URLRequestMethod,a=e.URLRequest,o=e.URLLoader,s=t.network.SettingsParser,l=t.model.QuerystringSerializer;i.prototype.destroy=function(){this._isDestroyed||(this._isDestroyed=!0,this._logger.debug(c,"#destroy()"),this._uninstallEventListeners())},i.prototype._onApiConfig=function(e){var t=e.data;this._logger.debug(c,"#_onApiConfig(sb_server="+t[u]+", check_status_server="+t[h]+", publisher="+t[d]+", quiet_mode="+t[p]+", ssl="+t[f]+")"),this._trackingServer=this._updateRequestProtocol(t[u],t[f]),this._checkStatusServer=this._updateRequestProtocol(t[h],t[f]),this._publisher=t[d],this._quietMode=t[p],this._isConfigured=!0},i.prototype._onUpdateVisitorOptOut=function(e){var t=e.data;this._logger.debug(c,"#_onUpdateVisitorOptOut(visitor_opt_out="+t[_]+")"),this._visitorOptedOut=t[_]},i.prototype._onFilterReportAvailable=function(e){var t=e.data;if(this._isConfigured){var i=t[g],s=this._serializer.serializeReport(i),l=this._trackingServer+"/?"+s.serializedOutput;if(this._prevReportSent&&this._prevReportSent.eventData&&i.eventData&&this._prevReportSent.eventData.playhead==i.eventData.playhead&&this._prevReportSent.eventData.ts==i.eventData.ts&&this._prevReportSent.eventData.prevTs==i.eventData.prevTs&&this._prevReportSent.eventData.type==i.eventData.type)this._logger.debug(c,"#_onFilterReportAvailable() > Duplicate heartbeat report not sent for URL:\n"+l);else{this._prevReportSent=i;var u=new a(l,r.GET);this._logger.debug(c,"#_onFilterReportAvailable() > "+u.url);var h=this;if(!this._quietMode&&!this._visitorOptedOut){var d=new o;d.addEventListener(n.SUCCESS,(function(e){d.close(),s.callback&&s.callback.call(null)}),this),d.addEventListener(n.ERROR,(function(e){d.close(),h._logger.warn(c,"#_onFilterReportAvailable() > Failed to send heartbeat report."),s.callback&&s.callback.call(null)}),this),d.load(u)}}}else this._logger.warn(c,"#_onFilterReportAvailable() > Unable to send request: not configured.")},i.prototype._onClockCheckStatusTick=function(e){if(this._isConfigured)if(this._publisher){var t=this,i=this._publisher.replace(/[^a-zA-Z0-9]+/,"-").toLocaleLowerCase(),l=this._checkStatusServer+i+".xml?r="+(new Date).getTime(),u=new a(l,r.GET),h=new o;h.addEventListener(n.SUCCESS,(function(e){if(e.data){var i=new s(e.data.response,t._logger).parse();i?t._channel.trigger(new n(S,i)):t._logger.warn(c,"#_onClockCheckStatusTick() > Failed to parse the config. settings.")}h.close()}),this),h.addEventListener(n.ERROR,(function(e){t._logger.warn(c,"#_onClockCheckStatusTick() > Failed to obtain the config. settings."),h.close()}),this),this._logger.debug(c,"#_onClockCheckStatusTick() > Get new settings from: "+l),h.load(u)}else this._logger.warn(c,"#_onClockCheckStatusTick() > Publisher is NULL.");else this._logger.warn(c,"#_onClockCheckStatusTick() > Unable to send request: not configured.")},i.prototype._updateRequestProtocol=function(e,t){var i=e;return 0===i.indexOf("http://")?i=i.slice(7):0===i.indexOf("https://")&&(i=i.slice(8)),t?"https://"+i:"http://"+i},i.prototype._installEventListeners=function(){this._channel.on(m,this._onApiConfig,this),this._channel.on(v,this._onUpdateVisitorOptOut,this),this._channel.on(y,this._onFilterReportAvailable,this),this._channel.on(b,this._onClockCheckStatusTick,this)},i.prototype._uninstallEventListeners=function(){this._channel.off(null,null,this)};var c="ah::Network",u="tracking_server",h="check_status_server",d="publisher",p="quiet_mode",f="ssl",g="report",_="visitor_opt_out",m="api:config",v="api:update_visitor_optout",y="filter:data_available",b="clock:check_status.tick",S="net:check_status_complete";t.network.Network=i}(e.ADB.core,t),function(e,t){"use strict";function i(e,t){if(!e)throw new Error("Reference to the channel object cannot be NULL");if(this._channel=e,!t)throw new Error("Reference to the logger object cannot be NULL");this._logger=t,this._isDestroyed=!1,this._isBufferingInProgress=!1,this._reportBuffer={},this._tsHistory={},this._workQueue=new s,this._installEventListeners()}function n(e){var t=[];return e&&e.forEach((function(e){e.eventData.type()==c.EVENT_TYPE_PAUSE||e.eventData.type()==c.EVENT_TYPE_STALL||e.eventData.type()==c.EVENT_TYPE_BUFFER?(!e.filterReport||e.eventData.duration()>y)&&t.push(e):t.push(e)})),t}function r(e){var t=-1,i=-1,n=[];return e.forEach((function(e){e.eventData.type()==c.EVENT_TYPE_START?e.assetData.type()==u.TYPE_MAIN_CONTENT?-1==t?t=n.push(e)-1:(e.eventData.prevTs(-1),n[t]=e):-1==i?i=n.push(e)-1:(e.eventData.prevTs(-1),n[i]=e):n.push(e)})),n}function a(e){var t=[];return e.forEach((function(i){if(i.eventData.type()==c.EVENT_TYPE_PLAY){if(i.eventData.duration()>v)t.push(i);else if(0==i.eventData.duration()&&i.assetData.type()==u.TYPE_MAIN_CONTENT){var n=function(e){var t=[];return e.forEach((function(e){e.eventData.type()!=c.EVENT_TYPE_PLAY&&e.eventData.type()!=c.EVENT_TYPE_BUFFER&&e.eventData.type()!=c.EVENT_TYPE_START||t.push(e)})),t}(e);n.indexOf(i)==n.length-1&&t.push(i)}}else t.push(i)})),t}var o=e.radio.Command,s=e.radio.CommandQueue,l=e.Event,c=t.model.EventDao,u=t.model.AssetDao;i.prototype.destroy=function(){this._isDestroyed||(this._isDestroyed=!0,this._logger.debug(S,"#destroy()"),this._uninstallEventListeners(),this.clear())},i.prototype.clear=function(){this._logger.debug(S,"#clear()"),this._workQueue.cancelAllCommands(),this._reportBuffer={},this._tsHistory={},this._isBufferingInProgress=!1},i.prototype.flush=function(){this._workQueue.addCommand(new o(this._flushBufferReport,this))},i.prototype._bufferReport=function(e){if(!this._isDestroyed){var t=e[g];if(t){var i=t.sessionData.sessionId();this._reportBuffer[i]=this._reportBuffer[i]||[],this._reportBuffer[i].push(t)}if(!this._isBufferingInProgress){this._isBufferingInProgress=!0;var n={};n[f]=!0,n[_]=1,this._channel.command(m,n)}}},i.prototype._flushBufferReport=function(){function e(e){if(e)for(var i=0;i<e.length;i++){var n=e[i],r=n.sessionData.sessionId();t._tsHistory[r]=t._tsHistory[r]||{};var a=n.eventData.type()+"."+(n.assetData.type()==u.TYPE_AD?n.assetData.adData().adId():n.assetData.videoId());t._tsHistory[r].hasOwnProperty(a)&&n.eventData.prevTs(t._tsHistory[r][a]),t._tsHistory[r][a]=n.eventData.ts()}}if(!this._isDestroyed){var t=this;for(var i in this._reportBuffer)if(this._reportBuffer.hasOwnProperty(i)){var o=a(r(n(this._reportBuffer[i])));e(o);for(var s=0;s<o.length;s++){var c=o[s],h={};h[g]=c,this._channel.trigger(new l(d,h))}}this._reportBuffer={};var p=this._channel.request(b),f=this._tsHistory[p]||{};this._tsHistory={},this._tsHistory[p]=f,this._isBufferingInProgress=!1}},i.prototype._onContextReportAvailable=function(e){var t=e.data;this._workQueue.addCommand(new o(this._bufferReport,this,[t]))},i.prototype._onClockFlushFilterTick=function(e){this.flush()},i.prototype._installEventListeners=function(){this._channel.on(h,this._onContextReportAvailable,this),this._channel.on(p,this._onClockFlushFilterTick,this)},i.prototype._uninstallEventListeners=function(){this._channel.off(null,null,this)};var h="context:report_available",d="filter:data_available",p="clock:flush_filter.tick",f="reset",g="report",_="repeat_count",m="clock:flush_filter.resume",v=250,y=250,b="session_id",S="ah::ReportFilter";t.filter.ReportFilter=i}(e.ADB.core,t),function(e,t){"use strict";function i(e,t){this._onFail={fn:e,ctx:t}}var n=e.ErrorInfo;i.prototype.validateFields=function(e,t){if(!e)return this._fail("Data cannot be null");if(t)for(var i=0;i<t.length;i++){var n=t[i];switch(n){case"videoId":if(!e.hasOwnProperty("videoId"))return this._fail("The ID for the main video must be specified.");if("string"!=typeof e.videoId)return this._fail("The ID for the main video must be a String.");if(""===e.videoId)return this._fail("The ID for the main video cannot be an empty string.");break;case"streamType":if(!e.hasOwnProperty("streamType"))return this._fail("The stream type for the main video must be specified.");if("string"!=typeof e.streamType)return this._fail("The stream type for the main video must be a String.");if(""===e.streamType)return this._fail("The stream type for the main video cannot be an empty string.");break;case"videoLength":if(!e.hasOwnProperty("videoLength"))return this._fail("The length of the main video must be specified.");if("number"!=typeof e.videoLength)return this._fail("The length of the main video must be a Number.");if(isNaN(e.videoLength))return this._fail("The length of the main video cannot be NaN.");break;case"playhead":if(!e.hasOwnProperty("playhead"))return this._fail("The playhead for the main video must be specified.");if("number"!=typeof e.playhead)return this._fail("The playhead for the main video must be a Number.");if(isNaN(e.playhead))return this._fail("The playhead for the main video cannot be NaN.");break;case"playerName":if(!e.hasOwnProperty("playerName"))return this._fail("The player name for the main video must be specified.");if("string"!=typeof e.playerName)return this._fail("The player name for the main video must be a String.");if(""===e.playerName)return this._fail("The player name for the main video cannot be an empty string.");break;case"rsid":if(!e.hasOwnProperty("rsid"))return this._fail("account (rsid) is required and has to be set in the AppMeasurement instance.");if("string"!=typeof e.rsid)return this._fail("account (rsid) of the AppMeasurement instance must be a String.");if(""===e.rsid)return this._fail("account (rsid) of the AppMeasurement instance  cannot be an empty string.");break;case"trackingServer":if(!e.hasOwnProperty("trackingServer"))return this._fail("trackingServer is required and has to be set in the AppMeasurement instance.");if("string"!=typeof e.trackingServer)return this._fail("trackingServer of the AppMeasurement instance must be a String.");if(""===e.trackingServer)return this._fail("trackingServer of the AppMeasurement instance cannot be an empty string.");break;case"podPlayerName":if(!e.hasOwnProperty("podPlayerName"))return this._fail("The player name for the ad-break must be specified.");if("string"!=typeof e.podPlayerName)return this._fail("The player name for the ad-break must be a String.");if(""===e.podPlayerName)return this._fail("The player name for the ad-break cannot be an empty string.");break;case"podPosition":if(!e.hasOwnProperty("podPosition"))return this._fail("Position (index) of the ad-break must be specified.");if("number"!=typeof e.podPosition)return this._fail("Position (index) of the ad-break must be a Number.");if(isNaN(e.podPosition))return this._fail("Position (index) of the ad-break cannot be NaN.");break;case"adId":if(!e.hasOwnProperty("adId"))return this._fail("The ad ID must be specified.");if("string"!=typeof e.adId)return this._fail("The ad ID must be a String.");if(""===e.adId)return this._fail("The ad ID cannot be an empty string.");break;case"adPosition":if(!e.hasOwnProperty("adPosition"))return this._fail("Position (index) of the ad must be specified.");if("number"!=typeof e.adPosition)return this._fail("Position (index) of the ad must be a Number.");if(isNaN(e.adPosition))return this._fail("Position (index) of the ad cannot be NaN.");break;case"chapterPosition":if(!e.hasOwnProperty("chapterPosition"))return this._fail("Position (index) of the chapter must be specified.");if("number"!=typeof e.chapterPosition)return this._fail("Position (index) of the chapter must be a Number.");if(isNaN(e.chapterPosition))return this._fail("Position (index) of the chapter cannot be NaN.");break;case"chapterOffset":if(!e.hasOwnProperty("chapterOffset"))return this._fail("Chapter start-time (offset) must be specified.");if("number"!=typeof e.chapterOffset)return this._fail("Chapter start-time (offset) must be a Number.");if(isNaN(e.chapterOffset))return this._fail("Chapter start-time (offset) cannot be NaN.");break;case"chapterLength":if(!e.hasOwnProperty("chapterLength"))return this._fail("The length of the chapter must be specified.");if("number"!=typeof e.chapterLength)return this._fail("The length of the chapter must be a Number.");if(isNaN(e.chapterLength))return this._fail("The length of the chapter cannot be NaN.");break;default:return this._fail("Unable to validate unknown parameter: "+n)}}return!0},i.prototype._fail=function(e){var t=new n("Invalid input data",e);return this._onFail.fn&&this._onFail.fn.call(this._onFail.ctx,t),!1},t.context.InputDataValidator=i}(e.ADB.va,t),function(e,t){"use strict";function i(e,t){if(!t)throw new Error("Reference to the logger object cannot be NULL");if(this._logger=t,!e)throw new Error("Reference to the context object cannot be NULL");this._context=e}var n=t.model.Report;i.prototype.createReportForItem=function(e){return this._logger.debug(r,"Creating report for item: "+e.eventData.type()),new n(this._context._adobeAnalyticsData,this._context._userData,this._context._aamData,this._context._serviceProviderData,this._context._sessionData,e)};var r="ah::ReportFactory";t.context.ReportFactory=i}(e.ADB.core,t),function(e,t,i,n){"use strict";function r(e,t){if(!e)throw new Error("Reference to the channel object cannot be NULL");if(this._channel=e,!t)throw new Error("Reference to the logger object cannot be NULL");this._logger=t,this._lastInBandItem=null,this._stashedLastInBandItem=null,this._stashedMainMetadata=null,this._autoComputedStartupTime=0,this._reportingInterval=de,this._assetData=null,this._streamData=null,this._qosData=null,this._sessionData=null,this._cuserData=null,this._adobeAnalyticsData=new c,this._serviceProviderData=new u,this._userData=new h,this._aamData=new d,this._isTrackingSessionActive=!1,this._isVideoComplete=!1,this._isDestroyed=!1,this._doNotOverrideEventDuration=!1,this._reportFactory=new b(this,this._logger),this._inputDataValidator=new S((function(e){this._logger.error(E,e.getMessage()+" | "+e.getDetails()),this._channel.trigger(new s(T,e))}),this),this._trackExternalErrors=!0,this._installEventListeners()}var a=i.md5,o=i.ObjectUtils,s=e.Event,l=n.model.SessionDao,c=n.model.AdobeAnalyticsDao,u=n.model.ServiceProviderDao,h=n.model.UserDao,d=n.model.AudienceManagerDao,p=n.model.EventDao,f=n.model.AssetDao,g=n.model.StreamDao,_=n.model.QoSDao,m=n.model.AdDao,v=n.model.ChapterDao,y=n.model.TrackItem,b=n.context.ReportFactory,S=n.context.InputDataValidator;r.prototype.destroy=function(){this._isDestroyed||(this._isDestroyed=!0,this._logger.debug(E,"#destroy()"),this._uninstallEventListeners())},r.prototype._onApiAnalyticsStart=function(e){this._logger.debug(E,"#_onApiAnalyticsStart()");var t=e.data;if(this._checkCall("_onApiAnalyticsStart")&&this._inputDataValidator.validateFields(t,["playhead"])){this._userData.visitorId(t.vid),this._userData.analyticsVisitorId(t.aid),this._userData.marketingCloudVisitorId(t.mid),this._aamData.audienceManagerBlob(t.blob),this._aamData.audienceManagerLocationHint(t.loc_hint),t.customerIDs&&(this._cuserData=t.customerIDs),this._updateQoSInfo(t);var i=new y(this,p.EVENT_TYPE_AA_START,t.playhead,null,t._eventData[P]);i.assetData.adData(null),i.assetData.type(f.TYPE_MAIN_CONTENT),this._cuserData=null,this._sendHit(i)}},r.prototype._onApiAnalyticsAdStart=function(e){this._logger.debug(E,"#_onApiAnalyticsAdStart()");var t=e.data;if(this._checkCall("_onApiAnalyticsAdStart")&&this._inputDataValidator.validateFields(t,["playhead"])){this._updateQoSInfo(t);var i=new y(this,p.EVENT_TYPE_AA_AD_START,t.playhead,null,t._eventData[P]);this._sendHit(i)}},r.prototype._onApiVideoLoad=function(e){var t=e.data;this._logger.debug(E,"#_onApiVideoLoad(rsid="+t.rsid+", aa_trackingServer="+t.trackingServer+")"),this._resetInternalState(),this._inputDataValidator.validateFields(t,["rsid","trackingServer"])&&(this._sessionData.sessionId(this._generateSessionId()),this._isTrackingSessionActive=!0)},r.prototype._onApiVideoUnload=function(e){this._logger.debug(E,"#_onApiVideoUnload()"),this._isTrackingSessionActive?this._isTrackingSessionActive=!1:this._logger.debug(E,"#_onApiVideoUnload() > No active tracking session.")},r.prototype._onApiVideoStart=function(e){var t=e.data;if(this._logger.debug(E,"#_onApiVideoStart(id="+t.videoId+", name="+t.videoName+", length="+t.videoLength+", type="+t.streamType+", playerName="+t.playerName+")"),this._checkCall("_onApiVideoStart")&&this._inputDataValidator.validateFields(t,["videoId","streamType","videoLength","playhead","playerName"])){this._lastInBandItem=null,this._stashedLastInBandItem=null,this._adobeAnalyticsData.reportSuiteId(t.rsid),this._adobeAnalyticsData.trackingServer(t.trackingServer),this._adobeAnalyticsData.ssl(Number(t.useSsl)),this._serviceProviderData.ovp(t.ovp),this._serviceProviderData.sdk(t.sdk),this._serviceProviderData.channel(t.channel),this._serviceProviderData.libVersion(t.version),this._serviceProviderData.apiLevel(t.apiLvl),this._serviceProviderData.playerName(t.playerName),this._assetData.adData(null),this._assetData.chapterData(null),this._assetData.videoId(t.videoId),this._assetData.length(t.videoLength),this._assetData.type(f.TYPE_MAIN_CONTENT),this._assetData.publisher(t.publisher),this._assetData.name(t.videoName),this._streamData.type(t.streamType),this._updateQoSInfo(t);var i=t.metaNielsen?o.merge(t.metaVideo,t.metaNielsen):t.metaVideo,n=new y(this,p.EVENT_TYPE_START,t.playhead,i,t._eventData[P]);this._sendHit(n)}},r.prototype._onApiVideoResume=function(e){var t=e.data;if(this._logger.debug(E,"#_onApiVideoResume(id="+t.videoId+", name="+t.videoName+", length="+t.videoLength+", type="+t.streamType+", playerName="+t.playerName+")"),this._checkCall("_onApiVideoResume")&&this._inputDataValidator.validateFields(t,["videoId","streamType","videoLength","playhead","playerName"])){this._assetData.videoId(t.videoId),this._assetData.length(t.videoLength),this._assetData.type(f.TYPE_MAIN_CONTENT),this._assetData.name(t.videoName),this._streamData.type(t.streamType);var i=new y(this,p.EVENT_TYPE_RESUME,t.playhead,null,t._eventData[P]);this._sendHit(i)}},r.prototype._onApiVideoSessionEnd=function(e){this._logger.debug(E,"#_onApiVideoSessionEnd()");var t=e.data;if(this._checkCall("_onApiVideoSessionEnd")&&this._inputDataValidator.validateFields(t,["playhead"])){var i=new y(this,p.EVENT_TYPE_END,t.playhead,null,t._eventData[P]);i.assetData.adData(null),i.assetData.type(f.TYPE_MAIN_CONTENT),this._sendHit(i)}},r.prototype._onApiVideoComplete=function(e){this._logger.debug(E,"#_onApiVideoComplete()");var t=e.data;if(this._checkCall("_onApiVideoComplete")){var i=new y(this,p.EVENT_TYPE_COMPLETE,this._assetData.length(),null,t._eventData[P]);this._sendHit(i),this._isVideoComplete=!0}},r.prototype._onApiVideoSkip=function(e){this._logger.debug(E,"#_onApiVideoSkip()");var t=e.data;if(this._checkCall("_onApiVideoSkip")){var i=new y(this,p.EVENT_TYPE_SKIP,t.playhead,null,t._eventData[P]);this._sendHit(i),this._isVideoComplete=!0}},r.prototype._onApiPlay=function(e){this._logger.debug(E,"#_onApiPlay()");var t=e.data;if(this._checkCall("_onApiPlay")&&this._inputDataValidator.validateFields(t,["playhead"])){this._updateQoSInfo(t);var i=new y(this,p.EVENT_TYPE_PLAY,t.playhead,null,t._eventData[P]);this._sendHit(i)}},r.prototype._onApiPause=function(e){this._logger.debug(E,"#_onApiPause()");var t=e.data;if(this._checkCall("_onApiPause")&&this._inputDataValidator.validateFields(t,["playhead"])){this._updateQoSInfo(t);var i=t.playheadStalled?p.EVENT_TYPE_STALL:p.EVENT_TYPE_PAUSE,n=new y(this,i,t.playhead,null,t._eventData[P]);t._eventData.hasOwnProperty(L)&&(n.filterReport=t._eventData[L]),this._sendHit(n)}},r.prototype._onApiBufferStart=function(e){this._logger.debug(E,"#_onApiBufferStart()");var t=e.data;if(this._checkCall("_onApiBufferStart")&&this._inputDataValidator.validateFields(t,["playhead"])){this._updateQoSInfo(t);var i=new y(this,p.EVENT_TYPE_BUFFER,t.playhead,null,t._eventData[P]);this._sendHit(i)}},r.prototype._onApiAdBreakStart=function(e){this._logger.debug(E,"#_onApiAdBreakStart()");var t=e.data;this._checkCall("_onApiAdBreakStart")&&this._inputDataValidator.validateFields(t,["playhead"])&&(this._flushLastInbandItem(t),this._updateLastInbandItemToBuffering())},r.prototype._onApiAdBreakComplete=function(e){this._logger.debug(E,"#_onApiAdBreakComplete()");var t=e.data;this._checkCall("_onApiAdBreakComplete")&&this._inputDataValidator.validateFields(t,["playhead"])&&(this._flushLastInbandItem(t),this._restoreLastInbandItem())},r.prototype._onApiAdStart=function(e){var t=e.data;if(this._logger.debug(E,"#_onApiAdStart(id="+t.adId+", player_name="+t.podPlayerName+", parent_name="+this._assetData.videoId()+", pod_pos="+t.adPosition+")"),this._checkCall("_onApiAdStart")&&this._inputDataValidator.validateFields(t,["playhead","podPosition","podPlayerName","adId","adPosition"])){var i=new m;i.adId(t.adId),i.adName(t.adName),i.adLength(t.adLength),i.resolver(t.podPlayerName),i.podId(a(this._assetData.videoId())+"_"+t.podPosition),i.podPosition(t.adPosition+""),i.podName(t.podName),i.podOffset(t.podSecond),i.sid(this._generateSessionId()),this._assetData.adData(i),this._assetData.type(f.TYPE_AD),this._updateQoSInfo(t);var n=o.merge(t.metaVideo,t.metaAd);n=t.metaNielsen?o.merge(n,t.metaNielsen):n,n=t.metaAdNielsen?o.merge(n,t.metaAdNielsen):n;var r=new y(this,p.EVENT_TYPE_START,t.playhead,n,t._eventData[P]);if(this._sendHit(r),this._restoreLastInbandItem(),t.adGranularTracking){var s=t.adTrackingInterval?t.adTrackingInterval:this._reportingInterval;this._updateReportingInterval(s,!0)}}},r.prototype._onApiAdComplete=function(e){this._logger.debug(E,"#_onApiAdComplete()");var t=e.data;if(this._checkCall("_onApiAdComplete")&&this._inputDataValidator.validateFields(t,["playhead"])){if(this._assetData.type()!=f.TYPE_AD)return void this._logger.warn(E,"#_onApiAdComplete() > Ignoring the ad complete event, because we are no longer in an ad.");this._updateQoSInfo(t);var i=new y(this,p.EVENT_TYPE_COMPLETE,t.playhead,null,t._eventData[P]);this._sendHit(i),this._updateLastInbandItemToBuffering(),this._assetData.adData(null),this._assetData.type(f.TYPE_MAIN_CONTENT),this._updateReportingInterval(this._reportingInterval,!1)}},r.prototype._onApiAdSkip=function(e){this._logger.debug(E,"#_onApiAdSkip()");var t=e.data;if(this._checkCall("_onApiAdSkip")&&this._inputDataValidator.validateFields(t,["playhead"])){if(this._assetData.type()!=f.TYPE_AD)return void this._logger.warn(E,"#_onApiAdSkip() > Ignoring the ad skip event, because we are no longer in an ad.");this._updateQoSInfo(t);var i=new y(this,p.EVENT_TYPE_SKIP,t.playhead,null,t._eventData[P]);this._sendHit(i),this._updateLastInbandItemToBuffering(),this._assetData.adData(null),this._assetData.type(f.TYPE_MAIN_CONTENT),this._updateReportingInterval(this._reportingInterval,!1)}},r.prototype._onApiChapterStart=function(e){var t=e.data;if(this._logger.debug(E,"#_onApiChapterStart(name="+t.chapterName+", length="+t.chapterLength+", position="+t.chapterPosition+", chapter_offset="+t.chapterOffset+")"),this._checkCall("_onApiChapterStart")&&this._inputDataValidator.validateFields(t,["playhead","chapterPosition","chapterOffset","chapterLength"])){var i=new v;i.id(a(this._assetData.videoId())+"_"+t.chapterPosition),i.name(t.chapterName),i.length(t.chapterLength),i.position(t.chapterPosition),i.offset(t.chapterOffset),i.sid(this._generateSessionId()),this._assetData.chapterData(i),this._updateQoSInfo(t);var n=o.merge(t.metaVideo,t.metaChapter),r=new y(this,p.EVENT_TYPE_CHAPTER_START,t.playhead,n,t._eventData[P]);r.assetData.adData(null),r.assetData.type(f.TYPE_MAIN_CONTENT),this._sendHit(r)}},r.prototype._onApiChapterComplete=function(e){this._logger.debug(E,"#_onApiChapterComplete()");var t=e.data;if(this._checkCall("_onApiChapterComplete")&&this._inputDataValidator.validateFields(t,["playhead"])){if(!this._assetData.chapterData())return void this._logger.warn(E,"#_onApiChapterComplete() > Ignoring the chapter complete event, because we are no longer in a chapter.");this._updateQoSInfo(t);var i=new y(this,p.EVENT_TYPE_CHAPTER_COMPLETE,t.playhead,null,t._eventData[P]);i.assetData.adData(null),i.assetData.type(f.TYPE_MAIN_CONTENT),this._sendHit(i),this._assetData.chapterData(null)}},r.prototype._onApiChapterSkip=function(e){this._logger.debug(E,"#_onApiChapterSkip()");var t=e.data;if(this._checkCall("_onApiChapterSkip")&&this._inputDataValidator.validateFields(t,["playhead"])){if(!this._assetData.chapterData())return void this._logger.warn(E,"#_onApiChapterSkip() > Ignoring the chapter skip event, because we are no longer in a chapter.");this._updateQoSInfo(t);var i=new y(this,p.EVENT_TYPE_CHAPTER_SKIP,t.playhead,null,t._eventData[P]);i.assetData.adData(null),i.assetData.type(f.TYPE_MAIN_CONTENT),this._sendHit(i),this._assetData.chapterData(null)}},r.prototype._onApiBitrateChange=function(e){this._logger.debug(E,"#_onApiBitrateChange()");var t=e.data;if(this._checkCall("_onApiBitrateChange")&&this._inputDataValidator.validateFields(t,["playhead"])){this._updateQoSInfo(t);var i=new y(this,p.EVENT_TYPE_BITRATE_CHANGE,t.playhead,null,t._eventData[P]);this._sendHit(i)}},r.prototype._onApiTrackError=function(e){var t=e.data;if(this._logger.debug(E,"#_onApiTrackError(source="+t._eventData.source+", err_id="+t._eventData.error_id+")"),this._isTrackingSessionActive){if(this._trackExternalErrors||t._eventData.source===w){this._updateQoSInfo(t);var i=new y(this,p.EVENT_TYPE_ERROR,0,null,t._eventData[P]);i.eventData.id(t._eventData.error_id),i.eventData.source(t._eventData.source),this._sendHit(i)}}else this._logger.warn(E,"#_onApiTrackError() > No active tracking session.")},r.prototype._onApiTrackInternalError=function(e){var t=e.data;this._logger.debug(E,"#_onApiTrackInternalError(source="+t.source+", err_id="+t.error_id+")"),this._updateQoSInfo(t);var i=new y(this,p.EVENT_TYPE_ERROR,0);i.eventData.id(t.error_id),i.eventData.source(t.source),this._sendHit(i)},r.prototype._onApiQuantumEnd=function(e){this._logger.debug(E,"#_onApiQuantumEnd(interval="+this._channel.request(C)+")");var t=e.data;if(this._checkCall("_onApiQuantumEnd")&&this._inputDataValidator.validateFields(t,["playhead"])){var i=this._lastInBandItem;if(i){this._updateQoSInfo(t);var n=new y(this,i.eventData.type(),t.playhead,i.meta,i.callback);n.filterReport=i.filterReport,this._sendHit(n,!0)}}},r.prototype._onNetworkCheckStatusComplete=function(e){var t=e.data;this._trackExternalErrors=t[k],this._reportingInterval=t[O],this._reportingInterval||(this._reportingInterval=de),this._logger.debug(E,"#_onNetworkCheckStatusComplete(track_ext_err="+this._trackExternalErrors+")")},r.prototype._onResetSessionId=function(e){var t=this._generateSessionId();this._sessionData=new l,this._sessionData.sessionId(t),this._logger.debug(E,"#_resetSessionId(new sessionId="+t+")")},r.prototype._installEventListeners=function(){this._channel.on(F,this._onApiAnalyticsStart,this),this._channel.on(V,this._onApiAnalyticsAdStart,this),this._channel.on(B,this._onApiVideoLoad,this),this._channel.on(U,this._onApiVideoUnload,this),this._channel.on(H,this._onApiVideoStart,this),this._channel.on(G,this._onApiVideoComplete,this),this._channel.on(j,this._onApiVideoSkip,this),this._channel.on(z,this._onApiVideoResume,this),this._channel.on(W,this._onApiVideoSessionEnd,this),this._channel.on(Y,this._onApiAdBreakStart,this),this._channel.on(K,this._onApiAdBreakComplete,this),this._channel.on(q,this._onApiAdStart,this),this._channel.on(X,this._onApiAdComplete,this),this._channel.on(Q,this._onApiAdSkip,this),this._channel.on(Z,this._onApiPlay,this),this._channel.on(J,this._onApiPause,this),this._channel.on($,this._onApiBufferStart,this),this._channel.on(ee,this._onApiChapterStart,this),this._channel.on(te,this._onApiChapterComplete,this),this._channel.on(ie,this._onApiChapterSkip,this),this._channel.on(ae,this._onApiBitrateChange,this),this._channel.on(ne,this._onApiTrackError,this),this._channel.on(re,this._onApiTrackInternalError,this),this._channel.on(oe,this._onApiQuantumEnd,this),this._channel.on(le,this._onNetworkCheckStatusComplete,this),this._channel.on(I,this._onResetSessionId,this),this._channel.reply(x,(function(){return this._sessionData&&this._sessionData.sessionId()?this._sessionData.sessionId():null}),this)},r.prototype._uninstallEventListeners=function(){this._channel.off(null,null,this)},r.prototype._resetInternalState=function(){this._logger.debug(E,"#_resetInternalState()"),this._isTrackingSessionActive=!1,this._isVideoComplete=!1,this._autoComputedStartupTime=0,this._lastInBandItem=null,this._stashedLastInBandItem=null,this._streamData=new g,this._qosData=new _,this._sessionData=new l,this._assetData=new f,this._cuserData=null},r.prototype._generateSessionId=function(){return""+(new Date).getTime()+Math.floor(1e9*Math.random())},r.prototype._updateQoSInfo=function(e){this._qosData.bitrate(e.bitrate||0),this._qosData.fps(e.fps||0),this._qosData.droppedFrames(e.droppedFrames||0),null==e.startupTime||isNaN(e.startupTime)?(this._qosData.startupTime(this._autoComputedStartupTime),this._qosData.isStartupTimeOverridden=!1):(this._qosData.startupTime(e.startupTime),this._qosData.isStartupTimeOverridden=!0)},r.prototype._checkCall=function(e){return this._isTrackingSessionActive?!this._isVideoComplete||"_onApiVideoSessionEnd"===e||(this._logger.warn(E,"#"+e+"() > The video content already completed."),!1):(this._logger.warn(E,"#"+e+"() > No active tracking session."),!1)},r.prototype._updateReportingInterval=function(e,t){var i={};i[N]=!!t,i[O]=e,this._channel.trigger(new s(ce,i))},r.prototype._updateLastInBandItem=function(e){var t=this._lastInBandItem,i=(new Date).getTime(),n=t.assetData.type()===f.TYPE_AD||e.assetData.type()===f.TYPE_AD,r=1e3*Math.abs(e.eventData.playhead()-t.eventData.playhead()),a=Math.abs(i-t.eventData.ts()),o=Math.abs(r-a),s=a;s>ue?(this._logger.warn(E," Resetting duration in lastInBandItem["+t.assetData.type()+":"+t.eventData.type()+"] call to 0 as calculated duration ("+s+")exceeds 10mins"),s=0):t.eventData.type()==p.EVENT_TYPE_PLAY&&!n&&!this._doNotOverrideEventDuration&&o>he&&(s=Math.min(r,a),this._logger.warn(E," Resetting duration in lastInBandItem["+t.assetData.type()+":"+t.eventData.type()+"] call to "+s+" as calculated error delta ("+o+")exceeds 2sec")),this._doNotOverrideEventDuration=!1,t.eventData.duration(s),t.eventData.ts(i),t.eventData.playhead(e.eventData.playhead()),t.qosData.startupTime(e.qosData.startupTime()),t.qosData.isStartupTimeOverridden=e.qosData.isStartupTimeOverridden},r.prototype._updateLastInbandItemToBuffering=function(){this._stashedLastInBandItem=this._lastInBandItem;var e=0;null!=this._lastInBandItem&&(this._lastInBandItem.assetData.type()==f.TYPE_MAIN_CONTENT&&this._lastInBandItem.eventData.type()==p.EVENT_TYPE_START&&(this._stashedMainMetadata=this._lastInBandItem.meta),e=this._lastInBandItem.eventData.playhead());var t=new y(this,p.EVENT_TYPE_BUFFER,e,null,null);t.assetData.adData(null),t.assetData.type(f.TYPE_MAIN_CONTENT),this._lastInBandItem=t},r.prototype._restoreLastInbandItem=function(){if(null!=this._stashedLastInBandItem){var e=null;this._stashedLastInBandItem.eventData.type()==p.EVENT_TYPE_START&&(this._lastInBandItem.assetData.type()==f.TYPE_AD?e=this._lastInBandItem.meta:(e=this._stashedMainMetadata,this._stashedMainMetadata=null));var t=new y(this,this._stashedLastInBandItem.eventData.type(),this._stashedLastInBandItem.eventData.playhead(),e,this._stashedLastInBandItem.callback);t.filterReport=this._stashedLastInBandItem.filterReport,this._lastInBandItem=t,this._stashedLastInBandItem=null}},r.prototype._flushLastInbandItem=function(e){if(this._lastInBandItem){this._updateQoSInfo(e);var t=new y(this,this._lastInBandItem.eventData.type(),e.playhead,this._lastInBandItem.meta,this._lastInBandItem.callback);this._sendHit(t,!0)}},r.prototype._createAndSendReport=function(e){var t=this._reportFactory.createReportForItem(e);t.qosData.isStartupTimeOverridden||t.qosData.startupTime(this._autoComputedStartupTime);var i={};if(i[D]=t,this._channel.trigger(new s(se,i)),t.eventData.type()==p.EVENT_TYPE_START||t.eventData.type()==p.EVENT_TYPE_PLAY||t.eventData.type()==p.EVENT_TYPE_PAUSE||t.eventData.type()==p.EVENT_TYPE_STALL||t.eventData.type()==p.EVENT_TYPE_BUFFER){var n={};n[R]=!0,this._channel.command(M,n)}},r.prototype._sendHit=function(e,t){switch(e.eventData.type()){case p.EVENT_TYPE_START:case p.EVENT_TYPE_PLAY:case p.EVENT_TYPE_PAUSE:case p.EVENT_TYPE_STALL:case p.EVENT_TYPE_BUFFER:this._lastInBandItem?(this._updateLastInBandItem(e),this._lastInBandItem.eventData.type()==p.EVENT_TYPE_START&&this._lastInBandItem.assetData.type()==f.TYPE_MAIN_CONTENT&&(this._autoComputedStartupTime+=this._lastInBandItem.eventData.duration()),this._createAndSendReport(this._lastInBandItem),t&&this._lastInBandItem.eventData.type()==e.eventData.type()||this._createAndSendReport(e)):this._createAndSendReport(e),this._lastInBandItem=e;break;case p.EVENT_TYPE_COMPLETE:case p.EVENT_TYPE_SKIP:if(this._lastInBandItem&&(this._updateLastInBandItem(e),this._createAndSendReport(this._lastInBandItem)),e.eventData.type()!==p.EVENT_TYPE_SKIP&&this._createAndSendReport(e),e.assetData.type()==f.TYPE_MAIN_CONTENT){this._lastInBandItem=null,this._stashedLastInBandItem=null;var i={};i[R]=!0,this._channel.command(A,i)}else e.assetData.type()==f.TYPE_AD&&(this._lastInBandItem.assetData.adData(null),this._lastInBandItem.assetData.type(f.TYPE_MAIN_CONTENT),this._doNotOverrideEventDuration=!0);break;case p.EVENT_TYPE_CHAPTER_START:case p.EVENT_TYPE_CHAPTER_COMPLETE:case p.EVENT_TYPE_CHAPTER_SKIP:this._lastInBandItem&&(this._updateLastInBandItem(e),this._createAndSendReport(this._lastInBandItem)),e.eventData.type()!==p.EVENT_TYPE_CHAPTER_SKIP&&this._createAndSendReport(e),this._lastInBandItem&&(this._lastInBandItem.assetData.chapterData(e.eventData.type()==p.EVENT_TYPE_CHAPTER_START?new v(e.assetData.chapterData()):null),this._lastInBandItem.eventData.duration(0),this._createAndSendReport(this._lastInBandItem));break;default:this._createAndSendReport(e)}};var E="ah::Context",w="sourceErrorSDK",T="error",M="clock:reporting.resume",A="clock:reporting.pause",C="reporting_interval",x="session_id",I="reset_session_id",P="callback",L="filter_report",D="report",R="reset",k="track_external_errors",O="reporting_interval",N="do_not_override_interval",F="api:aa_start",V="api:aa_ad_start",B="api:video_load",U="api:video_unload",H="api:video_start",G="api:video_complete",j="api:video_skip",z="api:video_resume",W="api:video_session_end",Y="api:adbreak_start",K="api:adbreak_complete",q="api:ad_start",X="api:ad_complete",Q="api:ad_skip",Z="api:play",J="api:pause",$="api:buffer_start",ee="api:chapter_start",te="api:chapter_complete",ie="api:chapter_skip",ne="api:track_error",re="api:track_internal_error",ae="api:bitrate_change",oe="api:quantum_end",se="context:report_available",le="net:check_status_complete",ce="reporting:update_interval",ue=6e5,he=2e3,de=10;n.context.Context=r}(e.ADB.core,e.ADB.va,e.ADB.va.utils,t),function(e){"use strict";var t="unknown";e.AdobeHeartbeatPluginConfig=function(e,i){this.trackingServer=e,this.publisher=i,this.ssl=!1,this.ovp=t,this.sdk=t,this.quietMode=!1,this.debugLogging=!1,this.__isPrimetime=!1,this.__psdkVersion=null}}(t),function(e){"use strict";function t(){}t.prototype.onError=function(e){},t.prototype.onTrackingDisabled=function(){},e.AdobeHeartbeatPluginDelegate=t}(t),function(e,t,i){"use strict";function n(e){n.__super__.constructor.call(this,_),this._radio=new l(this._logger),this._channel=this._radio.channel(T),this._delegate=e,this._context=new h(this._channel,this._logger),this._filter=new d(this._channel,this._logger),this._network=new p(this._channel,this._logger),this._setupDataResolver()}var r=e.Event,a=e.Trigger,o=e.plugin.BasePlugin,s=e.plugin.ParamMapping,l=e.radio.Radio,c=t.ErrorInfo,u=t.Version,h=i.context.Context,d=i.filter.ReportFilter,p=i.network.Network,f=i.clock.Clock,g=i.AdobeHeartbeatPluginConfig;e.extend(n,o),n.prototype.configure=function(e){if(!e)throw new Error("Reference to the configuration data cannot be NULL.");if(!(e instanceof g))throw new Error("Expected config data to be instance of AdobeHeartbeatPluginConfig.");this._config=e,this._config.debugLogging?this._logger.enable():this._logger.disable(),this._logger.debug(this._logTag,"#configure({trackingServer="+this._config.trackingServer+", publisher="+this._config.publisher+", quietMode="+this._config.quietMode+", ssl="+this._config.ssl+"})");var t=this._config.trackingServer+"/settings/",i={};i[oe]=this._config.trackingServer,i[se]=t,i[le]=this._config.publisher,i[ce]=this._config.quietMode,i[ue]=this._config.ssl,this._channel.trigger(new r(_e,i)),this._isConfigured=!0},n.prototype.bootstrap=function(e){n.__super__.bootstrap.call(this,e),this._channel.on(M,this._onError,this),this._clock=new f(this._pluginManager,this._channel,this._logger),this._channel.command(He),this._channel.trigger(new r(qe)),this._channel.on(pe,this._onCheckStatusComplete,this),this._registerCommands(),this._registerBehaviours()},n.prototype._teardown=function(){this._logger.debug(this._logTag,"#_teardown()"),this._radio.shutdown(),this._context.destroy(),this._clock.destroy(),this._filter.destroy(),this._network.destroy()},n.prototype._canProcess=function(){return this._isConfigured?this._errorInfo?(this._logger.error(this._logTag,"_canProcess() > Plugin in ERROR state."),!1):n.__super__._canProcess.call(this):(this._logger.error(this._logTag,"_canProcess() > Plugin not configured."),!1)},n.prototype._cmdAnalyticsError=function(e){this._errorInfo||(this._errorInfo=new c("Internal error","AdobeAnalyticsPlugin is in ERROR state."),this._trigger(M,this._errorInfo),this._delegate&&this._delegate.onError(this._errorInfo))},n.prototype._cmdAnalyticsStart=function(e){if(this._canProcess()){var t={};t[he]=e.visitorOptedOut,this._channel.trigger(new r(me,t)),this._channel.trigger(new r(fe,e))}},n.prototype._cmdAnalyticsAdStart=function(e){this._canProcess()&&this._channel.trigger(new r(ge,e))},n.prototype._cmdVideoLoad=function(e){this._errorInfo=null,this._canProcess()&&(this._isTrackingSessionActive&&this._channel.trigger(new r(ye,e)),this._isTrackingSessionActive=!1,this._isPaused=!0,this._isSeeking=!1,this._isBuffering=!1,this._isVideoIdle=!1,this._filter.clear(),this._channel.trigger(new r(ve,e)),this._isTrackingSessionActive=!0)},n.prototype._cmdVideoUnload=function(e){this._errorInfo=null,this._canProcess()&&(this._channel.trigger(new r(ye,e)),this._filter.flush(),this._runReportingTimer(!1),this._runFlushFilterTimer(!1),this._runIdleTimer(!1),this._isTrackingSessionActive=!1)},n.prototype._cmdVideoSessionEnd=function(e){this._canProcess()&&this._channel.trigger(new r(Te,e))},n.prototype._cmdVideoStart=function(e){this._canProcess()&&(this._channel.trigger(new r(be,e)),this._filter.flush())},n.prototype._cmdVideoComplete=function(e){this._canProcess()&&this._channel.trigger(new r(Se,e))},n.prototype._cmdVideoSkip=function(e){this._canProcess()&&this._channel.trigger(new r(Ee,e))},n.prototype._cmdVideoResume=function(e){this._canProcess()&&this._channel.trigger(new r(we,e))},n.prototype._cmdPlay=function(e){this._canProcess()&&(this._isPaused=!1,this._resumePlaybackIfPossible(e))},n.prototype._cmdPause=function(e){this._canProcess()&&(this._channel.trigger(new r(Le,e)),this._isPaused=!0,this._runIdleTimer(!0))},n.prototype._cmdAdBreakStart=function(e){this._canProcess()&&this._channel.trigger(new r(Me,e))},n.prototype._cmdAdBreakComplete=function(e){this._canProcess()&&(this._channel.trigger(new r(Ae,e)),this._resumePlaybackIfPossible(e))},n.prototype._cmdAdStart=function(e){this._canProcess()&&(this._channel.trigger(new r(Ce,e)),this._resumePlaybackIfPossible(e))},n.prototype._cmdAdComplete=function(e){this._canProcess()&&this._channel.trigger(new r(xe,e))},n.prototype._cmdAdSkip=function(e){this._canProcess()&&this._channel.trigger(new r(Ie,e))},n.prototype._cmdBufferStart=function(e){this._canProcess()&&(this._channel.trigger(new r(De,e)),this._isBuffering=!0,this._runIdleTimer(!0))},n.prototype._cmdBufferComplete=function(e){this._canProcess()&&(this._isBuffering=!1,this._isPaused?this._channel.trigger(new r(Le,e)):this._resumePlaybackIfPossible(e))},n.prototype._cmdSeekStart=function(e){this._canProcess()&&(this._channel.trigger(new r(Le,e)),this._isSeeking=!0,this._runIdleTimer(!0))},n.prototype._cmdSeekComplete=function(e){this._canProcess()&&(this._isSeeking=!1,this._resumePlaybackIfPossible(e))},n.prototype._cmdChapterStart=function(e){this._canProcess()&&this._channel.trigger(new r(Re,e))},n.prototype._cmdChapterComplete=function(e){this._canProcess()&&this._channel.trigger(new r(ke,e))},n.prototype._cmdChapterSkip=function(e){this._canProcess()&&this._channel.trigger(new r(Oe,e))},n.prototype._cmdBitrateChange=function(e){this._canProcess()&&this._channel.trigger(new r(Ve,e))},n.prototype._cmdTrackError=function(e){this._canProcess()&&this._channel.trigger(new r(Ne,e))},n.prototype._cmdClockReportingTick=function(e){this._canProcess()&&this._channel.trigger(new r(Be,e))},n.prototype._onCheckStatusComplete=function(e){if(this._canProcess()){var t=!1;e&&e.data&&e.data[de]&&(t=e.data[de]),this._logger.debug(this._logTag,"#_onCheckStatusComplete(trackingDisabled="+t+")"),t&&this._delegate&&this._delegate.onTrackingDisabled()}},n.prototype._cmdIdleTick=function(e){this._canProcess()&&(this._isVideoIdle=!0,this._trigger(ee),this._channel.trigger(new r(Te,e)),this._filter.flush(),this._runReportingTimer(!1),this._runFlushFilterTimer(!1),this._runIdleTimer(!1),this._trigger(J))},n.prototype._onError=function(e){this._errorInfo=e.data;var t={};t[re]=Ue,t[ae]=this._errorInfo.getMessage()+"|"+this._errorInfo.getDetails(),this._channel.trigger(new r(Fe,t)),this._runReportingTimer(!1),this._trigger(M,this._errorInfo),this._delegate&&this._delegate.onError(this._errorInfo)},n.prototype._runIdleTimer=function(e){var t={};t[ne]=!0,e?this._channel.command(Ye,t):this._channel.command(Ke,t)},n.prototype._runFlushFilterTimer=function(e){var t={};t[ne]=!0,e?this._channel.command(ze,t):this._channel.command(We,t)},n.prototype._runReportingTimer=function(e){var t={};t[ne]=!0,e?this._channel.command(Ge,t):this._channel.command(je,t)},n.prototype._registerCommands=function(){this._pluginManager.comply(this,"handleAnalyticsError",this._cmdAnalyticsError),this._pluginManager.comply(this,"handleAnalyticsStart",this._cmdAnalyticsStart),this._pluginManager.comply(this,"handleAnalyticsAdStart",this._cmdAnalyticsAdStart),this._pluginManager.comply(this,"handleVideoLoad",this._cmdVideoLoad),this._pluginManager.comply(this,"handleVideoUnload",this._cmdVideoUnload),this._pluginManager.comply(this,"handleVideoSessionEnd",this._cmdVideoSessionEnd),this._pluginManager.comply(this,"handleVideoStart",this._cmdVideoStart),this._pluginManager.comply(this,"handleVideoComplete",this._cmdVideoComplete),this._pluginManager.comply(this,"handleVideoSkip",this._cmdVideoSkip),this._pluginManager.comply(this,"handleVideoResume",this._cmdVideoResume),this._pluginManager.comply(this,"handlePlay",this._cmdPlay),this._pluginManager.comply(this,"handlePause",this._cmdPause),this._pluginManager.comply(this,"handleAdBreakStart",this._cmdAdBreakStart),this._pluginManager.comply(this,"handleAdBreakComplete",this._cmdAdBreakComplete),this._pluginManager.comply(this,"handleAdStart",this._cmdAdStart),this._pluginManager.comply(this,"handleAdComplete",this._cmdAdComplete),this._pluginManager.comply(this,"handleAdSkip",this._cmdAdSkip),this._pluginManager.comply(this,"handleBufferStart",this._cmdBufferStart),this._pluginManager.comply(this,"handleBufferComplete",this._cmdBufferComplete),this._pluginManager.comply(this,"handleSeekStart",this._cmdSeekStart),this._pluginManager.comply(this,"handleSeekComplete",this._cmdSeekComplete),this._pluginManager.comply(this,"handleChapterStart",this._cmdChapterStart),this._pluginManager.comply(this,"handleChapterComplete",this._cmdChapterComplete),this._pluginManager.comply(this,"handleChapterSkip",this._cmdChapterSkip),this._pluginManager.comply(this,"handleBitrateChange",this._cmdBitrateChange),this._pluginManager.comply(this,"handleTrackError",this._cmdTrackError),this._pluginManager.comply(this,"handleClockReportingTick",this._cmdClockReportingTick),this._pluginManager.comply(this,"handleIdleTick",this._cmdIdleTick)},n.prototype._registerBehaviours=function(){this._pluginManager.registerBehaviour(new a(y,x),this,"handleVideoLoad",[new s(v,"rsid","rsid"),new s(v,"tracking_server","trackingServer")]),this._pluginManager.registerBehaviour(new a(y,I),this,"handleVideoUnload"),this._pluginManager.registerBehaviour(new a(y,P),this,"handleVideoSessionEnd",[new s(y,"video.playhead","playhead")]),this._pluginManager.registerBehaviour(new a(y,L),this,"handleVideoStart",[new s(y,"video.id","videoId"),new s(y,"video.name","videoName"),new s(y,"video.length","videoLength"),new s(y,"video.playhead","playhead"),new s(y,"video.playerName","playerName"),new s(y,"video.streamType","streamType"),new s(y,"qos.fps","fps"),new s(y,"qos.droppedFrames","droppedFrames"),new s(y,"qos.bitrate","bitrate"),new s(y,"qos.startupTime","startupTime"),new s(v,"rsid","rsid"),new s(v,"tracking_server","trackingServer"),new s(v,"channel","channel"),new s(v,"meta.video.*","metaVideo"),new s(v,"ssl","useSsl"),new s(b,"meta","metaNielsen"),new s(m,"publisher","publisher"),new s(m,"sdk","sdk"),new s(m,"ovp","ovp"),new s(m,"version","version"),new s(m,"api_level","apiLvl")]),this._pluginManager.registerBehaviour(new a(y,R),this,"handleVideoComplete",[new s(y,"qos.fps","fps"),new s(y,"qos.droppedFrames","droppedFrames"),new s(y,"qos.bitrate","bitrate"),new s(y,"qos.startupTime","startupTime")]),this._pluginManager.registerBehaviour(new a(y,k),this,"handleVideoSkip",[new s(y,"video.playhead","playhead"),new s(y,"qos.fps","fps"),new s(y,"qos.droppedFrames","droppedFrames"),new s(y,"qos.bitrate","bitrate"),new s(y,"qos.startupTime","startupTime")]),this._pluginManager.registerBehaviour(new a(y,D),this,"handleVideoResume",[new s(y,"video.id","videoId"),new s(y,"video.name","videoName"),new s(y,"video.length","videoLength"),new s(y,"video.playhead","playhead"),new s(y,"video.playerName","playerName"),new s(y,"video.streamType","streamType")]),this._pluginManager.registerBehaviour(new a(y,O),this,"handlePlay",[new s(y,"video.playhead","playhead"),new s(y,"qos.fps","fps"),new s(y,"qos.droppedFrames","droppedFrames"),new s(y,"qos.bitrate","bitrate"),new s(y,"qos.startupTime","startupTime")]),this._pluginManager.registerBehaviour(new a(y,N),this,"handlePause",[new s(y,"video.playhead","playhead"),new s(y,"video.playheadStalled","playheadStalled"),new s(y,"qos.fps","fps"),new s(y,"qos.droppedFrames","droppedFrames"),new s(y,"qos.bitrate","bitrate"),new s(y,"qos.startupTime","startupTime")]),this._pluginManager.registerBehaviour(new a(y,V),this,"handleAdBreakStart",[new s(y,"ad.isInAdBreak","isInAdBreak"),new s(y,"video.playhead","playhead"),new s(y,"qos.fps","fps"),new s(y,"qos.droppedFrames","droppedFrames"),new s(y,"qos.bitrate","bitrate"),new s(y,"qos.startupTime","startupTime")]),this._pluginManager.registerBehaviour(new a(y,B),this,"handleAdBreakComplete",[new s(y,"ad.isInAdBreak","isInAdBreak"),new s(y,"video.playhead","playhead"),new s(y,"qos.fps","fps"),new s(y,"qos.droppedFrames","droppedFrames"),new s(y,"qos.bitrate","bitrate"),new s(y,"qos.startupTime","startupTime")]),this._pluginManager.registerBehaviour(new a(y,U),this,"handleAdStart",[new s(y,"video.playhead","playhead"),new s(y,"ad.id","adId"),new s(y,"ad.name","adName"),new s(y,"ad.length","adLength"),new s(y,"ad.position","adPosition"),new s(y,"ad.granularTracking","adGranularTracking"),new s(y,"ad.trackingInterval","adTrackingInterval"),new s(y,"pod.name","podName"),new s(y,"pod.playerName","podPlayerName"),new s(y,"pod.position","podPosition"),new s(y,"pod.startTime","podSecond"),new s(y,"qos.fps","fps"),new s(y,"qos.droppedFrames","droppedFrames"),new s(y,"qos.bitrate","bitrate"),new s(y,"qos.startupTime","startupTime"),new s(v,"meta.video.*","metaVideo"),new s(v,"meta.ad.*","metaAd"),new s(b,"meta","metaNielsen"),new s(b,"metaAd","metaAdNielsen")]),this._pluginManager.registerBehaviour(new a(y,H),this,"handleAdComplete",[new s(y,"video.playhead","playhead"),new s(y,"ad.isInAdBreak","isInAdBreak"),new s(y,"qos.fps","fps"),new s(y,"qos.droppedFrames","droppedFrames"),new s(y,"qos.bitrate","bitrate"),new s(y,"qos.startupTime","startupTime")]),this._pluginManager.registerBehaviour(new a(y,G),this,"handleAdSkip",[new s(y,"video.playhead","playhead"),new s(y,"ad.isInAdBreak","isInAdBreak"),new s(y,"qos.fps","fps"),new s(y,"qos.droppedFrames","droppedFrames"),new s(y,"qos.bitrate","bitrate"),new s(y,"qos.startupTime","startupTime")]),this._pluginManager.registerBehaviour(new a(y,j),this,"handleBufferStart",[new s(y,"video.playhead","playhead"),new s(y,"qos.fps","fps"),new s(y,"qos.droppedFrames","droppedFrames"),new s(y,"qos.bitrate","bitrate"),new s(y,"qos.startupTime","startupTime")]),this._pluginManager.registerBehaviour(new a(y,z),this,"handleBufferComplete",[new s(y,"video.playhead","playhead"),new s(y,"video.playheadStalled","playheadStalled"),new s(y,"qos.fps","fps"),new s(y,"qos.droppedFrames","droppedFrames"),new s(y,"qos.bitrate","bitrate"),new s(y,"qos.startupTime","startupTime")]),this._pluginManager.registerBehaviour(new a(y,W),this,"handleSeekStart",[new s(y,"video.playhead","playhead")]),this._pluginManager.registerBehaviour(new a(y,Y),this,"handleSeekComplete",[new s(y,"video.playhead","playhead"),new s(y,"ad.isInAd","isInAd"),new s(y,"ad.id","adId"),new s(y,"ad.position","adPosition"),new s(y,"pod.playerName","podPlayerName"),new s(y,"pod.position","podPosition"),new s(y,"chapter.isInChapter","isInChapter"),new s(y,"chapter.position","chapterPosition"),new s(y,"chapter.name","chapterName"),new s(y,"chapter.length","chapterLength"),new s(y,"chapter.startTime","chapterOffset"),new s(y,"qos.fps","fps"),new s(y,"qos.droppedFrames","droppedFrames"),new s(y,"qos.bitrate","bitrate"),new s(y,"qos.startupTime","startupTime")]),this._pluginManager.registerBehaviour(new a(y,K),this,"handleChapterStart",[new s(y,"video.playhead","playhead"),new s(y,"chapter.position","chapterPosition"),new s(y,"chapter.name","chapterName"),new s(y,"chapter.length","chapterLength"),new s(y,"chapter.startTime","chapterOffset"),new s(y,"qos.fps","fps"),new s(y,"qos.droppedFrames","droppedFrames"),new s(y,"qos.bitrate","bitrate"),new s(y,"qos.startupTime","startupTime"),new s(v,"meta.video.*","metaVideo"),new s(v,"meta.chapter.*","metaChapter"),new s(b,"meta","metaNielsen")]),this._pluginManager.registerBehaviour(new a(y,q),this,"handleChapterComplete",[new s(y,"video.playhead","playhead"),new s(y,"qos.fps","fps"),new s(y,"qos.droppedFrames","droppedFrames"),new s(y,"qos.bitrate","bitrate"),new s(y,"qos.startupTime","startupTime")]),this._pluginManager.registerBehaviour(new a(y,X),this,"handleChapterSkip",[new s(y,"video.playhead","playhead"),new s(y,"qos.fps","fps"),new s(y,"qos.droppedFrames","droppedFrames"),new s(y,"qos.bitrate","bitrate"),new s(y,"qos.startupTime","startupTime")]),this._pluginManager.registerBehaviour(new a(y,Q),this,"handleBitrateChange",[new s(y,"video.playhead","playhead"),new s(y,"qos.fps","fps"),new s(y,"qos.droppedFrames","droppedFrames"),new s(y,"qos.bitrate","bitrate"),new s(y,"qos.startupTime","startupTime")]),this._pluginManager.registerBehaviour(new a(y,Z),this,"handleTrackError"),this._pluginManager.registerBehaviour(new a(S,te),this,"handleClockReportingTick",[new s(y,"video.playhead","playhead"),new s(y,"qos.fps","fps"),new s(y,"qos.droppedFrames","droppedFrames"),new s(y,"qos.bitrate","bitrate"),new s(y,"qos.startupTime","startupTime")]),this._pluginManager.registerBehaviour(new a(y,F),this,"handleClockReportingTick",[new s(y,"video.playhead","playhead"),new s(y,"qos.fps","fps"),new s(y,"qos.droppedFrames","droppedFrames"),new s(y,"qos.bitrate","bitrate"),new s(y,"qos.startupTime","startupTime")]),this._pluginManager.registerBehaviour(new a(S,ie),this,"handleIdleTick",[new s(y,"video.playhead","playhead")]),this._pluginManager.registerBehaviour(new a(m,ee),this,"handleClockReportingTick",[new s(y,"video.playhead","playhead"),new s(y,"qos.fps","fps"),new s(y,"qos.droppedFrames","droppedFrames"),new s(y,"qos.bitrate","bitrate"),new s(y,"qos.startupTime","startupTime")]),this._pluginManager.registerBehaviour(new a(v,M),this,"handleAnalyticsError"),this._pluginManager.registerBehaviour(new a(v,A),this,"handleAnalyticsStart",[new s(v,"vid","vid"),new s(v,"aid","aid"),new s(v,"mid","mid"),new s(v,"customerIDs","customerIDs"),new s(v,"visitorOptedOut","visitorOptedOut"),new s(v,"blob","blob"),new s(v,"loc_hint","loc_hint"),new s(y,"video.playhead","playhead"),new s(y,"qos.fps","fps"),new s(y,"qos.droppedFrames","droppedFrames"),new s(y,"qos.bitrate","bitrate"),new s(y,"qos.startupTime","startupTime")]),this._pluginManager.registerBehaviour(new a(v,C),this,"handleAnalyticsAdStart",[new s(y,"video.playhead","playhead"),new s(y,"qos.fps","fps"),new s(y,"qos.droppedFrames","droppedFrames"),new s(y,"qos.bitrate","bitrate"),new s(y,"qos.startupTime","startupTime")])},n.prototype._setupDataResolver=function(){var e={},t=this;e.version=function(){return u.getVersion()},e.api_level=function(){return u.getApiLevel()},e.tracking_server=function(){return t._config?t._config.trackingServer:null},e.publisher=function(){return t._config?t._config.publisher:null},e.quiet_mode=function(){return!!t._config&&t._config.quietMode},e.ovp=function(){return t._config?t._config.ovp:null},e.sdk=function(){return t._config?t._config.sdk:null},e.is_primetime=function(){return!!t._config&&t._config.__isPrimetime},e.psdk_version=function(){return t._config?t._config.__psdkVersion:null},e.session_id=function(){return t._channel.request(E)},this._dataResolver=function(t){if(!t||0==t.length)return null;for(var i=null,n=0;n<t.length;n++){var r=t[n];(i=i||{})[r]=e.hasOwnProperty(r)?e[r].call(this):null}return i}},n.prototype._resumePlaybackIfPossible=function(e){this._errorInfo||this._isPaused||this._isSeeking||this._isBuffering||(this._isVideoIdle?(this._isVideoIdle=!1,this._resumePlaybackFromIdle()):this._channel.trigger(new r(Pe,e)),this._runIdleTimer(!1))},n.prototype._resumePlaybackFromIdle=function(){this._trigger(ee),this._filter.clear(),this._channel.trigger(new r(w)),this._trigger($),this._runReportingTimer(!0),this._runFlushFilterTimer(!0)};var _="adobe-heartbeat",m=_,v="adobe-analytics",y="player",b="nielsen",S="service.clock",E="session_id",w="reset_session_id",T="heartbeat-channel",M="error",A="aa_start",C="sc_ad_start",x="video_load",I="video_unload",P="video_session_end",L="video_start",D="video_resume",R="video_complete",k="video_skip",O="play",N="pause",F="content_start",V="adbreak_start",B="adbreak_complete",U="ad_start",H="ad_complete",G="ad_skip",j="buffer_start",z="buffer_complete",W="seek_start",Y="seek_complete",K="chapter_start",q="chapter_complete",X="chapter_skip",Q="bitrate_change",Z="track_error",J="video_idle_start",$="video_idle_resume",ee="quantum_close",te="heartbeat.reporting.tick",ie="heartbeat.idle.tick",ne="reset",re="source",ae="error_id",oe="tracking_server",se="check_status_server",le="publisher",ce="quiet_mode",ue="ssl",he="visitor_opt_out",de="tracking_disabled",pe="net:check_status_complete",fe="api:aa_start",ge="api:aa_ad_start",_e="api:config",me="api:update_visitor_optout",ve="api:video_load",ye="api:video_unload",be="api:video_start",Se="api:video_complete",Ee="api:video_skip",we="api:video_resume",Te="api:video_session_end",Me="api:adbreak_start",Ae="api:adbreak_complete",Ce="api:ad_start",xe="api:ad_complete",Ie="api:ad_skip",Pe="api:play",Le="api:pause",De="api:buffer_start",Re="api:chapter_start",ke="api:chapter_complete",Oe="api:chapter_skip",Ne="api:track_error",Fe="api:track_internal_error",Ve="api:bitrate_change",Be="api:quantum_end",Ue="sourceErrorHeartbeat",He="clock:check_status.resume",Ge="clock:reporting.resume",je="clock:reporting.pause",ze="clock:flush_filter.resume",We="clock:flush_filter.pause",Ye="clock:idle.resume",Ke="clock:idle.pause",qe="clock:check_status.get_settings";i.AdobeHeartbeatPlugin=n}(e.ADB.core,e.ADB.va,t),e.ADB.va.plugins.ah||(e.ADB.va.plugins.ah=t)}(this),function(e){if(void 0===t)var t={};!function(e,t){"use strict";function i(e,t){this._onFail={fn:e,ctx:t}}var n=e.ErrorInfo;i.prototype.validateFields=function(e,t){if(!e)return this._fail("Data cannot be null");if(t)for(var i=0;i<t.length;i++){var n=t[i];switch(n){case"videoId":if(!e.hasOwnProperty("videoId"))return this._fail("The ID for the main video must be specified.");if("string"!=typeof e.videoId)return this._fail("The ID for the main video must be a String.");if(""===e.videoId)return this._fail("The ID for the main video cannot be an empty string.");break;case"mediaType":if(!e.hasOwnProperty("mediaType"))return this._fail("The media type for the main video must be specified.");if("string"!=typeof e.mediaType)return this._fail("The media type for the main video must be a String.");if(""===e.mediaType)return this._fail("The stream type for the main video cannot be an empty string.");break;case"streamType":if(!e.hasOwnProperty("streamType"))return this._fail("The stream type for the main video must be specified.");if("string"!=typeof e.streamType)return this._fail("The stream type for the main video must be a String.");if(""===e.streamType)return this._fail("The stream type for the main video cannot be an empty string.");break;case"playerName":if(!e.hasOwnProperty("playerName"))return this._fail("The player name for the main video must be specified.");if("string"!=typeof e.playerName)return this._fail("The player name for the main video must be a String.");if(""===e.playerName)return this._fail("The player name for the main video cannot be an empty string.");break;case"videoLength":if(!e.hasOwnProperty("videoLength"))return this._fail("The length of the main video must be specified.");if("number"!=typeof e.videoLength)return this._fail("The length of the main video must be a Number.");if(isNaN(e.videoLength))return this._fail("The length of the main video cannot be NaN.");break;case"podPlayerName":if(!e.hasOwnProperty("podPlayerName"))return this._fail("The player name for the ad-break must be specified.");if("string"!=typeof e.podPlayerName)return this._fail("The player name for the ad-break must be a String.");if(""===e.podPlayerName)return this._fail("The player name for the ad-break cannot be an empty string.");break;case"podPosition":if(!e.hasOwnProperty("podPosition"))return this._fail("Position (index) of the ad-break must be specified.");if("number"!=typeof e.podPosition)return this._fail("Position (index) of the ad-break must be a Number.");if(isNaN(e.podPosition))return this._fail("Position (index) of the ad-break cannot be NaN.");break;case"adId":if(!e.hasOwnProperty("adId"))return this._fail("The ad ID must be specified.");if("string"!=typeof e.adId)return this._fail("The ad ID must be a String.");if(""===e.adId)return this._fail("The ad ID cannot be an empty string.");break;case"adPosition":if(!e.hasOwnProperty("adPosition"))return this._fail("Position (index) of the ad must be specified.");if("number"!=typeof e.adPosition)return this._fail("Position (index) of the ad must be a Number.");if(isNaN(e.adPosition))return this._fail("Position (index) of the ad cannot be NaN.");break;case"adLength":if(!e.hasOwnProperty("adLength"))return this._fail("The length of the ad must be specified.");if("number"!=typeof e.adLength)return this._fail("The length of the ad must be a Number.");if(isNaN(e.adLength))return this._fail("The length of the ad cannot be NaN.");break;default:return this._fail("Unable to validate unknown parameter: "+n)}}return!0},i.prototype._fail=function(e){var t=new n("Invalid input data",e);return this._onFail.fn&&this._onFail.fn.call(this._onFail.ctx,t),!1},t.InputDataValidator=i}(e.ADB.va,t),function(e){"use strict";var t="";e.AdobeAnalyticsPluginConfig=function(){this.channel=t,this.debugLogging=!1}}(t),function(e){"use strict";function t(){}t.prototype.onError=function(e){},e.AdobeAnalyticsPluginDelegate=t}(t),function(e,t,i,n){"use strict";function r(e,t){if(r.__super__.constructor.call(this,m),!e)throw new Error("The reference to the AppMeasurement object cannot be NULL.");if(e.unsupportedBrowser)throw new Error("AppMeasurement is not supported in current browser.");this._appMeasurement=e,this._delegate=t,this._videoMetadata={},this._adMetadata={},this._chapterMetadata={},this._errorInfo=null,this._workQueue=new u(!0,E),this._inputDataValidator=new _((function(e){this._errorInfo=e,this._logger.error(this._logTag,e.getMessage()+" | "+e.getDetails());var t=this;setTimeout((function(){t._trigger(w,e),t._delegate&&t._delegate.onError(t._errorInfo)}),0)}),this),this._appMeasurement.isReadyToTrack(),this._setupDataResolver()}var a=e.Trigger,o=e.plugin.BasePlugin,s=e.plugin.ParamMapping,l=e.radio.Channel,c=e.radio.Command,u=e.radio.CommandQueue,h=t.ErrorInfo,d=i.md5,p=i.StringUtils,f=i.ObjectUtils,g=n.AdobeAnalyticsPluginConfig,_=n.InputDataValidator;e.extend(r,o),r.prototype.configure=function(e){if(!e)throw new Error("Reference to the configuration data cannot be NULL.");if(!(e instanceof g))throw new Error("Expected config data to be instance of AdobeAnalyticsPluginConfig.");this._config=e,this._config.debugLogging?this._logger.enable():this._logger.disable(),this._logger.debug(this._logTag,"#configure({trackingServer="+this._config.debugLogging+", channel="+this._config.channel+", ssl="+this._appMeasurement.ssl+"})")},r.prototype.bootstrap=function(e){r.__super__.bootstrap.call(this,e),this._registerCommands(),this._registerBehaviours()},r.prototype.setup=function(){this._appMeasurement.isReadyToTrack()?this._onAppMeasurementReady():this._appMeasurement.callbackWhenReadyToTrack(this,this._onAppMeasurementReady,[]),r.__super__.setup.call(this)},r.prototype.setVideoMetadata=function(e){this._videoMetadata=f.clone(e)},r.prototype.setAdMetadata=function(e){this._adMetadata=f.clone(e)},r.prototype.setChapterMetadata=function(e){this._chapterMetadata=f.clone(e)},r.prototype._canProcess=function(){return this._errorInfo?(this._logger.error(this._logTag,"#_canProcess() > In ERROR state."),!1):r.__super__._canProcess.call(this)},r.prototype._cmdVideoLoad=function(e){this._errorInfo=null},r.prototype._cmdVideoStart=function(e){this._logger.debug(this._logTag,"#_cmdVideoStart()"),this._canProcess()&&this._workQueue.addCommand(new c(this._executeOpen,this,[e]))},r.prototype._cmdAdStart=function(e){this._logger.debug(this._logTag,"#_cmdAdStart()"),this._canProcess()&&this._workQueue.addCommand(new c(this._executeOpenAd,this,[e]))},r.prototype._cmdHeartbeatPluginError=function(e){this._errorInfo||(this._errorInfo=new h("Internal error","HeartbeatPlugin is in ERROR state."),this._trigger(w,this._errorInfo),this._delegate&&this._delegate.onError(this._errorInfo))},r.prototype._track=function(e){try{if(!this._appMeasurement.visitorOptedOut){var t=this._appMeasurement.linkTrackVars;this._appMeasurement.linkTrackVars="",this._appMeasurement.track(e),this._appMeasurement.linkTrackVars=t}}catch(e){this._logger.warn(this._logTag,"appMeasurement.track() call threw an exception.")}},r.prototype._executeOpen=function(e){if(this._logger.debug(this._logTag,"#_executeOpen(id="+e.videoId+", videoName="+e.videoName+", mediaType="+e.mediaType+", streamType="+e.streamType+", length="+e.videoLength+", playerName="+e.playerName+", channel="+e.channel+", isPrimetime="+e.isPrimetime+", sessionId="+e.sessionId+")"),this._canProcess()&&this._inputDataValidator.validateFields(e,["videoId","mediaType","streamType","videoLength","playerName"])){var t={};for(var i in e.metaVideo)e.metaVideo.hasOwnProperty(i)&&(t[i]=e.metaVideo[i]);if(e.metaNielsen)for(var i in e.metaNielsen)e.metaNielsen.hasOwnProperty(i)&&(t[i]=e.metaNielsen[i]);t["a.contentType"]=e.streamType,t["a.media.name"]=e.videoId,t["a.media.friendlyName"]=e.videoName||"",t["a.media.length"]=Math.floor(e.videoLength)||"0",t["a.media.playerName"]=e.playerName,t["a.media.channel"]=e.channel||"",t["a.media.view"]=!0,t["a.media.vsid"]=e.sessionId;var n={};n.contextData=t,"audio"===e.mediaType?(n.pev3=A,n.ms_a="1"):n.pev3=T,n.pe=e.isPrimetime?I:x,this._track(n);var r=this;setTimeout((function(){r._trigger(D,e)}),0)}},r.prototype._executeOpenAd=function(e){var t=d(e.videoId)+"_"+e.podPosition;if(this._logger.debug(this._logTag,"#_executeOpenAd(id="+e.adId+", mediaType="+e.mediaType+", streamType="+e.streamType+", length="+e.adLength+", podPlayerName="+e.podPlayerName+", parentId="+e.videoId+", podId="+t+", parentPodPosition="+e.adPosition+", podSecond="+e.podSecond+")"),this._canProcess()&&this._inputDataValidator.validateFields(e,["videoId","mediaType","streamType","playerName","adId","adLength","podPlayerName","adPosition"])){e.podSecond=null==e.podSecond||isNaN(e.podSecond)?e.playhead:e.podSecond;var i={};for(n in e.metaVideo)e.metaVideo.hasOwnProperty(n)&&(i[n]=e.metaVideo[n]);for(n in e.metaAd)e.metaAd.hasOwnProperty(n)&&(i[n]=e.metaAd[n]);if(e.metaNielsen)for(var n in e.metaNielsen)e.metaNielsen.hasOwnProperty(n)&&(i[n]=e.metaNielsen[n]);i["a.contentType"]=e.streamType,i["a.media.name"]=e.videoId,i["a.media.playerName"]=e.playerName,i["a.media.channel"]=e.channel||"",i["a.media.vsid"]=e.sessionId,i["a.media.friendlyName"]=e.videoName||"",i["a.media.length"]=Math.floor(e.videoLength)||"0",i["a.media.ad.name"]=e.adId,i["a.media.ad.friendlyName"]=e.adName||"",i["a.media.ad.podFriendlyName"]=e.podName||"",i["a.media.ad.length"]=Math.floor(e.adLength)||"0",i["a.media.ad.playerName"]=e.podPlayerName,i["a.media.ad.pod"]=t,i["a.media.ad.podPosition"]=Math.floor(e.adPosition)||"0",i["a.media.ad.podSecond"]=Math.floor(e.podSecond)||"0",i["a.media.ad.view"]=!0;var r={};r.contextData=i,"audio"===e.mediaType?(r.pev3=C,r.ms_a="1"):r.pev3=M,r.pe=e.isPrimetime?L:P,this._track(r);var a=this;setTimeout((function(){a._trigger(R,e)}),0)}},r.prototype._setupDataResolver=function(){var e={},t=this;e.rsid=function(){return t._appMeasurement.account},e.tracking_server=function(){return t._appMeasurement.ssl&&t._appMeasurement.trackingServerSecure?t._appMeasurement.trackingServerSecure:t._appMeasurement.trackingServer},e.ssl=function(){return t._appMeasurement.ssl},e.vid=function(){return t._appMeasurement.visitorID},e.aid=function(){return t._appMeasurement.analyticsVisitorID},e.mid=function(){return t._appMeasurement.marketingCloudVisitorID},e.blob=function(){return t._appMeasurement.audienceManagerBlob},e.loc_hint=function(){return t._appMeasurement.audienceManagerLocationHint?parseInt(t._appMeasurement.audienceManagerLocationHint):""},e.customerIDs=function(){var e={},i=t._appMeasurement.visitor.getCustomerIDs();for(var n in i)if(i.hasOwnProperty(n)){var r=i[n];if("object"==typeof r){for(var a in r)r.hasOwnProperty(a)&&("authState"==a?e[n+".as"]=r[a]:e[n+"."+a]=r[a]);e[n+".as"]||(e[n+".as"]="0")}}return e},e.visitorOptedOut=function(){return!!t._appMeasurement.visitorOptedOut},e.channel=function(){return t._config?t._config.channel:null},e.meta=function(e){var i=e.split(".");if(i.length<2)return null;var n=i.shift();switch(e=i.join("."),n){case"video":return e==l.WILDCARD?t._videoMetadata:t._videoMetadata[e];case"ad":return e==l.WILDCARD?t._adMetadata:t._adMetadata[e];case"chapter":return e==l.WILDCARD?t._chapterMetadata:t._chapterMetadata[e];default:return null}},this._dataResolver=function(t){if(!t||0==t.length)return null;for(var i=null,n=0;n<t.length;n++){var r=t[n];i=i||{},p.startsWith(r,"meta.")?i[r]=e.meta(r.split("meta.")[1]):i[r]=e.hasOwnProperty(r)?e[r].call(this):null}return i}},r.prototype._registerCommands=function(){this._pluginManager.comply(this,"handleVideoLoad",this._cmdVideoLoad),this._pluginManager.comply(this,"handleVideoStart",this._cmdVideoStart),this._pluginManager.comply(this,"handleAdStart",this._cmdAdStart),this._pluginManager.comply(this,"handleHeartbeatPluginError",this._cmdHeartbeatPluginError)},r.prototype._registerBehaviours=function(){this._pluginManager.registerBehaviour(new a(b,k),this,"handleVideoLoad"),this._pluginManager.registerBehaviour(new a(b,O),this,"handleVideoStart",[new s(b,"video.id","videoId"),new s(b,"video.mediaType","mediaType"),new s(b,"video.streamType","streamType"),new s(b,"video.name","videoName"),new s(b,"video.length","videoLength"),new s(b,"video.playerName","playerName"),new s(b,"video.streamType","streamType"),new s(S,"is_primetime","isPrimetime"),new s(S,"session_id","sessionId"),new s(v,"channel","channel"),new s(v,"meta.video.*","metaVideo"),new s(y,"meta","metaNielsen")]),this._pluginManager.registerBehaviour(new a(b,N),this,"handleAdStart",[new s(b,"video.id","videoId"),new s(b,"video.mediaType","mediaType"),new s(b,"video.streamType","streamType"),new s(b,"video.playhead","playhead"),new s(b,"video.playerName","playerName"),new s(b,"video.name","videoName"),new s(b,"video.length","videoLength"),new s(b,"ad.id","adId"),new s(b,"ad.length","adLength"),new s(b,"ad.position","adPosition"),new s(b,"ad.name","adName"),new s(b,"pod.name","podName"),new s(b,"pod.position","podPosition"),new s(b,"pod.playerName","podPlayerName"),new s(b,"pod.startTime","podSecond"),new s(S,"is_primetime","isPrimetime"),new s(S,"session_id","sessionId"),new s(v,"channel","channel"),new s(v,"meta.video.*","metaVideo"),new s(v,"meta.ad.*","metaAd"),new s(y,"meta","metaNielsen")]),this._pluginManager.registerBehaviour(new a(S,w),this,"handleHeartbeatPluginError")},r.prototype._onAppMeasurementReady=function(){this._logger.debug(this._logTag,"[Init] #_onAppMeasurementReady"),this._workQueue.resume()};var m="adobe-analytics",v=m,y="nielsen",b="player",S="adobe-heartbeat",E=2e3,w="error",T="video",M="videoAd",A="audio",C="audioAd",x="ms_s",I="msp_s",P="msa_s",L="mspa_s",D="aa_start",R="sc_ad_start",k="video_load",O="video_start",N="ad_start";n.AdobeAnalyticsPlugin=r}(e.ADB.core,e.ADB.va,e.ADB.va.utils,t),function(e){"use strict";e.VideoMetadataKeys={SHOW:"a.media.show",SEASON:"a.media.season",EPISODE:"a.media.episode",ASSET_ID:"a.media.asset",GENRE:"a.media.genre",FIRST_AIR_DATE:"a.media.airDate",FIRST_DIGITAL_DATE:"a.media.digitalDate",RATING:"a.media.rating",ORIGINATOR:"a.media.originator",NETWORK:"a.media.network",SHOW_TYPE:"a.media.type",AD_LOAD:"a.media.adLoad",MVPD:"a.media.pass.mvpd",AUTHORIZED:"a.media.pass.auth",DAY_PART:"a.media.dayPart",FEED:"a.media.feed",STREAM_FORMAT:"a.media.format"},e.AudioMetadataKeys={ARTIST:"a.media.artist",ALBUM:"a.media.album",LABEL:"a.media.label",AUTHOR:"a.media.author",STATION:"a.media.station",PUBLISHER:"a.media.publisher"},e.AdMetadataKeys={ADVERTISER:"a.media.ad.advertiser",CAMPAIGN_ID:"a.media.ad.campaign",CREATIVE_ID:"a.media.ad.creative",PLACEMENT_ID:"a.media.ad.placement",SITE_ID:"a.media.ad.site",CREATIVE_URL:"a.media.ad.creativeURL"}}(t),e.ADB.va.plugins.aa||(e.ADB.va.plugins.aa=t)}(this),function(e,t){"use strict";function i(){this._processAction=!0,this._store={}}function n(e){if(!e)throw new Error("Reference to the logger object cannot be NULL");this._logger=e,this._rules=[]}i.prototype.setRuleName=function(e){this._ruleName=e},i.prototype.getRuleName=function(e,t){return this._ruleName},i.prototype.setData=function(e,t){this._store[e]=t},i.prototype.getData=function(e){return this._store[e]},i.prototype.shouldProcessAction=function(){return this._processAction},i.prototype.stopProcessingAction=function(){this._processAction=!1},i.prototype.startProcessingAction=function(){this._processAction=!0},n.createContext=function(){return new i},n.createPredicate=function(e,t,i){return{fn:e,expectedValue:t,msg:i}},n.prototype.registerRule=function(e,t,i,n,r){this._rules.push({name:e,desc:t,preconditions:i,actions:n,scope:r})},n.prototype.registerEnterExitAction=function(e,t){this._enterAction=e,this._exitAction=t},n.prototype._handleFailure=function(e,t){this._logger.error(r,e.desc+" -  "+t.msg)},n.prototype._getRule=function(e){for(var t=0;t<this._rules.length;++t)if(this._rules[t].name===e)return this._rules[t];return null},n.prototype.processRule=function(e,t){var i=!0,a=this._getRule(e);if(a){var o=a.scope;t||(t=n.createContext()),t.setRuleName(e);for(var s=!1,l=0;l<a.preconditions.length;++l){var c=a.preconditions[l];if(s=!!c.fn.call(o,t)!==c.expectedValue){this._handleFailure(a,c);break}}if(s)i=!1;else{for(t.startProcessingAction(),this._enterAction&&this._enterAction.call(o,t),l=0;l<a.actions.length;++l){var u=a.actions[l];if(!t.shouldProcessAction()){this._logger.info(r,"Stopping actions for "+a.desc);break}u.call(o,t)}this._exitAction&&t.shouldProcessAction()&&this._exitAction.call(o,t)}}else this._logger.warn(r,"No registered event found for ruleName "+e),i=!1;return i};var r="RuleEngine";t._RuleEngine=n}((e=this).ADB.core,e.ADB.va),function(e,t){"use strict";function i(e,t,i){this.taskFn=e,this.scope=t,this.interval=i,this.remainingInterval=i}function n(e){if(!e)throw new Error("Reference to the logger object cannot be NULL");this._logger=e,this._tasks=[],this._pausedTasks=[]}i.prototype.elapsedTime=function(e){this.remainingInterval-=e},i.prototype.shouldExecute=function(){return this.remainingInterval<=0},i.prototype.execute=function(){this.taskFn.call(this.scope)},n.prototype._getCurrentTimeInMS=function(){return(new Date).getTime()},n.prototype._runTasksForTime=function(e){var t=[],i=e-this._lastTickTime;this._lastTickTime=e;for(var n=0;n<this._tasks.length;){var r=this._tasks[n];r.elapsedTime(i),r.shouldExecute()?(t.push(r),this._tasks.splice(n,1)):++n}for(this._checkStopTimer(),n=0;n<t.length;++n)t[n].execute()},n.prototype._onTick=function(){var e=this._getCurrentTimeInMS();this._runTasksForTime(e)},n.prototype._startTimer=function(){var e=this;this._timer||(this._logger.info(r,"#startTimer()"),e._lastTickTime=this._getCurrentTimeInMS(),this._timer=window.setInterval((function(){e._onTick()}),a))},n.prototype._stopTimer=function(){this._timer&&(this._logger.info(r,"#stopTimer()"),window.clearInterval(this._timer),this._timer=null)},n.prototype._checkStartTimer=function(){this._tasks.length>0&&this._startTimer()},n.prototype._checkStopTimer=function(){0===this._tasks.length&&this._stopTimer()},n.prototype._removeTask=function(e,t){for(var i=0;i<e.length;++i)if(e[i]===t)return e.splice(i,1),!0;return!1},n.prototype.scheduleTask=function(e,t,n){if(this._logger.info(r,"#scheduleTask()"),!e)throw new Error("Reference to the taskFn cannot be NULL");var a=new i(e,t,n);return this._tasks.push(a),this._checkStartTimer(),a},n.prototype.cancelTask=function(e){this._logger.info(r,"#cancelTask()"),this._removeTask(this._tasks,e),this._checkStopTimer()},n.prototype.pauseTask=function(e){this._logger.info(r,"#pauseTask()"),this._removeTask(this._tasks,e)&&this._pausedTasks.push(e),this._checkStopTimer()},n.prototype.resumeTask=function(e){this._logger.info(r,"#resumeTask()"),this._removeTask(this._pausedTasks,e)&&this._tasks.push(e),this._checkStartTimer()},n.prototype.clearTasks=function(){this._stopTimer(),this._tasks=[],this._pausedTasks=[]};var r="TaskScheduler",a=250;t._TaskScheduler=n}(e.ADB.core,e.ADB.va),function(e){"use strict";function t(){this.trackingServer=void 0,this.channel=void 0,this.ovp=void 0,this.appVersion=void 0,this.playerName=void 0,this.ssl=!1,this.debugLogging=!1}e.MediaHeartbeatConfig=t,e.MediaHeartbeatConfig.sharedInstance=new t}(e.ADB.va),function(e){"use strict";function t(){this.data={}}var i=e.plugins.videoplayer.VideoInfo,n=e.plugins.videoplayer.AdBreakInfo,r=e.plugins.videoplayer.AdInfo,a=e.plugins.videoplayer.ChapterInfo,o=e.plugins.videoplayer.QoSInfo;t.MEDIAINFO_KEY_NAME="a.name",t.MEDIAINFO_KEY_VIDEOID="a.videoId",t.MEDIAINFO_KEY_ADID="a.adId",t.MEDIAINFO_KEY_LENGTH="a.length",t.MEDIAINFO_KEY_PLAYHEAD="a.playhead",t.MEDIAINFO_KEY_MEDIATYPE="a.mediaType",t.MEDIAINFO_KEY_STREAMTYPE="a.streamType",t.MEDIAINFO_KEY_POSITION="a.position",t.MEDIAINFO_KEY_STARTTIME="a.startTime",t.MEDIAINFO_KEY_BITRATE="a.bitrate",t.MEDIAINFO_KEY_FPS="a.fps",t.MEDIAINFO_KEY_DROPPEDFRAMES="a.droppedFrames",t.MEDIAINFO_KEY_STARTUPTIME="a.startupTime",t.MEDIAINFO_KEY_TIMEDMETADATA="a.timedMetadata",t.prototype.setValue=function(e,t){this.data[e]=t},t.prototype.getValue=function(e){return this.data.hasOwnProperty(e)?this.data[e]:null},t.prototype.createVideoInfo=function(){var e=new i;return e.id=null!=this.getValue(t.MEDIAINFO_KEY_VIDEOID)?this.getValue(t.MEDIAINFO_KEY_VIDEOID):"",e.name=null!=this.getValue(t.MEDIAINFO_KEY_NAME)?this.getValue(t.MEDIAINFO_KEY_NAME):"",e.length=null!=this.getValue(t.MEDIAINFO_KEY_LENGTH)?this.getValue(t.MEDIAINFO_KEY_LENGTH):0,e.playhead=null!=this.getValue(t.MEDIAINFO_KEY_PLAYHEAD)?this.getValue(t.MEDIAINFO_KEY_PLAYHEAD):0,e.mediaType=null!=this.getValue(t.MEDIAINFO_KEY_MEDIATYPE)?this.getValue(t.MEDIAINFO_KEY_MEDIATYPE):"",e.streamType=null!=this.getValue(t.MEDIAINFO_KEY_STREAMTYPE)?this.getValue(t.MEDIAINFO_KEY_STREAMTYPE):"",e},t.prototype.createAdBreakInfo=function(){var e=new n;return e.name=null!=this.getValue(t.MEDIAINFO_KEY_NAME)?this.getValue(t.MEDIAINFO_KEY_NAME):"",e.position=null!=this.getValue(t.MEDIAINFO_KEY_POSITION)?this.getValue(t.MEDIAINFO_KEY_POSITION):0,e.startTime=null!=this.getValue(t.MEDIAINFO_KEY_STARTTIME)?this.getValue(t.MEDIAINFO_KEY_STARTTIME):0,e},t.prototype.createAdInfo=function(){var e=new r;return e.id=null!=this.getValue(t.MEDIAINFO_KEY_ADID)?this.getValue(t.MEDIAINFO_KEY_ADID):"",e.name=null!=this.getValue(t.MEDIAINFO_KEY_NAME)?this.getValue(t.MEDIAINFO_KEY_NAME):"",e.length=null!=this.getValue(t.MEDIAINFO_KEY_LENGTH)?this.getValue(t.MEDIAINFO_KEY_LENGTH):0,e.position=null!=this.getValue(t.MEDIAINFO_KEY_POSITION)?this.getValue(t.MEDIAINFO_KEY_POSITION):0,e},t.prototype.createChapterInfo=function(){var e=new a;return e.name=null!=this.getValue(t.MEDIAINFO_KEY_NAME)?this.getValue(t.MEDIAINFO_KEY_NAME):"",e.length=null!=this.getValue(t.MEDIAINFO_KEY_LENGTH)?this.getValue(t.MEDIAINFO_KEY_LENGTH):0,e.startTime=null!=this.getValue(t.MEDIAINFO_KEY_STARTTIME)?this.getValue(t.MEDIAINFO_KEY_STARTTIME):0,e.position=null!=this.getValue(t.MEDIAINFO_KEY_POSITION)?this.getValue(t.MEDIAINFO_KEY_POSITION):0,e},t.prototype.createQoSInfo=function(){var e=new o;return e.bitrate=null!=this.getValue(t.MEDIAINFO_KEY_BITRATE)?this.getValue(t.MEDIAINFO_KEY_BITRATE):0,e.fps=null!=this.getValue(t.MEDIAINFO_KEY_FPS)?this.getValue(t.MEDIAINFO_KEY_FPS):0,e.droppedFrames=null!=this.getValue(t.MEDIAINFO_KEY_DROPPEDFRAMES)?this.getValue(t.MEDIAINFO_KEY_DROPPEDFRAMES):0,e.startupTime=null!=this.getValue(t.MEDIAINFO_KEY_STARTUPTIME)?this.getValue(t.MEDIAINFO_KEY_STARTUPTIME):0,e},t.prototype.isEqual=function(e){if(this===e)return!0;if(!e||"object"!=typeof e||"function"!=typeof e.getValue)return!1;for(var i=[t.MEDIAINFO_KEY_NAME,t.MEDIAINFO_KEY_VIDEOID,t.MEDIAINFO_KEY_ADID,t.MEDIAINFO_KEY_LENGTH,t.MEDIAINFO_KEY_PLAYHEAD,t.MEDIAINFO_KEY_STREAMTYPE,t.MEDIAINFO_KEY_MEDIATYPE,t.MEDIAINFO_KEY_POSITION,t.MEDIAINFO_KEY_STARTTIME,t.MEDIAINFO_KEY_BITRATE,t.MEDIAINFO_KEY_FPS,t.MEDIAINFO_KEY_DROPPEDFRAMES,t.MEDIAINFO_KEY_STARTUPTIME,t.MEDIAINFO_KEY_TIMEDMETADATA],n=0;n<i.length;++n){var r=i[n];if(this.getValue(r)!==e.getValue(r))return!1}return!0},e.MediaObject=t}(e.ADB.va),function(e,t){"use strict";function i(e){i.__super__.constructor.call(this),this._heartbeat=e}function n(e){n.__super__.constructor.call(this),this._heartbeat=e}function r(e){r.__super__.constructor.call(this),this._heartbeat=e}function a(e){a.__super__.constructor.call(this),this._heartbeat=e}e.extend(i,t.plugins.aa.AdobeAnalyticsPluginDelegate),i.prototype.onError=function(e){this._heartbeat&&this._heartbeat._onDelegateError(e)},e.extend(n,t.plugins.ah.AdobeHeartbeatPluginDelegate),n.prototype.onError=function(e){this._heartbeat&&this._heartbeat._onDelegateError(e)},n.prototype.onTrackingDisabled=function(){this._heartbeat&&this._heartbeat._disableHBTracking()},e.extend(r,t.HeartbeatDelegate),r.prototype.onError=function(e){this._heartbeat&&this._heartbeat._onDelegateError(e)},e.extend(a,t.plugins.videoplayer.VideoPlayerPluginDelegate),a.prototype.getVideoInfo=function(){return this._heartbeat&&this._heartbeat._videoInfo?(this._heartbeat._delegate&&(this._heartbeat._videoInfo.playhead=this._heartbeat._delegate.getCurrentPlaybackTime()),this._heartbeat._videoInfo):null},a.prototype.getAdBreakInfo=function(){return this._heartbeat&&this._heartbeat._adBreakInfo?this._heartbeat._adBreakInfo:null},a.prototype.getAdInfo=function(){return this._heartbeat&&this._heartbeat._adInfo?this._heartbeat._adInfo:null},a.prototype.getChapterInfo=function(){return this._heartbeat&&this._heartbeat._chapterInfo?this._heartbeat._chapterInfo:null},a.prototype.getQoSInfo=function(){if(this._heartbeat&&this._heartbeat._delegate&&this._heartbeat._delegate.getQoSObject()){var e=this._heartbeat._delegate.getQoSObject();if(e&&"object"==typeof e&&e.setValue)return e.createQoSInfo()}return null},t._MediaAnalyticsPluginDelegate=i,t._MediaHeartbeatPluginDelegate=n,t._ADBMediaHeartbeatDelegate=r,t._MediaHeartbeatVideoPlayerPluginDelegate=a}(e.ADB.core,e.ADB.va),function(e,t){"use strict";function i(e,n){i.__super__.constructor.call(this),this._heartbeat=e,this._logger=n,this._validator=new t.plugins.nielsen.MetadataValidator(n)}var n="MediaHeartbeatNielsenPluginDelegate",r={NielsenContentMetadata:"media_nielsen_content_metadata",NielsenChannelMetadata:"media_nielsen_channel_metadata",NielsenAdMetadata:"media_nielsen_ad_metadata"};t.plugins.nielsen&&e.extend(i,t.plugins.nielsen.NielsenPluginDelegate),i.prototype.getMetadataInfo=function(){if(this._heartbeat&&this._heartbeat._currentMediaObject){var e=this._heartbeat._currentMediaObject.getValue(r.NielsenContentMetadata);if(e&&"object"==typeof e)return this._validator.validateContentMetadata(e,"MediaHeartbeat.NielsenContentMetadataKeys"),e;this._logger.warn(n,"We expect a valid object for MediaHeartbeat.MediaObjectKey.NielsenContentMetadata in MediaObject")}return null},i.prototype.getAdMetadataInfo=function(){if(this._heartbeat&&this._heartbeat._currentAdObject){var e=this._heartbeat._currentAdObject.getValue(r.NielsenAdMetadata);if(e&&"object"==typeof e)return this._validator.validateAdMetadata(e,"MediaHeartbeat.NielsenAdMetadataKeys"),e;this._logger.warn(n,"We expect a valid object for MediaHeartbeat.MediaObjectKey.NielsenAdMetadata in MediaObject")}return null},i.prototype.getChannelInfo=function(){if(this._heartbeat&&this._heartbeat._currentMediaObject){var e=this._heartbeat._currentMediaObject.getValue(r.NielsenChannelMetadata);if(e&&"object"==typeof e)return this._validator.validateChannelMetadata(e,"MediaHeartbeat.NielsenChannelMetadataKeys"),e;this._logger.warn(n,"We expect a valid object for MediaHeartbeat.MediaObjectKey.NielsenChannelMetadata in MediaObject")}return null},i.prototype.onError=function(e){this._heartbeat&&this._heartbeat._onDelegateError(e)},t.plugins.nielsen&&(t._NielsenObjectKey=r,t._NielsenPluginDelegate=i)}(e.ADB.core,e.ADB.va),function(t,i){"use strict";function n(){}function r(t,n,r){if(this._appMeasurement=r||e.s,!this._appMeasurement)throw new Error("MediaHeartbeat needs a valid AppMeasurement instance.");if(!this._appMeasurement.visitor||!this._appMeasurement.visitor.marketingCloudOrgID)throw new Error("MediaHeartbeat needs a valid visitor instance with marketingCloudOrgId set.");if(!t)throw new Error("MediaHeartbeat needs a valid delegate object.");if(!n||"object"!=typeof n||!n.trackingServer)throw new Error("MediaHeartbeat needs a valid config object with trackingServer set.");this._config=n,this._delegate=t,this._debugLogging=i.MediaHeartbeat._debugLogging||this._config.debugLogging,this._logger=new a,this._debugLogging?this._logger.enable():this._logger.disable(),this._ruleEngine=new y(this._logger),this._taskScheduler=new b(this._logger),this._resetState(),this._setupRules()}var a=t.Logger,o=i.MediaObject,s=i.Heartbeat,l=i.HeartbeatConfig,c=i._ADBMediaHeartbeatDelegate,u=i.plugins.videoplayer.VideoPlayerPlugin,h=i.plugins.videoplayer.VideoPlayerPluginConfig,d=i._MediaHeartbeatVideoPlayerPluginDelegate,p=i.plugins.aa.AdobeAnalyticsPlugin,f=i.plugins.aa.AdobeAnalyticsPluginConfig,g=i._MediaAnalyticsPluginDelegate,_=i.plugins.ah.AdobeHeartbeatPlugin,m=i.plugins.ah.AdobeHeartbeatPluginConfig,v=i._MediaHeartbeatPluginDelegate,y=i._RuleEngine,b=i._TaskScheduler,S=i.utils.ObjectUtils,E=i.utils.VersionUtils;if(n.prototype.getCurrentPlaybackTime=function(){return null},n.prototype.getQoSObject=function(){return null},r.MediaType={Video:"video",Audio:"audio"},r.Event={AdBreakStart:"adBreakStart",AdBreakComplete:"adBreakComplete",AdStart:"adStart",AdComplete:"adComplete",AdSkip:"adSkip",ChapterStart:"chapterStart",ChapterComplete:"chapterComplete",ChapterSkip:"chapterSkip",SeekStart:"seekStart",SeekComplete:"seekComplete",BufferStart:"bufferStart",BufferComplete:"bufferComplete",BitrateChange:"bitrateChange",TimedMetadataUpdate:"timedMetadataUpdate"},r.StreamType={VOD:"vod",LIVE:"live",LINEAR:"linear",PODCAST:"podcast",AUDIOBOOK:"audiobook",AOD:"aod"},r.MediaObjectKey={StandardVideoMetadata:"media_standard_content_metadata",StandardMediaMetadata:"media_standard_content_metadata",StandardAdMetadata:"media_standard_ad_metadata",VideoResumed:"resumed",MediaResumed:"resumed",PrerollTrackingWaitingTime:"preroll_tracking_waiting_time"},r.VideoMetadataKeys=i.plugins.aa.VideoMetadataKeys,r.AudioMetadataKeys=i.plugins.aa.AudioMetadataKeys,r.AdMetadataKeys=i.plugins.aa.AdMetadataKeys,r.createMediaObject=function(e,t,i,n,a){var s=new o;s.setValue(o.MEDIAINFO_KEY_VIDEOID,t),s.setValue(o.MEDIAINFO_KEY_NAME,e),s.setValue(o.MEDIAINFO_KEY_LENGTH,i),s.setValue(o.MEDIAINFO_KEY_PLAYHEAD,0);var l=n||r.StreamType.VOD;return s.setValue(o.MEDIAINFO_KEY_STREAMTYPE,l),("string"!=typeof a||a!=r.MediaType.Video&&a!=r.MediaType.Audio)&&(a=r.MediaType.Video),s.setValue(o.MEDIAINFO_KEY_MEDIATYPE,a),s},r.createAdBreakObject=function(e,t,i){var n=new o;return n.setValue(o.MEDIAINFO_KEY_NAME,e),n.setValue(o.MEDIAINFO_KEY_POSITION,t),n.setValue(o.MEDIAINFO_KEY_STARTTIME,i),n},r.createAdObject=function(e,t,i,n){var r=new o;return r.setValue(o.MEDIAINFO_KEY_NAME,e),r.setValue(o.MEDIAINFO_KEY_ADID,t),r.setValue(o.MEDIAINFO_KEY_POSITION,i),r.setValue(o.MEDIAINFO_KEY_LENGTH,n),r},r.createChapterObject=function(e,t,i,n){var r=new o;return r.setValue(o.MEDIAINFO_KEY_NAME,e),r.setValue(o.MEDIAINFO_KEY_POSITION,t),r.setValue(o.MEDIAINFO_KEY_LENGTH,i),r.setValue(o.MEDIAINFO_KEY_STARTTIME,n),r},r.createQoSObject=function(e,t,i,n){var r=new o;return r.setValue(o.MEDIAINFO_KEY_BITRATE,e),r.setValue(o.MEDIAINFO_KEY_FPS,i),r.setValue(o.MEDIAINFO_KEY_DROPPEDFRAMES,n),r.setValue(o.MEDIAINFO_KEY_STARTUPTIME,t),r},r.createTimedMetadataObject=function(e){var t=new o;return t.setValue(o.MEDIAINFO_KEY_TIMEDMETADATA,e),t},r.version=function(){return i.Version.getVersion()},r.prototype.trackSessionStart=function(e,t){this._logger.info(x,"#::trackSessionStart()");var i=y.createContext();i.setData(I,e),i.setData(k,this._cleanContextData(t)),this._processRule(A.SessionStart,i)},r.prototype.trackPlay=function(){this._logger.info(x,"#::trackPlay()"),this._processRule(A.Play)},r.prototype.trackPause=function(){this._logger.info(x,"#::trackPause()"),this._processRule(A.Pause)},r.prototype.trackComplete=function(){this._logger.info(x,"#::trackComplete()"),this._processRule(A.VideoComplete)},r.prototype.trackSessionEnd=function(){this._logger.info(x,"#::trackSessionEnd()"),this._processRule(A.SessionEnd)},r.prototype.trackError=function(e){this._logger.info(x,"#::trackError()");var t=y.createContext();t.setData(O,e),this._processRule(A.Error,t)},r.prototype.trackEvent=function(e,t,i){this._logger.info(x,"#::trackEvent() - "+e);var n,a=y.createContext();switch(e){case r.Event.AdBreakStart:a.setData(P,t),a.setData(k,this._cleanContextData(i)),n=A.AdBreakStart;break;case r.Event.AdBreakComplete:n=A.AdBreakComplete;break;case r.Event.AdStart:a.setData(L,t),a.setData(k,this._cleanContextData(i)),n=A.AdStart;break;case r.Event.AdComplete:n=A.AdComplete;break;case r.Event.AdSkip:n=A.AdSkip;break;case r.Event.SeekStart:n=A.SeekStart;break;case r.Event.SeekComplete:n=A.SeekComplete;break;case r.Event.ChapterStart:a.setData(D,t),a.setData(k,this._cleanContextData(i)),n=A.ChapterStart;break;case r.Event.ChapterComplete:n=A.ChapterComplete;break;case r.Event.ChapterSkip:n=A.ChapterSkip;break;case r.Event.BufferStart:n=A.BufferStart;break;case r.Event.BufferComplete:n=A.BufferComplete;break;case r.Event.BitrateChange:n=A.BitrateChange;break;case r.Event.TimedMetadataUpdate:n=A.TimedMetadataUpdate,a.setData(R,t);break;default:return void this._logger.error(x,"Incorrect event name.")}this._processRule(n,a)},i.plugins.nielsen){var w=i.MediaHeartbeatConfig;w.prototype.nielsenConfigKey=void 0,w.prototype.nielsenAppInfo=void 0;var T=i._NielsenObjectKey;r.MediaObjectKey.NielsenContentMetadata=T.NielsenContentMetadata,r.MediaObjectKey.NielsenAdMetadata=T.NielsenAdMetadata,r.MediaObjectKey.NielsenChannelMetadata=T.NielsenChannelMetadata,r.NielsenContentMetadataKeys=i.plugins.nielsen.ContentMetadataKeys,r.NielsenChannelMetadataKeys=i.plugins.nielsen.ChannelMetadataKeys,r.NielsenAdMetadataKeys=i.plugins.nielsen.AdMetadataKeys,r.prototype.nielsenLoadMetadata=function(e){this._nielsenPlugin&&this._nielsenPlugin.loadMetadata(e)}}r.prototype._setState=function(e,t){this._mediaState[e]=t},r.prototype._isInState=function(e){return this._mediaState[e]},r.prototype._isTrackingDisabled=function(e){return this._mediaHeartbeatDisabled},r.prototype._isInSession=function(e){return this._isInState(M.Session)},r.prototype._isInMedia=function(e){return this._isInState(M.Media)},r.prototype._isInAd=function(e){return this._isInState(M.Ad)},r.prototype._isInAdBreak=function(e){return this._isInState(M.AdBreak)},r.prototype._isInChapter=function(e){return this._isInState(M.Chapter)},r.prototype._isInPlay=function(e){return this._isInState(M.PlayPause)},r.prototype._isInPause=function(e){return!this._isInState(M.PlayPause)},r.prototype._isInBuffer=function(e){return this._isInState(M.Buffer)},r.prototype._isInSeek=function(e){return this._isInState(M.Seek)},r.prototype._isPlatformTrackingSupported=function(e){return!this._appMeasurement.unsupportedBrowser},r.prototype._isAudioTrackingSupported=function(e){return e.getData(I).getValue(o.MEDIAINFO_KEY_MEDIATYPE)!==r.MediaType.Audio||E.isGreaterThanEqual(this._appMeasurement.version,"2.11.0")},r.prototype._isValidMediaObject=function(e){var t=e.getData(I);if(t&&t instanceof o){var i=t.getValue(r.MediaObjectKey.MediaResumed);null!=i&&"boolean"!=typeof i&&this._logger.warn(x,"Ignoring value set for MediaHeartbeat.MediaObjectKey.MediaResumed in MediaObject as we expect a boolean value");var n=t.getValue(r.MediaObjectKey.PrerollTrackingWaitingTime);null!=n&&(("string"==typeof n||"number"==typeof n)&&!isNaN(n)||this._logger.warn(x,"Ignoring value set for MediaHeartbeat.MediaObjectKey.PrerollTrackingWaitingTime in MediaObject as we expect a valid duration as number in milliseconds."));var a=t.getValue(r.MediaObjectKey.StandardMediaMetadata);return null!=a&&"object"!=typeof a&&this._logger.warn(x,"Ignoring value set for MediaHeartbeat.MediaObjectKey.StandardMediaMetadata in MediaObject as we expect a valid object with kv pairs."),!0}return!1},r.prototype._isValidAdBreakObject=function(e){var t=e.getData(P);return t&&t instanceof o},r.prototype._isDifferentAdBreakObject=function(e){var t=e.getData(P);return!(this._currentAdBreakObject&&this._currentAdBreakObject.isEqual(t))},r.prototype._isValidAdObject=function(e){var t=e.getData(L);if(t&&t instanceof o){var i=t.getValue(V);null!=i&&"boolean"!=typeof i&&this._logger.warn(x,"Ignoring value set for MediaHeartbeat.MediaObjectKey.GranularAdTracking in AdObject as we expect a boolean value.");var n=t.getValue(r.MediaObjectKey.StandardAdMetadata);return null!=n&&"object"!=typeof n&&this._logger.warn(x,"Ignoring value set for MediaHeartbeat.MediaObjectKey.StandardAdMetadata in AdObject as we expect a valid object with kv pairs."),!0}return!1},r.prototype._isDifferentAdObject=function(e){var t=e.getData(L);return!(this._currentAdObject&&this._currentAdObject.isEqual(t))},r.prototype._isValidChapterObject=function(e){var t=e.getData(D);return t&&t instanceof o},r.prototype._isDifferentChapterObject=function(e){var t=e.getData(D);return!(this._currentChapterObject&&this._currentChapterObject.isEqual(t))},r.prototype._isValidTimedMetadataObject=function(e){var t=e.getData(R);if(t&&t instanceof o){var i=t.getValue(o.MEDIAINFO_KEY_TIMEDMETADATA);return i&&"string"==typeof i}return!1},r.prototype._shouldAllowPlayerStateChange=function(e){return!(this._isInState(M.AdBreak)&&!this._isInState(M.Ad))},r.prototype._deferredTrackPlay=function(){this._prerollWaitEnabled&&(this._logger.info(x,"Executing deferred API:trackPlay."),this._prerollWaitEnabled=!1,this._playTaskHandle=null,this._processRule(A.Play))},r.prototype._cmdEnterAction=function(e){var t=e.getRuleName();if(this._prerollWaitEnabled)if(this._playReceived)switch(t){case A.SeekStart:case A.BufferStart:this._logger.info(x,"Cancelling scheduled API:trackPlay because of SeekStart/BufferStart event"),this._taskScheduler.cancelTask(this._playTaskHandle),this._playTaskHandle=null;break;case A.SeekComplete:case A.BufferComplete:this._logger.info(x,"Rescheduled API:trackPlay after SeekComplete/BufferComplete event"),this._playTaskHandle=this._taskScheduler.scheduleTask(this._deferredTrackPlay,this,this._prerollWaitTime);break;case A.Play:this._logger.info(x,"Dropping API:trackPlay as we already have a API:trackPlay scheduled."),e.stopProcessingAction();break;case A.Pause:this._logger.info(x,"Cancelling scheduled API:trackPlay because of API:trackPause call."),this._taskScheduler.cancelTask(this._playTaskHandle),this._playTaskHandle=null,this._prerollWaitEnabled=!1;break;case A.AdBreakStart:this._logger.info(x,"Received API:trackEvent(AdBreakStart) within "+this._prerollWaitTime+" ms after API:trackPlay. We will track this as preroll AdBreak."),this._taskScheduler.cancelTask(this._playTaskHandle),this._playTaskHandle=null,this._prerollWaitEnabled=!1,this._playAfterAdStart=!0}else switch(t){case A.Play:this._logger.info(x,"Deferring API:trackPlay for "+this._prerollWaitTime+" ms."),this._playReceived=!0,this._playTaskHandle=this._taskScheduler.scheduleTask(this._deferredTrackPlay,this,this._prerollWaitTime),e.stopProcessingAction();break;case A.AdBreakStart:this._logger.info(x,"Received trackEvent(AdBreakStart) before first trackPlay."),this._prerollWaitEnabled=!1}},r.prototype._cmdExitAction=function(e){var t=e.getRuleName();this._playAfterAdStart&&(t===A.AdStart?(this._cmdPlay(e),this._playAfterAdStart=!1):t===A.AdBreakComplete&&(this._playAfterAdStart=!1)),t!==A.AdStart||this._isInState(M.FPlayPause)||this._cmdPlay(e)},r.prototype._cmdConfigure=function(e){this._resetState(),this._configureAdobeAnalyticsPlugin(),this._configureAdobeHearbeatPlugin(),this._configureVideoPlayerPlugin(),this._configureOtherPlugins(),this._configureHeartbeat()},r.prototype._cmdSessionStart=function(e){var t=e.getData(I),i=e.getData(k);this._currentMediaObject=t,this._videoInfo=t.createVideoInfo(),this._videoInfo.playerName=this._config.playerName?this._config.playerName:"";var n=t.getValue(r.MediaObjectKey.StandardMediaMetadata);n&&"object"==typeof n||(n=null);var a=t.getValue(r.MediaObjectKey.MediaResumed);"boolean"==typeof a&&(this._videoInfo.resumed=a);var o=t.getValue(r.MediaObjectKey.PrerollTrackingWaitingTime);"string"!=typeof o&&"number"!=typeof o||isNaN(o)||(this._prerollWaitTime=Number(o),this._prerollWaitTime<=0&&(this._prerollWaitEnabled=!1));var s=this._prepareMetadata(n,i);s[N]=this._videoInfo.mediaType,this._aaPlugin.setVideoMetadata(s),this._playerPlugin.trackVideoLoad(),this._playerPlugin.trackSessionStart(),this._setState(M.Session,!0),this._setState(M.Media,!0)},r.prototype._cmdVideoEnd=function(e){var t=e.getRuleName()===A.VideoComplete;if(this._isInState(M.Media)){var i=this._heartbeat,n=this._playerPlugin;this._playerPlugin.trackComplete((function(){n&&n.trackVideoUnload(),i&&i.destroy()}),t)}this._setState(M.Media,!1)},r.prototype._cmdHandleMediaComplete=function(e){this._isInMedia(e)||(this._logger.info(x,"API:trackComplete has already cleaned up Heartbeat instance."),this._cmdSessionEnd(e),e.stopProcessingAction())},r.prototype._cmdSessionEnd=function(e){this._setState(M.Session,!1),this._resetState()},r.prototype._cmdDisableTracking=function(e){this._logger.info(x,"#_cmdDisableTracking: ADBMediaHeartbeat Tracking Disabled Remotely."),this._mediaHeartbeatDisabled=!0},r.prototype._cmdBufferStart=function(e){this._playerPlugin.trackBufferStart(),this._setState(M.Buffer,!0)},r.prototype._cmdBufferComplete=function(e){this._isInState(M.Buffer)&&this._playerPlugin.trackBufferComplete(),this._setState(M.Buffer,!1)},r.prototype._cmdSeekStart=function(e){this._playerPlugin.trackSeekStart(),this._setState(M.Seek,!0)},r.prototype._cmdSeekComplete=function(e){this._isInState(M.Seek)&&this._playerPlugin.trackSeekComplete(),this._setState(M.Seek,!1)},r.prototype._cmdPlay=function(e){this._playerPlugin.trackPlay(),this._setState(M.PlayPause,!0),this._setState(M.FPlayPause,!0)},r.prototype._cmdPause=function(e){this._playerPlugin.trackPause(),this._setState(M.PlayPause,!1),this._setState(M.FPlayPause,!0)},r.prototype._cmdAdBreakStart=function(e){var t=e.getData(P);this._currentAdBreakObject=t,this._adBreakInfo=t.createAdBreakInfo(),this._adBreakInfo.playerName=this._config.playerName?this._config.playerName:"",this._playerPlugin.trackAdBreakStart(),this._setState(M.AdBreak,!0)},r.prototype._cmdAdBreakComplete=function(e){this._currentAdBreakObject=null,this._adBreakInfo=null,this._isInState(M.AdBreak)&&this._playerPlugin.trackAdBreakComplete(),this._setState(M.AdBreak,!1)},r.prototype._cmdAdStart=function(e){var t=e.getData(L),i=e.getData(k);this._currentAdObject=t,this._adInfo=t.createAdInfo();var n=t.getValue(V);"boolean"==typeof n&&(this._adInfo.granularTracking=n);var a=t.getValue(r.MediaObjectKey.StandardAdMetadata);a&&"object"==typeof a||(a=null);var o=this._prepareMetadata(a,i);this._aaPlugin.setAdMetadata(o),this._playerPlugin.trackAdStart(),this._setState(M.Ad,!0)},r.prototype._cmdAdComplete=function(e){this._currentAdObject=null,this._adInfo=null,this._isInState(M.Ad)&&this._playerPlugin.trackAdComplete(),this._setState(M.Ad,!1)},r.prototype._cmdAdSkip=function(e){this._currentAdObject=null,this._adInfo=null,this._isInState(M.Ad)&&this._playerPlugin.trackAdSkip(),this._setState(M.Ad,!1)},r.prototype._cmdChapterStart=function(e){var t=e.getData(D),i=e.getData(k);this._currentChapterObject=t,this._chapterInfo=t.createChapterInfo();var n=this._prepareMetadata(null,i);this._aaPlugin.setChapterMetadata(n),this._playerPlugin.trackChapterStart(),this._setState(M.Chapter,!0)},r.prototype._cmdChapterComplete=function(e){this._currentChapterObject=null,this._chapterInfo=null,this._isInState(M.Chapter)&&this._playerPlugin.trackChapterComplete(),this._setState(M.Chapter,!1)},r.prototype._cmdChapterSkip=function(e){this._currentChapterObject=null,this._chapterInfo=null,this._isInState(M.Chapter)&&this._playerPlugin.trackChapterSkip(),this._setState(M.Chapter,!1)},r.prototype._cmdError=function(e){var t=e.getData(O);t||(t="unknown_error_id"),this._playerPlugin.trackVideoPlayerError(t)},r.prototype._cmdBitrate=function(e){this._playerPlugin.trackBitrateChange()},r.prototype._cmdTimedMetadataUpdate=function(e){var t=e.getData(R).getValue(o.MEDIAINFO_KEY_TIMEDMETADATA);this._playerPlugin.trackTimedMetadata(t)},r.prototype._processRule=function(e,t){return this._ruleEngine.processRule(e,t)},r.prototype._setupRules=function(){this._ruleEngine.registerEnterExitAction(this._cmdEnterAction,this._cmdExitAction),this._ruleEngine.registerRule(A.SessionStart,"API:trackSessionStart",[y.createPredicate(this._isPlatformTrackingSupported,!0,C.ErrUnSupportedPlatform),y.createPredicate(this._isTrackingDisabled,!1,C.ErrTrackingDisabled),y.createPredicate(this._isInSession,!1,C.ErrInSession),y.createPredicate(this._isValidMediaObject,!0,C.ErrInvalidMediaObject),y.createPredicate(this._isAudioTrackingSupported,!0,C.ErrAudioTrackingNotSupported)],[this._cmdConfigure,this._cmdSessionStart],this),this._ruleEngine.registerRule(A.SessionEnd,"API:trackSessionEnd",[y.createPredicate(this._isInSession,!0,C.ErrNotInSession)],[this._cmdHandleMediaComplete,this._cmdAdSkip,this._cmdAdBreakComplete,this._cmdChapterSkip,this._cmdVideoEnd,this._cmdSessionEnd],this),this._ruleEngine.registerRule(A.VideoComplete,"API:trackComplete",[y.createPredicate(this._isInSession,!0,C.ErrNotInSession),y.createPredicate(this._isInMedia,!0,C.ErrNotInMedia)],[this._cmdAdSkip,this._cmdAdBreakComplete,this._cmdChapterSkip,this._cmdVideoEnd],this),this._ruleEngine.registerRule(A.DisableTracking,"DisableTracking",[y.createPredicate(this._isTrackingDisabled,!1,C.ErrTrackingDisabled)],[this._cmdDisableTracking],this),this._ruleEngine.registerRule(A.Error,"API:trackError",[y.createPredicate(this._isInSession,!0,C.ErrNotInSession),y.createPredicate(this._isInMedia,!0,C.ErrNotInMedia)],[this._cmdError],this),this._ruleEngine.registerRule(A.Play,"API:trackPlay",[y.createPredicate(this._isInSession,!0,C.ErrNotInSession),y.createPredicate(this._isInMedia,!0,C.ErrNotInMedia),y.createPredicate(this._shouldAllowPlayerStateChange,!0,C.ErrInvalidPlayerState)],[this._cmdSeekComplete,this._cmdBufferComplete,this._cmdPlay],this),this._ruleEngine.registerRule(A.Pause,"API:trackPause",[y.createPredicate(this._isInSession,!0,C.ErrNotInSession),y.createPredicate(this._isInMedia,!0,C.ErrNotInMedia),y.createPredicate(this._shouldAllowPlayerStateChange,!0,C.ErrInvalidPlayerState),y.createPredicate(this._isInBuffer,!1,C.ErrInBuffer),y.createPredicate(this._isInSeek,!1,C.ErrInSeek)],[this._cmdPause],this),this._ruleEngine.registerRule(A.BufferStart,"API:trackEvent(BufferStart)",[y.createPredicate(this._isInSession,!0,C.ErrNotInSession),y.createPredicate(this._isInMedia,!0,C.ErrNotInMedia),y.createPredicate(this._shouldAllowPlayerStateChange,!0,C.ErrInvalidPlayerState),y.createPredicate(this._isInBuffer,!1,C.ErrInBuffer),y.createPredicate(this._isInSeek,!1,C.ErrInSeek)],[this._cmdBufferStart],this),this._ruleEngine.registerRule(A.BufferComplete,"API:trackEvent(BufferComplete)",[y.createPredicate(this._isInSession,!0,C.ErrNotInSession),y.createPredicate(this._isInMedia,!0,C.ErrNotInMedia),y.createPredicate(this._shouldAllowPlayerStateChange,!0,C.ErrInvalidPlayerState),y.createPredicate(this._isInBuffer,!0,C.ErrNotInBuffer)],[this._cmdBufferComplete],this),this._ruleEngine.registerRule(A.SeekStart,"API:trackEvent(SeekStart)",[y.createPredicate(this._isInSession,!0,C.ErrNotInSession),y.createPredicate(this._isInMedia,!0,C.ErrNotInMedia),y.createPredicate(this._shouldAllowPlayerStateChange,!0,C.ErrInvalidPlayerState),y.createPredicate(this._isInSeek,!1,C.ErrInSeek),y.createPredicate(this._isInBuffer,!1,C.ErrInBuffer)],[this._cmdSeekStart],this),this._ruleEngine.registerRule(A.SeekComplete,"API:trackEvent(SeekComplete)",[y.createPredicate(this._isInSession,!0,C.ErrNotInSession),y.createPredicate(this._isInMedia,!0,C.ErrNotInMedia),y.createPredicate(this._shouldAllowPlayerStateChange,!0,C.ErrInvalidPlayerState),y.createPredicate(this._isInSeek,!0,C.ErrNotInSeek)],[this._cmdSeekComplete],this),this._ruleEngine.registerRule(A.AdBreakStart,"API:trackEvent(AdBreakStart)",[y.createPredicate(this._isInSession,!0,C.ErrNotInSession),y.createPredicate(this._isInMedia,!0,C.ErrNotInMedia),y.createPredicate(this._isValidAdBreakObject,!0,C.ErrInvalidAdBreakObject),y.createPredicate(this._isDifferentAdBreakObject,!0,C.ErrDuplicateAdBreakObject)],[this._cmdAdSkip,this._cmdAdBreakComplete,this._cmdAdBreakStart],this),this._ruleEngine.registerRule(A.AdBreakComplete,"API:trackEvent(AdBreakComplete)",[y.createPredicate(this._isInSession,!0,C.ErrNotInSession),y.createPredicate(this._isInMedia,!0,C.ErrNotInMedia),y.createPredicate(this._isInAdBreak,!0,C.ErrNotInAdBreak)],[this._cmdAdSkip,this._cmdAdBreakComplete],this),this._ruleEngine.registerRule(A.AdStart,"API:trackEvent(AdStart)",[y.createPredicate(this._isInSession,!0,C.ErrNotInSession),y.createPredicate(this._isInMedia,!0,C.ErrNotInMedia),y.createPredicate(this._isInAdBreak,!0,C.ErrNotInAdBreak),y.createPredicate(this._isValidAdObject,!0,C.ErrInvalidAdObject),y.createPredicate(this._isDifferentAdObject,!0,C.ErrDuplicateAdObject)],[this._cmdAdSkip,this._cmdAdStart],this),this._ruleEngine.registerRule(A.AdComplete,"API:trackEvent(AdComplete)",[y.createPredicate(this._isInSession,!0,C.ErrNotInSession),y.createPredicate(this._isInMedia,!0,C.ErrNotInMedia),y.createPredicate(this._isInAdBreak,!0,C.ErrNotInAdBreak),y.createPredicate(this._isInAd,!0,C.ErrNotInAd)],[this._cmdAdComplete],this),this._ruleEngine.registerRule(A.AdSkip,"API:trackEvent(AdSkip)",[y.createPredicate(this._isInSession,!0,C.ErrNotInSession),y.createPredicate(this._isInMedia,!0,C.ErrNotInMedia),y.createPredicate(this._isInAdBreak,!0,C.ErrNotInAdBreak),y.createPredicate(this._isInAd,!0,C.ErrNotInAd)],[this._cmdAdSkip],this),this._ruleEngine.registerRule(A.ChapterStart,"API:trackEvent(ChapterStart)",[y.createPredicate(this._isInSession,!0,C.ErrNotInSession),y.createPredicate(this._isInMedia,!0,C.ErrNotInMedia),y.createPredicate(this._isValidChapterObject,!0,C.ErrInvalidChapterObject),y.createPredicate(this._isDifferentChapterObject,!0,C.ErrDuplicateChapterObject)],[this._cmdChapterSkip,this._cmdChapterStart],this),this._ruleEngine.registerRule(A.ChapterComplete,"API:trackEvent(ChapterComplete)",[y.createPredicate(this._isInSession,!0,C.ErrNotInSession),y.createPredicate(this._isInMedia,!0,C.ErrNotInMedia),y.createPredicate(this._isInChapter,!0,C.ErrNotInChapter)],[this._cmdChapterComplete],this),this._ruleEngine.registerRule(A.ChapterSkip,"API:trackEvent(ChapterSkip)",[y.createPredicate(this._isInSession,!0,C.ErrNotInSession),y.createPredicate(this._isInMedia,!0,C.ErrNotInMedia),y.createPredicate(this._isInChapter,!0,C.ErrNotInChapter)],[this._cmdChapterSkip],this),this._ruleEngine.registerRule(A.BitrateChange,"API:trackEvent(BitrateChange)",[y.createPredicate(this._isInSession,!0,C.ErrNotInSession),y.createPredicate(this._isInMedia,!0,C.ErrNotInMedia)],[this._cmdBitrate],this),this._ruleEngine.registerRule(A.TimedMetadataUpdate,"API:trackEvent(TimedMetadataUpdate)",[y.createPredicate(this._isInSession,!0,C.ErrNotInSession),y.createPredicate(this._isInMedia,!0,C.ErrNotInMedia),y.createPredicate(this._isValidTimedMetadataObject,!0,C.ErrInvalidTimedMetadataObject)],[this._cmdTimedMetadataUpdate],this)},r.prototype._configureAdobeAnalyticsPlugin=function(){this._aaPlugin=new p(this._appMeasurement,new g(this));var e=new f;e.channel=this._config.channel?this._config.channel:"",e.debugLogging=i.MediaHeartbeat._debugLogging||this._config.debugLogging,this._aaPlugin.configure(e),this._plugins.push(this._aaPlugin)},r.prototype._configureAdobeHearbeatPlugin=function(){var e=this._appMeasurement.visitor?this._appMeasurement.visitor.marketingCloudOrgID:"";this._ahPlugin=new _(new v(this));var t=new m(this._config.trackingServer,e);t.debugLogging=i.MediaHeartbeat._debugLogging||this._config.debugLogging,t.ovp=this._config.ovp?this._config.ovp:"",t.ssl=this._config.ssl,t.sdk=this._config.appVersion?this._config.appVersion:"";var n=this._primetimeTVSDKVersion();n&&n.length>0&&(t.__primetime=!0,t.__psdkVersion=n),this._ahPlugin.configure(t),this._plugins.push(this._ahPlugin)},r.prototype._configureVideoPlayerPlugin=function(){this._playerPlugin=new u(new d(this));var e=new h;e.debugLogging=i.MediaHeartbeat._debugLogging||this._config.debugLogging,this._playerPlugin.configure(e),this._plugins.push(this._playerPlugin)},r.prototype._configureOtherPlugins=function(){if(i.plugins.nielsen&&this._config.nielsenConfigKey&&this._config.nielsenAppInfo){this._nielsenPlugin=new i.plugins.nielsen.NielsenPlugin(new i._NielsenPluginDelegate(this,this._logger));var e=new i.plugins.nielsen.NielsenPluginConfig;e.debugLogging=i.MediaHeartbeat._debugLogging||this._config.debugLogging,e.appInfo=this._config.nielsenAppInfo,e.configKey=this._config.nielsenConfigKey,this._nielsenPlugin.configure(e),this._plugins.push(this._nielsenPlugin)}},r.prototype._configureHeartbeat=function(){var e=new l;e.debugLogging=i.MediaHeartbeat._debugLogging||this._config.debugLogging,this._heartbeat=new s(new c(this),this._plugins),this._heartbeat.configure(e)},r.prototype._resetState=function(){this._taskScheduler.clearTasks(),this._mediaState={},this._plugins=[],this._playerPlugin=null,this._aaPlugin=null,this._ahPlugin=null,this._nielsenPlugin=null,this._heartbeat=null,this._currentMediaObject=null,this._currentAdBreakObject=null,this._currentAdObject=null,this._currentChapterObject=null,this._videoInfo=null,this._adBreakInfo=null,this._adInfo=null,this._chapterInfo=null,this._prerollWaitEnabled=!0,this._prerollWaitTime=B,this._playReceived=!1,this._playTaskHandle=null,this._playAfterAdStart=!1},r.prototype._primetimeTVSDKVersion=function(){return this._currentMediaObject?this._currentMediaObject.getValue(F):null},r.prototype._cleanContextData=function(e){if(null==e||"object"!=typeof e)return null;var t={};for(var i in e)if(e.hasOwnProperty(i)){var n=e[i];"number"!=typeof n&&"string"!=typeof n&&"boolean"!=typeof n||(t[i]=n)}return t},r.prototype._prepareMetadata=function(e,t){var i={};if(t&&S.append(i,t),e){var n=this._cleanContextData(e);S.append(i,n)}return delete i[N],i},r.prototype._onDelegateError=function(e){this._logger.error(x,e.getMessage()+" | "+e.getDetails())},r.prototype._disableHBTracking=function(){var e=y.createContext();this._processRule(A.DisableTracking,e),this._processRule(A.SessionEnd,e)};var M={Session:0,Media:1,AdBreak:2,Ad:3,Chapter:4,PlayPause:5,Buffer:6,Seek:7,FPlayPause:8},A={SessionStart:0,SessionEnd:1,VideoComplete:2,Play:3,Pause:4,Error:5,AdBreakStart:6,AdBreakComplete:7,AdStart:8,AdComplete:9,AdSkip:10,ChapterStart:11,ChapterComplete:12,ChapterSkip:13,SeekStart:14,SeekComplete:15,BufferStart:16,BufferComplete:17,BitrateChange:18,TimedMetadataUpdate:19,DisableTracking:20},C={ErrUnSupportedPlatform:"MediaHeartbeat does not support tracking due to AppMeasurement or VisitorAPI not supporting the browser.",ErrNotInSession:'MediaHeartbeat is not in active tracking session, call "API:trackSessionStart" to begin a new tracking session.',ErrInSession:'MediaHeartbeat is in active tracking session, call "API:trackSessionEnd" to end current tracking session.',ErrTrackingDisabled:"MediaHeartbeat tracking is disabled for this publisher. Please contact Adobe Representative to enable tracking.",ErrNotInMedia:'MediaHeartbeat has completed tracking session, call "API:trackSessionEnd" first to end current session and then begin a new tracking session.',ErrInBuffer:'MediaHeartbeat is tracking buffer events, call "API:trackEvent(BufferComplete)" first to stop tracking buffer events.',ErrNotInBuffer:'MediaHeartbeat is not tracking buffer events, call "API:trackEvent(BufferStart)" before "API:trackEvent(BufferComplete)".',ErrInSeek:'MediaHeartbeat is tracking seek events, call "API:trackEvent(SeekComplete)" first to stop tracking seek events.',ErrNotInSeek:'MediaHeartbeat is not tracking seek events, call "API:trackEvent(SeekStart)" before "API:trackEvent(SeekComplete)".',ErrNotInAdBreak:'MediaHeartbeat is not tracking any AdBreak, call "API:trackEvent(AdBreakStart)" to begin tracking AdBreak',ErrNotInAd:'MediaHeartbeat is not tracking any Ad, call "API:trackEvent(AdStart)" to begin tracking Ad',ErrNotInChapter:'MediaHeartbeat is not tracking any Chapter, call "API:trackEvent(ChapterStart)" to begin tracking Chapter',ErrInvalidMediaObject:'MediaInfo passed into "API:trackSessionStart" is invalid.',ErrInvalidAdBreakObject:'AdBreakInfo passed into "API:trackEvent(AdBreakStart)" is invalid.',ErrDuplicateAdBreakObject:'MediaHeartbeat is currently tracking the AdBreak passed into "API:trackEvent(AdBreakStart)".',ErrInvalidAdObject:'AdInfo passed into "API:trackEvent(AdStart)" is invalid.',ErrDuplicateAdObject:'MediaHeartbeat is currently tracking the Ad passed into "API:trackEvent(AdStart)".',ErrInvalidChapterObject:'ChapterInfo passed into "API:trackEvent(ChapterStart)" is invalid.',ErrDuplicateChapterObject:'MediaHeartbeat is currently tracking the Chapter passed into "API:trackEvent(ChapterStart)".',ErrInvalidTimedMetadataObject:'TimedMetadata passed into "API:trackEvent(TimedMetadataUpdate)" is invalid.',ErrInvalidPlayerState:"MediaHeartbeat is tracking an AdBreak but not tracking any Ad and will drop any calls to track player state (Play, Pause, Buffer or Seek) in this state.",ErrAudioTrackingNotSupported:"Upgrade your AppMeasurement library to version >= '2.11.0' to support tracking audio content."},x="MediaHeartbeat",I="key_media_object",P="key_adbreak_object",L="key_ad_object",D="key_chapter_object",R="key_timed_metadata_object",k="key_custom_metadata",O="key_error_id",N="a.media.streamType",F="a.__pttvsdkVersion",V="granular_ad_tracking",B=250;i._MediaHeartbeatErrorMessage=C,i.MediaHeartbeatDelegate=n,i.MediaHeartbeat=r,i.MediaHeartbeat._debugLogging=!1}(e.ADB.core,e.ADB.va),e.ADB||(e.ADB={}),e.ADB.core||(e.ADB.core=core),e.ADB.va||(e.ADB.va=va),e.ADB.va.plugins||(e.ADB.va.plugins={})}.call(e),e.ADB}()},function(e,t,i){var n,r;(function(){!function(a,o){if(void 0!==(r="function"==typeof(n=o)?n.call(t,i,t,e):n)&&(e.exports=r),void 0!==a){if(void 0!==a.Conviva)return;if(a.ConvivaLoading)return;a.ConvivaLoading=!0,a.Conviva=o(),delete a.ConvivaLoading}}(this,(function(){var e={};return function(){"use strict";var t={};!function(){var i=e.Client=function(t,o){function l(e,t){if(!(e instanceof n))throw new Error("clientSettings parameter should be an instance of ClientSettings.");if(!(t instanceof a))throw new Error("systemFactory parameter should be an instance of SystemFactory.");(e.gatewayUrl==n._httpsProtocol+n.defaultProductionGatewayDNS||e.gatewayUrl==n._httpProtocol+n.defaultProductionGatewayDNS)&&(this.defaultGatewayURLError=!0),this._settings=e.clone(),this._systemFactory=t,this._systemFactory.configure("SDK",this._settings),this._exceptionCatcher=this._systemFactory.buildExceptionCatcher(),this._exceptionCatcher.runProtected("Client.init",(function(){c._id=L.uinteger32(),c._logger=c._systemFactory.buildLogger(),c._logger.setModuleName("Client"),c.defaultGatewayURLError&&c._logger.info("Gateway URL should not be set to https://cws.conviva.com or http://cws.conviva.com, therefore this call is ignored"),c._logger.info("init(): url="+c._settings.gatewayUrl+" customerKey="+c._settings.customerKey),c._config=c._systemFactory.buildConfig(),c._config.load(),c._sessionFactory=c._systemFactory.buildSessionFactory(c,c._settings,c._config),c._logger.info("init(): done.")}),(function(e){throw new Error("Client constructor failed: "+e.message)}))}var c=this;this.defaultGatewayURLError=!1,this._logger=null,this._sessionFactory=null,this._systemFactory=null,this._globalSessionKey=-1,this._settings=null,this._systemSettings=null,this._exceptionCatcher=null,this._config=null,this._id=-1,this._released=!1,l.apply(this,arguments),this.release=function(){this._released||this._exceptionCatcher.runProtected("Client.release",(function(){c._logger.info("release()"),c._sessionFactory.cleanup(),c._sessionFactory=null,c._globalSessionKey=-1,c._logger=null,c._id=-1,c._exceptionCatcher=null,c._settings=null,c._systemSettings=null,c._systemFactory=null,c._released=!0}))},this.createSession=function(e){var t=i.NO_SESSION_KEY;return this._released?t:null==e||e instanceof r?(this._exceptionCatcher.runProtected("Client.createSession",(function(){t=c._sessionFactory.makeVideoSession(e,b.SESSION_TYPE.VIDEO)})),t):(c._logger.error("createSession(): expecting an instance of ContentMetadata for contentMetadata parameter"),t)},this.createAdSession=function(e,t){var n=i.NO_SESSION_KEY;return this._released?n:null==t||t instanceof r?(this._exceptionCatcher.runProtected("Client.createAdSession",(function(){var i=c._sessionFactory.getVideoSession(e);null!=i&&(null==t&&(t=new r),(null==t.applicationName||null==t.viewerId)&&(null==t.viewerId&&null!=i._contentMetadata.viewerId&&(t.viewerId=i._contentMetadata.viewerId),null==t.applicationName&&null!=i._contentMetadata.applicationName&&(t.applicationName=i._contentMetadata.applicationName)),t.custom["c3.csid"]=x.ToString(i._id)),n=c._sessionFactory.makeVideoSession(t,b.SESSION_TYPE.AD)})),n):(c._logger.error("createAdSession(): expecting an instance of ContentMetadata for adMetadata parameter"),n)},this.reportError=function(t,i,n){return this._released?void 0:x.isValidString(i)?n!==e.Client.ErrorSeverity.FATAL&&n!==e.Client.ErrorSeverity.WARNING?void this._logger.error("reportError(): invalid error severity: "+n):void this._exceptionCatcher.runProtected("Client.reportError",(function(){var e=c._sessionFactory.getVideoSession(t);null!=e&&e.reportError(i,n)})):void this._logger.error("reportError(): invalid error message string: "+i)},this.updateContentMetadata=function(e,t){return this._released?void 0:t instanceof r?void this._exceptionCatcher.runProtected("Client.updateContentMetadata",(function(){var i=c._sessionFactory.getVideoSession(e);if(null!=i){var n=t.clone();i.updateContentMetadata(n)}})):void c._logger.error("updateContentMetadata(): expecting an instance of ContentMetadata for contentMetadata parameter")},this.detachPlayer=function(e){this._released||this._exceptionCatcher.runProtected("Client.detachPlayer",(function(){var t=c._sessionFactory.getVideoSession(e);null!=t&&t.detachPlayer()}))},this.attachPlayer=function(e,t){return this._released?void 0:t instanceof s?void this._exceptionCatcher.runProtected("Client.attachPlayer",(function(){var i=c._sessionFactory.getVideoSession(e);null!=i&&i.attachPlayer(t)})):void c._logger.error("attachPlayer(): expecting an instance of PlayerStateManager for playerStateManager parameter")},this.contentPreload=function(e){this._released||this._exceptionCatcher.runProtected("Client.contentPreload",(function(){var t=c._sessionFactory.getVideoSession(e);null!=t&&t.contentPreload()}))},this.contentStart=function(e){this._released||this._exceptionCatcher.runProtected("Client.contentStart",(function(){var t=c._sessionFactory.getVideoSession(e);null!=t&&t.contentStart()}))},this.sendCustomEvent=function(e,t,n){return this._released?void 0:x.isValidString(t)?void this._exceptionCatcher.runProtected("Client.sendCustomEvent",(function(){if(e==i.NO_SESSION_KEY){if(c._globalSessionKey<0){var a=new r;c._globalSessionKey=c._sessionFactory.makeGlobalSession(a,null)}e=c._globalSessionKey}var o=x.sanitizeStringToStringObject(n),s=c._sessionFactory.getSession(e);null!=s&&s.sendCustomEvent(t,o)})):void c._logger.error("sendCustomEvent(): eventName parameter must be a valid string.")},this.adStart=function(e,t,n,r){return this._released?void 0:t!==i.AdStream.CONTENT&&t!==i.AdStream.SEPARATE?void this._logger.error("adStart(): ignored, invalid value for adStream parameter: "+t):n!==i.AdPlayer.CONTENT&&n!==i.AdPlayer.SEPARATE?void this._logger.error("adStart(): ignored, invalid value for adPlayer parameter: "+n):r!==i.AdPosition.BUMPER&&r!==i.AdPosition.PREROLL&&r!==i.AdPosition.MIDROLL&&r!==i.AdPosition.POSTROLL?void this._logger.error("adStart(): ignored, invalid value for adPosition parameter: "+r):void this._exceptionCatcher.runProtected("Client.adStart",(function(){var i=c._sessionFactory.getVideoSession(e);null!=i&&i.adStart(t,n,r)}))},this.adEnd=function(e){this._released||this._exceptionCatcher.runProtected("Client.adEnd",(function(){var t=c._sessionFactory.getVideoSession(e);null!=t&&t.adEnd()}))},this.cleanupSession=function(e){return this._released?void 0:e===i.NO_SESSION_KEY?void this._logger.warning("cleanupSession(): ignored, can't cleanup Client.NO_SESSION_KEY"):void this._exceptionCatcher.runProtected("Client.cleanupSession",(function(){null!=c._sessionFactory.getVideoSession(e)&&c._sessionFactory.cleanupSession(e)}))},this.getAttachedPlayer=function(e){var t=null;return this._released?t:e===i.NO_SESSION_KEY?(this._logger.warning("getAttachedPlayer(): ignored for Client.NO_SESSION_KEY"),t):(this._exceptionCatcher.runProtected("Client.getAttachedPlayer",(function(){var i=c._sessionFactory.getVideoSession(e);null!=i&&(t=i.getPlayerStateManager())})),t)},this.isPlayerAttached=function(e){return!this._released&&null!==this.getAttachedPlayer(e)},this.getPlayerStateManager=function(){if(this._released)throw new Error("This instance of Conviva.Client has been released.");return new s(this._systemFactory)},this.releasePlayerStateManager=function(e){if(this._released)throw new Error("This instance of Conviva.Client has been released.");this._exceptionCatcher.runProtected("Client.releasePlayerStateManager",(function(){e instanceof s&&e.release()}))},this.getSettings=function(){return this._settings},this.getId=function(){return this._id}};i.version="2.151.0.36981",i.NO_SESSION_KEY=-2,i.AdPosition={BUMPER:"BUMPER",PREROLL:"PREROLL",MIDROLL:"MIDROLL",POSTROLL:"POSTROLL"},i.AdStream={CONTENT:"CONTENT",SEPARATE:"SEPARATE"},i.AdPlayer={CONTENT:"CONTENT",SEPARATE:"SEPARATE"},i.ErrorSeverity={FATAL:0,WARNING:1},i.DeviceType={DESKTOP:"DESKTOP",CONSOLE:"Console",SETTOP:"Settop",MOBILE:"Mobile",TABLET:"Tablet",SMARTTV:"SmartTV"},i.AdTechnology={CLIENT_SIDE:"Client Side",SERVER_SIDE:"Server Side"},i.AdType={BLACKOUT_SLATE:"Blackout slate",TECHNICAL_DIFFICULTIES_SLATE:"Technical Difficulties slate",COMMERCIAL_SLATE:"Commercial Break slate",OTHER_SLATE:"Other slate",VPAID:"VPAID",REGULAR:"Regular Ad"},i.AdServingType={INLINE:"Inline",WRAPPER:"Wrapper"},i.DeviceCategory={ANDROID_DEVICE:"AND",APPLE_DEVICE:"APL",CHROMECAST:"CHR",DESKTOP_APP:"DSKAPP",DEVICE_SIMULATOR:"SIMULATOR",LG_TV:"LGTV",NINTENDO:"NINTENDO",PLAYSTATION:"PS",ROKU:"RK",SAMSUNG_TV:"SAMSUNGTV",SMART_TV:"TV",SET_TOP_BOX:"STB",TIVO:"TIVO",WEB:"WEB",WINDOWS_DEVICE:"WIN",XBOX:"XB"};var n=e.ClientSettings=function(e){function t(e){if(!x.isValidString(e))throw new Error("customerKey must be valid");this.customerKey=e}function i(e){if(x.isValidString(e)){var t=e.split("://");if("cws.conviva.com"!=t[1]&&("https"==t[0]||"http"==t[0]))return e}return"https://"+r.customerKey+"."+n.defaultProductionGatewayDNS}var r=this;this._customerKey=null,x.defGet(this,"customerKey",(function(){return this._customerKey})),x.defSet(this,"customerKey",(function(e){x.isValidString(e)&&(this._customerKey=e)})),this._heartbeatInterval=n.defaultProductionHeartbeatInterval,x.defGet(this,"heartbeatInterval",(function(){return this._heartbeatInterval})),x.defSet(this,"heartbeatInterval",(function(e){if("number"==typeof e){var t=x.NumberToUnsignedInt(e);t===e&&(this._heartbeatInterval=t)}})),this._gatewayUrl=null,x.defGet(this,"gatewayUrl",(function(){return this._gatewayUrl})),x.defSet(this,"gatewayUrl",(function(e){x.isValidString(e)&&(this._gatewayUrl=e)})),t.apply(this,arguments),this.equals=function(e){return this.customerKey===e.customerKey&&this.gatewayUrl===e.gatewayUrl&&this.heartbeatInterval===e.heartbeatInterval},this.clone=function(){var e=new n(this.customerKey);return e.gatewayUrl=i(this.gatewayUrl),e.heartbeatInterval=this.heartbeatInterval,e}};n.defaultDevelopmentGatewayUrl="https://conviva.testonly.conviva.com",n.defaultProductionGatewayUrl="https://cws.conviva.com",n.defaultProductionGatewayDNS="cws.conviva.com",n.defaultDevelopmentGatewayDNS="conviva.testonly.conviva.com",n._httpsProtocol="https://",n._httpProtocol="http://",n.defaultDevelopmentHeartbeatInterval=5,n.defaultProductionHeartbeatInterval=20;var r=e.ContentMetadata=function(){function e(){return this._assetName}function t(e){"string"==typeof e&&(this._assetName=e)}function i(){return this._custom}function n(e){"object"==typeof e&&(this._custom=x.sanitizeStringToStringObject(e))}function a(){return this._defaultResource}function o(e){"string"==typeof e&&(this._defaultResource=e)}function s(){return this._viewerId}function l(e){"string"==typeof e&&(this._viewerId=e)}function c(){return this._applicationName}function u(e){"string"==typeof e&&(this._applicationName=e)}function h(){return this._streamUrl}function d(e){"string"==typeof e&&(this._streamUrl=e)}function p(){return this._streamType}function f(e){(e===r.StreamType.UNKNOWN||e===r.StreamType.VOD||e===r.StreamType.LIVE)&&(this._streamType=e)}function g(){return this._duration}function _(e){this._duration=D.sanitizeSpecialIntegerValue(e)}function m(){return this._encodedFrameRate}function v(e){this._encodedFrameRate=D.sanitizeSpecialIntegerValue(e)}function y(){}this._assetName=null,x.defGet(this,"assetName",e),x.defSet(this,"assetName",t),this._custom={},x.defGet(this,"custom",i),x.defSet(this,"custom",n),this._defaultResource=null,x.defGet(this,"defaultResource",a),x.defSet(this,"defaultResource",o),this._viewerId=null,x.defGet(this,"viewerId",s),x.defSet(this,"viewerId",l),this._applicationName=null,x.defGet(this,"applicationName",c),x.defSet(this,"applicationName",u),this._streamUrl=null,x.defGet(this,"streamUrl",h),x.defSet(this,"streamUrl",d),this._streamType=r.StreamType.UNKNOWN,x.defGet(this,"streamType",p),x.defSet(this,"streamType",f),this._duration=-1,x.defGet(this,"duration",g),x.defSet(this,"duration",_),this._encodedFrameRate=-1,x.defGet(this,"encodedFrameRate",m),x.defSet(this,"encodedFrameRate",v),y.apply(this,arguments),this.clone=function(){var e=new r;for(var t in e.assetName=this.assetName,e.applicationName=this.applicationName,e.streamUrl=this.streamUrl,e.viewerId=this.viewerId,e.defaultResource=this.defaultResource,e.streamType=this.streamType,e.duration=this.duration,e.encodedFrameRate=this.encodedFrameRate,this.custom)e.custom[t]=this.custom[t];return e}};r.StreamType={UNKNOWN:"UNKNOWN",LIVE:"LIVE",VOD:"VOD"};var a=(e.ErrorType={ERROR_UNKNOWN:"ERROR_UNKNOWN",ERROR_IO:"ERROR_IO",ERROR_TIMEOUT:"ERROR_TIMEOUT",ERROR_NULL_ASSET:"ERROR_NULL_ASSET",ERROR_MISSING_PARAMETER:"ERROR_MISSING_PARAMETER",ERROR_NO_AD_AVAILABLE:"ERROR_NO_AD_AVAILABLE",ERROR_PARSE:"ERROR_PARSE",ERROR_INVALID_VALUE:"ERROR_INVALID_VALUE",ERROR_INVALID_SLOT:"ERROR_INVALID_SLOT",ERROR_3P_COMPONENT:"ERROR_3P_COMPONENT",ERROR_UNSUPPORTED_3P_FEATURE:"ERROR_UNSUPPORTED_3P_FEATURE",ERROR_DEVICE_LIMIT:"ERROR_DEVICE_LIMIT",ERROR_UNMATCHED_SLOT_SIZE:"ERROR_UNMATCHED_SLOT_SIZE"},e.Events={AD_REQUESTED:"Conviva.AdRequested",AD_RESPONSE:"Conviva.AdResponse",AD_SLOT_STARTED:"Conviva.SlotStarted",AD_ATTEMPTED:"Conviva.AdAttempted",AD_SLOT_ENDED:"Conviva.SlotEnded",AD_IMPRESSION_START:"Conviva.AdImpression",AD_START:"Conviva.AdStart",AD_FIRST_QUARTILE:"Conviva.AdFirstQuartile",AD_MID_QUARTILE:"Conviva.AdMidQuartile",AD_THIRD_QUARTILE:"Conviva.AdThirdQuartile",AD_COMPLETE:"Conviva.AdComplete",AD_END:"Conviva.AdEnd",AD_IMPRESSION_END:"Conviva.AdImpressionEnd",AD_SKIPPED:"Conviva.AdSkipped",AD_ERROR:"Conviva.AdError",AD_PROGRESS:"Conviva.AdProgress",AD_CLOSE:"Conviva.AdClose",CONTENT_PAUSED:"Conviva.PauseContent",CONTENT_RESUMED:"Conviva.ResumeContent",POD_START:"Conviva.PodStart",POD_END:"Conviva.PodEnd"},e.SystemFactory=function(e,t){function i(e,t){if(!(e instanceof d))throw new Error("systemInterface parameter should be an instance of SystemInterface.");this._systemInterface=e,this._timeInterface=this._systemInterface._timeInterface,this._timerInterface=this._systemInterface._timerInterface,this._httpInterface=this._systemInterface._httpInterface,this._storageInterface=this._systemInterface._storageInterface,this._metadataInterface=this._systemInterface._metadataInterface,this._loggingInterface=this._systemInterface._loggingInterface,this._settings=t instanceof o?t.clone():new o}var n=this;i.apply(this,arguments),this.configure=function(e,t){this._packageName=e,this._clientSettings=t},this.release=function(){this._systemInterface.release(),this._systemInterface=null,this._packageName=null,this._settings=null,this._logBuffer=null};var r={build:function(){return new k(n._loggingInterface,n._timeInterface,n.getSettings(),n._logBuffer,n._packageName)}};this.buildLogger=function(){return r.build()},this.buildSessionFactory=function(e,t,i){return new E(e,t,i,this)},this.buildPing=function(){return new P(this.buildLogger(),this.buildHttpClient(),this._clientSettings)},this.buildCallbackWithTimeout=function(){return new w(this.buildTimer())},this.buildCallbackWithTimeoutNoPing=function(){var e=new A(this.buildLogger(),null,this.getSettings()),t=new V(this.buildLogger(),this._timerInterface,e);return new w(t)},this.buildHttpClient=function(){return new R(this.buildLogger(),this._httpInterface,this.buildCallbackWithTimeoutNoPing(),this.getSettings())},this.buildExceptionCatcher=function(){return new A(this.buildLogger(),this.buildPing(),this.getSettings())},this.buildTime=function(){return new F(this._timeInterface,this.buildLogger())},this.buildTimer=function(){return new V(this.buildLogger(),this._timerInterface,this.buildExceptionCatcher())},this.buildStorage=function(){return new O(this.buildLogger(),this._storageInterface,this.buildCallbackWithTimeout(),this.getSettings())},this.buildConfig=function(){return new T(this.buildLogger(),this.buildStorage(),this.buildJsonInterface())},this.buildSystemMetadata=function(){return new N(this.buildLogger(),this._metadataInterface,this.buildExceptionCatcher())},this.buildCwsProtocol=function(){return new m},this.buildGatewayControl=function(e){return new C(e,this.buildLogger(),this.buildHttpClient(),this.buildJsonInterface())},this.buildCwsSession=function(e,t,i){var n=this.buildGatewayControl(t);return new b(this.buildEventQueue(),e,t,this.buildLogger(),this.buildExceptionCatcher(),this.buildTimer(),n,this.buildCwsProtocol(),this.buildTime(),this.getLogBuffer(),i)},this.buildSession=function(e,t,i,n,r,a){var o=this.buildExceptionCatcher(),s=this.buildLogger(),l=t.clone(),c=this.buildCwsSession(e,l,i);return new S(n,r,a,i,this.buildSystemMetadata(),c,o,s)},this.buildEventQueue=function(){return new M},this.buildJsonInterface=function(){return new v},this.getLogBuffer=function(){return this._logBuffer},this.getSettings=function(){return this._settings},this._logBuffer=new I}),o=e.SystemSettings=function(){function e(){}this._logLevel=o.defaultProductionLogLevel,x.defGet(this,"logLevel",(function(){return this._logLevel})),x.defSet(this,"logLevel",(function(e){if("number"==typeof e){var t=x.NumberToUnsignedInt(e);t===e&&t>=o.LogLevel.DEBUG&&t<=o.LogLevel.ERROR&&(this._logLevel=t)}})),this._allowUncaughtExceptions=o.defaultProductionAllowUncaughtExceptions,x.defGet(this,"allowUncaughtExceptions",(function(){return this._allowUncaughtExceptions})),x.defSet(this,"allowUncaughtExceptions",(function(e){x.isBoolean(e)&&(this._allowUncaughtExceptions=e)})),this._storageTimeout=o.defaultStorageTimeout,x.defGet(this,"storageTimeout",(function(){return this._storageTimeout})),x.defSet(this,"storageTimeout",(function(e){if("number"==typeof e){var t=x.NumberToUnsignedInt(e);t===e&&(this._storageTimeout=t)}})),this._httpTimeout=o.defaultHttpTimeout,x.defGet(this,"httpTimeout",(function(){return this._httpTimeout})),x.defSet(this,"httpTimeout",(function(e){if("number"==typeof e){var t=x.NumberToUnsignedInt(e);t===e&&(this._httpTimeout=t)}})),e.apply(this,arguments),this.equals=function(e){return this.logLevel===e.logLevel&&this.allowUncaughtExceptions===e.allowUncaughtExceptions&&this.storageTimeout===e.storageTimeout&&this.httpTimeout===e.httpTimeout},this.clone=function(){var e=new o;return e.logLevel=this.logLevel,e.allowUncaughtExceptions=this.allowUncaughtExceptions,e.storageTimeout=this.storageTimeout,e.httpTimeout=this.httpTimeout,e}};o.LogLevel={DEBUG:0,INFO:1,WARNING:2,ERROR:3,NONE:4},o.defaultDevelopmentLogLevel=o.LogLevel.DEBUG,o.defaultProductionLogLevel=o.LogLevel.ERROR,o.defaultDevelopmentAllowUncaughtExceptions=!0,o.defaultProductionAllowUncaughtExceptions=!1,o.defaultStorageTimeout=10,o.defaultHttpTimeout=10;var s=e.PlayerStateManager=function(i){function n(e){r._systemFactory=e,r._logger=r._systemFactory.buildLogger(),r._logger.setModuleName("PlayerStateManager"),r._exceptionCatcher=r._systemFactory.buildExceptionCatcher()}var r=this;r._monitorNotifier=null,r._bitrateKbps=-2,r._playerState=s.PlayerState.UNKNOWN,r._currentMetadata={},r._renderedFrameRate=-2,r._encodedFrameRate=-2,r._duration=-2,r._playerVersion=null,r._playerType=null,r._streamUrl=null,r._moduleName=null,r._moduleVersion=null,r._width=-1,r._height=-1,r._connectionType=null,r._linkEncryption=null,r._lastError=null,r._pendingErrors=[],r._released=!1,this.release=function(){r._released||r._exceptionCatcher.runProtected("PlayerStateManager.release",(function(){null!=r._monitorNotifier&&r._monitorNotifier.onRelease(),r.removeMonitoringNotifier(),r._systemFactory=null,r._logger=null,r._exceptionCatcher=null,r._released=!0}))},this.setPlayheadTime=function(e){},this.setBufferLength=function(e){},this.setRenderedFrameRate=function(e){},this.getEncodedFrameRate=function(){return r._encodedFrameRate},this.setEncodedFrameRate=function(e){r._released||r._exceptionCatcher.runProtected("PlayerStateManager.setEncodedFrameRate",(function(){var t=D.sanitizeSpecialIntegerValue(e);t>=-1&&(r._encodedFrameRate=t,null!=r._monitorNotifier&&r._monitorNotifier.onEncodedFrameRateChange(r._encodedFrameRate))}))},this.getDuration=function(){return r._duration},this.setClientMeasureInterface=function(t){x.validateInterface(t,new e.ClientMeasureInterface,"ClientMeasureInterface"),this._playerInterface=t},this.getPHT=function(){return this._playerInterface&&"function"==typeof this._playerInterface.getPHT?this._playerInterface.getPHT():s.DEFAULT_PHT},this.getBufferLength=function(){return this._playerInterface&&"function"==typeof this._playerInterface.getBufferLength?this._playerInterface.getBufferLength():s.DEFAULT_BUFFER_LENGTH},this.getSignalStrength=function(){return this._playerInterface&&"function"==typeof this._playerInterface.getSignalStrength?this._playerInterface.getSignalStrength():s.DEFAULT_SIGNAL_STRENGTH},this.getRenderedFrameRate=function(){return this._playerInterface&&"function"==typeof this._playerInterface.getRenderedFrameRate?this._playerInterface.getRenderedFrameRate():s.DEFAULT_RENDERED_FRAME_RATE},this.setDuration=function(e){r._released||r._exceptionCatcher.runProtected("PlayerStateManager.setDuration",(function(){var t=D.sanitizeSpecialIntegerValue(e);t>=-1&&(r._duration=t,null!=r._monitorNotifier&&r._monitorNotifier.onContentLengthChange(r._duration))}))},this.getStreamUrl=function(){return r._streamUrl},this.setStreamUrl=function(e){r._released||r._exceptionCatcher.runProtected("PlayerStateManager.setStreamUrl",(function(){null!=e&&(r._streamUrl=e,null!=r._monitorNotifier&&r._monitorNotifier.onStreamUrlChange(r._streamUrl))}))},this.getModuleName=function(){return r._moduleName},this.getModuleVersion=function(){return r._moduleVersion},this.setModuleNameAndVersion=function(e,t){r._moduleName=e,r._moduleVersion=t},this.getPlayerType=function(){return r._playerType},this.setPlayerType=function(e){r._released||r._exceptionCatcher.runProtected("PlayerStateManager.setPlayerType",(function(){r._playerType=e,null!=r._monitorNotifier&&r._monitorNotifier.onPlayerTypeChange(r._playerType)}))},this.getPlayerVersion=function(){return r._playerVersion},this.setPlayerVersion=function(e){r._released||r._exceptionCatcher.runProtected("PlayerStateManager.setPlayerVersion",(function(){r._playerVersion=e,null!=r._monitorNotifier&&r._monitorNotifier.onPlayerVersionChange(r._playerVersion)}))},this.setMonitoringNotifier=function(e,t){return r._released?void 0:null==r._monitorNotifier&&(r._monitorNotifier=e,r._logger.setSessionId(t),!0)},this.removeMonitoringNotifier=function(){r._released||(r._monitorNotifier=null,r._logger.setSessionId(null))},this.pushCurrentState=function(){r.setPlayerState(r.getPlayerState()),r.setBitrateKbps(r.getBitrateKbps()),r.setDuration(r.getDuration()),r.setEncodedFrameRate(r.getEncodedFrameRate()),r.setStreamUrl(r.getStreamUrl()),r.setPlayerType(r.getPlayerType()),r.setPlayerVersion(r.getPlayerVersion());for(var e=0;e<r._pendingErrors.length;e++){var t=r._pendingErrors[e];r.setError(t)}r._pendingErrors=[]},this.getPlayerState=function(){return r._playerState},this.setPlayerState=function(e){r._released||r._exceptionCatcher.runProtected("PlayerStateManager.setPlayerState",(function(){s.isValidPlayerState(e)?(r._playerState=e,null!=r._monitorNotifier&&r._monitorNotifier.onPlayerStateChange(r._playerState)):r._logger.error("PlayerStateManager.SetPlayerState(): invalid state: "+e)}))},this.getBitrateKbps=function(){return r._bitrateKbps},this.setBitrateKbps=function(e){r._released||r._exceptionCatcher.runProtected("PlayerStateManager.setBitrateKbps",(function(){var t=D.sanitizeSpecialIntegerValue(e);t>=-1&&(r._bitrateKbps=t,null!=r._monitorNotifier&&r._monitorNotifier.onBitrateChange(r._bitrateKbps))}))},this.setPlayerSeekStart=function(e){r._released||r._exceptionCatcher.runProtected("PlayerStateManager.setPlayerSeekStart()",(function(){null!=r._monitorNotifier&&r._monitorNotifier.onSeekEvent(s.SEEK_ACTIONS_TYPE.SEEK_START,e)}))},this.setPlayerSeekEnd=function(){r._released||r._exceptionCatcher.runProtected("PlayerStateManager.setPlayerSeekEnd()",(function(){null!=r._monitorNotifier&&r._monitorNotifier.onSeekEvent(s.SEEK_ACTIONS_TYPE.SEEK_END,-1)}))},this.setUserSeekButtonUp=function(){r._released||r._exceptionCatcher.runProtected("PlayerStateManager.setUserSeekButtonUp()",(function(){null!=r._monitorNotifier&&r._monitorNotifier.onSeekEvent(s.SEEK_ACTIONS_TYPE.BUTTON_UP,-1)}))},this.setUserSeekButtonDown=function(){r._released||r._exceptionCatcher.runProtected("PlayerStateManager.setUserSeekButtonDown()",(function(){null!=r._monitorNotifier&&r._monitorNotifier.onSeekEvent(s.SEEK_ACTIONS_TYPE.BUTTON_DOWN,-1)}))},this.setVideoResolutionWidth=function(e){r._released||r._exceptionCatcher.runProtected("PlayerStateManager.setVideoResolutionWidth()",(function(){var t=D.sanitizeSpecialIntegerValue(e);t>0&&(r._width=t),null!=r._monitorNotifier&&r._monitorNotifier.onStreamResolutionWidthChange(r._width)}))},this.setVideoResolutionHeight=function(e){r._released||r._exceptionCatcher.runProtected("PlayerStateManager.setVideoResolutionHeight()",(function(){var t=D.sanitizeSpecialIntegerValue(e);t>0&&(r._height=t),null!=r._monitorNotifier&&r._monitorNotifier.onStreamResolutionHeightChange(r._height)}))},this.setConnectionType=function(e){r._released||r._exceptionCatcher.runProtected("PlayerStateManager.setConnectionType()",(function(){r._connectionType=e,null!=r._monitorNotifier&&r._monitorNotifier.onConnectionTypeChange(r._connectionType)}))},this.setLinkEncryption=function(e){r._released||r._exceptionCatcher.runProtected("PlayerStateManager.setLinkEncryption()",(function(){r._linkEncryption=e,null!=r._monitorNotifier&&r._monitorNotifier.onLinkEncryptionChange(r._linkEncryption)}))},this.setSignalStrength=function(e){},this.setError=function(e){if(r._lastError=e,null!=r._monitorNotifier){var t=e.errorCode,i=e.severity;r._monitorNotifier.onError(t,i)}else r._pendingErrors.push(e)},this.sendError=function(e,i){r._released||r._exceptionCatcher.runProtected("PlayerStateManager.sendError",(function(){var n=new t.StreamerError(e,i);r.setError(n)}))},this.reset=function(){r._released||r._exceptionCatcher.runProtected("PlayerStateManager.reset",(function(){r._bitrateKbps=-2,r._playerState=s.PlayerState.UNKNOWN,r._currentMetadata={},r._renderedFrameRate=-1,r._encodedFrameRate=-1,r._duration=-1,r._playerVersion=null,r._playerType=null,r._streamUrl=null,r._lastError=null,r._pendingErrors=[]}))},this.getError=function(){return r._lastError},n.apply(r,arguments),s.DEFAULT_SIGNAL_STRENGTH=1e3,s.DEFAULT_RENDERED_FRAME_RATE=-1,s.DEFAULT_BUFFER_LENGTH=-1,s.DEFAULT_PHT=-1};s.PlayerState={STOPPED:"STOPPED",PLAYING:"PLAYING",BUFFERING:"BUFFERING",PAUSED:"PAUSED",UNKNOWN:"UNKNOWN",NOT_MONITORED:"NOT_MONITORED"},s.isValidPlayerState=function(e){return e===s.PlayerState.STOPPED||e===s.PlayerState.PLAYING||e===s.PlayerState.BUFFERING||e===s.PlayerState.PAUSED||e===s.PlayerState.UNKNOWN||e===s.PlayerState.NOT_MONITORED},s.SEEK_ACTIONS_TYPE={SEEK_START:"pss",SEEK_END:"pse",BUTTON_UP:"bu",BUTTON_DOWN:"bd"};var l=(e.ClientMeasureInterface=function(){this.getPHT=function(){},this.getBufferLength=function(){},this.getSignalStrength=function(){},this.getRenderedFrameRate=function(){}},e.HttpInterface=function(){this.makeRequest=function(e,t,i,n,r,a){},this.release=function(){}}),c=e.LoggingInterface=function(){this.consoleLog=function(e,t){},this.release=function(){}},u=e.MetadataInterface=function(){this.getBrowserName=function(){},this.getBrowserVersion=function(){},this.getDeviceBrand=function(){},this.getDeviceManufacturer=function(){},this.getDeviceModel=function(){},this.getDeviceType=function(){},this.getDeviceVersion=function(){},this.getFrameworkName=function(){},this.getFrameworkVersion=function(){},this.getOperatingSystemName=function(){},this.getOperatingSystemVersion=function(){},this.getDeviceCategory=function(){},this.release=function(){}},h=e.StorageInterface=function(){this.saveData=function(e,t,i,n){},this.loadData=function(e,t,i){},this.release=function(){}},d=e.SystemInterface=function(e,t,i,n,r,a){function o(e,t,i,n,r,a){x.validateInterface(e,new p,"TimeInterface"),x.validateInterface(t,new f,"TimerInterface"),x.validateInterface(i,new l,"HttpInterface"),x.validateInterface(n,new h,"StorageInterface"),x.validateInterface(r,new u,"MetadataInterface"),x.validateInterface(a,new c,"LoggingInterface"),this._timeInterface=e,this._timerInterface=t,this._httpInterface=i,this._storageInterface=n,this._metadataInterface=r,this._loggingInterface=a}o.apply(this,arguments),this.release=function(){this._timeInterface.release(),this._timeInterface=null,this._timerInterface.release(),this._timerInterface=null,this._httpInterface.release(),this._httpInterface=null,this._storageInterface.release(),this._storageInterface=null,this._metadataInterface.release(),this._metadataInterface=null,this._loggingInterface.release(),this._loggingInterface=null}},p=e.TimeInterface=function(){this.getEpochTimeMs=function(){},this.release=function(){}},f=e.TimerInterface=function(){this.createTimer=function(e,t,i){},this.release=function(){}},g=t.JSON2={};!function(){function e(e){return 10>e?"0"+e:e}function t(e){return n.lastIndex=0,n.test(e)?'"'+e.replace(n,(function(e){var t=o[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}))+'"':'"'+e+'"'}function i(e,n){var o,l,c,u,h,d=r,p=n[e];switch(p&&"object"==typeof p&&"function"==typeof p.toJSON&&(p=p.toJSON(e)),"function"==typeof s&&(p=s.call(n,e,p)),typeof p){case"string":return t(p);case"number":return isFinite(p)?String(p):"null";case"boolean":case"null":return String(p);case"object":if(!p)return"null";if(r+=a,h=[],Object.prototype.toString.apply(p)===Object.prototype.toString.apply([])){for(u=p.length,o=0;u>o;o+=1)h[o]=i(o,p)||"null";return c=0===h.length?"[]":r?"[\n"+r+h.join(",\n"+r)+"\n"+d+"]":"["+h.join(",")+"]",r=d,c}if(s&&"object"==typeof s)for(u=s.length,o=0;u>o;o+=1)"string"==typeof s[o]&&((c=i(l=s[o],p))&&h.push(t(l)+(r?": ":":")+c));else for(l in p)Object.prototype.hasOwnProperty.call(p,l)&&((c=i(l,p))&&h.push(t(l)+(r?": ":":")+c));return c=0===h.length?"{}":r?"{\n"+r+h.join(",\n"+r)+"\n"+d+"}":"{"+h.join(",")+"}",r=d,c}}var n,r,a,o,s;"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+e(this.getUTCMonth()+1)+"-"+e(this.getUTCDate())+"T"+e(this.getUTCHours())+":"+e(this.getUTCMinutes())+":"+e(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()}),"function"!=typeof g.stringify&&(n=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,o={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},g.stringify=function(e,t,n){var o;if(r="",a="","number"==typeof n)for(o=0;n>o;o+=1)a+=" ";else"string"==typeof n&&(a=n);if(s=t,t&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw new Error("JSON2.stringify");return i("",{"":e})})}();var _=t.JsonParse=function(){var e,t,i,n,r={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"},a=function(t){throw{name:"SyntaxError",message:t,at:e,text:i}},o=function(n){return n&&n!==t&&a("Expected '"+n+"' instead of '"+t+"'"),t=i.charAt(e),e+=1,t},s=function(){var e,i="";for("-"===t&&(i="-",o("-"));t>="0"&&"9">=t;)i+=t,o();if("."===t)for(i+=".";o()&&t>="0"&&"9">=t;)i+=t;if("e"===t||"E"===t)for(i+=t,o(),("-"===t||"+"===t)&&(i+=t,o());t>="0"&&"9">=t;)i+=t,o();return e=+i,isNaN(e)?void a("Bad number"):e},l=function(){var e,i,n,s="";if('"'===t)for(;o();){if('"'===t)return o(),s;if("\\"===t)if(o(),"u"===t){for(n=0,i=0;4>i&&(e=parseInt(o(),16),isFinite(e));i+=1)n=16*n+e;s+=String.fromCharCode(n)}else{if("string"!=typeof r[t])break;s+=r[t]}else s+=t}a("Bad string")},c=function(){for(;t&&" ">=t;)o()};return n=function(){switch(c(),t){case"{":return function(){var e,i={};if("{"===t){if(o("{"),c(),"}"===t)return o("}"),i;for(;t;){if(e=l(),c(),o(":"),Object.hasOwnProperty.call(i,e)&&a('Duplicate key "'+e+'"'),i[e]=n(),c(),"}"===t)return o("}"),i;o(","),c()}}a("Bad object")}();case"[":return function(){var e=[];if("["===t){if(o("["),c(),"]"===t)return o("]"),e;for(;t;){if(e.push(n()),c(),"]"===t)return o("]"),e;o(","),c()}}a("Bad array")}();case'"':return l();case"-":return s();default:return t>="0"&&"9">=t?s():function(){switch(t){case"t":return o("t"),o("r"),o("u"),o("e"),!0;case"f":return o("f"),o("a"),o("l"),o("s"),o("e"),!1;case"n":return o("n"),o("u"),o("l"),o("l"),null}a("Unexpected '"+t+"'")}()}},function(r,o){var s;return i=r,e=0,t=" ",s=n(),c(),t&&a("Syntax error"),"function"==typeof o?function e(t,i){var n,r,a=t[i];if(a&&"object"==typeof a)for(n in a)Object.hasOwnProperty.call(a,n)&&(void 0!==(r=e(a,n))?a[n]=r:delete a[n]);return o.call(t,i,a)}({"":s},""):s}}(),m=t.CwsProtocol=function(){this.generateEvent=function(e,t,i,n){return n.seq=e,n.st=t,n.t=i,n},this.generateSessionEndEvent=function(e,t){var i=m.EVENT_TYPE_SESSION_END;return this.generateEvent(e,t,i,{})}};m.version="2.4",m.gatewayPath="/0/wsg",m.DEFAULT_CLIENT_ID="0",m.DEFAULT_MAX_HEARTBEAT_INFOS=0,m.DEFAULT_PLAYHEAD_TIME=-1,m.DEFAULT_BUFFER_LENGTH=-1,m.DEFAULT_SIGNAL_STRENGTH=1e3,m.SDK_METADATA_SCHEMA="sdk.js.1",m.EVENT_TYPE_STATE_CHANGE="CwsStateChangeEvent",m.EVENT_TYPE_ERROR="CwsErrorEvent",m.EVENT_TYPE_SESSION_END="CwsSessionEndEvent",m.EVENT_TYPE_CUSTOM="CwsCustomEvent",m.EVENT_TYPE_SEEK="CwsSeekEvent",m.EVENT_TYPE_DATA_SAMPLE="CwsDataSamplesEvent",m.RESPONSE_STATUS_NO_ERRORS="ok",m.RESPONSE_KEY_STATUS="err",m.RESPONSE_KEY_CLIENT_ID="clid",m.RESPONSE_KEY_CONFIG="cfg",m.RESPONSE_KEY_EVENTS="evs",m.RESPONSE_CONFIG_KEY_MAX_HEARTBEAT_INFOS="maxhbinfos",m.RESPONSE_CONFIG_KEY_SEND_LOGS="slg",m.RESPONSE_CONFIG_KEY_HEARTBEAT_INTERVAL="hbi",m.RESPONSE_CONFIG_KEY_GATEWAY_URL="gw",m.MESSAGE_TYPE_SESSION_HEARTBEAT="CwsSessionHb",m.REQUEST_KEY_MESSAGE_TYPE="t",m.REQUEST_KEY_SESSION_TIME="st",m.REQUEST_KEY_SESSION_START_TIME="sst",m.REQUEST_KEY_IS_LIVE="lv",m.REQUEST_KEY_SEQUENCE_NUMBER="seq",m.REQUEST_KEY_CUSTOMER_KEY="cid",m.REQUEST_KEY_CLIENT_ID="clid",m.REQUEST_KEY_CLIENT_VERSION="clv",m.REQUEST_KEY_PROTOCOL_VERSION="pver",m.REQUEST_KEY_INSTANCE_ID="iid",m.REQUEST_KEY_SESSION_ID="sid",m.REQUEST_KEY_VIEWER_ID="vid",m.REQUEST_KEY_ASSET_NAME="an",m.REQUEST_KEY_PLAYER_NAME="pn",m.REQUEST_KEY_TAGS="tags",m.REQUEST_KEY_SESSION_FLAGS="sf",m.REQUEST_KEY_EVENTS="evs",m.REQUEST_KEY_LOGS="lg",m.REQUEST_KEY_HEARTBEAT_INFOS="hbinfos",m.REQUEST_KEY_IS_SDK_CLIENT="sdk",m.REQUEST_KEY_PAUSE_JOIN="pj",m.REQUEST_KEY_PLAYER_STATE="ps",m.REQUEST_KEY_BITRATE="br",m.REQUEST_KEY_CONTENT_LENGTH="cl",m.REQUEST_KEY_ENCODED_FRAME_RATE="efps",m.REQUEST_KEY_AVERAGE_FRAME_RATE="afps",m.REQUEST_KEY_RFPS_TOTAL="rfpstot",m.REQUEST_KEY_RFPS_COUNT="rfpscnt",m.REQUEST_KEY_RESOURCE="rs",m.REQUEST_KEY_PLAYHEAD_TIME="pht",m.REQUEST_KEY_BUFFER_LENGTH="bl",m.REQUEST_KEY_STREAM_URL="url",m.REQUEST_KEY_CAPABILITIES="caps",m.REQUEST_KEY_PLATFORM_METADATA="pm",m.REQUEST_KEY_VIDEO_WIDTH="w",m.REQUEST_KEY_VIDEO_HEIGHT="h",m.REQUEST_KEY_CONNECTION_TYPE="ct",m.REQUEST_KEY_LINK_ENCRYPTION="le",m.REQUEST_KEY_SIGNAL_STRENGTH="ss",m.REQUEST_KEY_STREAM_METADATA_CHANGE="strmetadata",m.REQUEST_PLATFORM_METADATA_KEY_SCHEMA="sch",m.REQUEST_PLATFORM_METADATA_KEY_BROWSER_NAME="br",m.REQUEST_PLATFORM_METADATA_KEY_BROWSER_VERSION="brv",m.REQUEST_PLATFORM_METADATA_KEY_DEVICE_BRAND="dvb",m.REQUEST_PLATFORM_METADATA_KEY_DEVICE_MANUFACTURER="dvma",m.REQUEST_PLATFORM_METADATA_KEY_DEVICE_MODEL="dvm",m.REQUEST_PLATFORM_METADATA_KEY_DEVICE_TYPE="dvt",m.REQUEST_PLATFORM_METADATA_KEY_DEVICE_VERSION="dvv",m.REQUEST_PLATFORM_METADATA_KEY_FRAMEWORK_NAME="fw",m.REQUEST_PLATFORM_METADATA_KEY_FRAMEWORK_VERSION="fwv",m.REQUEST_PLATFORM_METADATA_KEY_CLIENT_CONFIGURATION="cc",m.REQUEST_PLATFORM_METADATA_KEY_MODULE_NAME="mn",m.REQUEST_PLATFORM_METADATA_KEY_MODULE_VERSION="mv",m.REQUEST_PLATFORM_METADATA_KEY_OPERATING_SYSTEM_NAME="os",m.REQUEST_PLATFORM_METADATA_KEY_OPERATING_SYSTEM_VERSION="osv",m.REQUEST_PLATFORM_METADATA_KEY_DEVICE_CATEGORY="cat",m.REQUEST_KEY_PROTOCOL_CAPP="caps",m.REQUEST_EVENT_KEY_TYPE="t",m.REQUEST_EVENT_KEY_SEQUENCE_NUMBER="seq",m.REQUEST_EVENT_KEY_SESSION_TIME="st",m.REQUEST_EVENT_KEY_SEEK_ACT_TYPE="act",m.REQUEST_EVENT_KEY_SEEK_TO_POS="skto",m.REQUEST_ERROR_EVENT_KEY_MESSAGE="err",m.REQUEST_ERROR_EVENT_KEY_FATAL="ft",m.REQUEST_STATE_CHANGE_EVENT_KEY_NEW="new",m.REQUEST_STATE_CHANGE_EVENT_KEY_OLD="old",m.REQUEST_CUSTOM_EVENT_KEY_NAME="name",m.REQUEST_CUSTOM_EVENT_KEY_ATTRIBUTES="attr",m.REQUEST_HEARTBEAT_INFO_KEY_SEQUENCE_NUMBER="seq",m.REQUEST_HEARTBEAT_INFO_KEY_STATUS="err",m.REQUEST_HEARTBEAT_INFO_KEY_ROUNDTRIP_TIME="rtt",m.REQUEST_KEY_IS_AD_SESSION="ad",m.convertPlayerState=function(e){switch(e){case s.PlayerState.STOPPED:return m.eStopped;case s.PlayerState.PLAYING:return m.ePlaying;case s.PlayerState.BUFFERING:return m.eBuffering;case s.PlayerState.PAUSED:return m.ePaused;case s.PlayerState.NOT_MONITORED:return m.eNotMonitored;default:return m.eUnknown}},m.eStopped=1,m.ePlaying=3,m.eBuffering=6,m.ePaused=12,m.eNotMonitored=98,m.eUnknown=100,m.SessionFlags={GLOBAL:0,VIDEO:1,QUALITY_METRICS:2,BITRATE_METRICS:4},m.Capabilities={INSIGHTS:0};var v=(t.JSONInterface=function(){this.encode=function(e){},this.decode=function(e){}},t.LibJSONInterface=function(){this.encode=function(e){var t=null;try{t=g.stringify(e)}catch(e){}return t},this.decode=function(e){var t=null;try{t=_(e)}catch(e){}return x.isObject(t)||(t=null),t}}),y=t.CwsHeartbeat=function(){function e(){}this._data={},e.apply(this,arguments),this.get=function(){return this._data},this.setField=function(e,t){this._data[e]=t},this.setInnerField=function(e,t,i){this._data[e]||(this._data[e]={}),this._data[e][t]=i},this.setMessageType=function(e){this.setField(m.REQUEST_KEY_MESSAGE_TYPE,e)},this.setSessionTime=function(e){this.setField(m.REQUEST_KEY_SESSION_TIME,e)},this.setSessionStartTime=function(e){this.setField(m.REQUEST_KEY_SESSION_START_TIME,e)},this.setIsLive=function(e){this.setField(m.REQUEST_KEY_IS_LIVE,e)},this.setSequenceNumber=function(e){this.setField(m.REQUEST_KEY_SEQUENCE_NUMBER,e)},this.setCustomerKey=function(e){this.setField(m.REQUEST_KEY_CUSTOMER_KEY,e)},this.setClientId=function(e){this.setField(m.REQUEST_KEY_CLIENT_ID,e)},this.setClientVersion=function(e){this.setField(m.REQUEST_KEY_CLIENT_VERSION,e)},this.setProtocolVersion=function(e){this.setField(m.REQUEST_KEY_PROTOCOL_VERSION,e)},this.setCapfield=function(e){this.setField(m.REQUEST_KEY_PROTOCOL_CAPP,e)},this.setSessionId=function(e){this.setField(m.REQUEST_KEY_SESSION_ID,e)},this.setInstanceId=function(e){this.setField(m.REQUEST_KEY_INSTANCE_ID,e)},this.setViewerId=function(e){this.setField(m.REQUEST_KEY_VIEWER_ID,e)},this.setAssetName=function(e){this.setField(m.REQUEST_KEY_ASSET_NAME,e)},this.setPlayerName=function(e){this.setField(m.REQUEST_KEY_PLAYER_NAME,e)},this.setTags=function(e){this.setField(m.REQUEST_KEY_TAGS,e)},this.setSessionFlags=function(e){this.setField(m.REQUEST_KEY_SESSION_FLAGS,e)},this.setCapabilities=function(e){this.setField(m.REQUEST_KEY_CAPABILITIES,e)},this.setEvents=function(e){this.setField(m.REQUEST_KEY_EVENTS,e)},this.setIsSdkClient=function(e){this.setField(m.REQUEST_KEY_IS_SDK_CLIENT,e)},this.setLogs=function(e){this.setField(m.REQUEST_KEY_LOGS,e)},this.setHeartbeatInfos=function(e){this.setField(m.REQUEST_KEY_HEARTBEAT_INFOS,e)},this.setPlayerState=function(e){this.setField(m.REQUEST_KEY_PLAYER_STATE,e)},this.setPauseJoin=function(e){this.setField(m.REQUEST_KEY_PAUSE_JOIN,e)},this.setContentLength=function(e){this.setField(m.REQUEST_KEY_CONTENT_LENGTH,e)},this.setBitrate=function(e){this.setField(m.REQUEST_KEY_BITRATE,e)},this.setResource=function(e){this.setField(m.REQUEST_KEY_RESOURCE,e)},this.setEncodedFrameRate=function(e){this.setField(m.REQUEST_KEY_ENCODED_FRAME_RATE,e)},this.setAverageFrameRate=function(e){this.setField(m.REQUEST_KEY_AVERAGE_FRAME_RATE,e)},this.setRfpsObservationCount=function(e){this.setField(m.REQUEST_KEY_RFPS_COUNT,e)},this.setRfpsTotal=function(e){this.setField(m.REQUEST_KEY_RFPS_TOTAL,e)},this.setPlatformMetadataSchema=function(e){this.setInnerField(m.REQUEST_KEY_PLATFORM_METADATA,m.REQUEST_PLATFORM_METADATA_KEY_SCHEMA,e)},this.setBrowserName=function(e){this.setInnerField(m.REQUEST_KEY_PLATFORM_METADATA,m.REQUEST_PLATFORM_METADATA_KEY_BROWSER_NAME,e)},this.setBrowserVersion=function(e){this.setInnerField(m.REQUEST_KEY_PLATFORM_METADATA,m.REQUEST_PLATFORM_METADATA_KEY_BROWSER_VERSION,e)},this.setDeviceBrand=function(e){this.setInnerField(m.REQUEST_KEY_PLATFORM_METADATA,m.REQUEST_PLATFORM_METADATA_KEY_DEVICE_BRAND,e)},this.setDeviceManufacturer=function(e){this.setInnerField(m.REQUEST_KEY_PLATFORM_METADATA,m.REQUEST_PLATFORM_METADATA_KEY_DEVICE_MANUFACTURER,e)},this.setDeviceModel=function(e){this.setInnerField(m.REQUEST_KEY_PLATFORM_METADATA,m.REQUEST_PLATFORM_METADATA_KEY_DEVICE_MODEL,e)},this.setDeviceType=function(e){this.setInnerField(m.REQUEST_KEY_PLATFORM_METADATA,m.REQUEST_PLATFORM_METADATA_KEY_DEVICE_TYPE,e)},this.setDeviceVersion=function(e){this.setInnerField(m.REQUEST_KEY_PLATFORM_METADATA,m.REQUEST_PLATFORM_METADATA_KEY_DEVICE_VERSION,e)},this.setFrameworkName=function(e){this.setInnerField(m.REQUEST_KEY_PLATFORM_METADATA,m.REQUEST_PLATFORM_METADATA_KEY_FRAMEWORK_NAME,e),this.setField(m.REQUEST_PLATFORM_METADATA_KEY_FRAMEWORK_NAME,e)},this.setFrameworkVersion=function(e){this.setInnerField(m.REQUEST_KEY_PLATFORM_METADATA,m.REQUEST_PLATFORM_METADATA_KEY_FRAMEWORK_VERSION,e),this.setField(m.REQUEST_PLATFORM_METADATA_KEY_FRAMEWORK_VERSION,e)},this.setOperatingSystemName=function(e){this.setInnerField(m.REQUEST_KEY_PLATFORM_METADATA,m.REQUEST_PLATFORM_METADATA_KEY_OPERATING_SYSTEM_NAME,e.toUpperCase())},this.setOperatingSystemVersion=function(e){this.setInnerField(m.REQUEST_KEY_PLATFORM_METADATA,m.REQUEST_PLATFORM_METADATA_KEY_OPERATING_SYSTEM_VERSION,e)},this.setDeviceCategory=function(e){this.setInnerField(m.REQUEST_KEY_PLATFORM_METADATA,m.REQUEST_PLATFORM_METADATA_KEY_DEVICE_CATEGORY,e)},this.setPlayheadTime=function(e){this.setField(m.REQUEST_KEY_PLAYHEAD_TIME,e)},this.setBufferLength=function(e){this.setField(m.REQUEST_KEY_BUFFER_LENGTH,e)},this.setStreamUrl=function(e){this.setField(m.REQUEST_KEY_STREAM_URL,e)},this.setStreamWidth=function(e){this.setField(m.REQUEST_KEY_VIDEO_WIDTH,e)},this.setStreamHeight=function(e){this.setField(m.REQUEST_KEY_VIDEO_HEIGHT,e)},this.setConnectionType=function(e){this.setField(m.REQUEST_KEY_CONNECTION_TYPE,e)},this.setLinkEncryption=function(e){this.setField(m.REQUEST_KEY_LINK_ENCRYPTION,e)},this.setIsAdSession=function(){this.setField(m.REQUEST_KEY_IS_AD_SESSION,!0)},this.setSignalStrength=function(e){this.setField(m.REQUEST_KEY_SIGNAL_STRENGTH,e)},this.setModuleName=function(e){this.setInnerField(m.REQUEST_PLATFORM_METADATA_KEY_CLIENT_CONFIGURATION,m.REQUEST_PLATFORM_METADATA_KEY_MODULE_NAME,e)},this.setModuleVersion=function(e){this.setInnerField(m.REQUEST_PLATFORM_METADATA_KEY_CLIENT_CONFIGURATION,m.REQUEST_PLATFORM_METADATA_KEY_MODULE_VERSION,e)}},b=t.CwsSession=function(e,t,n,r,a,o,l,c,u,h,d){function p(e,t,i,n,r,a,o,s,l,c,u){this._eventQueue=e,this._client=t,this._clientSettings=i,this._logger=n,this._logger.setModuleName("CwsSession"),this._exceptionCatcher=r,this._timer=a,this._gatewayControl=o,this._cwsProtocol=s,this._time=l,this._logBuffer=c,this._clientConfig=u}var f=this;f._heartbeatTimerCancel=null,f._startTimeMs=0,f._heartbeatSequenceNumber=0,f._sessionFlags=m.SessionFlags.GLOBAL,f._capabilities=m.Capabilities.INSIGHTS,f._heartbeatInfos=[],f._lastRequestSentMs=-1,f._bitrateKbps=-2,f._resource=null,f._playerState=s.PlayerState.NOT_MONITORED,f._encodedFrameRate=-1,f._contentLengthSec=-1,f._streamUrl=null,f._width=-1,f._height=-1,f._playerStateManager=null,f._assetName=null,f._viewerId=null,f._playerName=null,f._isLive=null,f._tags={},f._browserName=null,f._browserVersion=null,f._deviceBrand=null,f._deviceManufacturer=null,f._deviceModel=null,f._deviceType=null,f._deviceVersion=null,f._frameworkName=null,f._frameworkVersion=null,f._operatingSystemName=null,f._operatingSystemVersion=null,f._deviceCategory=null,f._moduleName=null,f._moduleVersion=null,f._connectionType=null,f._linkEncryption=null,f._pauseJoin=!1,f._hasJoined=!1,f._cleanedUp=!1,f._willEndSoon=!1,f._rfpsTimerCancel=null,f._rfpsTimerInterval=1e3,f._playingFpsObservationCount=0,f._playingFpsTotal=0,p.apply(this,arguments),this.cleanup=function(){this._clientConfig=null,this._logBuffer=null,this._systemSettings=null,this._time=null,this._cwsProtocol=null,this._gatewayControl=null,this._timer=null,this._exceptionCatcher=null,this._logger=null,this._clientSettings=null,this._client=null,this._eventQueue.flush(),this._eventQueue=null,this._cleanedUp=!0},this.start=function(e){this._session=e,this._global=this._session._global,this._logger.setSessionId(this._session._id),this._startTimeMs=this._time.current(),(this.isVideoSession()||this.isAdSession())&&(this._sessionFlags+=b.DEFAULT_VIDEO_SESSION_FLAGS)},this.willEndSoon=function(){this._willEndSoon=!0},this.initialize=function(){this._logger.debug("initialize()")},this.end=function(){(this.isVideoSession()||this.isAdSession())&&(this._logger.debug("end(): schedule the last hb before session cleanup"+f.sessionTypeTag()),this.enqueueSessionEndEvent()),this.cancelHeartbeatTimer(),this.sendHeartbeat()},this.startSendingHeartbeats=function(){this._willEndSoon||(this.sendHeartbeat(),this.resetHeartbeatTimer())},this.setBrowserName=function(e){f._logger.debug("setBrowserName(): "+e);var t=f._browserName;t!==e&&null!=e&&(f._logger.debug("Change browserName from "+t+" to "+e),f._browserName=e)},this.setBrowserVersion=function(e){f._logger.debug("setBrowserVersion(): "+e);var t=f._browserVersion;t!==e&&null!=e&&(f._logger.debug("Change browserVersion from "+t+" to "+e),f._browserVersion=e)},this.setDeviceBrand=function(e){f._logger.debug("setDeviceBrand(): "+e);var t=f._deviceBrand;t!==e&&null!=e&&(f._logger.debug("Change deviceBrand from "+t+" to "+e),f._deviceBrand=e)},this.setDeviceManufacturer=function(e){f._logger.debug("setDeviceManufacturer(): "+e);var t=f._deviceManufacturer;t!==e&&null!=e&&(f._logger.debug("Change deviceManufacturer from "+t+" to "+e),f._deviceManufacturer=e)},this.setDeviceModel=function(e){f._logger.debug("setDeviceModel(): "+e);var t=f._deviceModel;t!==e&&null!=e&&(f._logger.debug("Change deviceModel from "+t+" to "+e),f._deviceModel=e)},this.setDeviceType=function(e){f._logger.debug("setDeviceBrand(): "+e);var t=f._deviceType;t!==e&&null!=e&&(f._logger.debug("Change deviceType from "+t+" to "+e),f._deviceType=e)},this.setDeviceVersion=function(e){f._logger.debug("setDeviceVersion(): "+e);var t=f._deviceVersion;t!==e&&null!=e&&(f._logger.debug("Change deviceVersion from "+t+" to "+e),f._deviceVersion=e)},this.setOperatingSystemName=function(e){f._logger.debug("setOperatingSystemName(): "+e);var t=f._operatingSystemName;t!==e&&null!=e&&(f._logger.debug("Change operatingSystemName from "+t+" to "+e),f._operatingSystemName=e)},this.setOperatingSystemVersion=function(e){f._logger.debug("setOperatingSystemVersion(): "+e);var t=f._operatingSystemVersion;t!==e&&null!=e&&(f._logger.debug("Change operatingSystemVersion from "+t+" to "+e),f._operatingSystemVersion=e)},this.setDeviceCategory=function(e){f._logger.debug("setDeviceCategory(): "+e);var t=f._deviceCategory;t!==e&&null!=e&&(f._logger.debug("Change operatingSystemVersion from "+t+" to "+e),f._deviceCategory=e)},this.getFrameworkName=function(){return f._frameworkName},this.setFrameworkName=function(e){f._logger.debug("setFrameworkName(): "+e);var t=f._frameworkName;t!==e&&null!=e&&(f._logger.debug("Change frameworkName from "+t+" to "+e),f._frameworkName=e)},this.getFrameworkVersion=function(){return f._frameworkVersion},this.setFrameworkVersion=function(e){f._logger.debug("setFrameworkVersion(): "+e);var t=f._frameworkVersion;t!==e&&null!=e&&(f._logger.debug("Change frameworkVersion from "+t+" to "+e),f._frameworkVersion=e)},this.setStreamUrl=function(e){f._logger.debug("setStreamUrl(): "+e);var t=f._streamUrl;t!==e&&null!=e&&(f._logger.debug("Change stream url from "+t+" to "+e),f._streamUrl=e)},this.setBitrateKbps=function(e){f._logger.debug("setBitrateKbps(): "+e);var t=f._bitrateKbps;t!==e&&e>0&&(f._logger.info("Change bitrate from "+t+" to "+e),f.enqueueBitrateChangeEvent(t,e),f._bitrateKbps=e)},this.setResource=function(e){f._logger.debug("setResource(): "+e);var t=f._resource;t!==e&&null!=e&&(f._logger.info("Change resource from "+t+" to "+e),f._resource=e)},this.setAssetName=function(e){f._logger.debug("setAssetName(): "+e),f._assetName!==e&&null!=e&&(f._logger.info("Change assetName from "+f._assetName+" to "+e),f._assetName=e)},this.setIsLive=function(e){f._logger.debug("setIsLive(): "+e);var t=f._isLive;t!==e&&null!=e&&(f._logger.info("Change isLive from "+t+" to "+e),f._isLive=e)},this.setViewerId=function(e){f._logger.debug("setViewerId(): "+e);var t=f._viewerId;t!==e&&null!=e&&(f._logger.info("Change viewerId from "+t+" to "+e),f._viewerId=e)},this.setPlayerName=function(e){f._logger.debug("setPlayerName(): "+e);var t=f._playerName;t!==e&&null!=e&&(f._logger.info("Change playerName from "+t+" to "+e),f._playerName=e)},this.setTags=function(e){f._logger.debug("setTags()");var t=f._tags;x.ObjectShallowEquals(t,e)||null==e||(f._logger.info("Change tags from "+x.ObjectToString(t)+" to "+x.ObjectToString(e)),f._tags=e)},this.setEncodedFrameRate=function(e){f._logger.debug("setEncodedFrameRate(): "+e),f._encodedFrameRate=e},this.setContentLength=function(e){f._logger.debug("setContentLength(): "+e),f._contentLengthSec=e},this.setPlayerState=function(e){if(f._logger.debug("setPlayerState(): "+e),f._hasJoined||e!=s.PlayerState.PLAYING||(f.togglePauseJoin(!1),f._hasJoined=!0),f._playerState!==e){var t=f._playerState;f._logger.info("setPlayerState(): changing player state from "+t+" to "+e),f.enqueuePlayerStateChangeEvent(t,e),f._playerState=e}},this.setStreamResolutionWidth=function(e){f._logger.debug("setStreamResolutionWidth(): "+e);var t=f._width;t!==e&&e>0&&(f._logger.debug("Change stream resolution width from "+t+" to "+e),f.enqueueResolutionWidthChangeEvent(t,e),f._width=e)},this.setStreamResolutionHeight=function(e){f._logger.debug("setStreamResolutionHeight(): "+e);var t=f._height;t!==e&&e>0&&(f._logger.debug("Change stream resolution height from "+t+" to "+e),f.enqueueResolutionHeightChangeEvent(t,e),f._height=e)},this.setConnectionType=function(e){f._logger.debug("setConnectionType(): "+e);var t=f._connectionType;t!==e&&null!=e&&(f._logger.debug("Change network connection type from "+t+" to "+e),f.enqueueConnectionTypeChangeEvent(t,e),f._connectionType=e)},this.setLinkEncryption=function(e){f._logger.debug("setLinkEncryption(): "+e);var t=f._linkEncryption;t!==e&&null!=e&&(f._logger.debug("Change network link encryption from "+t+" to "+e),f.enqueueLinkEncryptionChangeEvent(t,e),f._linkEncryption=e)},this.togglePauseJoin=function(e){if(f._logger.debug("togglePauseJoin()"),f._pauseJoin!==e){var t=f._pauseJoin,i=!f._pauseJoin;f.enqueuePauseJoinChangeEvent(t,i),f._pauseJoin=!f._pauseJoin}else f._logger.debug("togglePauseJoin(): same value, ignoring")},this.sendError=function(e,t){f.enqueueErrorEvent(e,t)},this.enqueueEvent=function(e,t){if(t[m.REQUEST_EVENT_KEY_TYPE]=e,t[m.REQUEST_EVENT_KEY_SESSION_TIME]=this.getSessionTime(),t[m.REQUEST_EVENT_KEY_SEQUENCE_NUMBER]=this._eventQueue.getNumber(),this._playerStateManager){var i=D.Integer(this._playerStateManager.getPHT(),0,null,-1),n=D.Integer(this._playerStateManager.getBufferLength(),0,null,-1);i>=0&&(t[m.REQUEST_KEY_PLAYHEAD_TIME]=i),n>0&&(t[m.REQUEST_KEY_BUFFER_LENGTH]=n)}this._eventQueue.enqueue(t)},this.setPlayerStateManager=function(e){f._playerStateManager=e,null!=f._playerStateManager?f.startRfpsTimer():f.cancelRfpsTimer()},this.enqueueSessionEndEvent=function(){var e=this.getSessionTime(),t=this.getNextEventNumber(),i=this._cwsProtocol.generateSessionEndEvent(t,e);this._eventQueue.enqueue(i)},this.enqueueErrorEvent=function(e,t){var i={};i[m.REQUEST_ERROR_EVENT_KEY_MESSAGE]=e,i[m.REQUEST_ERROR_EVENT_KEY_FATAL]=t,this.enqueueEvent(m.EVENT_TYPE_ERROR,i)},this.enqueueBitrateChangeEvent=function(e,t){var i={},n={};e>0&&(n[m.REQUEST_KEY_BITRATE]=e),i[m.REQUEST_KEY_BITRATE]=t,this.declareStateChange(i,n)},this.enqueueSeekEvent=function(e,t){var i={};i[m.REQUEST_EVENT_KEY_SEEK_ACT_TYPE]=e,t>=0&&(i[m.REQUEST_EVENT_KEY_SEEK_TO_POS]=t),this.enqueueEvent(m.EVENT_TYPE_SEEK,i)},this.enqueueResolutionWidthChangeEvent=function(e,t){var i={},n={};-1!==e&&(n[m.REQUEST_KEY_VIDEO_WIDTH]=e),i[m.REQUEST_KEY_VIDEO_WIDTH]=t,this.declareStateChange(i,n)},this.enqueueResolutionHeightChangeEvent=function(e,t){var i={},n={};-1!==e&&(n[m.REQUEST_KEY_VIDEO_HEIGHT]=e),i[m.REQUEST_KEY_VIDEO_HEIGHT]=t,this.declareStateChange(i,n)},this.enqueueConnectionTypeChangeEvent=function(e,t){var i={},n={};null!==e&&(n[m.REQUEST_KEY_CONNECTION_TYPE]=e),i[m.REQUEST_KEY_CONNECTION_TYPE]=t,this.declareStateChange(i,n)},this.enqueueLinkEncryptionChangeEvent=function(e,t){var i={},n={};null!==e&&(n[m.REQUEST_KEY_LINK_ENCRYPTION]=e),i[m.REQUEST_KEY_LINK_ENCRYPTION]=t,this.declareStateChange(i,n)},this.enqueuePauseJoinChangeEvent=function(e,t){var i={},n={};n[m.REQUEST_KEY_PAUSE_JOIN]=e,i[m.REQUEST_KEY_PAUSE_JOIN]=t,this.declareStateChange(i,n)},this.enqueuePlayerStateChangeEvent=function(e,t){var i={},n={};i[m.REQUEST_KEY_PLAYER_STATE]=m.convertPlayerState(t),n[m.REQUEST_KEY_PLAYER_STATE]=m.convertPlayerState(e),this.declareStateChange(i,n)},this.declareStateChange=function(e,t){var i={};i[m.REQUEST_STATE_CHANGE_EVENT_KEY_NEW]=e,null!=t&&x.dictCount(t)>0&&(i[m.REQUEST_STATE_CHANGE_EVENT_KEY_OLD]=t),this.enqueueEvent(m.EVENT_TYPE_STATE_CHANGE,i)},this.enqueueCustomEvent=function(e,t){var i={};i[m.REQUEST_CUSTOM_EVENT_KEY_NAME]=e,i[m.REQUEST_CUSTOM_EVENT_KEY_ATTRIBUTES]=t,this.enqueueEvent(m.EVENT_TYPE_CUSTOM,i)},this.cancelHeartbeatTimer=function(){null!=f._heartbeatTimerCancel&&(f._heartbeatTimerCancel(),f._heartbeatTimerCancel=null)},this.resetHeartbeatTimer=function(){f.cancelHeartbeatTimer();var e=1e3*f._clientSettings.heartbeatInterval;f._heartbeatTimerCancel=f._timer.create(f.sendHeartbeat,e,"Session.sendHeartbeat")},this.cancelRfpsTimer=function(){null!=f._rfpsTimerCancel&&(f._rfpsTimerCancel(),f._rfpsTimerCancel=null)},this.startRfpsTimer=function(){f.cancelRfpsTimer(),f._rfpsTimerCancel=f._timer.create(f.countRfps,f._rfpsTimerInterval,"Session.startRfpsTimer")},this.createHeartbeatInfo=function(){var e={err:"pending"};e.seq=f._heartbeatSequenceNumber-1,e.sentAt=f.getSessionTime(),e.rtt=-1,f._heartbeatInfos.push(e)},this.updateHeartbeatInfoOnFailure=function(e,t){for(var i=0;i<f._heartbeatInfos.length;i++){var n=f._heartbeatInfos[i];n.seq===e&&(n.rtt=f.getSessionTime()-n.sentAt,n.err=t)}},this.updateHeartbeatInfoOnSuccess=function(e){for(var t=0;t<f._heartbeatInfos.length;t++){var i=f._heartbeatInfos[t];i.seq===e&&(i.rtt=f.getSessionTime()-i.sentAt,i.err="ok")}},this.removeOutdatedHeartbeatInfos=function(){for(var e=f._clientConfig.get(T.CONFIG_KEY_MAX_HEARTBEAT_INFOS),t=[],i=0;i<f._heartbeatInfos.length;i++)f._heartbeatInfos[i].seq<f._heartbeatSequenceNumber-e&&t.push(i);for(var n=[],r=0;r<f._heartbeatInfos.length;r++)f._heartbeatInfos[r].seq,t.indexOf(r)<0&&n.push(f._heartbeatInfos[r]);f._heartbeatInfos=n},this.compileHeartbeatInfos=function(){f.removeOutdatedHeartbeatInfos();for(var e=[],t=0;t<f._heartbeatInfos.length;t++){var i=f._heartbeatInfos[t],n={};n[m.REQUEST_HEARTBEAT_INFO_KEY_SEQUENCE_NUMBER]=i.seq,n[m.REQUEST_HEARTBEAT_INFO_KEY_ROUNDTRIP_TIME]=i.rtt,n[m.REQUEST_HEARTBEAT_INFO_KEY_STATUS]=i.err,e.push(n)}return e},this.makeHeartbeat=function(){var e=f._eventQueue.flush();if(f.isGlobalSession()&&0===e.length)return null;var t=new y;if(t.setMessageType(m.MESSAGE_TYPE_SESSION_HEARTBEAT),t.setCustomerKey(f._clientSettings.customerKey),t.setClientId(f._clientConfig.get(T.CONFIG_KEY_CLIENT_ID)),t.setSessionId(f._session._id),t.setSequenceNumber(f._heartbeatSequenceNumber),t.setProtocolVersion(m.version),t.setClientVersion(i.version),t.setInstanceId(f._client.getId()),t.setCapfield(0),null!=f._connectionType&&t.setConnectionType(f._connectionType),null!=f._linkEncryption&&t.setLinkEncryption(f._linkEncryption),t.setPlatformMetadataSchema(m.SDK_METADATA_SCHEMA),null!=f._browserName&&t.setBrowserName(f._browserName),null!=f._browserVersion&&t.setBrowserVersion(f._browserVersion),null!=f._deviceBrand&&t.setDeviceBrand(f._deviceBrand),null!=f._deviceManufacturer&&t.setDeviceManufacturer(f._deviceManufacturer),null!=f._deviceModel&&t.setDeviceModel(f._deviceModel),null!=f._deviceType&&t.setDeviceType(f._deviceType),null!=f._deviceVersion&&t.setDeviceVersion(f._deviceVersion),null!=f._frameworkName&&t.setFrameworkName(f._frameworkName),null!=f._frameworkVersion&&t.setFrameworkVersion(f._frameworkVersion),null!=f._operatingSystemName&&t.setOperatingSystemName(f._operatingSystemName),null!=f._operatingSystemVersion&&t.setOperatingSystemVersion(f._operatingSystemVersion),null!=f._deviceCategory&&t.setDeviceCategory(f._deviceCategory),null!=f._playerStateManager&&(f._moduleName=f._playerStateManager.getModuleName(),null!=f._moduleName&&t.setModuleName(f._moduleName)),null!=f._playerStateManager&&(f._moduleVersion=f._playerStateManager.getModuleVersion(),null!=f._moduleVersion&&t.setModuleVersion(f._moduleVersion)),null!=f._viewerId&&t.setViewerId(f._viewerId),x.dictCount(f._tags)>0&&t.setTags(f._tags),f.isVideoSession()||f.isAdSession()){f.isAdSession()&&t.setIsAdSession(),null!=f._assetName&&t.setAssetName(f._assetName),t.setSessionFlags(f._sessionFlags);var n,r,a,o=m.convertPlayerState(f._playerState);t.setPlayerState(o),t.setPauseJoin(f._pauseJoin),null!=f._playerName&&t.setPlayerName(f._playerName),null!=f._isLive&&t.setIsLive(f._isLive),f._contentLengthSec>0&&t.setContentLength(f._contentLengthSec),f._bitrateKbps>0&&t.setBitrate(f._bitrateKbps),null!==f._resource&&t.setResource(f._resource),f._encodedFrameRate>0&&t.setEncodedFrameRate(f._encodedFrameRate),null!=f._playerStateManager&&(n=D.Integer(f._playerStateManager.getPHT(),0,null,-1),r=D.Integer(f._playerStateManager.getBufferLength(),0,null,-1),a=f._playerStateManager.getSignalStrength()),n>=0&&t.setPlayheadTime(n),r>0&&t.setBufferLength(r);var s=f.updateAverageFrameRate();s>0&&t.setAverageFrameRate(s),f._playingFpsTotal>0&&t.setRfpsTotal(D.Integer(f._playingFpsTotal,0,null,-1)),f._playingFpsObservationCount>0&&t.setRfpsObservationCount(D.Integer(f._playingFpsObservationCount,0,null,-1)),0>=a&&t.setSignalStrength(a),null!=f._streamUrl&&t.setStreamUrl(f._streamUrl),f._width>0&&t.setStreamWidth(f._width),f._height>0&&t.setStreamHeight(f._height)}else t.setSessionFlags(m.SessionFlags.GLOBAL);if(e.length>0&&t.setEvents(e),t.setCapabilities(f._capabilities),t.setIsSdkClient(!0),f._clientConfig.get(T.CONFIG_KEY_SEND_LOGS)&&t.setLogs(f._logBuffer.flush()),f._clientConfig.get(T.CONFIG_KEY_MAX_HEARTBEAT_INFOS)>0){var l=f.compileHeartbeatInfos();l.length>0&&t.setHeartbeatInfos(l)}return t.setSessionStartTime(f._startTimeMs),t.setSessionTime(f.getSessionTime()),f._heartbeatSequenceNumber++,t.get()},this.sendHeartbeat=function(){if(!f._cleanedUp){var e=f.makeHeartbeat();null!=e&&f.postHeartbeat(e)}},this.countRfps=function(){if(f._playerState===s.PlayerState.PLAYING){var e=f._playerStateManager.getRenderedFrameRate();e>=0&&(f._playingFpsTotal+=e,f._playingFpsObservationCount++)}},this.updateAverageFrameRate=function(){if(f._playerState===s.PlayerState.PLAYING){var e=f._playerStateManager.getRenderedFrameRate();return e>=0?(f._playingFpsTotal+=e,f._playingFpsObservationCount++,x.Int32.Cast(1*f._playingFpsTotal/f._playingFpsObservationCount)):-1}return-1},this.postHeartbeat=function(e){f.createHeartbeatInfo();var t=f._heartbeatSequenceNumber-1;f._logger.info("postHeartbeat(): Send HB["+t+"]"+f.sessionTypeTag());f._gatewayControl.send(e,(function(e,i){f.onHeartbeatResponse(e,i,t)}))},this.onHeartbeatResponse=function(e,t,i){f._cleanedUp||f._exceptionCatcher.runProtected("onHeartbeatResponse",(function(){if(e){var n=t;if(null!=n){f._logger.debug("onHeartbeatResponse(): received valid response for HB["+i+"]"),f.updateHeartbeatInfoOnSuccess(i);var r=n[m.RESPONSE_KEY_CLIENT_ID];null!=r&&r!=f._clientConfig.get(T.CONFIG_KEY_CLIENT_ID)&&(f._logger.debug("onHeartbeatResponse(): setting the client id to "+r+" (from gateway)"),f._clientConfig.set(T.CONFIG_KEY_CLIENT_ID,r),f._clientConfig.save());var a=n[m.RESPONSE_KEY_STATUS];null!=a&&a!=m.RESPONSE_STATUS_NO_ERRORS&&f._logger.error("onHeartbeatResponse(): error from gateway: "+a);var o=n[m.RESPONSE_KEY_CONFIG];if("object"==typeof o){var s=o[m.RESPONSE_CONFIG_KEY_MAX_HEARTBEAT_INFOS];null!=s&&f._clientConfig.get(T.CONFIG_KEY_MAX_HEARTBEAT_INFOS)!==s&&(f._logger.debug("onHeartbeatResponse(): setting Maximum Heartbeat Infos to "+s+" (from gateway)"),f._clientConfig.set(T.CONFIG_KEY_MAX_HEARTBEAT_INFOS,s));var l=o[m.RESPONSE_CONFIG_KEY_SEND_LOGS],c=null!=l&&x.AsBoolean(l);c!==f._clientConfig.get(T.CONFIG_KEY_SEND_LOGS)&&(f._logger.debug("onHeartbeatResponse(): turning "+(c?"on":"off")+" sending of logs"),f._clientConfig.set(T.CONFIG_KEY_SEND_LOGS,c));var u=o[m.RESPONSE_CONFIG_KEY_HEARTBEAT_INTERVAL];if(null!=u){var h=x.Int32.Cast(u);h!=f._clientSettings.heartbeatInterval&&(f._logger.debug("onHeartbeatResponse(): received hbIntervalMs from gateway: "+h),f._clientSettings.heartbeatInterval=h,null!=f._heartbeatTimerCancel&&f.resetHeartbeatTimer())}var d=o[m.RESPONSE_CONFIG_KEY_GATEWAY_URL];null!=d&&d!=f._clientSettings.gatewayUrl&&(f._logger.debug("onHeartbeatResponse(): received gatewayUrl from gateway: "+d),f._clientSettings.gatewayUrl=d)}}else f._logger.warning("onHeartbeatResponse(): decoded heartbeat response is null.")}else{var p=t;x.isValidString(p)?x.stringStartsWith(p,"HTTP timeout")?f._logger.warning("onHeartbeatResponse(): "+p):f._logger.error("onHeartbeatResponse(): failed to send heartbeat: "+p):(p=S.DEFAULT_HEARTBEAT_ERROR_MESSAGE,f._logger.error("onHeartbeatResponse(): "+p)),f.updateHeartbeatInfoOnFailure(i,p)}}))},this.getSessionTime=function(){return x.Int32.Cast(f._time.current()-f._startTimeMs)},this.getNextEventNumber=function(){return this._eventQueue.getNumber()},this.sessionTypeTag=function(){return this.isGlobalSession()?" (global session)":""},this.isGlobalSession=function(){return this._global==b.SESSION_TYPE.GLOBAL},this.isVideoSession=function(){return this._global==b.SESSION_TYPE.VIDEO},this.isAdSession=function(){return this._global==b.SESSION_TYPE.AD}};b.DEFAULT_VIDEO_SESSION_FLAGS=m.SessionFlags.VIDEO+m.SessionFlags.QUALITY_METRICS+m.SessionFlags.BITRATE_METRICS,b.SESSION_TYPE={VIDEO:"Video",GLOBAL:"Global",AD:"Ad"};var S=(t.IMonitor=function(){this.onPlayerStateChange=function(e){},this.onBitrateChange=function(e){},this.onSeekEvent=function(e,t){},this.onEncodedFrameRateChange=function(e){},this.onRenderedFrameRateChange=function(e){},this.onContentLengthChange=function(e){},this.onPlayheadTimeChange=function(e){},this.onStreamUrlChange=function(e){},this.onBufferLengthChange=function(e){},this.onPlayerTypeChange=function(e){},this.onPlayerVersionChange=function(e){},this.onStreamResolutionWidthChange=function(e){},this.onStreamResolutionHeightChange=function(e){},this.onConnectionTypeChange=function(e){},this.onLinkEncryptionChange=function(e){},this.onSignalStrengthChange=function(e){},this.onError=function(e,t){},this.onRelease=function(){}},t.Session=function(){function t(e,t,i,n,r,a,o,s){this._id=e,this._global=t,this._contentMetadata=i,this._clientConfig=n,this._systemMetadata=r,this._cwsSession=a,this._exceptionCatcher=o,this._logger=s,this._logger.setModuleName("Session"),this._logger.setSessionId(x.ToString(this._id))}var i=this;i._contentMetadata=null,i._playerStateManager=null,i._id=0,i._global=b.SESSION_TYPE.VIDEO,i._cleaningUp=!1,i._cleanedUp=!1,i._adPlaying=!1,i._adStream=null,i._adPlayer=null,i._adPosition=null,i._ignorePlayerState=!1,i._pooledPlayerState=s.PlayerState.NOT_MONITORED,i._ignoreBitrateAndResource=!1,i._ignorePlayheadTimeandBufferLength=!1,i._ignoreEncodedFrameRateAndDuration=!1,i._ignoreError=!1,t.apply(i,arguments),this.start=function(){if(i.isVideoSession()||i.isAdSession()?i._logger.info("start(): assetName="+i._contentMetadata.assetName):i._logger.info("start()"+i.sessionTypeTag()),i._cwsSession.start(this),i._clientConfig.isReady())i.initiateSession();else{i._clientConfig.register((function(){i.initiateSession()}))}},this.cleanup=function(){if(i._logger.info("cleanup()"+i.sessionTypeTag()),i._cleaningUp=!0,i._cwsSession.willEndSoon(),i._clientConfig.isReady())i.endCwsSessionAndCleanupAll();else{i._clientConfig.register((function(){i.endCwsSessionAndCleanupAll()}))}},this.cleanupAll=function(){i._logger.debug("cleanupAll()"+i.sessionTypeTag()),(i.isVideoSession()||i.isAdSession())&&null!=i._playerStateManager&&i.detachPlayer(),i._contentMetadata=null,i._logger.setSessionId(null),i._logger=null,i._exceptionCatcher=null,i._client=null,i._clientConfig=null,i._systemMetadata=null,i._cwsSession.cleanup(),i._cwsSession=null,i._cleanedUp=!0},this.endCwsSessionAndCleanupAll=function(){i._cwsSession.end(),i.cleanupAll()},this.initiateSession=function(){i._cwsSession.initialize(),i.setStatesFromSystemMetadata(),(i.isVideoSession()||i.isAdSession())&&(i.setStatesFromContentMetadata(),i.enqueueEventForContentMetadata()),i._cwsSession.startSendingHeartbeats()},this.enqueueEventForContentMetadata=function(){var t={};if(null!=i._contentMetadata.assetName?t[m.REQUEST_KEY_ASSET_NAME]=i._contentMetadata.assetName:i._logger.warning("enqueueEventForContentMetadata(): assetName was not set."),null!=i._contentMetadata.applicationName?(void 0===t[m.REQUEST_KEY_STREAM_METADATA_CHANGE]&&(t[m.REQUEST_KEY_STREAM_METADATA_CHANGE]={}),t[m.REQUEST_KEY_STREAM_METADATA_CHANGE][m.REQUEST_KEY_PLAYER_NAME]=i._contentMetadata.applicationName):i._logger.warning("enqueueEventForContentMetadata(): applicationName was not set."),null!=i._contentMetadata.streamUrl?t[m.REQUEST_KEY_STREAM_URL]=i._contentMetadata.streamUrl:i._logger.warning("enqueueEventForContentMetadata(): streamUrl was not set."),null!=i._contentMetadata.viewerId?(void 0===t[m.REQUEST_KEY_STREAM_METADATA_CHANGE]&&(t[m.REQUEST_KEY_STREAM_METADATA_CHANGE]={}),t[m.REQUEST_KEY_STREAM_METADATA_CHANGE][m.REQUEST_KEY_VIEWER_ID]=i._contentMetadata.viewerId):i._logger.warning("enqueueEventForContentMetadata(): viewerId was not set."),null!=i._contentMetadata.defaultResource?t[m.REQUEST_KEY_RESOURCE]=i._contentMetadata.defaultResource:i._logger.warning("enqueueEventForContentMetadata(): defaultResource was not set."),i._contentMetadata.duration>-1?t[m.REQUEST_KEY_CONTENT_LENGTH]=i._contentMetadata.duration:i._logger.warning("enqueueEventForContentMetadata(): duration was not set."),i._contentMetadata.encodedFrameRate>-1?t[m.REQUEST_KEY_ENCODED_FRAME_RATE]=i._contentMetadata.encodedFrameRate:i._logger.warning("enqueueEventForContentMetadata(): encodedFrameRate was not set."),i._contentMetadata.streamType!=r.StreamType.UNKNOWN?i._contentMetadata.streamType==e.ContentMetadata.StreamType.LIVE?t[m.REQUEST_KEY_IS_LIVE]=!0:t[m.REQUEST_KEY_IS_LIVE]=!1:i._logger.warning("enqueueEventForContentMetadata(): streamType was not set."),x.dictCount(i._contentMetadata.custom)>0)for(var n in t[m.REQUEST_KEY_TAGS]={},i._contentMetadata.custom)t[m.REQUEST_KEY_TAGS][n]=i._contentMetadata.custom[n];else i._logger.warning("enqueueEventForContentMetadata(): custom tags were not set.");x.dictCount(t)>0&&i._cwsSession.declareStateChange(t,null)},this.setStatesFromSystemMetadata=function(){i._logger.debug("setStatesFromSystemMetadata()");var e=i._systemMetadata.get(),t=e[N.BROWSER_NAME];null!=t&&i._cwsSession.setBrowserName(t);var n=e[N.BROWSER_VERSION];null!=n&&i._cwsSession.setBrowserVersion(n);var r=e[N.DEVICE_BRAND];null!=r&&i._cwsSession.setDeviceBrand(r);var a=e[N.DEVICE_MANUFACTURER];null!=a&&i._cwsSession.setDeviceManufacturer(a);var o=e[N.DEVICE_MODEL];null!=o&&i._cwsSession.setDeviceModel(o);var s=e[N.DEVICE_TYPE];null!=s&&i._cwsSession.setDeviceType(s);var l=e[N.DEVICE_VERSION];null!=l&&i._cwsSession.setDeviceVersion(l);var c=e[N.FRAMEWORK_NAME];null!=c&&i._cwsSession.setFrameworkName(c);var u=e[N.FRAMEWORK_VERSION];null!=u&&i._cwsSession.setFrameworkVersion(u);var h=e[N.OPERATING_SYSTEM_NAME];null!=h&&i._cwsSession.setOperatingSystemName(h);var d=e[N.OPERATING_SYSTEM_VERSION];null!=d&&i._cwsSession.setOperatingSystemVersion(d);var p=e[N.DEVICE_CATEGORY];null!=p&&i._cwsSession.setDeviceCategory(p)},this.setStatesFromContentMetadata=function(){if(i._logger.debug("setStatesFromContentMetadata()"),null!=i._contentMetadata.defaultResource&&i._cwsSession.setResource(i._contentMetadata.defaultResource),null!=i._contentMetadata.streamUrl&&i._cwsSession.setStreamUrl(i._contentMetadata.streamUrl),i._contentMetadata.duration>0&&i._cwsSession.setContentLength(i._contentMetadata.duration),i._contentMetadata.encodedFrameRate>0&&i._cwsSession.setEncodedFrameRate(i._contentMetadata.encodedFrameRate),i._contentMetadata.streamType!==r.StreamType.UNKNOWN){var e=i._contentMetadata.streamType===r.StreamType.LIVE;i._cwsSession.setIsLive(e)}null!=i._contentMetadata.assetName&&i._cwsSession.setAssetName(i._contentMetadata.assetName),null!=i._contentMetadata.viewerId&&i._cwsSession.setViewerId(i._contentMetadata.viewerId),null!=i._contentMetadata.applicationName&&i._cwsSession.setPlayerName(i._contentMetadata.applicationName),x.dictCount(i._contentMetadata.custom)>0&&i._cwsSession.setTags(i._contentMetadata.custom)},this.onPlayerStateChange=function(e){return i._logger.debug("onPlayerStateChange(): "+e),i._cwsSession._playerState!=e?(i._cwsSession._playerState==s.PlayerState.NOT_MONITORED&&e!=s.PlayerState.NOT_MONITORED&&(i._pooledPlayerState=e),i._ignorePlayerState?void i._logger.debug("onPlayerStateChange(): "+e+" (pooled, "+(i._adPlaying?"ad playing":"preloading")+")"):void i._cwsSession.setPlayerState(e)):void 0},this.onBitrateChange=function(e){return i._logger.debug("onBitrateChange(): "+e),i._ignoreBitrateAndResource?void i._logger.info("onBitrateChange(): ignored"):void i._cwsSession.setBitrateKbps(e)},this.onSeekEvent=function(e,t){null==t||x.isInteger(t)||(i._logger.error("onSeekEvent(): Ignored non-integer seekToPosition data: "+t),t=-1),i._cwsSession.enqueueSeekEvent(e,t)},this.onEncodedFrameRateChange=function(e){i._logger.debug("onEncodedFrameRateChange(): "+e),i._contentMetadata.encodedFrameRate>0||(e>0?i._ignoreEncodedFrameRateAndDuration?i._logger.info("onEncodedFrameRateChange(): Ignored encoded frame rate data: "+e+" (ads)"):(i._cwsSession.setEncodedFrameRate(e),i._logger.info("onEncodedFrameRateChange(): Received encoded frame rate data: "+e)):i._logger.warning("onEncodedFrameRateChange(): Ignored invalid encoded frame rate data: "+e))},this.onContentLengthChange=function(e){i._logger.debug("onContentLengthChange(): "+e),i._contentMetadata.duration>0||(e>0?i._ignoreEncodedFrameRateAndDuration?i._logger.info("setContentLength(): Ignored content length data: "+e+" (ads)"):(i._cwsSession.setContentLength(e),i._logger.info("setContentLength(): Received content length data: "+e)):i._logger.warning("setContentLength(): Ignored invalid content length data: "+e))},this.onStreamUrlChange=function(e){i._logger.debug("onStreamUrlChange(): "+e),null==i._contentMetadata.streamUrl&&i._cwsSession.setStreamUrl(e)},this.onStreamResolutionWidthChange=function(e){i._logger.debug("onStreamResolutionWidthChange(): "+e),i._cwsSession.setStreamResolutionWidth(e)},this.onStreamResolutionHeightChange=function(e){i._logger.debug("onStreamResolutionHeightChange(): "+e),i._cwsSession.setStreamResolutionHeight(e)},this.onConnectionTypeChange=function(e){i._logger.debug("onConnectionTypeChange(): "+e),i._cwsSession.setConnectionType(e)},this.onLinkEncryptionChange=function(e){i._logger.debug("onLinkEncryptionChange(): "+e),i._cwsSession.setLinkEncryption(e)},this.onPlayerTypeChange=function(e){i._logger.debug("onPlayerTypeChange(): "+e),null==i._cwsSession.getFrameworkName()&&i._cwsSession.setFrameworkName(e)},this.onPlayerVersionChange=function(e){i._logger.debug("onPlayerVersionChange(): "+e),null==i._cwsSession.getFrameworkVersion()&&i._cwsSession.setFrameworkVersion(e)},this.onError=function(e,t){i._logger.debug("onError(): "+e+" ("+t+")"),i.reportError(e,t)},this.onRelease=function(){i._logger.debug("onRelease()"),i.detachPlayer()},this.adStart=function(t,n,r){return i._logger.debug("adStart(): adStream="+t+" adPlayer="+n+" adPosition="+r),i._adPlaying?void i._logger.warning("adStart(): multiple adStart calls, ignoring"):(i._adPlaying=!0,i._adStream=t,i._adPlayer=n,i._adPosition=r,i._cwsSession._hasJoined||i._cwsSession.togglePauseJoin(!0),void(i._adStream==e.Client.AdStream.CONTENT||i._adPlayer==e.Client.AdPlayer.SEPARATE?(i._cwsSession._playerState!==s.PlayerState.NOT_MONITORED&&(i._pooledPlayerState=i._cwsSession._playerState),i._cwsSession.setPlayerState(s.PlayerState.NOT_MONITORED),i._ignorePlayerState=!0):i._adStream==e.Client.AdStream.SEPARATE&&i._adPlayer==e.Client.AdPlayer.CONTENT&&(i._cwsSession._playerState!==s.PlayerState.NOT_MONITORED&&(i._pooledPlayerState=i._cwsSession._playerState),i._cwsSession.setPlayerState(s.PlayerState.NOT_MONITORED),i._ignorePlayerState=!0,i._ignoreBitrateAndResource=!0,i._ignoreEncodedFrameRateAndDuration=!0,i._ignorePlayheadTimeandBufferLength=!0,i._ignoreError=!0)))},this.adEnd=function(){return i._logger.debug("adEnd()"),i._adPlaying?(i._cwsSession._hasJoined||i._cwsSession.togglePauseJoin(!1),i._adStream==e.Client.AdStream.CONTENT||i._adPlayer==e.Client.AdPlayer.SEPARATE?i._preloading||(i._ignorePlayerState=!1,i._cwsSession.setPlayerState(i._pooledPlayerState)):i._adStream==e.Client.AdStream.SEPARATE&&i._adPlayer==e.Client.AdPlayer.CONTENT&&(i._ignoreBitrateAndResource=!1,i._ignoreEncodedFrameRateAndDuration=!1,i._ignorePlayheadTimeandBufferLength=!1,i._ignoreError=!1,i._preloading||(i._ignorePlayerState=!1,i._cwsSession.setPlayerState(i._pooledPlayerState))),i._adPlaying=!1,void(i._adStream=i._adPlayer=i._adPosition=null)):void i._logger.debug("adEnd(): called before adStart, ignoring")},this.detachPlayer=function(){i._logger.debug("detachPlayer()"),null!==i._playerStateManager&&(i._exceptionCatcher.runProtected("Session.detachPlayer",(function(){i._playerStateManager.removeMonitoringNotifier()})),i._playerStateManager=null,i._cwsSession.setPlayerStateManager(null),i._cwsSession.setPlayerState(s.PlayerState.NOT_MONITORED))},this.attachPlayer=function(e){return i._logger.debug("attachPlayer()"),null!=i._playerStateManager?void i._logger.error("attachPlayer(): detach current PlayerStateManager first"):void i._exceptionCatcher.runProtected("Session.attachPlayer()",(function(){e.setMonitoringNotifier(i,i._id)?(e.pushCurrentState(),i._playerStateManager=e,i._cwsSession.setPlayerStateManager(i._playerStateManager)):i._logger.error("attachPlayer(): instance of PlayerStateManager is already attached to a session")}))},this.getPlayerStateManager=function(){return i._logger.debug("getPlayerStateManager()"),i._playerStateManager},this.contentPreload=function(){return i._logger.debug("contentPreload()"),i._preloading?void i._logger.debug("contentPreload(): called twice, ignoring"):(i._preloading=!0,void(i._ignorePlayerState=!0))},this.contentStart=function(){return i._logger.debug("contentStart()"),i._preloading?(i._preloading=!1,void(i._adPlaying||(i._ignorePlayerState=!1,i._cwsSession.setPlayerState(i._pooledPlayerState)))):void i._logger.warning("contentStart(): called without contentPreload, ignoring")},this.reportError=function(t,n){if(i._logger.info("reportError(): "+t),x.isValidString(t))if(n===e.Client.ErrorSeverity.FATAL||n===e.Client.ErrorSeverity.WARNING)if(i._ignoreError)i._logger.debug("reportError(): ignored");else{var r=n===e.Client.ErrorSeverity.FATAL;i._cwsSession.sendError(t,r)}else i._logger.error("reportError(): invalid error severity: "+n);else i._logger.error("reportError(): invalid error message string: "+t)},this.updateContentMetadata=function(e){i._logger.debug("updateContentMetadata(): enter"),i._exceptionCatcher.runProtected("Session.updateContentMetadata",(function(){i.mergeContentMetadata(e),i.setStatesFromContentMetadata()}))},this.sendCustomEvent=function(e,t){i._logger.info("sendEvent(): eventName="+e+i.sessionTypeTag()),i._cwsSession.enqueueCustomEvent(e,t)},this.mergeContentMetadata=function(t){var n={},a={};if(x.isValidString(t.assetName)&&(i._contentMetadata.assetName!=t.assetName?(null!=i._contentMetadata.assetName&&(n[m.REQUEST_KEY_ASSET_NAME]=i._contentMetadata.assetName),a[m.REQUEST_KEY_ASSET_NAME]=t.assetName,i._contentMetadata.assetName=t.assetName):i._logger.warning("mergeContentMetadata(): assetName was not changed.")),x.isValidString(t.applicationName)&&(i._contentMetadata.applicationName!=t.applicationName?(null!=i._contentMetadata.applicationName&&(void 0===n[m.REQUEST_KEY_STREAM_METADATA_CHANGE]&&(n[m.REQUEST_KEY_STREAM_METADATA_CHANGE]={}),n[m.REQUEST_KEY_STREAM_METADATA_CHANGE][m.REQUEST_KEY_PLAYER_NAME]=i._contentMetadata.applicationName),void 0===a[m.REQUEST_KEY_STREAM_METADATA_CHANGE]&&(a[m.REQUEST_KEY_STREAM_METADATA_CHANGE]={}),a[m.REQUEST_KEY_STREAM_METADATA_CHANGE][m.REQUEST_KEY_PLAYER_NAME]=t.applicationName,i._contentMetadata.applicationName=t.applicationName):i._logger.warning("mergeContentMetadata(): applicationName was not changed.")),x.isValidString(t.streamUrl)&&(i._contentMetadata.streamUrl!=t.streamUrl?(null!=i._contentMetadata.streamUrl&&(n[m.REQUEST_KEY_STREAM_URL]=i._contentMetadata.streamUrl),a[m.REQUEST_KEY_STREAM_URL]=t.streamUrl,i._contentMetadata.streamUrl=t.streamUrl):i._logger.warning("mergeContentMetadata(): streamUrl was not changed.")),x.isValidString(t.viewerId)&&(i._contentMetadata.viewerId!=t.viewerId?(null!=i._contentMetadata.viewerId&&(void 0===n[m.REQUEST_KEY_STREAM_METADATA_CHANGE]&&(n[m.REQUEST_KEY_STREAM_METADATA_CHANGE]={}),n[m.REQUEST_KEY_STREAM_METADATA_CHANGE][m.REQUEST_KEY_VIEWER_ID]=i._contentMetadata.viewerId),void 0===a[m.REQUEST_KEY_STREAM_METADATA_CHANGE]&&(a[m.REQUEST_KEY_STREAM_METADATA_CHANGE]={}),a[m.REQUEST_KEY_STREAM_METADATA_CHANGE][m.REQUEST_KEY_VIEWER_ID]=t.viewerId,i._contentMetadata.viewerId=t.viewerId):i._logger.warning("mergeContentMetadata(): viewerId was not changed.")),x.isValidString(t.defaultResource)&&(i._contentMetadata.defaultResource!=t.defaultResource?(null!=i._contentMetadata.defaultResource&&(n[m.REQUEST_KEY_RESOURCE]=i._contentMetadata.defaultResource),a[m.REQUEST_KEY_RESOURCE]=t.defaultResource,i._contentMetadata.defaultResource=t.defaultResource):i._logger.warning("mergeContentMetadata(): defaultResource was not changed.")),x.isInteger(t.duration)&&t.duration>0&&(i._contentMetadata.duration!=t.duration?(i._cwsSession._contentLengthSec>0&&(n[m.REQUEST_KEY_CONTENT_LENGTH]=i._cwsSession._contentLengthSec),a[m.REQUEST_KEY_CONTENT_LENGTH]=t.duration,i._contentMetadata.duration=t.duration):i._logger.warning("mergeContentMetadata(): duration was not changed.")),x.isInteger(t.encodedFrameRate)&&t.encodedFrameRate>0&&(i._contentMetadata.encodedFrameRate!=t.encodedFrameRate?(i._contentMetadata.encodedFrameRate>-1&&(n[m.REQUEST_KEY_ENCODED_FRAME_RATE]=i._contentMetadata.encodedFrameRate),a[m.REQUEST_KEY_ENCODED_FRAME_RATE]=t.encodedFrameRate,i._contentMetadata.encodedFrameRate=t.encodedFrameRate):i._logger.warning("mergeContentMetadata(): encodedFrameRate was not changed.")),t.streamType!=r.StreamType.UNKNOWN&&(i._contentMetadata.streamType!=t.streamType?(i._contentMetadata.streamType!=r.StreamType.UNKNOWN&&(i._contentMetadata.streamType==e.ContentMetadata.StreamType.LIVE?n[m.REQUEST_KEY_IS_LIVE]=!0:n[m.REQUEST_KEY_IS_LIVE]=!1),t.streamType==e.ContentMetadata.StreamType.LIVE?a[m.REQUEST_KEY_IS_LIVE]=!0:a[m.REQUEST_KEY_IS_LIVE]=!1,i._contentMetadata.streamType=t.streamType):i._logger.warning("mergeContentMetadata(): streamType was not changed.")),x.dictCount(t.custom)>0){var o={},s={};for(var l in t.custom){i._contentMetadata.custom[l]!=t.custom[l]?(o[l]=t.custom[l],i._contentMetadata.custom[l]&&(s[l]=i._contentMetadata.custom[l]),i._contentMetadata.custom[l]=t.custom[l]):i._logger.info("mergeContentMetadata(): custom."+l+" was not changed.")}x.dictCount(o)>0?(x.dictCount(s)>0&&(n[m.REQUEST_KEY_TAGS]=s),a[m.REQUEST_KEY_TAGS]=o):i._logger.warning("mergeContentMetadata(): custom was not changed.")}x.dictCount(a)>0&&i._cwsSession.declareStateChange(a,n)},this.isGlobalSession=function(){return i._global==b.SESSION_TYPE.GLOBAL},this.isVideoSession=function(){return i._global==b.SESSION_TYPE.VIDEO},this.isAdSession=function(){return i._global==b.SESSION_TYPE.AD},this.sessionTypeTag=function(){return i.isGlobalSession()?" (global session)":""}});S.DEFAULT_HEARTBEAT_ERROR_MESSAGE="received no response (or a bad response) to heartbeat POST request";var E=t.SessionFactory=function(){function e(e,i,n,r){t._client=e,t._clientSettings=i,t._clientConfig=n,t._systemFactory=r,t._logger=t._systemFactory.buildLogger(),t._logger.setModuleName("SessionFactory"),t._nextSessionKey=0,t._sessionsByKey={}}var t=this;t._logger=null,t._logBuffer=null,t._nextSessionKey=0,t._sessionsByKey=null,e.apply(t,arguments),this.cleanup=function(){for(var e in t._logger=null,t._logBuffer=null,t._sessionsByKey){t._sessionsByKey[e].cleanup()}t._sessionsByKey=null,t._nextSessionKey=0},this.newSessionKey=function(){var e=t._nextSessionKey;return t._nextSessionKey++,e},this.makeVideoSession=function(e,i){return null==e&&(e=new r),t.makeSession(e,i)},this.makeGlobalSession=function(e){return t.makeSession(e,b.SESSION_TYPE.GLOBAL)},this.generateSessionId=function(){return L.integer32()},this.makeSession=function(e,i){var n=e.clone(),r=t.generateSessionId(),a=t._systemFactory.buildSession(t._client,t._clientSettings,t._clientConfig,r,i,n),o=t.newSessionKey();return t.addSession(o,a),a.start(),o},this.getSession=function(e){var i=t._sessionsByKey[e];return null==i&&t._logger.error("Client: invalid sessionKey. Did you cleanup that session previously?"),i},this.getVideoSession=function(e){var i=this.getSession(e);return null!=i&&(i.isVideoSession()||i.isAdSession()||(t._logger.error("Client: invalid sessionKey. Did you cleanup that session previously?"),i=null)),i},this.addSession=function(e,i){t._sessionsByKey[e]=i},this.removeSession=function(e){delete t._sessionsByKey[e]},this.cleanupSession=function(e){var i=t.getSession(e);t.removeSession(e),i.cleanup()}},w=t.CallbackWithTimeout=function(e){this._timer=e,this.getWrapperCallback=function(e,t,i){var n=!1;this._timer.createOnce((function(){n||(n=!0,e(!1,i+" ("+t+" ms)"))}),t,"CallbackWithTimeout.wrap");return function(t,i){n||(n=!0,e(t,i))}}},T=t.Config=function(e,t,i){var n=this;this._logger=e,this._logger.setModuleName("Config"),this._storage=t,this._jsonInterface=i,this._defaultConfig={clientId:m.DEFAULT_CLIENT_ID,sendLogs:!1,maxHbInfos:m.DEFAULT_MAX_HEARTBEAT_INFOS},this._config=x.ObjectShallowCopy(this._defaultConfig),this._loaded=!1,this._loadedEmpty=!1,this._waitingConsumers=[],this.isReady=function(){return this._loaded},this.load=function(){this._storage.load(T.STORAGE_KEY,(function(e,t){e?(n._parse(t),n._logger.debug("load(): configuration successfully loaded from local storage"+(n._loadedEmpty?" (was empty)":"")+".")):n._logger.error("load(): error loading configuration from local storage: "+t),n._loaded=!0,n._notify()}))},this._parse=function(e){var t=this._jsonInterface.decode(e);if(null!=t){var i=t[T.CONFIG_STORAGE_KEY_CLIENT_ID];null!=i&&i!=m.DEFAULT_CLIENT_ID&&""!=i&&"null"!=i&&(this._config[T.CONFIG_KEY_CLIENT_ID]=i,this._logger.debug("parse(): loaded clientId="+i+" (from local storage)"))}else this._loadedEmpty=!0},this._marshall=function(){var e={};return e[T.CONFIG_STORAGE_KEY_CLIENT_ID]=this._config.clientId,this._logger.debug("_marshall(): saving clientId="+this._config.clientId+" (to local storage)"),this._jsonInterface.encode(e)},this.save=function(){this._storage.save(T.STORAGE_KEY,this._marshall(),(function(e,t){e?n._logger.debug("save(): configuration successfully saved to local storage."):n._logger.error("save(): error saving configuration to local storage: "+t)}))},this.register=function(e){return this.isReady()?void e():void this._waitingConsumers.push(e)},this.get=function(e){return this._loaded?this._config[e]:null},this.set=function(e,t){this._loaded&&(this._config[e]=t)},this._notify=function(){for(var e;null!=(e=this._waitingConsumers.shift());)e()}};T.STORAGE_KEY="sdkConfig",T.CONFIG_STORAGE_KEY_CLIENT_ID="clId",T.CONFIG_KEY_CLIENT_ID="clientId",T.CONFIG_KEY_SEND_LOGS="sendLogs",T.CONFIG_KEY_MAX_HEARTBEAT_INFOS="maxHbInfos";var M=t.EventQueue=function(){this._events=[],this._nextEventNumber=0,this.enqueue=function(e){this._events.push(e)},this.getNumber=function(){var e=this._nextEventNumber;return this._nextEventNumber++,e},this.flush=function(){var e=this._events;return this._events=[],e}},A=t.ExceptionCatcher=function(e,t,i){this._logger=e,this._logger.setModuleName("ExceptionCatcher"),this._ping=t,this._systemSettings=i,this.runProtected=function(e,t,i){try{t()}catch(t){if(null!=i)i(t);else{if(this._systemSettings.allowUncaughtExceptions)throw t;this.onUncaughtException(e,t)}}},this.onUncaughtException=function(e,t){var i="Uncaught exception: "+e+": "+t.toString();if(null!=this._ping)try{this._ping.send(i)}catch(e){this._logger.error("Caught exception while sending ping: "+e.toString())}this._logger.error(i)}},C=t.GatewayControl=function(e,t,i,n){var r=this;this._clientSettings=e,this._logger=t,this._logger.setModuleName("GatewayControl"),this._httpClient=i,this._jsonInterface=n,this.send=function(e,t){var i=this._jsonInterface.encode(e),n=this._clientSettings.gatewayUrl+m.gatewayPath;this._httpClient.request("POST",n,i,"application/json",(function(e,i){if(e){var n=r._jsonInterface.decode(i);t(e,n)}else{t(e,i)}}))}},x=t.Lang={};x.isMeaningfulString=function(e){return x.isValidString(e)&&null!=e&&"undefined"!=e&&"null"!=e},x.sanitizeStringToStringObject=function(e){var t={};for(var i in e)if(x.isMeaningfulString(i)){var n=e[i];x.isMeaningfulString(n)&&(t[i]=n)}return t},x.validateInterface=function(e,t,i){if(null==e)throw new Error("Expected "+i+" implementation is null.");for(var n in t)if("function"!=typeof e[n])throw new Error("Expected method "+n+" in "+i+" implementation.")},x.dictCount=function(e){var t,i=0;for(t in e)e.hasOwnProperty(t)&&i++;return i},x.ToString=function(e){return""+e},x.NumberToInt=function(e){return Math.floor(e)},x.NumberToUnsignedInt=function(e){return Math.abs(x.NumberToInt(e))},x.AsBoolean=function(e){return Boolean(e)},x.isValidString=function(e){return"string"==typeof e&&""!==e},x.stringStartsWith=function(e,t){return"string"==typeof e&&"string"==typeof t&&("function"==typeof e.indexOf&&0===e.indexOf(t))},x.isBoolean=function(e){return"boolean"==typeof e},x.UrlEncodeString=function(e){return escape(e)},x.isObject=function(e){return"object"==typeof e},x.ObjectToString=function(e){var t="";for(var i in e){t+=i+"="+e[i]}return"Object{"+t+"}"},x.ObjectShallowCopyOmitNull=function(e){var t=x.ObjectShallowCopy(e);for(var i in t)null==t[i]&&delete t[i];return t},x.ObjectShallowCopy=function(e){var t={};for(var i in e)t[i]=e[i];return t},x.ObjectShallowEquals=function(e,t){if(typeof e!=typeof t)return!1;if(e instanceof Object&&t instanceof Object){if(x.dictCount(e)!==x.dictCount(t))return!1;for(var i in e)if(!(e[i]===t[i]))return!1;return!0}return e===t},x.isInteger=function(e){return"number"==typeof e&&Math.round(e)===e},x.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)},x.ArrayEquals=function(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!=t.length)return!1;for(var i=0;i<e.length;++i)if(x.isArray(e[i])&&x.isArray(t[i])){if(!x.ArrayEquals(e[i],t[i]))return!1}else if(e[i]!==t[i])return!1;return!0},x.isObjectDefinePropertyPresent=function(){return void 0!==Object.defineProperty&&function(){try{return Object.defineProperty({},"x",{}),!0}catch(e){return!1}}()},x.defGet=function(e,t,i){if(x.isObjectDefinePropertyPresent())Object.defineProperty(e,t,{configurable:!0,enumerable:!0,get:i});else{if(void 0===e.__defineGetter__)throw new Error("JavaScript runtime must support either Object.defineProperty or __defineGetter__");e.__defineGetter__(t,i)}},x.defSet=function(e,t,i){if(x.isObjectDefinePropertyPresent())Object.defineProperty(e,t,{configurable:!0,set:i});else{if(void 0===e.__defineSetter__)throw new Error("JavaScript runtime must support either Object.defineProperty or __defineSetter__");e.__defineSetter__(t,i)}},function(){var e={two32:4294967296};e.MaxValue=e.two32-1,e.MinValue=0,x.UInt32=e,x.UInt32.Cast=function(t){var i=parseInt(t,10);return i>e.MaxValue?i%=e.two32:i<e.MinValue&&(i=-i%e.two32,i=e.two32-i),i},x.UInt32.InRange=function(t){var i=parseInt(t,10);return i<=e.MaxValue&&i>=e.MinValue};var t={MaxValue:2147483647,MinValue:-2147483648};x.Int32=t,x.Int32.Cast=function(e){var i=parseInt(e,10);return i>t.MaxValue?i%=t.MaxValue:i<t.MinValue&&(i=-i%t.MaxValue,i=t.MaxValue-i),i},x.Int32.InRange=function(e){var i=parseInt(e,10);return i<=t.MaxValue&&i>=t.MinValue}}();var I=t.LogBuffer=function(){this._buffer=[],this.add=function(e){this._buffer.length>=32&&this._buffer.shift(),this._buffer.push(e)},this.flush=function(){var e=this._buffer;return this._buffer=[],e}},P=t.Ping=function(e,t,n){this._isSendingPing=!1,this._cachedBasePingUrl=null,this._logger=e,this._logger.setModuleName("Ping"),this._httpClient=t,this._clientSettings=n,this.send=function(e){if(!this._isSendingPing){this._isSendingPing=!0;var t=this.getBasePingUrl()+"&d="+x.UrlEncodeString(e.toString());this._logger.error("send(): "+t),this._httpClient.request("GET",t,null,null,null),this._isSendingPing=!1}},this.getBasePingUrl=function(){if(!this._cachedBasePingUrl){var e=P.SERVICE_URL+"?comp="+P.COMPONENT_NAME+"&clv="+i.version;if(this._clientSettings&&(e+="&cid="+this._clientSettings.customerKey),e+="&sch="+m.SDK_METADATA_SCHEMA,!this._clientSettings)return e;this._cachedBasePingUrl=e}return this._cachedBasePingUrl}};P.COMPONENT_NAME="sdkjs",P.SERVICE_URL="https://pings.conviva.com/ping.ping";var L=t.Random={};L.maxUInt32=4294967295,L.maxInt32=2147483647,L.minInt32=-2147483648,L.integer32=function(){return Math.floor(Math.random()*L.maxUInt32)+L.minInt32},L.uinteger32=function(){return Math.floor(Math.random()*L.maxUInt32)};var D=t.Sanitize={};D.Integer=function(e,t,i,n){if(isNaN(e))return n;if("number"!=typeof e)return n;if(e==n)return n;var r=x.NumberToInt(e);return D.EnforceBoundaries(r,t,i)},D.EnforceBoundaries=function(e,t,i){return null!=i&&e>i?e=i:null!=t&&t>e&&(e=t),e},D.sanitizeSpecialIntegerValue=function(e){return-1==e||-2==e?e:e=D.Integer(e,0,null,-1)};var R=(t.StreamerError=function(){function e(e,i){t.errorCode=e,t.severity=i}var t=this;t.errorCode=null,t.severity=i.ErrorSeverity.FATAL,e.apply(t,arguments)},t.HttpClient=function(e,t,i,n){this._logger=e,this._logger.setModuleName("HttpClient"),this._httpInterface=t,this._callbackWithTimeout=i,this._systemSettings=n,this.request=function(e,t,i,n,r){var a=1e3*this._systemSettings.httpTimeout,o=this._callbackWithTimeout.getWrapperCallback(r,a,"HTTP timeout");this._logger.debug("request(): calling HttpInterface.makeRequest"),this._httpInterface.makeRequest(e,t,i,n,a,o)}}),k=t.Logger=function(e,t,i,n,r){this._loggingInterface=e,this._timeInterface=t,this._settings=i,this._logBuffer=n,this._packageName=r,this.debug=function(e){this.log(e,o.LogLevel.DEBUG)},this.info=function(e){this.log(e,o.LogLevel.INFO)},this.warning=function(e){this.log(e,o.LogLevel.WARNING)},this.error=function(e){this.log(e,o.LogLevel.ERROR)},this.log=function(e,t){var i=this.formatMessage(e,t);this._logBuffer.add(i),this._settings.logLevel<=t&&this._loggingInterface.consoleLog(i,t)},this.prependModuleName=function(e){var t=e;return"["+this._moduleName+"] "+t},this.prependPackageName=function(e){var t=e;return"["+this._packageName+"] "+t},this.prependConvivaNamespace=function(e){return"[Conviva] "+e},this.prependTime=function(e){return"["+(this._timeInterface.getEpochTimeMs()/1e3).toFixed(3).toString()+"] "+e},this.prependLogLevel=function(e,t){return"["+k.getLogLevelString(t)+"] "+e},this.prependSessionId=function(e){var t=e;return null!=this._sessionId&&(t="sid="+this._sessionId+" "+t),t},this.setSessionId=function(e){this._sessionId=e},this.setModuleName=function(e){this._moduleName=e},this.formatMessage=function(e,t){return this.prependConvivaNamespace(this.prependTime(this.prependLogLevel(this.prependPackageName(this.prependModuleName(this.prependSessionId(e))),t)))}};k.getLogLevelString=function(e){var t;switch(e){case o.LogLevel.ERROR:t="ERROR";break;case o.LogLevel.WARNING:t="WARNING";break;case o.LogLevel.INFO:t="INFO";break;case o.LogLevel.DEBUG:t="DEBUG"}return t};var O=t.Storage=function(e,t,i,n){this._logger=e,this._logger.setModuleName("Storage"),this._storageInterface=t,this._callbackWithTimeout=i,this._systemSettings=n,this.load=function(e,t){var i=this._callbackWithTimeout.getWrapperCallback(t,1e3*this._systemSettings.storageTimeout,"storage load timeout");this._logger.debug("load(): calling StorageInterface.loadData"),this._storageInterface.loadData(O.STORAGE_SPACE,e,i)},this.save=function(e,t,i){var n=this._callbackWithTimeout.getWrapperCallback(i,1e3*this._systemSettings.storageTimeout,"storage save timeout");this._logger.debug("save(): calling StorageInterface.saveData"),this._storageInterface.saveData(O.STORAGE_SPACE,e,t,n)}};O.STORAGE_SPACE="Conviva";var N=t.SystemMetadata=function(t,i,n){this._logger=t,this._logger.setModuleName("SystemMetadata"),this._metadataInterface=i,this._exceptionCatcher=n,this._cachedMetadata=null,this.get=function(){return this._cachedMetadata||this.retrieve(),this._cachedMetadata},this.retrieve=function(){function t(e,t){n._exceptionCatcher.runProtected("Session.getSystemMetadataSchema(): "+e,(function(){var i=t[e];t[e]=i.call(n._metadataInterface)}))}var i={};i[N.BROWSER_NAME]=this._metadataInterface.getBrowserName,i[N.BROWSER_VERSION]=this._metadataInterface.getBrowserVersion,i[N.DEVICE_BRAND]=this._metadataInterface.getDeviceBrand,i[N.DEVICE_MANUFACTURER]=this._metadataInterface.getDeviceManufacturer,i[N.DEVICE_MODEL]=this._metadataInterface.getDeviceModel,i[N.DEVICE_TYPE]=this._metadataInterface.getDeviceType,i[N.DEVICE_VERSION]=this._metadataInterface.getDeviceVersion,i[N.FRAMEWORK_NAME]=this._metadataInterface.getFrameworkName,i[N.FRAMEWORK_VERSION]=this._metadataInterface.getFrameworkVersion,i[N.OPERATING_SYSTEM_NAME]=this._metadataInterface.getOperatingSystemName,i[N.OPERATING_SYSTEM_VERSION]=this._metadataInterface.getOperatingSystemVersion,i[N.DEVICE_CATEGORY]=this._metadataInterface.getDeviceCategory;var n=this;for(var r in this._logger.debug("retrieve(): calling MetadataInterface methods"),i)t(r,i),x.isValidString(i[r])||delete i[r];var a=!1;if(void 0!==i[N.DEVICE_TYPE]){for(var o in e.Client.DeviceType)if(i[N.DEVICE_TYPE]===e.Client.DeviceType[o]){a=!0;break}a||delete i[N.DEVICE_TYPE]}if(a=!1,void 0!==i[N.DEVICE_CATEGORY]){for(var s in e.Client.DeviceCategory)if(i[N.DEVICE_CATEGORY]===e.Client.DeviceCategory[s]){a=!0;break}a||delete i[N.DEVICE_CATEGORY]}this._cachedMetadata=x.ObjectShallowCopyOmitNull(i)}};N.BROWSER_NAME="browserName",N.BROWSER_VERSION="browserVersion",N.DEVICE_BRAND="deviceBrand",N.DEVICE_MANUFACTURER="deviceManufacturer",N.DEVICE_MODEL="deviceModel",N.DEVICE_TYPE="deviceType",N.DEVICE_VERSION="deviceVersion",N.FRAMEWORK_NAME="frameworkName",N.FRAMEWORK_VERSION="frameworkVersion",N.OPERATING_SYSTEM_NAME="operatingSystemName",N.OPERATING_SYSTEM_VERSION="operatingSystemVersion",N.DEVICE_CATEGORY="deviceCategory";var F=t.Time=function(e,t){this._timeInterface=e,this._logger=t,this._logger.setModuleName("Time"),this.current=function(){var e=this._timeInterface.getEpochTimeMs();return x.isInteger(e)||this._logger.error("current(): TimeInterface.getEpochTimeMs() did not return an integer ("+e+")"),e}},V=t.Timer=function(e,t,i){var n=this;this._logger=e,this._logger.setModuleName("Timer"),this._timerInterface=t,this._exceptionCatcher=i,this.create=function(e,t,i){return this.createTimer((function(){n._exceptionCatcher.runProtected(i,(function(){e()}))}),t,i)},this.createOnce=function(e,t,i){var r={cancel:null},a=this.createTimer((function(){n._exceptionCatcher.runProtected(i,(function(){r&&"function"==typeof r.cancel&&(r.cancel(),r.cancel=null,r=null),e()}))}),t,i);return r.cancel=a,a},this.createTimer=function(e,t,i){return this._logger.debug("createTimer(): calling TimerInterface.create"),this._timerInterface.createTimer(e,t,i)}}}()}(),e}));var a={Html5Time:function(){function e(){}e.apply(this,arguments),this.getEpochTimeMs=function(){return(new Date).getTime()},this.release=function(){}},Html5Http:function(){function e(){}e.apply(this,arguments),this.makeRequest=function(e,t,i,n,r,a){return this.makeRequestStandard.apply(this,arguments)},this.makeRequestStandard=function(e,t,i,n,r,a){var o=new XMLHttpRequest;return o.open(e,t,!0),n&&o.overrideMimeType&&(o.overrideMimeType=n),n&&o.setRequestHeader&&o.setRequestHeader("Content-Type",n),r>0&&(o.timeout=r,o.ontimeout=function(){o.ontimeout=o.onreadystatechange=null,a&&a(!1,"timeout after "+r+" ms")}),o.onreadystatechange=function(){4===o.readyState&&(o.ontimeout=o.onreadystatechange=null,200==o.status?a&&a(!0,o.responseText):a&&a(!1,"http status "+o.status))},o.send(i),null},this.release=function(){}},Html5Timer:function(){function e(){}e.apply(this,arguments),this.createTimer=function(e,t,i){var n=setInterval(e,t);return function(){-1!==n&&(clearInterval(n),n=-1)}},this.release=function(){}},Html5Storage:function(){function e(){}e.apply(this,arguments),this.saveData=function(e,t,i,n){var r=e+"."+t;try{localStorage.setItem(r,i),n(!0,null)}catch(e){n(!1,e.toString())}},this.loadData=function(e,t,i){var n=e+"."+t;try{i(!0,localStorage.getItem(n))}catch(e){i(!1,e.toString())}},this.release=function(){}},Html5Metadata:function(){function e(){}e.apply(this,arguments),this.getBrowserName=function(){return null},this.getBrowserVersion=function(){return null},this.getDeviceBrand=function(){return null},this.getDeviceManufacturer=function(){return null},this.getDeviceModel=function(){return null},this.getDeviceType=function(){return Conviva.Client.DeviceType.DESKTOP},this.getDeviceVersion=function(){return null},this.getFrameworkName=function(){return"HTML5"},this.getFrameworkVersion=function(){return null},this.getOperatingSystemName=function(){return null},this.getOperatingSystemVersion=function(){return null},this.getDeviceCategory=function(){return Conviva.Client.DeviceCategory.WEB},this.release=function(){}},Html5Logging:function(){function e(){}e.apply(this,arguments),this.consoleLog=function(e,t){"undefined"!=typeof console&&(console.log&&t===Conviva.SystemSettings.LogLevel.DEBUG||t===Conviva.SystemSettings.LogLevel.INFO?console.log(e):console.warn&&t===Conviva.SystemSettings.LogLevel.WARNING?console.warn(e):console.error&&t===Conviva.SystemSettings.LogLevel.ERROR&&console.error(e))},this.release=function(){}},Html5PlayerInterface:function(e,t){var i=this;function n(e,t){if(!e)throw new Error("Html5PlayerInterface: playerStateManager argument cannot be null.");if(!t)throw new Error("Html5PlayerInterface: videoElement argument cannot be null.");this._playerStateManager=e,this._videoElement=t,this._eventListeners=[],this._registerVideoEventListeners(),this._startPolling(),this._findCurrentState(),this._playerStateManager.setClientMeasureInterface(this)}i._timeupdate=0,i._lastTimeupdate=0,i._currentTimeIsInvalid=!1,i._width=-1,i._height=-1,this._timerInterface=new a.Html5Timer,this._loggingInterface=new a.Html5Logging,this._addEventListener=function(e,t,n){void 0===n&&(n=i._videoElement),i._eventListeners.push([e,t,n]),window.addEventListener?n.addEventListener(e,t,!1):n.attachEvent("on"+e,t)},this._removeEventListener=function(e,t,n){void 0===n&&(n=i._videoElement),window.removeEventListener?n.removeEventListener(e,t,!1):n.detachEvent("on"+e,t)},this._registerVideoEventListeners=function(){i._addEventListener("ended",(function(){i._receivedHtml5Event("ended")})),i._addEventListener("pause",(function(){i._receivedHtml5Event("pause")})),i._addEventListener("playing",(function(){0!=i._videoElement.currentTime?i._videoElement.seeking||i._receivedHtml5Event("playing"):i._currentTimeIsInvalid=!0})),i._addEventListener("waiting",(function(){i._receivedHtml5Event("waiting")})),i._addEventListener("timeupdate",(function(){i._currentTimeIsInvalid&&(i._timeupdate++,i._playerStateManager.getPlayerState()===Conviva.PlayerStateManager.PlayerState.PLAYING||i._videoElement.seeking||i._receivedHtml5Event("playing"))})),i._addEventListener("error",(function(){if(i._videoElement.error){var e=i._videoElement.error.code;i._reportHtml5Error(e)}})),i._addEventListener("loadedmetadata",i._loadedMetadata),i._addEventListener("seeking",(function(){i.isSeekStarted||(i.isSeekStarted=!0,i._playerStateManager.setPlayerSeekStart(-1)),i._currentTimeIsInvalid&&i._playerStateManager.getPlayerState()!==Conviva.PlayerStateManager.PlayerState.BUFFERING&&i._receivedHtml5Event("waiting")})),i._addEventListener("seeked",(function(){i.isSeekStarted=!1,i._playerStateManager.setPlayerSeekEnd()})),i._monitorErrorsFromSourceElements()},this.getPHT=function(){return 1e3*i._videoElement.currentTime},this.getBufferLength=function(){if(i._videoElement){var e=i._videoElement.buffered;if(void 0!==e){for(var t=0,n=0;n<e.length;n++){var r=e.start(n),a=e.end(n);r<=i._videoElement.currentTime&&i._videoElement.currentTime<a&&(t+=a-i._videoElement.currentTime)}return i._currentBufferLength=t,1e3*i._currentBufferLength}}},this.getSignalStrength=function(){return Conviva.PlayerStateManager.DEFAULT_SIGNAL_STRENGTH},this.getRenderedFrameRate=function(){return Conviva.PlayerStateManager.DEFAULT_RENDERED_FRAME_RATE},this._monitorErrorsFromSourceElements=function(){if(void 0!==i._videoElement.children){var e=function(){i._log("Caught non-specific error from <source> element, reporting as ERR_UNKNOWN"),i._reportHtml5Error(0)};i._videoElement._sources=i._videoElement.children;for(var t=0;t<i._videoElement._sources.length;t++){var n=i._videoElement._sources[t];"SOURCE"==n.tagName&&i._addEventListener("error",e,n)}}},this._removeVideoEventHandlers=function(){for(var e=0;e<i._eventListeners.length;e++){var t=i._eventListeners[e];i._removeEventListener(t[0],t[1],t[2])}i._eventListeners=[]},this._findCurrentState=function(){i._prevReadyState=i._videoElement.readyState,0===i._videoElement.readyState||i._videoElement.ended?i._updateConvivaPlayerState(Conviva.PlayerStateManager.PlayerState.STOPPED):(i._videoElement.paused||i._videoElement.seeking)&&i._updateConvivaPlayerState(Conviva.PlayerStateManager.PlayerState.PAUSED),i._videoElement.readyState>=i._videoElement.HAVE_METADATA&&i._loadedMetadata()},this._receivedHtml5Event=function(e){var t=i._convertHtml5EventToConvivaPlayerState(e);i._updateConvivaPlayerState(t)},this._updateConvivaPlayerState=function(e){i._playerStateManager.getPlayerState()!==e&&(i._playerStateManager.setPlayerState(e),i._playerStateRecentlyChanged=!0)},this._convertHtml5EventToConvivaPlayerState=function(e){switch(e){case"playing":return Conviva.PlayerStateManager.PlayerState.PLAYING;case"waiting":return Conviva.PlayerStateManager.PlayerState.BUFFERING;case"ended":case"stopped":return Conviva.PlayerStateManager.PlayerState.STOPPED;case"pause":return Conviva.PlayerStateManager.PlayerState.PAUSED;default:return Conviva.PlayerStateManager.PlayerState.UNKNOWN}},this._reportHtml5Error=function(e){var t;switch(e){case 1:t="MEDIA_ERR_ABORTED";break;case 2:t="MEDIA_ERR_NETWORK";break;case 3:t="MEDIA_ERR_DECODE";break;case 4:t="MEDIA_ERR_SRC_NOT_SUPPORTED";break;default:t="MEDIA_ERR_UNKNOWN"}i._log("Reporting error: code="+e+" message="+t);var n=Conviva.Client.ErrorSeverity.FATAL;i._playerStateManager.sendError(t,n)},this._loadedMetadata=function(){var e=i._videoElement.duration;isNaN(e)||e==1/0||i._playerStateManager.setDuration(e);var t=i._videoElement.videoWidth;!isNaN(t)&&t>=0&&i._playerStateManager.setVideoResolutionWidth(t);var n=i._videoElement.videoHeight;!isNaN(n)&&n>=0&&i._playerStateManager.setVideoResolutionHeight(n),i._playerStateManager.setConnectionType("Wi-fi"),i._playerStateManager.setLinkEncryption("YES")},this._startPolling=function(){this._previousPosition=0,this._currentPosition=0,this._currentBufferLength=0,this._pollingTimerCancel=this._timerInterface.createTimer(this._poll,500,"Html5PlayerInterface._poll()")},this._poll=function(){i._pollStreamerResolution(),i._inferPlayerStateFromPosition()},this._pollStreamerResolution=function(){var e=i._videoElement.videoWidth;!isNaN(e)&&e>=0&&e!=i._width&&(i._playerStateManager.setVideoResolutionWidth(e),i._width=e);var t=i._videoElement.videoHeight;!isNaN(t)&&t>=0&&t!=i._height&&(i._playerStateManager.setVideoResolutionHeight(t),i._height=t)},this._inferPlayerStateFromPosition=function(){if(i._previousPosition=i._currentPosition,i._currentPosition=i._videoElement.currentTime,i._positionDelta=Math.abs(i._previousPosition-i._currentPosition),!(i._positionDelta>1))if(i._playerStateRecentlyChanged)i._playerStateRecentlyChanged=!1;else{var e=0!==i._positionDelta,t=i._playerStateManager.getPlayerState();e&&t!==Conviva.PlayerStateManager.PlayerState.PLAYING?i._updateConvivaPlayerState(Conviva.PlayerStateManager.PlayerState.PLAYING):e||t!==Conviva.PlayerStateManager.PlayerState.PLAYING||(i._videoElement.paused?t!=Conviva.PlayerStateManager.PlayerState.PAUSED&&i._updateConvivaPlayerState(Conviva.PlayerStateManager.PlayerState.PAUSED):i._videoElement.seeking||i._updateConvivaPlayerState(Conviva.PlayerStateManager.PlayerState.BUFFERING)),i._currentTimeIsInvalid&&(i._videoElement.paused?(t!=Conviva.PlayerStateManager.PlayerState.PAUSED&&i._updateConvivaPlayerState(Conviva.PlayerStateManager.PlayerState.PAUSED),i._timeupdate=i._lastTimeupdate):i._videoElement.seeking||(i._timeupdate>1&&i._timeupdate==i._lastTimeupdate&&i._updateConvivaPlayerState(Conviva.PlayerStateManager.PlayerState.BUFFERING),i._lastTimeupdate=i._timeupdate))}},this._stopPolling=function(){this._pollingTimerCancel()},this._log=function(e){var t="[Html5PlayerInterface] "+e;this._loggingInterface.consoleLog(t,Conviva.SystemSettings.LogLevel.ERROR)},n.apply(this,arguments),this.cleanup=function(){this._stopPolling(),this._removeVideoEventHandlers(),this._videoElement=null,this._playerStateManager=null}}};e.exports=a}).call(window)},function(e,t){e.exports=function(e,t,i,n,r){var a,o,s=document.createElement("script"),l=[];t={adData:{ids:t,duration:i,url:r},dispatchEvent:function(e){this.sendEvent?(l&&(l.push(e),e=l,l=!1),this.sendEvent(e)):l.push(e)}},i="_moatApi"+Math.floor(1e8*Math.random());try{o=(a=e.ownerDocument).defaultView||a.parentWindow}catch(e){a=document,o=window}return o[i]=t,s.type="text/javascript",e&&e.insertBefore(s,e.childNodes[0]||null),s.src="https://z.moatads.com/"+n+"/moatvideo.js#"+i,t}},function(e,t){e.exports=function(e){return window.document[e]?window.document[e]:-1!=navigator.appName.indexOf("Microsoft Internet")?document.getElementById(e):document.embeds&&document.embeds[e]?document.embeds[e]:void 0}},function(e,t){"undefined"==typeof _comscore&&(_comscore=[]),function(){var e,t="length",i=self,n=i.encodeURIComponent?encodeURIComponent:escape,r=".scorecardresearch.com",a=Math,o="script",s=/c2=(\d*)&/,l=function(e){if(e){var i,a,o,s=[],l=0,c="";for(var h in e)"string"!=(i=typeof e[h])&&"number"!=i||(s[s[t]]=h+"="+n(e[h]),"c2"==h?c=e[h]:"c1"==h&&(l=1));if(s[t]<=0||""==c)return;if((o=e.options||{}).d=o.d||document,"string"==typeof o.url_append){h=0;for(var d,p=(a=o.url_append.replace(/&amp;/,"&").split("&"))[t];h<p;h++)2==(d=a[h].split("="))[t]&&(s[s[t]]=d[0]+"="+n(d[1]))}(function(e,t){var i,n,r,a,o,s="comScore=",l=document,c=l.cookie,u="",h="indexOf",d="substring",p="length",f=2048,g="&ns_",_=window,m=_.encodeURIComponent||escape;if(c[h](s)+1)for(a=0,o=(r=c.split(";"))[p];a<o;a++)(n=r[a][h](s))+1&&(u="&"+unescape(r[a][d](n+s[p])));(e+=g+"_t="+ +new Date+g+"c="+(l.characterSet||l.defaultCharset||"")+"&c8="+m(l.title)+u+"&c7="+m(l.URL)+"&c9="+m(l.referrer))[p]>f&&e[h]("&")>0&&(i=e[d](0,2040).lastIndexOf("&"),e=(e[d](0,i)+g+"cut="+m(e[d](i+1)))[d](0,f)),l.images?(n=new Image,_.ns_p||(ns_p=n),"function"==typeof t&&(n.onload=n.onerror=t),n.src=e):l.write("<","p","><",'img src="',e,'" height="1" width="1" alt="*"',"><","/p",">")})(["http","s"==o.d.URL.charAt(4)?"s://sb":"://b",r,"/b?",l?"":"c1=2&",s.join("&").replace(/&$/,"")].join(""),(function(){u(this,o)}))}},c=function(e){for(var i=0,n=(e=e||_comscore)[t];i<n;i++)l(e[i]);e=_comscore=[]},u=function(e,t){if(!(e.src.indexOf("c1=2")<0)&&t.d.createElement&&(t.force_script_extension||2==e.width&&e.height>a.round(100*a.random()))){var i=t.d.createElement(o),n=t.d.getElementsByTagName(o)[0],r=[t.script_extension_url||"//app.scorecardresearch.com/s2e/invite","?","c2=",e.src.match(s)[1]].join("");n&&(i.src=r,i.async=!0,n.parentNode.insertBefore(i,n))}};c(),(e=i.COMSCORE)?(e.purge=c,e.beacon=l):COMSCORE={purge:c,beacon:l}}();var i=i||{};i.StreamSense=i.StreamSense||function(){function e(e){s=e}function t(e){e}function n(e,t){var i=e||"",n="undefined",r=a.comScore||a.sitestat||function(e){var t,i,r,l,c,u="comScore=",h=o.cookie,d="",p="indexOf",f="substring",g="length",_=2048,m="&ns_",v=a.encodeURIComponent||escape;if(h[p](u)+1)for(l=0,c=(r=h.split(";"))[g];l<c;l++)(i=r[l][p](u))+1&&(d="&"+unescape(r[l][f](i+u[g])));(e+=m+"_t="+ +new Date+m+"c="+(o.characterSet||o.defaultCharset||"")+d)[g]>_&&e[p]("&")>0&&(t=e[f](0,2040).lastIndexOf("&"),e=(e[f](0,t)+m+"cut="+v(e[f](t+1)))[f](0,_)),s(e),typeof ns_p===n&&(ns_p={src:e}),ns_p.lastMeasurement=e};if(typeof t!==n){var l=[],c=a.encodeURIComponent||escape;for(var u in t)t.hasOwnProperty(u)&&l.push(c(u)+"="+c(t[u]));/[\?\&]$/.test(i)||(i+="&"),i+=l.join("&")}return r(i)}function r(e,t){for(var i,n=2048,r=a.encodeURIComponent||escape,s=[],l=d.LABELS_ORDER,c=e.split("?"),u=c[0],h=c[1].split("&"),p=0,f=h.length;p<f;p++){var g=h[p].split("="),_=unescape(g[0]),m=unescape(g[1]);_&&(t[_]=m)}var v={};for(p=0,f=l.length;p<f;p++){var y=l[p];t.hasOwnProperty(y)&&(v[y]=!0,s.push(r(y)+"="+r(t[y])))}for(var y in t)v[y]||t.hasOwnProperty(y)&&s.push(r(y)+"="+r(t[y]));return(i=(i=u+"?"+s.join("&"))+(i.indexOf("&c8=")<0?"&c8="+r(o.title):"")+(i.indexOf("&c7=")<0?"&c7="+r(o.URL):"")+(i.indexOf("&c9=")<0?"&c9="+r(o.referrer):"")).length>n&&i.indexOf("&")>0&&(last=i.substr(0,2040).lastIndexOf("&"),i=(i.substring(0,last)+"&ns_cut="+r(i.substring(last+1))).substr(0,n)),i}var a,o,s=function(e,t){};e((function(e,t){(new Image).src=e,t&&setTimeout(t,0)})),t((function(e,t,i){i&&setTimeout(i,0)})),"undefined"!=typeof window&&"undefined"!=typeof document?(a=window,o=document):(a={},o={location:{href:""},title:"",URL:"",referrer:"",cookie:""});var l=function(){var e={uid:function(){var e=1;return function(){return+new Date+"_"+e++}}(),filter:function(e,t){var i={};for(var n in t)t.hasOwnProperty(n)&&e(t[n])&&(i[n]=t[n]);return i},extend:function(e){var t,i=arguments.length;e=e||{};for(var n=1;n<i;n++)if(t=arguments[n])for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e},getString:function(e,t){var i=String(e);return null==e?t||"na":i},getLong:function(e,t){var i=Number(e);return null==e||isNaN(i)?t||0:i},getInteger:function(e,t){var i=Number(e);return null==e||isNaN(i)?t||0:i},getBoolean:function(e,t){var i="true"==String(e).toLowerCase();return null==e?t||!1:i},isNotEmpty:function(e){return null!=e&&e.length>0},indexOf:function(t,i){var n=-1;return e.forEach(i,(function(e,i){e==t&&(n=i)})),n},forEach:function(e,t,i){try{if("function"==typeof t)if(i=void 0!==i?i:null,"number"!=typeof e.length||void 0===e[0]){var n=void 0!==e.__proto__;for(var r in e)(!n||n&&void 0===e.__proto__[r])&&"function"!=typeof e[r]&&t.call(i,e[r],r)}else{r=0;for(var a=e.length;r<a;r++)t.call(i,e[r],r)}}catch(e){}},regionMatches:function(e,t,i,n,r){if(t<0||n<0||t+r>e.length||n+r>i.length)return!1;for(;--r>=0;){if(e.charAt(t++)!=i.charAt(n++))return!1}return!0},size:function(e){var t=0;for(var i in e)e.hasOwnProperty(i)&&t++;return t},log:function(e,t){if(void 0!==t&&t){var i=new Date,n=i.getHours()+":"+i.getMinutes()+":"+i.getSeconds();console.log(n,e)}},isTrue:function(e){return void 0!==e&&("string"==typeof e?"true"===(e=e.toLowerCase())||"1"===e||"on"===e:!!e)},toString:function(t){if(void 0===t)return"undefined";if("string"==typeof t)return t;if("[object Array]"===Object.prototype.toString.call(t))return t.join(",");if(e.size(t)>0){var i="";for(var n in t)t.hasOwnProperty(n)&&(i+=n+":"+t[n]+";");return i}return t.toString()},exists:function(e){return void 0!==e&&null!=e},firstGreaterThan0:function(){for(var e=0,t=arguments.length;e<t;e++){var i=arguments[e];if(i>0)return i}return 0},cloneObject:function(e){if(null==e||"object"!=typeof e)return e;var t=e.constructor();for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t},filterMap:function(t,i){for(var n in t)-1==e.indexOf(n,i)&&delete t[n]},getKeys:function(e,t){var i,n=[];for(i in e)(!t||t.test(i))&&e.hasOwnProperty(i)&&(n[n.length]=i);return n},getBrowserName:function(){var e,t,i=navigator.userAgent,n=navigator.appName;return-1!=(t=i.indexOf("Opera"))?n="Opera":-1!=(t=i.indexOf("MSIE"))?n="Microsoft Internet Explorer":-1!=(t=i.indexOf("Android"))?n="Android":-1!=(t=i.indexOf("Chrome"))?n="Chrome":-1!=(t=i.indexOf("Safari"))?n="Safari":-1!=(t=i.indexOf("Firefox"))?n="Firefox":-1!=(t=i.indexOf("Windows NT"))?n="Microsoft Internet Explorer":(e=i.lastIndexOf(" ")+1)<(t=i.lastIndexOf("/"))&&((n=i.substring(e,t)).toLowerCase()==n.toUpperCase()&&(n=navigator.appName)),n},getBrowserFullVersion:function(){var e,t,i=navigator.userAgent,n=""+parseFloat(navigator.appVersion),r=parseInt(navigator.appVersion,10);return-1!=(e=i.indexOf("Opera"))?(n=i.substring(e+6),-1!=(e=i.indexOf("Version"))&&(n=i.substring(e+8))):-1!=(e=i.indexOf("MSIE"))?n=i.substring(e+5):-1!=(e=i.indexOf("Android"))?n=i.substring(e+8):-1!=(e=i.indexOf("Chrome"))?n=i.substring(e+7):-1!=(e=i.indexOf("Safari"))?(n=i.substring(e+7),-1!=(e=i.indexOf("Version"))&&(n=i.substring(e+8))):-1!=(e=i.indexOf("Firefox"))?n=i.substring(e+8):-1!=(e=i.indexOf("Windows NT"))?(e=i.indexOf("rv:"),n=i.substring(e+3)):i.lastIndexOf(" ")+1<(e=i.lastIndexOf("/"))&&(n=i.substring(e+1)),-1!=(t=n.indexOf(";"))&&(n=n.substring(0,t)),-1!=(t=n.indexOf(" "))&&(n=n.substring(0,t)),-1!=(t=n.indexOf(")"))&&(n=n.substring(0,t)),r=parseInt(""+n,10),isNaN(r)&&(n=""+parseFloat(navigator.appVersion)),n}};return e}(),c=function(){var e=["play","pause","end","buffer","keep-alive","hb","custom","ad_play","ad_pause","ad_end","ad_click"];return{PLAY:0,PAUSE:1,END:2,BUFFER:3,KEEP_ALIVE:4,HEART_BEAT:5,CUSTOM:6,AD_PLAY:7,AD_PAUSE:8,AD_END:9,AD_CLICK:10,toString:function(t){return e[t]}}}(),u=function(){var e=[c.END,c.PLAY,c.PAUSE,c.BUFFER];return{IDLE:0,PLAYING:1,PAUSED:2,BUFFERING:3,toEventType:function(t){return e[t]}}}(),h={ADPLAY:c.AD_PLAY,ADPAUSE:c.AD_PAUSE,ADEND:c.AD_END,ADCLICK:c.AD_CLICK},d={STREAMSENSE_VERSION:"4.1408.29",DEFAULT_PLAYERNAME:"streamsense",DEFAULT_HEARTBEAT_INTERVAL:[{playingtime:6e4,interval:1e4},{playingtime:null,interval:6e4}],DEFAULT_KEEP_ALIVE_INTERVAL:12e5,DEFAULT_PAUSED_ON_BUFFERING_INTERVAL:500,C1_VALUE:"19",C10_VALUE:"js",NS_AP_C12M_VALUE:"1",NS_NC_VALUE:"1",PAGE_NAME_LABEL:"name",LABELS_ORDER:["c1","c2","ns_site","ns_vsite","ns_ap_an","ns_ap_pn","ns_ap_pv","c12","name","ns_ak","ns_ap_ec","ns_ap_ev","ns_ap_device","ns_ap_id","ns_ap_csf","ns_ap_bi","ns_ap_pfm","ns_ap_pfv","ns_ap_ver","ns_ap_sv","ns_type","ns_radio","ns_nc","ns_ap_ui","ns_ap_gs","ns_st_sv","ns_st_pv","ns_st_it","ns_st_id","ns_st_ec","ns_st_sp","ns_st_sq","ns_st_cn","ns_st_ev","ns_st_po","ns_st_cl","ns_st_el","ns_st_pb","ns_st_hc","ns_st_mp","ns_st_mv","ns_st_pn","ns_st_tp","ns_st_pt","ns_st_pa","ns_st_ad","ns_st_li","ns_st_ci","ns_ap_jb","ns_ap_res","ns_ap_c12m","ns_ap_install","ns_ap_updated","ns_ap_lastrun","ns_ap_cs","ns_ap_runs","ns_ap_usage","ns_ap_fg","ns_ap_ft","ns_ap_dft","ns_ap_bt","ns_ap_dbt","ns_ap_dit","ns_ap_as","ns_ap_das","ns_ap_it","ns_ap_uc","ns_ap_aus","ns_ap_daus","ns_ap_us","ns_ap_dus","ns_ap_ut","ns_ap_oc","ns_ap_uxc","ns_ap_uxs","ns_ap_lang","ns_ap_miss","ns_ts","ns_st_ca","ns_st_cp","ns_st_er","ns_st_pe","ns_st_ui","ns_st_bc","ns_st_bt","ns_st_bp","ns_st_pc","ns_st_pp","ns_st_br","ns_st_ub","ns_st_vo","ns_st_ws","ns_st_pl","ns_st_pr","ns_st_ep","ns_st_ty","ns_st_cs","ns_st_ge","ns_st_st","ns_st_dt","ns_st_ct","ns_st_de","ns_st_pu","ns_st_cu","ns_st_fee","c3","c4","c5","c6","c10","c11","c12","c13","c14","c15","c16","c7","c8","c9"]},p=function(){function e(e,t){var n=t[e];null!=n&&(i[e]=n)}var t,i,n=this,r=0,a=0,o=0,s=0,h=0,d=0;l.extend(this,{reset:function(e){null!=e&&e.length>0?l.filterMap(i,e):i={},i.hasOwnProperty("ns_st_cl")||(i.ns_st_cl="0"),i.hasOwnProperty("ns_st_pn")||(i.ns_st_pn="1"),i.hasOwnProperty("ns_st_tp")||(i.ns_st_tp="1"),n.setPauses(0),n.setStarts(0),n.setBufferingTime(0),n.setBufferingTimestamp(-1),n.setPlaybackTime(0),n.setPlaybackTimestamp(-1)},setLabels:function(e,t){null!=e&&l.extend(i,e),n.setRegisters(i,t)},getLabels:function(){return i},setLabel:function(e,t){var i={};i[e]=t,n.setLabels(i,null)},getLabel:function(e){return i[e]},getClipId:function(){return(void 0===t||null==t)&&n.setClipId("1"),t},setClipId:function(e){t=e},setRegisters:function(t,i){var s=t.ns_st_cn;null!=s&&(n.setClipId(s),delete t.ns_st_cn),null!=(s=t.ns_st_bt)&&(o=Number(s),delete t.ns_st_bt),e("ns_st_cl",t),e("ns_st_pn",t),e("ns_st_tp",t),e("ns_st_ub",t),e("ns_st_br",t),i!=u.PLAYING&&null!=i||null!=(s=t.ns_st_sq)&&(a=Number(s),delete t.ns_st_sq),i!=u.BUFFERING&&null!=(s=t.ns_st_pt)&&(h=Number(s),delete t.ns_st_pt),i!=u.PAUSED&&i!=u.IDLE&&null!=i||null!=(s=t.ns_st_pc)&&(r=Number(s),delete t.ns_st_pc)},createLabels:function(e,t){var i=t||{};return i.ns_st_cn=n.getClipId(),i.ns_st_bt=String(n.getBufferingTime()),e!=c.PLAY&&null!=e||(i.ns_st_sq=String(a)),e!=c.PAUSE&&e!=c.END&&e!=c.KEEP_ALIVE&&e!=c.HEART_BEAT&&null!=e||(i.ns_st_pt=String(n.getPlaybackTime()),i.ns_st_pc=String(r)),l.extend(i,n.getLabels()),i},incrementPauses:function(){r++},incrementStarts:function(){a++},getBufferingTime:function(){var e=o;return s>=0&&(e+=+new Date-s),e},setBufferingTime:function(e){o=e},getPlaybackTime:function(){var e=h;return d>=0&&(e+=+new Date-d),e},setPlaybackTime:function(e){h=e},getPlaybackTimestamp:function(){return d},setPlaybackTimestamp:function(e){d=e},getBufferingTimestamp:function(){return s},setBufferingTimestamp:function(e){s=e},getPauses:function(){return r},setPauses:function(e){r=e},getStarts:function(){return a},setStarts:function(e){a=e}}),i={},n.reset()},f=function(){var e,t,i=this,n=null,r=0,a=0,o=0,s=0,h=0,d=0,f=!1;l.extend(this,{reset:function(e){null!=e&&e.length>0?l.filterMap(t,e):t={},i.setPlaylistId(+new Date+"_"+d),i.setBufferingTime(0),i.setPlaybackTime(0),i.setPauses(0),i.setStarts(0),i.setRebufferCount(0),f=!1},setLabels:function(e,n){null!=e&&l.extend(t,e),i.setRegisters(t,n)},getLabels:function(){return t},setLabel:function(e,t){var n={};n[e]=t,i.setLabels(n,null)},getLabel:function(e){return t[e]},getClip:function(){return n},getPlaylistId:function(){return e},setPlaylistId:function(t){e=t},setRegisters:function(t,i){var n=t.ns_st_sp;null!=n&&(r=Number(n),delete t.ns_st_sp),null!=(n=t.ns_st_bc)&&(o=Number(n),delete t.ns_st_bc),null!=(n=t.ns_st_bp)&&(s=Number(n),delete t.ns_st_bp),null!=(n=t.ns_st_id)&&(e=n,delete t.ns_st_id),i!=u.BUFFERING&&null!=(n=t.ns_st_pa)&&(h=Number(n),delete t.ns_st_pa),i!=u.PAUSED&&i!=u.IDLE&&null!=i||null!=(n=t.ns_st_pp)&&(a=Number(n),delete t.ns_st_pp)},createLabels:function(t,n){var s=n||{};return s.ns_st_bp=String(i.getBufferingTime()),s.ns_st_sp=String(r),s.ns_st_id=String(e),o>0&&(s.ns_st_bc=String(o)),t!=c.PAUSE&&t!=c.END&&t!=c.KEEP_ALIVE&&t!=c.HEART_BEAT&&null!=t||(s.ns_st_pa=String(i.getPlaybackTime()),s.ns_st_pp=String(a)),t!=c.PLAY&&null!=t||i.didFirstPlayOccurred()||(s.ns_st_pb="1",i.setFirstPlayOccurred(!0)),l.extend(s,i.getLabels()),s},incrementStarts:function(){r++},incrementPauses:function(){a++,n.incrementPauses()},setPlaylistCounter:function(e){d=e},incrementPlaylistCounter:function(){d++},addPlaybackTime:function(e){if(n.getPlaybackTimestamp()>=0){var t=e-n.getPlaybackTimestamp();n.setPlaybackTimestamp(-1),n.setPlaybackTime(n.getPlaybackTime()+t),i.setPlaybackTime(i.getPlaybackTime()+t)}},addBufferingTime:function(e){if(n.getBufferingTimestamp()>=0){var t=e-n.getBufferingTimestamp();n.setBufferingTimestamp(-1),n.setBufferingTime(n.getBufferingTime()+t),i.setBufferingTime(i.getBufferingTime()+t)}},getBufferingTime:function(){var e=s;return n.getBufferingTimestamp()>=0&&(e+=+new Date-n.getBufferingTimestamp()),e},setBufferingTime:function(e){s=e},getPlaybackTime:function(){var e=h;return n.getPlaybackTimestamp()>=0&&(e+=+new Date-n.getPlaybackTimestamp()),e},setPlaybackTime:function(e){h=e},getStarts:function(){return r},setStarts:function(e){r=e},getPauses:function(){return a},setPauses:function(e){a=e},getRebufferCount:function(){return o},incrementRebufferCount:function(){o++},setRebufferCount:function(e){o=e},didFirstPlayOccurred:function(){return f},setFirstPlayOccurred:function(e){f=e}}),n=new p,t={},i.reset()},g=function(){var a=function(a,o){function h(e){var t=0;if(null!=re)for(var i=0;i<re.length;i++){var n=re[i],r=n.playingtime;if(!r||e<r){t=n.interval;break}}return t}function p(){v();var e=h(te.getClip().getPlaybackTime());e>0&&(j=setTimeout(m,se>0?se:e));se=0}function g(){v();var e=h(te.getClip().getPlaybackTime());se=e-te.getClip().getPlaybackTime()%e,null!=j&&v()}function _(){se=0,0,le=0}function m(){le++,P(k(c.HEART_BEAT,null)),se=0,p()}function v(){null!=j&&(clearTimeout(j),j=null)}function y(){S(),G=setTimeout(b,ae)}function b(){P(k(c.KEEP_ALIVE,null)),ee++,y()}function S(){null!=G&&(clearTimeout(G),G=null)}function E(){T(),X.isPauseOnBufferingEnabled()&&L(u.PAUSED)&&(H=setTimeout(w,oe))}function w(){z==u.PLAYING&&(te.incrementRebufferCount(),te.incrementPauses(),P(k(c.PAUSE,null)),ee++,z=u.PAUSED)}function T(){null!=H&&(clearTimeout(H),H=null)}function M(e){return e==u.PLAYING||e==u.PAUSED}function A(){V&&(clearTimeout(V),V=null)}function C(e){return e==c.PLAY?u.PLAYING:e==c.PAUSE?u.PAUSED:e==c.BUFFER?u.BUFFERING:e==c.END?u.IDLE:null}function x(e,t,i){if(A(),i)V=setTimeout(function(e,t){return function(){x(e,t)}}(e,t),i);else if(function(e){return null!=e&&R()!=e}(e)){var n=R(),r=J,a=D(t),o=r>=0?a-r:0;(function(e,t){var i=D(t);if(e==u.PLAYING)te.addPlaybackTime(i),g(),S();else if(e==u.BUFFERING)te.addBufferingTime(i),T();else if(e==u.IDLE){var n=l.getKeys(te.getClip().getLabels());te.getClip().reset(n)}})(R(),t),function(e,t){var i=D(t),n=function(e){var t=-1;return e.hasOwnProperty("ns_st_po")&&(t=l.getInteger(e.ns_st_po)),t}(t);$=n,e==u.PLAYING?(p(),y(),te.getClip().setPlaybackTimestamp(i),L(e)&&(te.getClip().incrementStarts(),te.getStarts()<1&&te.setStarts(1))):e==u.PAUSED?L(e)&&te.incrementPauses():e==u.BUFFERING?(te.getClip().setBufferingTimestamp(i),ne&&E()):e==u.IDLE&&_()}(e,t),function(e){e}(R()),function(e){B=e,J=+new Date}(e);for(var s=0,c=q.length;s<c;s++)q[s](n,e,t,o);I(t),te.setRegisters(t,e),te.getClip().setRegisters(t,e);var h=k(u.toEventType(e),t);l.extend(h,t),L(B)&&(P(h),z=B,ee++)}}function I(e){var t=e.ns_st_mp;null!=t&&(W=t,delete e.ns_st_mp),null!=(t=e.ns_st_mv)&&(Y=t,delete e.ns_st_mv),null!=(t=e.ns_st_ec)&&(ee=Number(t),delete e.ns_st_ec)}function P(e,t){void 0===t&&(t=!0),t&&function(e){K=k(null),l.extend(K,e)}(e);var i=X.getPixelURL();if(U){if(!function(){var e=U.getAppContext(),t=U.getSalt(),i=U.getPixelURL();return null==e||null==t||0==t.length||null==i||0==i.length}()){var n=ue.am,a=ue.et,o=n.newApplicationMeasurement(U,a.HIDDEN,e,i);U.getQueue().offer(o)}}else i&&s(r(i,e))}function L(e){return(e!=u.PAUSED&&e!=u.IDLE||z!=u.IDLE&&null!=z)&&(e!=u.BUFFERING&&z!=e)}function D(e){var t=-1;return e.hasOwnProperty("ns_ts")&&(t=Number(e.ns_ts)),t}function R(){return B}function k(){var e,t;1==arguments.length?(e=u.toEventType(B),t=arguments[0]):(e=arguments[0],t=arguments[1]);var i={};if("undefined"!=typeof document){var n=document;i.c7=n.URL,i.c8=n.title,i.c9=n.referrer}return null!=t&&l.extend(i,t),i.hasOwnProperty("ns_ts")||(i.ns_ts=String(+new Date)),null!=e&&!i.hasOwnProperty("ns_st_ev")&&(i.ns_st_ev=c.toString(e)),X.isPersistentLabelsShared()&&U&&l.extend(i,U.getLabels()),l.extend(i,X.getLabels()),O(e,i),te.createLabels(e,i),te.getClip().createLabels(e,i),i.hasOwnProperty("ns_st_mp")||(i.ns_st_mp=W),i.hasOwnProperty("ns_st_mv")||(i.ns_st_mv=Y),i.hasOwnProperty("ns_st_ub")||(i.ns_st_ub="0"),i.hasOwnProperty("ns_st_br")||(i.ns_st_br="0"),i.hasOwnProperty("ns_st_pn")||(i.ns_st_pn="1"),i.hasOwnProperty("ns_st_tp")||(i.ns_st_tp="1"),i.hasOwnProperty("ns_st_it")||(i.ns_st_it="c"),i.ns_st_sv=d.STREAMSENSE_VERSION,i.ns_type="hidden",i}function O(e,t){var i=t||{};if(i.ns_st_ec=String(ee),!i.hasOwnProperty("ns_st_po")){var n=$,r=D(i);(e==c.PLAY||e==c.KEEP_ALIVE||e==c.HEART_BEAT||null==e&&B==u.PLAYING)&&(n+=r-te.getClip().getPlaybackTimestamp()),i.ns_st_po=l.getInteger(n)}return e==c.HEART_BEAT&&(i.ns_st_hc=String(le)),i}function N(e){D(e)<0&&(e.ns_ts=String(+new Date))}var F,V,B,U,H,G,j,z,W,Y,K,q,X=this,Q=500,Z=null,J=0,$=0,ee=0,te=null,ie=!0,ne=!0,re=d.DEFAULT_HEARTBEAT_INTERVAL,ae=d.DEFAULT_KEEP_ALIVE_INTERVAL,oe=d.DEFAULT_PAUSED_ON_BUFFERING_INTERVAL,se=0,le=0,ce=!1,ue={};l.extend(this,{reset:function(e){te.reset(e),te.setPlaylistCounter(0),te.setPlaylistId(+new Date+"_1"),te.getClip().reset(e),null==e||e.isEmpty()?F={}:l.filterMap(F,e),ee=1,le=0,g(),_(),S(),T(),A(),B=u.IDLE,null,J=-1,z=null,W=d.DEFAULT_PLAYERNAME,Y=d.STREAMSENSE_VERSION,K=null},setPauseOnBufferingInterval:function(e){oe=e},getPauseOnBufferingInterval:function(){return oe},setKeepAliveInterval:function(e){ae=e},getKeepAliveInterval:function(){return ae},setHeartbeatIntervals:function(e){re=e},notify:function(){var e,t,i,n;3==arguments.length?(i=arguments[1],n=arguments[2]):(i={},n=arguments[1]),e=C(t=arguments[0]);var r=l.extend({},i);if(N(r),r.hasOwnProperty("ns_st_po")||(r.ns_st_po=l.getInteger(n).toString()),t==c.PLAY||t==c.PAUSE||t==c.BUFFER||t==c.END)X.isPausePlaySwitchDelayEnabled()&&M(B)&&M(e)&&(B!=u.PLAYING||e!=u.PAUSED||V)?x(e,r,Q):x(e,r);else{var a=k(t,r);l.extend(a,r),P(a,!1),ee++}},getLabels:function(){return F},getState:function(){return B},setLabels:function(e){null!=e&&(null==F?F=e:l.extend(F,e))},getLabel:function(e){return F[e]},setLabel:function(e,t){null==t?delete F[e]:F[e]=t},setPixelURL:function(e){if(null==e||0==e.length)return null;var t=decodeURIComponent||unescape,i=e.indexOf("?");if(i>=0){if(i<e.length-1){for(var n=e.substring(i+1).split("&"),r=0,a=n.length;r<a;r++){var o=n[r].split("=");2==o.length?X.setLabel(o[0],t(o[1])):1==o.length&&X.setLabel(d.PAGE_NAME_LABEL,t(o[0]))}e=e.substring(0,i+1)}}else e+="?";return Z=e},getPixelURL:function(){return Z||("undefined"!=typeof ns_p&&"string"==typeof ns_p.src?Z=ns_p.src.replace(/&amp;/,"&").replace(/&ns__t=\d+/,""):"string"==typeof ns_pixelUrl?Z=ns_pixelUrl.replace(/&amp;/,"&").replace(/&ns__t=\d+/,""):null)},isPersistentLabelsShared:function(){return ie},setPersistentLabelsShared:function(e){ie=e},isPauseOnBufferingEnabled:function(){return ne},setPauseOnBufferingEnabled:function(e){ne=e},isPausePlaySwitchDelayEnabled:function(){return ce},setPausePlaySwitchDelayEnabled:function(e){ce=e},setPausePlaySwitchDelay:function(e){e&&e>0&&(Q=e)},getPausePlaySwitchDelay:function(){return Q},setClip:function(e,t){var i=!1;return B==u.IDLE&&(te.getClip().reset(),te.getClip().setLabels(e,null),t&&te.incrementStarts(),i=!0),i},setPlaylist:function(e){var t=!1;return B==u.IDLE&&(te.incrementPlaylistCounter(),te.reset(),te.getClip().reset(),te.setLabels(e,null),t=!0),t},importState:function(e){reset();var t=l.extend({},e);te.setRegisters(t,null),te.getClip().setRegisters(t,null),I(t),ee++},exportState:function(){return K},getVersion:function(){return d.STREAMSENSE_VERSION},addListener:function(e){q.push(e)},removeListener:function(e){q.splice(l.indexOf(e,q),1)},getClip:function(){return te.getClip()},getPlaylist:function(){return te},setHttpGet:e,setHttpPost:t}),l.extend(this,{adNotify:function(e,t,i){(t=t||{}).ns_st_ad=1,e>=c.AD_PLAY&&e<=c.AD_CLICK&&X.notify(e,t,i)},customNotify:function(e,t){X.notify(c.CUSTOM,e,t)},viewNotify:function(e,t){(e=e||X.getPixelURL())&&n(e,t)}}),i.comScore&&(ue=i.comScore.exports,U=ue.c()),F={},ee=1,B=u.IDLE,te=new f,H=null,ne=!0,j=null,le=0,_(),G=null,V=null,ce=!1,z=null,$=0,q=[],X.reset(),a&&X.setLabels(a),o&&X.setPixelURL(o)};return function(e){function t(e,t){return o[c]||r(e,t)}function n(){c=-1;for(var e=0;e<=s;e++)if(o.hasOwnProperty(e)){c=e;break}return i.StreamSense.activeIndex=c,c}function r(e,t){return t=t||null,(e=e||null)&&"object"==typeof e&&(t=e,e=null),o[++s]=new i.StreamSense(t,e),n(),o[s]}function a(){var e=!1,t=c;if("number"==typeof arguments[0]&&isFinite(arguments[0]))t=arguments[0];else if(arguments[0]instanceof i.StreamSense)for(var r in o)if(o[r]===arguments[0]){t=r;break}return o.hasOwnProperty(t)&&(e=o[t],delete o[t],e.reset(),n()),e}var o={},s=-1,c=-1;l.extend(e,{activeIndex:c,newInstance:r,new:r,destroyInstance:a,destroy:a,newPlaylist:function(e){return e=e||{},t().setPlaylist(e),t().getPlaylist()},newClip:function(e,i,n){return e=e||{},"number"==typeof i&&(e.ns_st_cn=i),t().setClip(e,n),t().getClip()},notify:function(e,i,n){return void 0!==e&&(n=n||null,i=i||{},t().notify(e,i,n))},setLabels:function(e){void 0!==e&&t().setLabels(e)},getLabels:function(){return t().getLabels()},setPlaylistLabels:function(e){void 0!==e&&t().getPlaylist().setLabels(e)},getPlaylistLabels:function(){return t().getPlaylist().getLabels()},setClipLabels:function(e){void 0!==e&&t().getClip().setLabels(e)},getClipLabels:function(){return t().getClip().getLabels()},resetInstance:function(e){return t().reset(e||{})},resetPlaylist:function(e){return t().getPlaylist().reset(e||{})},resetClip:function(e){return t().getClip().reset(e||{})},viewEvent:function(e){return e=e||{},t().viewNotify(null,e)},customEvent:function(e,i){return arguments.length>2&&(e=arguments[1],i=arguments[2]),e=e||{},"number"==typeof i&&(e.ns_st_po=i),t().customNotify(e,i)},exportState:function(){return t().exportState()},importState:function(e){t().importState(e)}})}(a),a}();return g.AdEvents=h,g.PlayerEvents=c,i.StreamingTag=i.StreamingTag||function(){var e=function(e){function t(e){return l.exists(e)||(e={}),l.exists(e.ns_st_ci)||(e.ns_st_ci="0"),l.exists(e.c3)||(e.c3="*null"),l.exists(e.c4)||(e.c4="*null"),l.exists(e.c6)||(e.c6="*null"),e}function i(e){return s>0&&e>=s?h+=e-s:h=0,h}function n(e){f.getState()!=u.IDLE&&f.getState()!=u.PAUSED?f.notify(c.END,i(e)):f.getState()==u.PAUSED&&f.notify(c.END,h)}function r(e,t,i){if(l.exists(e)&&l.exists(t)&&l.exists(i)){var n=t[e],r=i[e];return l.exists(n)&&l.exists(r)&&n===r}return!1}function a(e,t){n(e),o++,f.setClip({ns_st_cn:o,ns_st_pn:"1",ns_st_ct:"vc",ns_st_tp:"0"}),f.getClip().setLabels(t),d=t,s=e,h=0,f.notify(c.PLAY,h)}var o=0,s=0,h=0,d=null,p=!1,f=new g;l.extend(this,{playAdvertisement:function(){var e=+new Date;n(e),o++;var i=t(null);i.ns_st_cn=o,i.ns_st_pn="1",i.ns_st_ct="va",i.ns_st_tp="1",i.ns_st_ad="1",f.setClip(i),h=0,f.notify(c.PLAY,h),s=e,p=!1},playContentPart:function(e){var i=+new Date;e=t(e),p&&function(e){return r("ns_st_ci",d,e)&&r("c3",d,e)&&r("c4",d,e)&&r("c6",d,e)}(e)?(f.getClip().setLabels(e),f.getState()!=u.PLAYING&&(s=i,f.notify(c.PLAY,h))):a(i,e),p=!0},stop:function(){var e=+new Date;f.notify(c.PAUSE,i(e))}}),function(){if(l.exists(e)&&l.exists(e.customerC2)){var t=e.secure?"https://sb":"http"+("s"==document.location.href.charAt(4)?"s://sb":"://b");f.setPixelURL(t+".scorecardresearch.com/p?c1=2"),f.setLabel("c2",e.customerC2),f.setLabel("ns_st_it","r")}}()};return e}(),g}(),e.exports=i},function(e,t,i){!function(){"use strict";var t="undefined"!=typeof window&&void 0!==window.document?window.document:{},i=e.exports,n="undefined"!=typeof Element&&"ALLOW_KEYBOARD_INPUT"in Element,r=function(){for(var e,i=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],n=0,r=i.length,a={};n<r;n++)if((e=i[n])&&e[1]in t){for(n=0;n<e.length;n++)a[i[0][n]]=e[n];return a}return!1}(),a={change:r.fullscreenchange,error:r.fullscreenerror},o={request:function(e){return new Promise(function(i){var a=r.requestFullscreen,o=function(){this.off("change",o),i()}.bind(this);e=e||t.documentElement,/ Version\/5\.1(?:\.\d+)? Safari\//.test(navigator.userAgent)?e[a]():e[a](n?Element.ALLOW_KEYBOARD_INPUT:{}),this.on("change",o)}.bind(this))},exit:function(){return new Promise(function(e){var i=function(){this.off("change",i),e()}.bind(this);t[r.exitFullscreen](),this.on("change",i)}.bind(this))},toggle:function(e){return this.isFullscreen?this.exit():this.request(e)},onchange:function(e){this.on("change",e)},onerror:function(e){this.on("error",e)},on:function(e,i){var n=a[e];n&&t.addEventListener(n,i,!1)},off:function(e,i){var n=a[e];n&&t.removeEventListener(n,i,!1)},raw:r};r?(Object.defineProperties(o,{isFullscreen:{get:function(){return Boolean(t[r.fullscreenElement])}},element:{enumerable:!0,get:function(){return t[r.fullscreenElement]}},enabled:{enumerable:!0,get:function(){return Boolean(t[r.fullscreenEnabled])}}}),i?e.exports=o:window.screenfull=o):i?e.exports=!1:window.screenfull=!1}()},function(e,t,i){(function(t){
/**
 * @license
 * Adobe Visitor API for JavaScript version: 4.4.0
 * Copyright 2019 Adobe, Inc. All Rights Reserved
 * More info available at https://marketing.adobe.com/resources/help/en_US/mcvid/
 */
!function(){"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function i(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function n(e,t,i){var n=null==e?void 0:e[t];return void 0===n?i:n}function r(e,t){if(e===t)return 0;var i=e.toString().split("."),n=t.toString().split(".");return function(e){for(var t=/^\d+$/,i=0,n=e.length;i<n;i++)if(!t.test(e[i]))return!1;return!0}(i.concat(n))?(function(e,t){for(;e.length<t.length;)e.push("0");for(;t.length<e.length;)t.push("0")}(i,n),function(e,t){for(var i=0;i<e.length;i++){var n=parseInt(e[i],10),r=parseInt(t[i],10);if(n>r)return 1;if(r>n)return-1}return 0}(i,n)):NaN}function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.isEnabled,i=e.cookieName,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.cookies;return t&&i&&r?{remove:function(){r.remove(i)},get:function(){var e=r.get(i),t={};try{t=JSON.parse(e)}catch(e){t={}}return t},set:function(e,t){t=t||{},r.set(i,JSON.stringify(e),{domain:t.optInCookieDomain||"",cookieLifetime:t.optInStorageExpiry||3419e4,expires:!0})}}:{get:be,set:be,remove:be}}function o(e){this.name=this.constructor.name,this.message=e,"function"==typeof Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error(e).stack}function s(){function e(e,t){var i=ue(e);return i.length?i.every((function(e){return!!t[e]})):he(t)}function t(){C(M),A($.COMPLETE),m(_.status,_.permissions),g.set(_.permissions,{optInCookieDomain:c,optInStorageExpiry:u}),v.execute(Me)}function i(e){return function(i,n){if(!de(i))throw new Error("[OptIn] Invalid category(-ies). Please use the `OptIn.Categories` enum.");return A($.CHANGED),Object.assign(M,pe(ue(i),e)),n||t(),_}}var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.doesOptInApply,o=n.previousPermissions,s=n.preOptInApprovals,l=n.isOptInStorageEnabled,c=n.optInCookieDomain,u=n.optInStorageExpiry,h=n.isIabContext,d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},p=d.cookies,f=Se(o);Ee(f,"Invalid `previousPermissions`!"),Ee(s,"Invalid `preOptInApprovals`!");var g=a({isEnabled:!!l,cookieName:"adobeujs-optin"},{cookies:p}),_=this,m=J(_),v=re(),y=_e(f),b=_e(s),S=g.get(),E={},w=function(e,t){return me(e)||t&&me(t)?$.COMPLETE:$.PENDING}(y,S),T=function(e,t,i){var n=pe(ne,!r);return r?Object.assign({},n,e,t,i):n}(b,y,S),M=fe(T),A=function(e){return w=e},C=function(e){return T=e};_.deny=i(!1),_.approve=i(!0),_.denyAll=_.deny.bind(_,ne),_.approveAll=_.approve.bind(_,ne),_.isApproved=function(t){return e(t,_.permissions)},_.isPreApproved=function(t){return e(t,b)},_.fetchPermissions=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=t?_.on($.COMPLETE,e):be;return!r||r&&_.isComplete||s?e(_.permissions):t||v.add(Me,(function(){return e(_.permissions)})),i},_.complete=function(){_.status===$.CHANGED&&t()},_.registerPlugin=function(e){if(!e||!e.name||"function"!=typeof e.onRegister)throw new Error(Ae);E[e.name]||(E[e.name]=e,e.onRegister.call(e,_))},_.execute=Te(E),Object.defineProperties(_,{permissions:{get:function(){return T}},status:{get:function(){return w}},Categories:{get:function(){return ee}},doesOptInApply:{get:function(){return!!r}},isPending:{get:function(){return _.status===$.PENDING}},isComplete:{get:function(){return _.status===$.COMPLETE}},__plugins:{get:function(){return Object.keys(E)}},isIabContext:{get:function(){return h}}})}function l(e,t){if(void 0===t)return e;var i=setTimeout((function(){i=null,e.call(e,new o("The call took longer than you wanted!"))}),t);return function(){i&&(clearTimeout(i),e.apply(e,arguments))}}function c(){if(window.__cmp)return window.__cmp;var e=window;if(e!==window.top){for(var t;!t;){e=e.parent;try{e.frames.__cmpLocator&&(t=e)}catch(e){}if(e===window.top)break}if(t){var i={};return window.__cmp=function(e,n,r){var a=Math.random()+"",o={__cmpCall:{command:e,parameter:n,callId:a}};i[a]=r,t.postMessage(o,"*")},window.addEventListener("message",(function(e){var t=e.data;if("string"==typeof t)try{t=JSON.parse(e.data)}catch(e){}if(t.__cmpReturn){var n=t.__cmpReturn;i[n.callId]&&(i[n.callId](n.returnValue,n.success),delete i[n.callId])}}),!1),window.__cmp}le.error("__cmp not found")}else le.error("__cmp not found")}var u="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{};Object.assign=Object.assign||function(e){for(var t,i,n=1;n<arguments.length;++n)for(t in i=arguments[n])Object.prototype.hasOwnProperty.call(i,t)&&(e[t]=i[t]);return e};var h,d,p={HANDSHAKE:"HANDSHAKE",GETSTATE:"GETSTATE",PARENTSTATE:"PARENTSTATE"},f={MCMID:"getMarketingCloudVisitorID",MCAID:"getAnalyticsVisitorID",MCAAMB:"getAudienceManagerBlob",MCAAMLH:"getAudienceManagerLocationHint",MCOPTOUT:"isOptedOut",ALLFIELDS:"getVisitorValues"},g={MCMID:"getMarketingCloudVisitorID",MCAAMB:"getAudienceManagerBlob",MCAAMLH:"getAudienceManagerLocationHint",MCOPTOUT:"isOptedOut",MCAID:"getAnalyticsVisitorID",CUSTOMERIDS:"getCustomerIDs",ALLFIELDS:"getVisitorValues"},_={MC:"MCMID",A:"MCAID",AAM:"MCAAMB"},m={MCMID:"MCMID",MCOPTOUT:"MCOPTOUT",MCAID:"MCAID",MCAAMLH:"MCAAMLH",MCAAMB:"MCAAMB"},v={UNKNOWN:0,AUTHENTICATED:1,LOGGED_OUT:2},y={GLOBAL:"global"},b={MCMID:"MCMID",MCAID:"MCAID",MCAAMB:"MCAAMB",MCAAMLH:"MCAAMLH",MCOPTOUT:"MCOPTOUT",CUSTOMERIDS:"CUSTOMERIDS"},S=function(e){function t(){}function i(t,i){var n=this;return function(){var r=e(0,t),a={};return a[t]=r,n.setStateAndPublish(a),i(r),r}}this.getMarketingCloudVisitorID=function(e){e=e||t;var n=this.findField(b.MCMID,e),r=i.call(this,b.MCMID,e);return void 0!==n?n:r()},this.getVisitorValues=function(e){this.getMarketingCloudVisitorID((function(t){e({MCMID:t})}))}},E=p,w=f,T={CUSTOMERIDS:"getCustomerIDs"},M=function(){function e(){}function t(e,t){var i=this;return function(){return i.callbackRegistry.add(e,t),i.messageParent(E.GETSTATE),""}}Object.keys(w).forEach((function(i){this[w[i]]=function(n){n=n||e;var r=this.findField(i,n),a=t.call(this,i,n);return void 0!==r?r:a()}}),this),Object.keys(T).forEach((function(t){this[T[t]]=function(){return this.findField(t,e)||{}}}),this)},A=f,C=function(){Object.keys(A).forEach((function(e){this[A[e]]=function(t){this.callbackRegistry.add(e,t)}}),this)},x=function(e,t){return e(t={exports:{}},t.exports),t.exports}((function(t,i){i.isObjectEmpty=function(e){return e===Object(e)&&0===Object.keys(e).length},i.isValueEmpty=function(e){return""===e||i.isObjectEmpty(e)},i.getIeVersion=function(){if(document.documentMode)return document.documentMode;for(var e=7;e>4;e--){var t=document.createElement("div");if(t.innerHTML="\x3c!--[if IE "+e+"]><span></span><![endif]--\x3e",t.getElementsByTagName("span").length)return t=null,e;t=null}return null},i.encodeAndBuildRequest=function(e,t){return e.map(encodeURIComponent).join(t)},i.isObject=function(t){return null!==t&&"object"===e(t)&&!1===Array.isArray(t)},i.defineGlobalNamespace=function(){return window.adobe=i.isObject(window.adobe)?window.adobe:{},window.adobe},i.pluck=function(e,t){return t.reduce((function(t,i){return e[i]&&(t[i]=e[i]),t}),Object.create(null))},i.parseOptOut=function(e,t,i){t||(t=i,e.d_optout&&e.d_optout instanceof Array&&(t=e.d_optout.join(",")));var n=parseInt(e.d_ottl,10);return isNaN(n)&&(n=7200),{optOut:t,d_ottl:n}},i.normalizeBoolean=function(e){var t=e;return"true"===e?t=!0:"false"===e&&(t=!1),t}})),I=(x.isObjectEmpty,x.isValueEmpty,x.getIeVersion,x.encodeAndBuildRequest,x.isObject,x.defineGlobalNamespace,x.pluck,x.parseOptOut,x.normalizeBoolean,function(){return{callbacks:{},add:function(e,t){this.callbacks[e]=this.callbacks[e]||[];var i=this.callbacks[e].push(t)-1,n=this;return function(){n.callbacks[e].splice(i,1)}},execute:function(e,t){if(this.callbacks[e]){t=(t=void 0===t?[]:t)instanceof Array?t:[t];try{for(;this.callbacks[e].length;){var i=this.callbacks[e].shift();"function"==typeof i?i.apply(null,t):i instanceof Array&&i[1].apply(i[0],t)}delete this.callbacks[e]}catch(e){}}},executeAll:function(e,t){(t||e&&!x.isObjectEmpty(e))&&Object.keys(this.callbacks).forEach((function(t){var i=void 0!==e[t]?e[t]:"";this.execute(t,i)}),this)},hasCallbacks:function(){return Boolean(Object.keys(this.callbacks).length)}}}),P=p,L={0:"prefix",1:"orgID",2:"state"},D=function(e,t){this.parse=function(e){try{var t={};return e.data.split("|").forEach((function(e,i){void 0!==e&&(t[L[i]]=2!==i?e:JSON.parse(e))})),t}catch(e){}},this.isInvalid=function(i){var n=this.parse(i);if(!n||Object.keys(n).length<2)return!0;var r=e!==n.orgID,a=!t||i.origin!==t,o=-1===Object.keys(P).indexOf(n.prefix);return r||a||o},this.send=function(i,n,r){var a=n+"|"+e;r&&r===Object(r)&&(a+="|"+JSON.stringify(r));try{i.postMessage(a,t)}catch(e){}}},R=p,k=function(e,t,i,n){function r(e){Object.assign(c,e)}function a(e){if(!p.isInvalid(e)){d=!1;var t=p.parse(e);c.setStateAndPublish(t.state)}}function o(e){!d&&h&&(d=!0,p.send(n,e))}function s(){r(new S(i._generateID)),c.getMarketingCloudVisitorID(),c.callbackRegistry.executeAll(c.state,!0),u.removeEventListener("message",l)}function l(e){if(!p.isInvalid(e)){var t=p.parse(e);d=!1,u.clearTimeout(c._handshakeTimeout),u.removeEventListener("message",l),r(new M(c)),u.addEventListener("message",a),c.setStateAndPublish(t.state),c.callbackRegistry.hasCallbacks()&&o(R.GETSTATE)}}var c=this,h=t.whitelistParentDomain;c.state={ALLFIELDS:{}},c.version=i.version,c.marketingCloudOrgID=e,c.cookieDomain=i.cookieDomain||"",c._instanceType="child";var d=!1,p=new D(e,h);c.callbackRegistry=I(),c.init=function(){u.s_c_in||(u.s_c_il=[],u.s_c_in=0),c._c="Visitor",c._il=u.s_c_il,c._in=u.s_c_in,c._il[c._in]=c,u.s_c_in++,Object.keys(i).forEach((function(e){0!==e.indexOf("_")&&"function"==typeof i[e]&&(c[e]=function(){})})),c.getSupplementalDataID=i.getSupplementalDataID,c.isAllowed=function(){return!0},r(new C(c)),h&&postMessage?(u.addEventListener("message",l),o(R.HANDSHAKE),c._handshakeTimeout=setTimeout(s,250)):s()},c.findField=function(e,t){if(void 0!==c.state[e])return t(c.state[e]),c.state[e]},c.messageParent=o,c.setStateAndPublish=function(e){Object.assign(c.state,e),Object.assign(c.state.ALLFIELDS,e),c.callbackRegistry.executeAll(c.state)}},O=p,N=g,F=f,V=_,B=function(e,t){function i(){var t={};return Object.keys(N).forEach((function(i){var n=N[i],r=e[n]();x.isValueEmpty(r)||(t[i]=r)})),t}function n(t){return function i(n){var r=function(){var t=[];return e._loading&&Object.keys(e._loading).forEach((function(i){if(e._loading[i]){var n=V[i];t.push(n)}})),t.length?t:null}();if(r){var a=F[r[0]];e[a](i,!0)}else t()}}function r(e,n){var r=i();t.send(e,n,r)}function a(e){s(e),r(e,O.HANDSHAKE)}function o(e){n((function(){r(e,O.PARENTSTATE)}))()}function s(i){var n=e.setCustomerIDs;e.setCustomerIDs=function(r){n.call(e,r),t.send(i,O.PARENTSTATE,{CUSTOMERIDS:e.getCustomerIDs()})}}return function(e){t.isInvalid(e)||(t.parse(e).prefix===O.HANDSHAKE?a:o)(e.source)}},U={get:function(e){e=encodeURIComponent(e);var t=(";"+document.cookie).split(" ").join(";"),i=t.indexOf(";"+e+"="),n=i<0?i:t.indexOf(";",i+1);return i<0?"":decodeURIComponent(t.substring(i+2+e.length,n<0?t.length:n))},set:function(e,t,i){var r=n(i,"cookieLifetime"),a=n(i,"expires"),o=n(i,"domain"),s=n(i,"secure")?"Secure":"";if(a&&"SESSION"!==r&&"NONE"!==r){var l=""!==t?parseInt(r||0,10):-60;if(l)(a=new Date).setTime(a.getTime()+1e3*l);else if(1===a){var c=(a=new Date).getYear();a.setYear(c+2+(c<1900?1900:0))}}else a=0;return e&&"NONE"!==r?(document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(t)+"; path=/;"+(a?" expires="+a.toGMTString()+";":"")+(o?" domain="+o+";":"")+s,this.get(e)===t):0},remove:function(e,t){var i=n(t,"domain");i=i?" domain="+i+";":"",document.cookie=encodeURIComponent(e)+"=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;"+i}},H=function(e){var t;!e&&u.location&&(e=u.location.hostname);var i,n=(t=e).split(".");for(i=n.length-2;i>=0;i--)if(t=n.slice(i).join("."),U.set("test","cookie",{domain:t}))return U.remove("test",{domain:t}),t;return""},G=function(e,t){return r(e,t)<0},j=function(e,t){return 0!==r(e,t)},z=!!u.postMessage,W=function(e,t,i){var n=1;t&&(z?i.postMessage(e,t.replace(/([^:]+:\/\/[^\/]+).*/,"$1")):t&&(i.location=t.replace(/#.*$/,"")+"#"+ +new Date+n+++"&"+e))},Y=function(e,t){var i;try{z&&(e&&(i=function(i){if("string"==typeof t&&i.origin!==t||"[object Function]"===Object.prototype.toString.call(t)&&!1===t(i.origin))return!1;e(i)}),u.addEventListener?u[e?"addEventListener":"removeEventListener"]("message",i):u[e?"attachEvent":"detachEvent"]("onmessage",i))}catch(e){}},K=function(e){var t,i,n="0123456789",r="",a="",o=8,s=10,l=10;if(1==e){for(n+="ABCDEF",t=0;16>t;t++)i=Math.floor(Math.random()*o),r+=n.substring(i,i+1),i=Math.floor(Math.random()*o),a+=n.substring(i,i+1),o=16;return r+"-"+a}for(t=0;19>t;t++)i=Math.floor(Math.random()*s),r+=n.substring(i,i+1),0===t&&9==i?s=3:((1==t||2==t)&&10!=s&&2>i||2<t)&&(s=10),i=Math.floor(Math.random()*l),a+=n.substring(i,i+1),0===t&&9==i?l=3:((1==t||2==t)&&10!=l&&2>i||2<t)&&(l=10);return r+a},q=function(e,t){return{corsMetadata:function(){var e="none",t=!0;return"undefined"!=typeof XMLHttpRequest&&XMLHttpRequest===Object(XMLHttpRequest)&&("withCredentials"in new XMLHttpRequest?e="XMLHttpRequest":"undefined"!=typeof XDomainRequest&&XDomainRequest===Object(XDomainRequest)&&(t=!1),Object.prototype.toString.call(u.HTMLElement).indexOf("Constructor")>0&&(t=!1)),{corsType:e,corsCookiesEnabled:t}}(),getCORSInstance:function(){return"none"===this.corsMetadata.corsType?null:new u[this.corsMetadata.corsType]},fireCORS:function(t,i,n){var r=this;i&&(t.loadErrorHandler=i);try{var a=this.getCORSInstance();a.open("get",t.corsUrl+"&ts="+(new Date).getTime(),!0),"XMLHttpRequest"===this.corsMetadata.corsType&&(a.withCredentials=!0,a.timeout=e.loadTimeout,a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),a.onreadystatechange=function(){4===this.readyState&&200===this.status&&function(e){var i;try{if((i=JSON.parse(e))!==Object(i))return void r.handleCORSError(t,null,"Response is not JSON")}catch(e){return void r.handleCORSError(t,e,"Error parsing response as JSON")}try{for(var n=t.callback,a=u,o=0;o<n.length;o++)a=a[n[o]];a(i)}catch(e){r.handleCORSError(t,e,"Error forming callback function")}}(this.responseText)}),a.onerror=function(e){r.handleCORSError(t,e,"onerror")},a.ontimeout=function(e){r.handleCORSError(t,e,"ontimeout")},a.send(),e._log.requests.push(t.corsUrl)}catch(e){this.handleCORSError(t,e,"try-catch")}},handleCORSError:function(t,i,n){e.CORSErrors.push({corsData:t,error:i,description:n}),t.loadErrorHandler&&("ontimeout"===n?t.loadErrorHandler(!0):t.loadErrorHandler(!1))}}},X={POST_MESSAGE_ENABLED:!!u.postMessage,DAYS_BETWEEN_SYNC_ID_CALLS:1,MILLIS_PER_DAY:864e5,ADOBE_MC:"adobe_mc",ADOBE_MC_SDID:"adobe_mc_sdid",VALID_VISITOR_ID_REGEX:/^[0-9a-fA-F\-]+$/,ADOBE_MC_TTL_IN_MIN:5,VERSION_REGEX:/vVersion\|((\d+\.)?(\d+\.)?(\*|\d+))(?=$|\|)/,FIRST_PARTY_SERVER_COOKIE:"s_ecid"},Q={audienceManagerServer:{},audienceManagerServerSecure:{},cookieDomain:{},cookieLifetime:{},cookieName:{},doesOptInApply:{},disableThirdPartyCalls:{},discardTrackingServerECID:{},idSyncAfterIDCallResult:{},idSyncAttachIframeOnWindowLoad:{},idSyncContainerID:{},idSyncDisable3rdPartySyncing:{},disableThirdPartyCookies:{},idSyncDisableSyncs:{},disableIdSyncs:{},idSyncIDCallResult:{},idSyncSSLUseAkamai:{},isCoopSafe:{},isIabContext:{},isOptInStorageEnabled:{},loadSSL:{},loadTimeout:{},marketingCloudServer:{},marketingCloudServerSecure:{},optInCookieDomain:{},optInStorageExpiry:{},overwriteCrossDomainMCIDAndAID:{},preOptInApprovals:{},previousPermissions:{},resetBeforeVersion:{},sdidParamExpiry:{},serverState:{},sessionCookieName:{},secureCookie:{},takeTimeoutMetrics:{},trackingServer:{},trackingServerSecure:{},whitelistIframeDomains:{},whitelistParentDomain:{}},Z={getConfigNames:function(){return Object.keys(Q)},getConfigs:function(){return Q},normalizeConfig:function(e){return"function"!=typeof e?e:e()}},J=function(e){var t={};return e.on=function(e,i,n){if(!i||"function"!=typeof i)throw new Error("[ON] Callback should be a function.");t.hasOwnProperty(e)||(t[e]=[]);var r=t[e].push({callback:i,context:n})-1;return function(){t[e].splice(r,1),t[e].length||delete t[e]}},e.off=function(e,i){t.hasOwnProperty(e)&&(t[e]=t[e].filter((function(e){if(e.callback!==i)return e})))},e.publish=function(e){if(t.hasOwnProperty(e)){var i=[].slice.call(arguments,1);t[e].slice(0).forEach((function(e){e.callback.apply(e.context,i)}))}},e.publish},$={PENDING:"pending",CHANGED:"changed",COMPLETE:"complete"},ee={AAM:"aam",ADCLOUD:"adcloud",ANALYTICS:"aa",CAMPAIGN:"campaign",ECID:"ecid",LIVEFYRE:"livefyre",TARGET:"target",VIDEO_ANALYTICS:"videoaa"},te=(i(h={},ee.AAM,565),i(h,ee.ECID,565),h),ie=(i(d={},ee.AAM,[1,2,5]),i(d,ee.ECID,[1,2,5]),d),ne=function(e){return Object.keys(e).map((function(t){return e[t]}))}(ee),re=function(){var e={};return e.callbacks=Object.create(null),e.add=function(t,i){if(!function(e){return"function"==typeof e||e instanceof Array&&e.length}(i))throw new Error("[callbackRegistryFactory] Make sure callback is a function or an array of functions.");e.callbacks[t]=e.callbacks[t]||[];var n=e.callbacks[t].push(i)-1;return function(){e.callbacks[t].splice(n,1)}},e.execute=function(t,i){if(e.callbacks[t]){i=(i=void 0===i?[]:i)instanceof Array?i:[i];try{for(;e.callbacks[t].length;){var n=e.callbacks[t].shift();"function"==typeof n?n.apply(null,i):n instanceof Array&&n[1].apply(n[0],i)}delete e.callbacks[t]}catch(e){}}},e.executeAll=function(t,i){(i||t&&!function(e){return e===Object(e)&&0===Object.keys(e).length}(t))&&Object.keys(e.callbacks).forEach((function(i){var n=void 0!==t[i]?t[i]:"";e.execute(i,n)}),e)},e.hasCallbacks=function(){return Boolean(Object.keys(e.callbacks).length)},e},ae=function(){},oe=function(e){var t=window.console;return!!t&&"function"==typeof t[e]},se=function(e,t,i){return i()?function(){if(oe(e)){for(var i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];console[e].apply(console,[t].concat(n))}}:ae},le=new function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return!0};this.log=se("log",e,t),this.warn=se("warn",e,t),this.error=se("error",e,t)}("[ADOBE OPT-IN]"),ce=function(t,i){return e(t)===i},ue=function(e,t){return e instanceof Array?e:ce(e,"string")?[e]:t||[]},he=function(e){var t=Object.keys(e);return!!t.length&&t.every((function(t){return!0===e[t]}))},de=function(e){return!(!e||ge(e))&&ue(e).every((function(e){return ne.indexOf(e)>-1}))},pe=function(e,t){return e.reduce((function(e,i){return e[i]=t,e}),{})},fe=function(e){return JSON.parse(JSON.stringify(e))},ge=function(e){return"[object Array]"===Object.prototype.toString.call(e)&&!e.length},_e=function(e){if(ye(e))return e;try{return JSON.parse(e)}catch(e){return{}}},me=function(e){return void 0===e||(ye(e)?de(Object.keys(e)):ve(e))},ve=function(e){try{var t=JSON.parse(e);return!!e&&ce(e,"string")&&de(Object.keys(t))}catch(e){return!1}},ye=function(e){return null!==e&&ce(e,"object")&&!1===Array.isArray(e)},be=function(){},Se=function(e){return ce(e,"function")?e():e},Ee=function(e,t){me(e)||le.error("".concat(t))},we=function(e){return function(e){return Object.keys(e).map((function(t){return e[t]}))}(e).filter((function(e,t,i){return i.indexOf(e)===t}))},Te=function(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=t.command,n=t.params,r=void 0===n?{}:n,a=t.callback,o=void 0===a?be:a;if(!i||-1===i.indexOf("."))throw new Error("[OptIn.execute] Please provide a valid command.");try{var s=i.split("."),l=e[s[0]],c=s[1];if(!l||"function"!=typeof l[c])throw new Error("Make sure the plugin and API name exist.");var u=Object.assign(r,{callback:o});l[c].call(l,u)}catch(e){le.error("[execute] Something went wrong: "+e.message)}}};o.prototype=Object.create(Error.prototype),o.prototype.constructor=o;var Me="fetchPermissions",Ae="[OptIn#registerPlugin] Plugin is invalid.";s.Categories=ee,s.TimeoutError=o;var Ce=Object.freeze({OptIn:s,IabPlugin:function(){var e=this;e.name="iabPlugin",e.version="0.0.1";var t=re(),i={allConsentData:null},n=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return i[e]=t};e.fetchConsentData=function(e){var t=l(e.callback,e.timeout);r({callback:t})},e.isApproved=function(e){var t=e.callback,n=e.category,a=e.timeout;if(i.allConsentData)return t(null,s(n,i.allConsentData.vendorConsents,i.allConsentData.purposeConsents));var o=l((function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=i.vendorConsents,a=i.purposeConsents;t(e,s(n,r,a))}),a);r({category:n,callback:o})},e.onRegister=function(t){var i=Object.keys(te);e.fetchConsentData({callback:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.purposeConsents,a=n.gdprApplies,o=n.vendorConsents;!e&&a&&o&&r&&(i.forEach((function(e){var i=s(e,o,r);t[i?"approve":"deny"](e,!0)})),t.complete())}})};var r=function(e){var r=e.callback;if(i.allConsentData)return r(null,i.allConsentData);t.add("FETCH_CONSENT_DATA",r);var s={};o((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.purposeConsents,o=e.gdprApplies,l=e.vendorConsents;(arguments.length>1?arguments[1]:void 0)&&n("allConsentData",s={purposeConsents:r,gdprApplies:o,vendorConsents:l}),a((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(arguments.length>1?arguments[1]:void 0)&&(s.consentString=e.consentData,n("allConsentData",s)),t.execute("FETCH_CONSENT_DATA",[null,i.allConsentData])}))}))},a=function(e){var t=c();t&&t("getConsentData",null,e)},o=function(e){var t=we(te),i=c();i&&i("getVendorConsents",t,e)},s=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=!!t[te[e]];return n&&ie[e].every((function(e){return i[e]}))}}}),xe=function(e,t){return"SHA-256"!==t&&"SHA256"!==t&&"sha256"!==t&&"sha-256"!==t||(e=function e(t){function i(e,t){return e>>>t|e<<32-t}for(var n,r,a=Math.pow,o=a(2,32),s="",l=[],c=8*t.length,u=e.h=e.h||[],h=e.k=e.k||[],d=h.length,p={},f=2;d<64;f++)if(!p[f]){for(n=0;n<313;n+=f)p[n]=f;u[d]=a(f,.5)*o|0,h[d++]=a(f,1/3)*o|0}for(t+="Â€";t.length%64-56;)t+="\0";for(n=0;n<t.length;n++){if((r=t.charCodeAt(n))>>8)return;l[n>>2]|=r<<(3-n)%4*8}for(l[l.length]=c/o|0,l[l.length]=c,r=0;r<l.length;){var g=l.slice(r,r+=16),_=u;for(u=u.slice(0,8),n=0;n<64;n++){var m=g[n-15],v=g[n-2],y=u[0],b=u[4],S=u[7]+(i(b,6)^i(b,11)^i(b,25))+(b&u[5]^~b&u[6])+h[n]+(g[n]=n<16?g[n]:g[n-16]+(i(m,7)^i(m,18)^m>>>3)+g[n-7]+(i(v,17)^i(v,19)^v>>>10)|0);(u=[S+((i(y,2)^i(y,13)^i(y,22))+(y&u[1]^y&u[2]^u[1]&u[2]))|0].concat(u))[4]=u[4]+S|0}for(n=0;n<8;n++)u[n]=u[n]+_[n]|0}for(n=0;n<8;n++)for(r=3;r+1;r--){var E=u[n]>>8*r&255;s+=(E<16?0:"")+E.toString(16)}return s}(e)),e},Ie=function(e){return String(e).trim().toLowerCase()},Pe=Ce.OptIn;x.defineGlobalNamespace(),window.adobe.OptInCategories=Pe.Categories;var Le=function(t,i,n){function r(e){var t=e;return function(e){var i=e||b.location.href;try{var n=d._extractParamFromUri(i,t);if(n)return O.parsePipeDelimetedKeyValues(n)}catch(e){}}}function a(e){e=e||{},d._supplementalDataIDCurrent=e.supplementalDataIDCurrent||"",d._supplementalDataIDCurrentConsumed=e.supplementalDataIDCurrentConsumed||{},d._supplementalDataIDLast=e.supplementalDataIDLast||"",d._supplementalDataIDLastConsumed=e.supplementalDataIDLastConsumed||{}}function o(e){return function(e){return(e=e?e+="|":e)+"TS="+O.getTimestampInSeconds()}(e.reduce((function(e,t){var i=t[0],n=t[1];return null!=n&&n!==P&&(e=function(e,t,i){return(i=i?i+="|":i)+(e+"=")+encodeURIComponent(t)}(i,n,e)),e}),""))}function s(){return d.configs.isIabContext?p.optIn.isApproved(p.optIn.Categories.ECID)&&g:p.optIn.isApproved(p.optIn.Categories.ECID)}function l(e,t){if(g=!0,e)throw new Error("[IAB plugin] : "+e);t.gdprApplies&&(f=t.consentString),d.init(),h()}function c(){p.optIn.isApproved(p.optIn.Categories.ECID)&&(d.configs.isIabContext?p.optIn.execute({command:"iabPlugin.fetchConsentData",callback:l}):(d.init(),h()))}function h(){p.optIn.off("complete",c)}if(!n||n.split("").reverse().join("")!==t)throw new Error("Please use `Visitor.getInstance` to instantiate Visitor.");var d=this,p=window.adobe,f="",g=!1,_=!1;d.version="4.4.0";var b=u,S=b.Visitor;S.version=d.version,S.AuthState=v,S.OptOut=y,b.s_c_in||(b.s_c_il=[],b.s_c_in=0),d._c="Visitor",d._il=b.s_c_il,d._in=b.s_c_in,d._il[d._in]=d,b.s_c_in++,d._instanceType="regular",d._log={requests:[]},d.marketingCloudOrgID=t,d.cookieName="AMCV_"+t,d.sessionCookieName="AMCVS_"+t,d.cookieDomain=H(),d.loadSSL=b.location.protocol.toLowerCase().indexOf("https")>=0,d.loadTimeout=3e4,d.CORSErrors=[],d.marketingCloudServer=d.audienceManagerServer="dpm.demdex.net",d.sdidParamExpiry=30;var E=null,w="MCMID",T="MCIDTS",M="A",A="MCAID",C="AAM",I="MCAAMB",P="NONE",L=function(e){return!Object.prototype[e]},R=q(d);d.FIELDS=m,d.cookieRead=function(e){return U.get(e)},d.cookieWrite=function(e,t,i){var n=d.cookieLifetime?(""+d.cookieLifetime).toUpperCase():"",r=!1;return d.configs&&d.configs.secureCookie&&"https:"===location.protocol&&(r=!0),U.set(e,""+t,{expires:i,domain:d.cookieDomain,cookieLifetime:n,secure:r})},d.resetState=function(e){e?d._mergeServerState(e):a()},d._isAllowedDone=!1,d._isAllowedFlag=!1,d.isAllowed=function(){return d._isAllowedDone||(d._isAllowedDone=!0,(d.cookieRead(d.cookieName)||d.cookieWrite(d.cookieName,"T",1))&&(d._isAllowedFlag=!0)),"T"===d.cookieRead(d.cookieName)&&d._helpers.removeCookie(d.cookieName),d._isAllowedFlag},d.setMarketingCloudVisitorID=function(e){d._setMarketingCloudFields(e)},d._use1stPartyMarketingCloudServer=!1,d.getMarketingCloudVisitorID=function(e,t){d.marketingCloudServer&&d.marketingCloudServer.indexOf(".demdex.net")<0&&(d._use1stPartyMarketingCloudServer=!0);var i=d._getAudienceManagerURLData("_setMarketingCloudFields"),n=i.url;return d._getRemoteField(w,n,e,t,i)},d.getVisitorValues=function(e,t){var i={MCMID:{fn:d.getMarketingCloudVisitorID,args:[!0],context:d},MCOPTOUT:{fn:d.isOptedOut,args:[void 0,!0],context:d},MCAID:{fn:d.getAnalyticsVisitorID,args:[!0],context:d},MCAAMLH:{fn:d.getAudienceManagerLocationHint,args:[!0],context:d},MCAAMB:{fn:d.getAudienceManagerBlob,args:[!0],context:d}};!function(e,t){function i(e){return function(i){n[e]=i,++r===a&&t(n)}}var n={},r=0,a=Object.keys(e).length;Object.keys(e).forEach((function(t){var n=e[t];if(n.fn){var r=n.args||[];r.unshift(i(t)),n.fn.apply(n.context||null,r)}}))}(t&&t.length?x.pluck(i,t):i,e)},d._currentCustomerIDs={},d._customerIDsHashChanged=!1,d._newCustomerIDsHash="",d.setCustomerIDs=function(t,i){if(!d.isOptedOut()&&t){if(!x.isObject(t)||x.isObjectEmpty(t))return!1;var n,r,a;for(n in d._readVisitor(),t)if(L(n)&&(i=(r=t[n]).hasOwnProperty("hashType")?r.hashType:i,r))if("object"===e(r)){var o={};if(r.id){if(i){if(!(a=xe(Ie(r.id),i)))return;r.id=a,o.hashType=i}o.id=r.id}null!=r.authState&&(o.authState=r.authState),d._currentCustomerIDs[n]=o}else if(i){if(!(a=xe(Ie(r),i)))return;d._currentCustomerIDs[n]={id:a,hashType:i}}else d._currentCustomerIDs[n]={id:r};var s=d.getCustomerIDs(),l=d._getField("MCCIDH"),c="";for(n in l||(l=0),s)L(n)&&(c+=(c?"|":"")+n+"|"+((r=s[n]).id?r.id:"")+(r.authState?r.authState:""));d._newCustomerIDsHash=String(d._hash(c)),d._newCustomerIDsHash!==l&&(d._customerIDsHashChanged=!0,d._mapCustomerIDs((function(){d._customerIDsHashChanged=!1})))}},d.getCustomerIDs=function(){d._readVisitor();var e,t,i={};for(e in d._currentCustomerIDs)L(e)&&(t=d._currentCustomerIDs[e],i[e]||(i[e]={}),t.id&&(i[e].id=t.id),null!=t.authState?i[e].authState=t.authState:i[e].authState=S.AuthState.UNKNOWN,t.hashType&&(i[e].hashType=t.hashType));return i},d.setAnalyticsVisitorID=function(e){d._setAnalyticsFields(e)},d.getAnalyticsVisitorID=function(e,t,i){if(!O.isTrackingServerPopulated()&&!i)return d._callCallback(e,[""]),"";var n="";if(i||(n=d.getMarketingCloudVisitorID((function(t){d.getAnalyticsVisitorID(e,!0)}))),n||i){var r=i?d.marketingCloudServer:d.trackingServer,a="";d.loadSSL&&(i?d.marketingCloudServerSecure&&(r=d.marketingCloudServerSecure):d.trackingServerSecure&&(r=d.trackingServerSecure));var o={};if(r){var s="http"+(d.loadSSL?"s":"")+"://"+r+"/id",l="d_visid_ver="+d.version+"&mcorgid="+encodeURIComponent(d.marketingCloudOrgID)+(n?"&mid="+encodeURIComponent(n):"")+(d.idSyncDisable3rdPartySyncing||d.disableThirdPartyCookies?"&d_coppa=true":""),c=["s_c_il",d._in,"_set"+(i?"MarketingCloud":"Analytics")+"Fields"];a=s+"?"+l+"&callback=s_c_il%5B"+d._in+"%5D._set"+(i?"MarketingCloud":"Analytics")+"Fields",o.corsUrl=s+"?"+l,o.callback=c}return o.url=a,d._getRemoteField(i?w:A,a,e,t,o)}return""},d.getAudienceManagerLocationHint=function(e,t){if(d.getMarketingCloudVisitorID((function(t){d.getAudienceManagerLocationHint(e,!0)}))){var i=d._getField(A);if(!i&&O.isTrackingServerPopulated()&&(i=d.getAnalyticsVisitorID((function(t){d.getAudienceManagerLocationHint(e,!0)}))),i||!O.isTrackingServerPopulated()){var n=d._getAudienceManagerURLData(),r=n.url;return d._getRemoteField("MCAAMLH",r,e,t,n)}}return""},d.getLocationHint=d.getAudienceManagerLocationHint,d.getAudienceManagerBlob=function(e,t){if(d.getMarketingCloudVisitorID((function(t){d.getAudienceManagerBlob(e,!0)}))){var i=d._getField(A);if(!i&&O.isTrackingServerPopulated()&&(i=d.getAnalyticsVisitorID((function(t){d.getAudienceManagerBlob(e,!0)}))),i||!O.isTrackingServerPopulated()){var n=d._getAudienceManagerURLData(),r=n.url;return d._customerIDsHashChanged&&d._setFieldExpire(I,-1),d._getRemoteField(I,r,e,t,n)}}return""},d._supplementalDataIDCurrent="",d._supplementalDataIDCurrentConsumed={},d._supplementalDataIDLast="",d._supplementalDataIDLastConsumed={},d.getSupplementalDataID=function(e,t){d._supplementalDataIDCurrent||t||(d._supplementalDataIDCurrent=d._generateID(1));var i=d._supplementalDataIDCurrent;return d._supplementalDataIDLast&&!d._supplementalDataIDLastConsumed[e]?(i=d._supplementalDataIDLast,d._supplementalDataIDLastConsumed[e]=!0):i&&(d._supplementalDataIDCurrentConsumed[e]&&(d._supplementalDataIDLast=d._supplementalDataIDCurrent,d._supplementalDataIDLastConsumed=d._supplementalDataIDCurrentConsumed,d._supplementalDataIDCurrent=i=t?"":d._generateID(1),d._supplementalDataIDCurrentConsumed={}),i&&(d._supplementalDataIDCurrentConsumed[e]=!0)),i};var k=!1;d._liberatedOptOut=null,d.getOptOut=function(e,t){var i=d._getAudienceManagerURLData("_setMarketingCloudFields"),n=i.url;if(s())return d._getRemoteField("MCOPTOUT",n,e,t,i);if(d._registerCallback("liberatedOptOut",e),null!==d._liberatedOptOut)return d._callAllCallbacks("liberatedOptOut",[d._liberatedOptOut]),k=!1,d._liberatedOptOut;if(k)return null;k=!0;var r="liberatedGetOptOut";return i.corsUrl=i.corsUrl.replace(/dpm\.demdex\.net\/id\?/,"dpm.demdex.net/optOutStatus?"),i.callback=[r],u[r]=function(e){if(e===Object(e)){var t,i,n=x.parseOptOut(e,t,P);t=n.optOut,i=1e3*n.d_ottl,d._liberatedOptOut=t,setTimeout((function(){d._liberatedOptOut=null}),i)}d._callAllCallbacks("liberatedOptOut",[t]),k=!1},R.fireCORS(i),null},d.isOptedOut=function(e,t,i){t||(t=S.OptOut.GLOBAL);var n=d.getOptOut((function(i){var n=i===S.OptOut.GLOBAL||i.indexOf(t)>=0;d._callCallback(e,[n])}),i);return n?n===S.OptOut.GLOBAL||n.indexOf(t)>=0:null},d._fields=null,d._fieldsExpired=null,d._hash=function(e){var t,i=0;if(e)for(t=0;t<e.length;t++)i=(i<<5)-i+e.charCodeAt(t),i&=i;return i},d._generateID=K,d._generateLocalMID=function(){var e=d._generateID(0);return F.isClientSideMarketingCloudVisitorID=!0,e},d._callbackList=null,d._callCallback=function(e,t){try{"function"==typeof e?e.apply(b,t):e[1].apply(e[0],t)}catch(e){}},d._registerCallback=function(e,t){t&&(null==d._callbackList&&(d._callbackList={}),null==d._callbackList[e]&&(d._callbackList[e]=[]),d._callbackList[e].push(t))},d._callAllCallbacks=function(e,t){if(null!=d._callbackList){var i=d._callbackList[e];if(i)for(;i.length>0;)d._callCallback(i.shift(),t)}},d._addQuerystringParam=function(e,t,i,n){var r=encodeURIComponent(t)+"="+encodeURIComponent(i),a=O.parseHash(e),o=O.hashlessUrl(e);if(-1===o.indexOf("?"))return o+"?"+r+a;var s=o.split("?"),l=s[0]+"?",c=s[1];return l+O.addQueryParamAtLocation(c,r,n)+a},d._extractParamFromUri=function(e,t){var i=new RegExp("[\\?&#]"+t+"=([^&#]*)").exec(e);if(i&&i.length)return decodeURIComponent(i[1])},d._parseAdobeMcFromUrl=r(X.ADOBE_MC),d._parseAdobeMcSdidFromUrl=r(X.ADOBE_MC_SDID),d._attemptToPopulateSdidFromUrl=function(e){var i=d._parseAdobeMcSdidFromUrl(e),n=1e9;i&&i.TS&&(n=O.getTimestampInSeconds()-i.TS),i&&i.SDID&&i.MCORGID===t&&n<d.sdidParamExpiry&&(d._supplementalDataIDCurrent=i.SDID,d._supplementalDataIDCurrentConsumed.SDID_URL_PARAM=!0)},d._attemptToPopulateIdsFromUrl=function(){var e=d._parseAdobeMcFromUrl();if(e&&e.TS){var i=O.getTimestampInSeconds()-e.TS;if(Math.floor(i/60)>X.ADOBE_MC_TTL_IN_MIN||e.MCORGID!==t)return;!function(e){function t(e,t,i){e&&e.match(X.VALID_VISITOR_ID_REGEX)&&(i===w&&(_=!0),t(e))}t(e[w],d.setMarketingCloudVisitorID,w),d._setFieldExpire(I,-1),t(e[A],d.setAnalyticsVisitorID)}(e)}},d._mergeServerState=function(e){if(e)try{if((e=function(e){return O.isObject(e)?e:JSON.parse(e)}(e))[d.marketingCloudOrgID]){var t=e[d.marketingCloudOrgID];!function(e){O.isObject(e)&&d.setCustomerIDs(e)}(t.customerIDs),a(t.sdid)}}catch(e){throw new Error("`serverState` has an invalid format.")}},d._timeout=null,d._loadData=function(e,t,i,n){t=d._addQuerystringParam(t,"d_fieldgroup",e,1),n.url=d._addQuerystringParam(n.url,"d_fieldgroup",e,1),n.corsUrl=d._addQuerystringParam(n.corsUrl,"d_fieldgroup",e,1),F.fieldGroupObj[e]=!0,n===Object(n)&&n.corsUrl&&"XMLHttpRequest"===R.corsMetadata.corsType&&R.fireCORS(n,i,e)},d._clearTimeout=function(e){null!=d._timeout&&d._timeout[e]&&(clearTimeout(d._timeout[e]),d._timeout[e]=0)},d._settingsDigest=0,d._getSettingsDigest=function(){if(!d._settingsDigest){var e=d.version;d.audienceManagerServer&&(e+="|"+d.audienceManagerServer),d.audienceManagerServerSecure&&(e+="|"+d.audienceManagerServerSecure),d._settingsDigest=d._hash(e)}return d._settingsDigest},d._readVisitorDone=!1,d._readVisitor=function(){if(!d._readVisitorDone){d._readVisitorDone=!0;var e,t,i,n,r,a,o=d._getSettingsDigest(),s=!1,l=d.cookieRead(d.cookieName),c=new Date;if(l||_||d.discardTrackingServerECID||(l=d.cookieRead(X.FIRST_PARTY_SERVER_COOKIE)),null==d._fields&&(d._fields={}),l&&"T"!==l)for((l=l.split("|"))[0].match(/^[\-0-9]+$/)&&(parseInt(l[0],10)!==o&&(s=!0),l.shift()),l.length%2==1&&l.pop(),e=0;e<l.length;e+=2)i=(t=l[e].split("-"))[0],n=l[e+1],t.length>1?(r=parseInt(t[1],10),a=t[1].indexOf("s")>0):(r=0,a=!1),s&&("MCCIDH"===i&&(n=""),r>0&&(r=c.getTime()/1e3-60)),i&&n&&(d._setField(i,n,1),r>0&&(d._fields["expire"+i]=r+(a?"s":""),(c.getTime()>=1e3*r||a&&!d.cookieRead(d.sessionCookieName))&&(d._fieldsExpired||(d._fieldsExpired={}),d._fieldsExpired[i]=!0)));!d._getField(A)&&O.isTrackingServerPopulated()&&(l=d.cookieRead("s_vi"))&&((l=l.split("|")).length>1&&l[0].indexOf("v1")>=0&&((e=(n=l[1]).indexOf("["))>=0&&(n=n.substring(0,e)),n&&n.match(X.VALID_VISITOR_ID_REGEX)&&d._setField(A,n)))}},d._appendVersionTo=function(e){var t="vVersion|"+d.version,i=e?d._getCookieVersion(e):null;return i?j(i,d.version)&&(e=e.replace(X.VERSION_REGEX,t)):e+=(e?"|":"")+t,e},d._writeVisitor=function(){var e,t,i=d._getSettingsDigest();for(e in d._fields)L(e)&&d._fields[e]&&"expire"!==e.substring(0,6)&&(t=d._fields[e],i+=(i?"|":"")+e+(d._fields["expire"+e]?"-"+d._fields["expire"+e]:"")+"|"+t);i=d._appendVersionTo(i),d.cookieWrite(d.cookieName,i,1)},d._getField=function(e,t){return null==d._fields||!t&&d._fieldsExpired&&d._fieldsExpired[e]?null:d._fields[e]},d._setField=function(e,t,i){null==d._fields&&(d._fields={}),d._fields[e]=t,i||d._writeVisitor()},d._getFieldList=function(e,t){var i=d._getField(e,t);return i?i.split("*"):null},d._setFieldList=function(e,t,i){d._setField(e,t?t.join("*"):"",i)},d._getFieldMap=function(e,t){var i=d._getFieldList(e,t);if(i){var n,r={};for(n=0;n<i.length;n+=2)r[i[n]]=i[n+1];return r}return null},d._setFieldMap=function(e,t,i){var n,r=null;if(t)for(n in r=[],t)L(n)&&(r.push(n),r.push(t[n]));d._setFieldList(e,r,i)},d._setFieldExpire=function(e,t,i){var n=new Date;n.setTime(n.getTime()+1e3*t),null==d._fields&&(d._fields={}),d._fields["expire"+e]=Math.floor(n.getTime()/1e3)+(i?"s":""),t<0?(d._fieldsExpired||(d._fieldsExpired={}),d._fieldsExpired[e]=!0):d._fieldsExpired&&(d._fieldsExpired[e]=!1),i&&(d.cookieRead(d.sessionCookieName)||d.cookieWrite(d.sessionCookieName,"1"))},d._findVisitorID=function(t){return t&&("object"===e(t)&&(t=t.d_mid?t.d_mid:t.visitorID?t.visitorID:t.id?t.id:t.uuid?t.uuid:""+t),t&&"NOTARGET"===(t=t.toUpperCase())&&(t=P),t&&(t===P||t.match(X.VALID_VISITOR_ID_REGEX))||(t="")),t},d._setFields=function(t,i){if(d._clearTimeout(t),null!=d._loading&&(d._loading[t]=!1),F.fieldGroupObj[t]&&F.setState(t,!1),"MC"===t){!0!==F.isClientSideMarketingCloudVisitorID&&(F.isClientSideMarketingCloudVisitorID=!1);var n=d._getField(w);if(!n||d.overwriteCrossDomainMCIDAndAID){if(!(n="object"===e(i)&&i.mid?i.mid:d._findVisitorID(i))){if(d._use1stPartyMarketingCloudServer&&!d.tried1stPartyMarketingCloudServer)return d.tried1stPartyMarketingCloudServer=!0,void d.getAnalyticsVisitorID(null,!1,!0);n=d._generateLocalMID()}d._setField(w,n)}n&&n!==P||(n=""),"object"===e(i)&&((i.d_region||i.dcs_region||i.d_blob||i.blob)&&d._setFields(C,i),d._use1stPartyMarketingCloudServer&&i.mid&&d._setFields(M,{id:i.id})),d._callAllCallbacks(w,[n])}if(t===C&&"object"===e(i)){var r=604800;null!=i.id_sync_ttl&&i.id_sync_ttl&&(r=parseInt(i.id_sync_ttl,10));var a=N.getRegionAndCheckIfChanged(i,r);d._callAllCallbacks("MCAAMLH",[a]);var o=d._getField(I);(i.d_blob||i.blob)&&((o=i.d_blob)||(o=i.blob),d._setFieldExpire(I,r),d._setField(I,o)),o||(o=""),d._callAllCallbacks(I,[o]),!i.error_msg&&d._newCustomerIDsHash&&d._setField("MCCIDH",d._newCustomerIDsHash)}if(t===M){var l=d._getField(A);l&&!d.overwriteCrossDomainMCIDAndAID||((l=d._findVisitorID(i))?l!==P&&d._setFieldExpire(I,-1):l=P,d._setField(A,l)),l&&l!==P||(l=""),d._callAllCallbacks(A,[l])}if(d.idSyncDisableSyncs||d.disableIdSyncs)N.idCallNotProcesssed=!0;else{N.idCallNotProcesssed=!1;var c={};c.ibs=i.ibs,c.subdomain=i.subdomain,N.processIDCallData(c)}if(i===Object(i)){var u,h;s()&&d.isAllowed()&&(u=d._getField("MCOPTOUT"));var p=x.parseOptOut(i,u,P);u=p.optOut,h=p.d_ottl,d._setFieldExpire("MCOPTOUT",h,!0),d._setField("MCOPTOUT",u),d._callAllCallbacks("MCOPTOUT",[u])}},d._loading=null,d._getRemoteField=function(e,t,i,n,r){var a,o="",l=O.isFirstPartyAnalyticsVisitorIDCall(e);if(s()&&d.isAllowed())if(d._readVisitor(),!(!(o=d._getField(e,!0==={MCAAMLH:!0,MCAAMB:!0}[e]))||d._fieldsExpired&&d._fieldsExpired[e])||d.disableThirdPartyCalls&&!l)o||(e===w?(d._registerCallback(e,i),o=d._generateLocalMID(),d.setMarketingCloudVisitorID(o)):e===A?(d._registerCallback(e,i),o="",d.setAnalyticsVisitorID(o)):(o="",n=!0));else if(e===w||"MCOPTOUT"===e?a="MC":"MCAAMLH"===e||e===I?a=C:e===A&&(a=M),a)return!t||null!=d._loading&&d._loading[a]||(null==d._loading&&(d._loading={}),d._loading[a]=!0,d._loadData(a,t,(function(t){if(!d._getField(e)){t&&F.setState(a,!0);var i="";e===w?i=d._generateLocalMID():a===C&&(i={error_msg:"timeout"}),d._setFields(a,i)}}),r)),d._registerCallback(e,i),o||(t||d._setFields(a,{id:P}),"");return e!==w&&e!==A||o!==P||(o="",n=!0),i&&n&&d._callCallback(i,[o]),o},d._setMarketingCloudFields=function(e){d._readVisitor(),d._setFields("MC",e)},d._mapCustomerIDs=function(e){d.getAudienceManagerBlob(e,!0)},d._setAnalyticsFields=function(e){d._readVisitor(),d._setFields(M,e)},d._setAudienceManagerFields=function(e){d._readVisitor(),d._setFields(C,e)},d._getAudienceManagerURLData=function(e){var t=d.audienceManagerServer,i="",n=d._getField(w),r=d._getField(I,!0),a=d._getField(A),o=a&&a!==P?"&d_cid_ic=AVID%01"+encodeURIComponent(a):"";if(d.loadSSL&&d.audienceManagerServerSecure&&(t=d.audienceManagerServerSecure),t){var s,l,c=d.getCustomerIDs();if(c)for(s in c)L(s)&&(l=c[s],o+="&d_cid_ic="+encodeURIComponent(s)+"%01"+encodeURIComponent(l.id?l.id:"")+(l.authState?"%01"+l.authState:""));e||(e="_setAudienceManagerFields");var u="http"+(d.loadSSL?"s":"")+"://"+t+"/id",h="d_visid_ver="+d.version+(f&&-1!==u.indexOf("demdex.net")?"&gdpr=1&gdpr_force=1&gdpr_consent="+f:"")+"&d_rtbd=json&d_ver=2"+(!n&&d._use1stPartyMarketingCloudServer?"&d_verify=1":"")+"&d_orgid="+encodeURIComponent(d.marketingCloudOrgID)+"&d_nsid="+(d.idSyncContainerID||0)+(n?"&d_mid="+encodeURIComponent(n):"")+(d.idSyncDisable3rdPartySyncing||d.disableThirdPartyCookies?"&d_coppa=true":"")+(!0===E?"&d_coop_safe=1":!1===E?"&d_coop_unsafe=1":"")+(r?"&d_blob="+encodeURIComponent(r):"")+o,p=["s_c_il",d._in,e];return{url:i=u+"?"+h+"&d_cb=s_c_il%5B"+d._in+"%5D."+e,corsUrl:u+"?"+h,callback:p}}return{url:i}},d.appendVisitorIDsTo=function(e){try{var t=[[w,d._getField(w)],[A,d._getField(A)],["MCORGID",d.marketingCloudOrgID]];return d._addQuerystringParam(e,X.ADOBE_MC,o(t))}catch(t){return e}},d.appendSupplementalDataIDTo=function(e,t){if(!(t=t||d.getSupplementalDataID(O.generateRandomString(),!0)))return e;try{var i=o([["SDID",t],["MCORGID",d.marketingCloudOrgID]]);return d._addQuerystringParam(e,X.ADOBE_MC_SDID,i)}catch(t){return e}};var O={parseHash:function(e){var t=e.indexOf("#");return t>0?e.substr(t):""},hashlessUrl:function(e){var t=e.indexOf("#");return t>0?e.substr(0,t):e},addQueryParamAtLocation:function(e,t,i){var n=e.split("&");return i=null!=i?i:n.length,n.splice(i,0,t),n.join("&")},isFirstPartyAnalyticsVisitorIDCall:function(e,t,i){return e===A&&(t||(t=d.trackingServer),i||(i=d.trackingServerSecure),!("string"!=typeof(n=d.loadSSL?i:t)||!n.length)&&n.indexOf("2o7.net")<0&&n.indexOf("omtrdc.net")<0);var n},isObject:function(e){return Boolean(e&&e===Object(e))},removeCookie:function(e){U.remove(e,{domain:d.cookieDomain})},isTrackingServerPopulated:function(){return!!d.trackingServer||!!d.trackingServerSecure},getTimestampInSeconds:function(){return Math.round((new Date).getTime()/1e3)},parsePipeDelimetedKeyValues:function(e){return e.split("|").reduce((function(e,t){var i=t.split("=");return e[i[0]]=decodeURIComponent(i[1]),e}),{})},generateRandomString:function(e){e=e||5;for(var t="",i="abcdefghijklmnopqrstuvwxyz0123456789";e--;)t+=i[Math.floor(Math.random()*i.length)];return t},normalizeBoolean:function(e){return"true"===e||"false"!==e&&e},parseBoolean:function(e){return"true"===e||"false"!==e&&null},replaceMethodsWithFunction:function(e,t){for(var i in e)e.hasOwnProperty(i)&&"function"==typeof e[i]&&(e[i]=t);return e}};d._helpers=O;var N=function(e,t){var i=u.document;return{THROTTLE_START:3e4,MAX_SYNCS_LENGTH:649,throttleTimerSet:!1,id:null,onPagePixels:[],iframeHost:null,getIframeHost:function(e){if("string"==typeof e){var t=e.split("/");return t[0]+"//"+t[2]}},subdomain:null,url:null,getUrl:function(){var t,n="http://fast.",r="?d_nsid="+e.idSyncContainerID+"#"+encodeURIComponent(i.location.origin);return this.subdomain||(this.subdomain="nosubdomainreturned"),e.loadSSL&&(n=e.idSyncSSLUseAkamai?"https://fast.":"https://"),t=n+this.subdomain+".demdex.net/dest5.html"+r,this.iframeHost=this.getIframeHost(t),this.id="destination_publishing_iframe_"+this.subdomain+"_"+e.idSyncContainerID,t},checkDPIframeSrc:function(){var t="?d_nsid="+e.idSyncContainerID+"#"+encodeURIComponent(i.location.href);"string"==typeof e.dpIframeSrc&&e.dpIframeSrc.length&&(this.id="destination_publishing_iframe_"+(e._subdomain||this.subdomain||(new Date).getTime())+"_"+e.idSyncContainerID,this.iframeHost=this.getIframeHost(e.dpIframeSrc),this.url=e.dpIframeSrc+t)},idCallNotProcesssed:null,doAttachIframe:!1,startedAttachingIframe:!1,iframeHasLoaded:null,iframeIdChanged:null,newIframeCreated:null,originalIframeHasLoadedAlready:null,iframeLoadedCallbacks:[],regionChanged:!1,timesRegionChanged:0,sendingMessages:!1,messages:[],messagesPosted:[],messagesReceived:[],messageSendingInterval:X.POST_MESSAGE_ENABLED?null:100,onPageDestinationsFired:[],jsonForComparison:[],jsonDuplicates:[],jsonWaiting:[],jsonProcessed:[],canSetThirdPartyCookies:!0,receivedThirdPartyCookiesNotification:!1,readyToAttachIframePreliminary:function(){return!(e.idSyncDisableSyncs||e.disableIdSyncs||e.idSyncDisable3rdPartySyncing||e.disableThirdPartyCookies||e.disableThirdPartyCalls)},readyToAttachIframe:function(){return this.readyToAttachIframePreliminary()&&(this.doAttachIframe||e._doAttachIframe)&&(this.subdomain&&"nosubdomainreturned"!==this.subdomain||e._subdomain)&&this.url&&!this.startedAttachingIframe},attachIframe:function(){function e(){(r=i.createElement("iframe")).sandbox="allow-scripts allow-same-origin",r.title="Adobe ID Syncing iFrame",r.id=n.id,r.name=n.id+"_name",r.style.cssText="display: none; width: 0; height: 0;",r.src=n.url,n.newIframeCreated=!0,t(),i.body.appendChild(r)}function t(e){r.addEventListener("load",(function(){r.className="aamIframeLoaded",n.iframeHasLoaded=!0,n.fireIframeLoadedCallbacks(e),n.requestToProcess()}))}this.startedAttachingIframe=!0;var n=this,r=i.getElementById(this.id);r?"IFRAME"!==r.nodeName?(this.id+="_2",this.iframeIdChanged=!0,e()):(this.newIframeCreated=!1,"aamIframeLoaded"!==r.className?(this.originalIframeHasLoadedAlready=!1,t("The destination publishing iframe already exists from a different library, but hadn't loaded yet.")):(this.originalIframeHasLoadedAlready=!0,this.iframeHasLoaded=!0,this.iframe=r,this.fireIframeLoadedCallbacks("The destination publishing iframe already exists from a different library, and had loaded alresady."),this.requestToProcess())):e(),this.iframe=r},fireIframeLoadedCallbacks:function(e){this.iframeLoadedCallbacks.forEach((function(t){"function"==typeof t&&t({message:e||"The destination publishing iframe was attached and loaded successfully."})})),this.iframeLoadedCallbacks=[]},requestToProcess:function(t){function i(){r.jsonForComparison.push(t),r.jsonWaiting.push(t),r.processSyncOnPage(t)}var n,r=this;if(t===Object(t)&&t.ibs)if(n=JSON.stringify(t.ibs||[]),this.jsonForComparison.length){var a,o,s,l=!1;for(a=0,o=this.jsonForComparison.length;a<o;a++)if(s=this.jsonForComparison[a],n===JSON.stringify(s.ibs||[])){l=!0;break}l?this.jsonDuplicates.push(t):i()}else i();if((this.receivedThirdPartyCookiesNotification||!X.POST_MESSAGE_ENABLED||this.iframeHasLoaded)&&this.jsonWaiting.length){var c=this.jsonWaiting.shift();this.process(c),this.requestToProcess()}e.idSyncDisableSyncs||e.disableIdSyncs||!this.iframeHasLoaded||!this.messages.length||this.sendingMessages||(this.throttleTimerSet||(this.throttleTimerSet=!0,setTimeout((function(){r.messageSendingInterval=X.POST_MESSAGE_ENABLED?null:150}),this.THROTTLE_START)),this.sendingMessages=!0,this.sendMessages())},getRegionAndCheckIfChanged:function(t,i){var n=e._getField("MCAAMLH"),r=t.d_region||t.dcs_region;return n?r&&(e._setFieldExpire("MCAAMLH",i),e._setField("MCAAMLH",r),parseInt(n,10)!==r&&(this.regionChanged=!0,this.timesRegionChanged++,e._setField("MCSYNCSOP",""),e._setField("MCSYNCS",""),n=r)):(n=r)&&(e._setFieldExpire("MCAAMLH",i),e._setField("MCAAMLH",n)),n||(n=""),n},processSyncOnPage:function(e){var t,i,n,r;if((t=e.ibs)&&t instanceof Array&&(i=t.length))for(n=0;n<i;n++)(r=t[n]).syncOnPage&&this.checkFirstPartyCookie(r,"","syncOnPage")},process:function(e){var t,i,n,r,a,o=encodeURIComponent,s=!1;if((t=e.ibs)&&t instanceof Array&&(i=t.length))for(s=!0,n=0;n<i;n++)r=t[n],a=[o("ibs"),o(r.id||""),o(r.tag||""),x.encodeAndBuildRequest(r.url||[],","),o(r.ttl||""),"","",r.fireURLSync?"true":"false"],r.syncOnPage||(this.canSetThirdPartyCookies?this.addMessage(a.join("|")):r.fireURLSync&&this.checkFirstPartyCookie(r,a.join("|")));s&&this.jsonProcessed.push(e)},checkFirstPartyCookie:function(t,i,n){var r="syncOnPage"===n,a=r?"MCSYNCSOP":"MCSYNCS";e._readVisitor();var o,s,l=e._getField(a),c=!1,u=!1,h=Math.ceil((new Date).getTime()/X.MILLIS_PER_DAY);l?(o=l.split("*"),c=(s=this.pruneSyncData(o,t.id,h)).dataPresent,u=s.dataValid,c&&u||this.fireSync(r,t,i,o,a,h)):(o=[],this.fireSync(r,t,i,o,a,h))},pruneSyncData:function(e,t,i){var n,r,a,o=!1,s=!1;for(r=0;r<e.length;r++)n=e[r],a=parseInt(n.split("-")[1],10),n.match("^"+t+"-")?(o=!0,i<a?s=!0:(e.splice(r,1),r--)):i>=a&&(e.splice(r,1),r--);return{dataPresent:o,dataValid:s}},manageSyncsSize:function(e){if(e.join("*").length>this.MAX_SYNCS_LENGTH)for(e.sort((function(e,t){return parseInt(e.split("-")[1],10)-parseInt(t.split("-")[1],10)}));e.join("*").length>this.MAX_SYNCS_LENGTH;)e.shift()},fireSync:function(t,i,n,r,a,o){var s=this;if(t){if("img"===i.tag){var l,c,u,h,d=i.url,p=e.loadSSL?"https:":"http:";for(l=0,c=d.length;l<c;l++){u=d[l],h=/^\/\//.test(u);var f=new Image;f.addEventListener("load",function(t,i,n,r){return function(){s.onPagePixels[t]=null,e._readVisitor();var o,l,c,u,h=e._getField(a),d=[];if(h)for(l=0,c=(o=h.split("*")).length;l<c;l++)(u=o[l]).match("^"+i.id+"-")||d.push(u);s.setSyncTrackingData(d,i,n,r)}}(this.onPagePixels.length,i,a,o)),f.src=(h?p:"")+u,this.onPagePixels.push(f)}}}else this.addMessage(n),this.setSyncTrackingData(r,i,a,o)},addMessage:function(t){var i=encodeURIComponent(e._enableErrorReporting?"---destpub-debug---":"---destpub---");this.messages.push((X.POST_MESSAGE_ENABLED?"":i)+t)},setSyncTrackingData:function(t,i,n,r){t.push(i.id+"-"+(r+Math.ceil(i.ttl/60/24))),this.manageSyncsSize(t),e._setField(n,t.join("*"))},sendMessages:function(){var e,t=this,i="",n=encodeURIComponent;this.regionChanged&&(i=n("---destpub-clear-dextp---"),this.regionChanged=!1),this.messages.length?X.POST_MESSAGE_ENABLED?(e=i+n("---destpub-combined---")+this.messages.join("%01"),this.postMessage(e),this.messages=[],this.sendingMessages=!1):(e=this.messages.shift(),this.postMessage(i+e),setTimeout((function(){t.sendMessages()}),this.messageSendingInterval)):this.sendingMessages=!1},postMessage:function(e){W(e,this.url,this.iframe.contentWindow),this.messagesPosted.push(e)},receiveMessage:function(e){var t,i=/^---destpub-to-parent---/;"string"==typeof e&&i.test(e)&&("canSetThirdPartyCookies"===(t=e.replace(i,"").split("|"))[0]&&(this.canSetThirdPartyCookies="true"===t[1],this.receivedThirdPartyCookiesNotification=!0,this.requestToProcess()),this.messagesReceived.push(e))},processIDCallData:function(n){(null==this.url||n.subdomain&&"nosubdomainreturned"===this.subdomain)&&("string"==typeof e._subdomain&&e._subdomain.length?this.subdomain=e._subdomain:this.subdomain=n.subdomain||"",this.url=this.getUrl()),n.ibs instanceof Array&&n.ibs.length&&(this.doAttachIframe=!0),this.readyToAttachIframe()&&(e.idSyncAttachIframeOnWindowLoad?(t.windowLoaded||"complete"===i.readyState||"loaded"===i.readyState)&&this.attachIframe():this.attachIframeASAP()),"function"==typeof e.idSyncIDCallResult?e.idSyncIDCallResult(n):this.requestToProcess(n),"function"==typeof e.idSyncAfterIDCallResult&&e.idSyncAfterIDCallResult(n)},canMakeSyncIDCall:function(t,i){return e._forceSyncIDCall||!t||i-t>X.DAYS_BETWEEN_SYNC_ID_CALLS},attachIframeASAP:function(){var e=this;!function t(){e.startedAttachingIframe||(i.body?e.attachIframe():setTimeout(t,30))}()}}}(d,S);d._destinationPublishing=N,d.timeoutMetricsLog=[];var F={isClientSideMarketingCloudVisitorID:null,MCIDCallTimedOut:null,AnalyticsIDCallTimedOut:null,AAMIDCallTimedOut:null,fieldGroupObj:{},setState:function(e,t){switch(e){case"MC":!1===t?!0!==this.MCIDCallTimedOut&&(this.MCIDCallTimedOut=!1):this.MCIDCallTimedOut=t;break;case M:!1===t?!0!==this.AnalyticsIDCallTimedOut&&(this.AnalyticsIDCallTimedOut=!1):this.AnalyticsIDCallTimedOut=t;break;case C:!1===t?!0!==this.AAMIDCallTimedOut&&(this.AAMIDCallTimedOut=!1):this.AAMIDCallTimedOut=t}}};d.isClientSideMarketingCloudVisitorID=function(){return F.isClientSideMarketingCloudVisitorID},d.MCIDCallTimedOut=function(){return F.MCIDCallTimedOut},d.AnalyticsIDCallTimedOut=function(){return F.AnalyticsIDCallTimedOut},d.AAMIDCallTimedOut=function(){return F.AAMIDCallTimedOut},d.idSyncGetOnPageSyncInfo=function(){return d._readVisitor(),d._getField("MCSYNCSOP")},d.idSyncByURL=function(e){if(!d.isOptedOut()){var t=function(e){var t=e.minutesToLive,i="";return(d.idSyncDisableSyncs||d.disableIdSyncs)&&(i=i||"Error: id syncs have been disabled"),"string"==typeof e.dpid&&e.dpid.length||(i=i||"Error: config.dpid is empty"),"string"==typeof e.url&&e.url.length||(i=i||"Error: config.url is empty"),void 0===t?t=20160:(t=parseInt(t,10),(isNaN(t)||t<=0)&&(i=i||"Error: config.minutesToLive needs to be a positive number")),{error:i,ttl:t}}(e||{});if(t.error)return t.error;var i,n,r=e.url,a=encodeURIComponent,o=N;return r=r.replace(/^https:/,"").replace(/^http:/,""),i=x.encodeAndBuildRequest(["",e.dpid,e.dpuuid||""],","),n=["ibs",a(e.dpid),"img",a(r),t.ttl,"",i],o.addMessage(n.join("|")),o.requestToProcess(),"Successfully queued"}},d.idSyncByDataSource=function(e){if(!d.isOptedOut())return e===Object(e)&&"string"==typeof e.dpuuid&&e.dpuuid.length?(e.url="//dpm.demdex.net/ibs:dpid="+e.dpid+"&dpuuid="+e.dpuuid,d.idSyncByURL(e)):"Error: config or config.dpuuid is empty"},function(e,t){e.publishDestinations=function(i){var n=arguments[1],r=arguments[2];try{r="function"==typeof r?r:i.callback}catch(e){r=function(){}}var a=t;if(a.readyToAttachIframePreliminary()){if("string"==typeof i){if(!i.length)return void r({error:"subdomain is not a populated string."});if(!(n instanceof Array&&n.length))return void r({error:"messages is not a populated array."});var o=!1;if(n.forEach((function(e){"string"==typeof e&&e.length&&(a.addMessage(e),o=!0)})),!o)return void r({error:"None of the messages are populated strings."})}else{if(!x.isObject(i))return void r({error:"Invalid parameters passed."});var s=i;if("string"!=typeof(i=s.subdomain)||!i.length)return void r({error:"config.subdomain is not a populated string."});var l=s.urlDestinations;if(!(l instanceof Array&&l.length))return void r({error:"config.urlDestinations is not a populated array."});var c=[];l.forEach((function(e){x.isObject(e)&&(e.hideReferrer?e.message&&a.addMessage(e.message):c.push(e))})),function e(){c.length&&setTimeout((function(){var t=new Image,i=c.shift();t.src=i.url,a.onPageDestinationsFired.push(i),e()}),100)}()}a.iframe?(r({message:"The destination publishing iframe is already attached and loaded."}),a.requestToProcess()):!e.subdomain&&e._getField("MCMID")?(a.subdomain=i,a.doAttachIframe=!0,a.url=a.getUrl(),a.readyToAttachIframe()?(a.iframeLoadedCallbacks.push((function(e){r({message:"Attempted to attach and load the destination publishing iframe through this API call. Result: "+(e.message||"no result")})})),a.attachIframe()):r({error:"Encountered a problem in attempting to attach and load the destination publishing iframe through this API call."})):a.iframeLoadedCallbacks.push((function(e){r({message:"Attempted to attach and load the destination publishing iframe through normal Visitor API processing. Result: "+(e.message||"no result")})}))}else r({error:"The destination publishing iframe is disabled in the Visitor library."})}}(d,N),d._getCookieVersion=function(e){e=e||d.cookieRead(d.cookieName);var t=X.VERSION_REGEX.exec(e);return t&&t.length>1?t[1]:null},d._resetAmcvCookie=function(e){var t=d._getCookieVersion();t&&!G(t,e)||O.removeCookie(d.cookieName)},d.setAsCoopSafe=function(){E=!0},d.setAsCoopUnsafe=function(){E=!1},function(){if(d.configs=Object.create(null),O.isObject(i))for(var e in i)L(e)&&(d[e]=i[e],d.configs[e]=i[e])}(),[["getMarketingCloudVisitorID"],["setCustomerIDs",void 0],["getAnalyticsVisitorID"],["getAudienceManagerLocationHint"],["getLocationHint"],["getAudienceManagerBlob"]].forEach((function(e){var t=e[0],i=2===e.length?e[1]:"",n=d[t];d[t]=function(e){return s()&&d.isAllowed()?n.apply(d,arguments):("function"==typeof e&&d._callCallback(e,[i]),i)}})),d.init=function(){if(!(!d.configs.doesOptInApply||p.optIn.isComplete&&s()))return p.optIn.fetchPermissions(c,!0);!function(){if(O.isObject(i)){d.idSyncContainerID=d.idSyncContainerID||0,E="boolean"==typeof d.isCoopSafe?d.isCoopSafe:O.parseBoolean(d.isCoopSafe),d.resetBeforeVersion&&d._resetAmcvCookie(d.resetBeforeVersion),d._attemptToPopulateIdsFromUrl(),d._attemptToPopulateSdidFromUrl(),d._readVisitor();var e=d._getField(T),t=Math.ceil((new Date).getTime()/X.MILLIS_PER_DAY);d.idSyncDisableSyncs||d.disableIdSyncs||!N.canMakeSyncIDCall(e,t)||(d._setFieldExpire(I,-1),d._setField(T,t)),d.getMarketingCloudVisitorID(),d.getAudienceManagerLocationHint(),d.getAudienceManagerBlob(),d._mergeServerState(d.serverState)}else d._attemptToPopulateIdsFromUrl(),d._attemptToPopulateSdidFromUrl()}(),function(){if(!d.idSyncDisableSyncs&&!d.disableIdSyncs){N.checkDPIframeSrc();b.addEventListener("load",(function(){S.windowLoaded=!0,function(){var e=N;e.readyToAttachIframe()&&e.attachIframe()}()}));try{Y((function(e){N.receiveMessage(e.data)}),N.iframeHost)}catch(e){}}}(),d.whitelistIframeDomains&&X.POST_MESSAGE_ENABLED&&(d.whitelistIframeDomains=d.whitelistIframeDomains instanceof Array?d.whitelistIframeDomains:[d.whitelistIframeDomains],d.whitelistIframeDomains.forEach((function(e){var i=new D(t,e),n=B(d,i);Y(n,e)})))}};Le.config=Z,u.Visitor=Le;var De=Le,Re=Ce.OptIn,ke=Ce.IabPlugin;De.getInstance=function(e,t){if(!e)throw new Error("Visitor requires Adobe Marketing Cloud Org ID.");e.indexOf("@")<0&&(e+="@AdobeOrg");var i=function(){var t=u.s_c_il;if(t)for(var i=0;i<t.length;i++){var n=t[i];if(n&&"Visitor"===n._c&&n.marketingCloudOrgID===e)return n}}();if(i)return i;var n=function(e){if(x.isObject(e))return Object.keys(e).filter((function(t){return""!==e[t]})).reduce((function(t,i){var n="doesOptInApply"!==i?e[i]:Z.normalizeConfig(e[i]),r=x.normalizeBoolean(n);return t[i]=r,t}),Object.create(null))}(t);!function(e){u.adobe.optIn=u.adobe.optIn||function(){var t=x.pluck(e,["doesOptInApply","previousPermissions","preOptInApprovals","isOptInStorageEnabled","optInStorageExpiry","isIabContext"]),i=e.optInCookieDomain||e.cookieDomain;i=(i=i||H())===window.location.hostname?"":i,t.optInCookieDomain=i;var n=new Re(t,{cookies:U});if(t.isIabContext){var r=new ke(window.__cmp);n.registerPlugin(r)}return n}()}(n||{});var r=e.split("").reverse().join(""),a=new De(e,null,r);x.isObject(n)&&n.cookieDomain&&(a.cookieDomain=n.cookieDomain),u.s_c_il.splice(--u.s_c_in,1);var o=x.getIeVersion();if("number"==typeof o&&o<10)return a._helpers.replaceMethodsWithFunction(a,(function(){}));var s=function(){try{return u.self!==u.parent}catch(e){return!0}}()&&!function(e){return e.cookieWrite("TEST_AMCV_COOKIE","T",1),"T"===e.cookieRead("TEST_AMCV_COOKIE")&&(e._helpers.removeCookie("TEST_AMCV_COOKIE"),!0)}(a)&&u.parent?new k(e,n,a,u.parent):new De(e,n,r);return a=null,s.init(),s},function(){function e(){De.windowLoaded=!0}u.addEventListener?u.addEventListener("load",e):u.attachEvent&&u.attachEvent("onload",e),De.codeLoadEnd=(new Date).getTime()}()}();function i(e){var t=this;t.version="2.17.0";var i=window;i.s_c_in||(i.s_c_il=[],i.s_c_in=0),t._il=i.s_c_il,t._in=i.s_c_in,t._il[t._in]=t,i.s_c_in++,t._c="s_c";var n=i.AppMeasurement.ec;n||(n=null);var r,a,o,s=i;try{for(r=s.parent,a=s.location;r&&r.location&&a&&""+r.location!=""+a&&s.location&&""+r.location!=""+s.location&&r.location.host==a.host;)r=(s=r).parent}catch(e){}t.C=function(e){try{console.log(e)}catch(e){}},t.Pa=function(e){return""+parseInt(e)==""+e},t.replace=function(e,t,i){return!e||0>e.indexOf(t)?e:e.split(t).join(i)},t.escape=function(e){var i,n;if(!e)return e;for(e=encodeURIComponent(e),i=0;7>i;i++)n="+~!*()'".substring(i,i+1),0<=e.indexOf(n)&&(e=t.replace(e,n,"%"+n.charCodeAt(0).toString(16).toUpperCase()));return e},t.unescape=function(e){if(!e)return e;e=0<=e.indexOf("+")?t.replace(e,"+"," "):e;try{return decodeURIComponent(e)}catch(e){}return unescape(e)},t.Kb=function(){var e,n=i.location.hostname,r=t.fpCookieDomainPeriods;if(r||(r=t.cookieDomainPeriods),n&&!t.Ia&&!/^[0-9.]+$/.test(n)&&(r=2<(r=r?parseInt(r):2)?r:2,0<=(e=n.lastIndexOf(".")))){for(;0<=e&&1<r;)e=n.lastIndexOf(".",e-1),r--;t.Ia=0<e?n.substring(e):n}return t.Ia},t.c_r=t.cookieRead=function(e){e=t.escape(e);var i=" "+t.d.cookie,n=i.indexOf(" "+e+"="),r=0>n?n:i.indexOf(";",n);return"[[B]]"!=(e=0>n?"":t.unescape(i.substring(n+2+e.length,0>r?i.length:r)))?e:""},t.c_w=t.cookieWrite=function(e,i,n){var r,a=t.Kb(),o=t.cookieLifetime;return i=""+i,o=o?(""+o).toUpperCase():"",n&&"SESSION"!=o&&"NONE"!=o&&((r=""!=i?parseInt(o||0):-60)?(n=new Date).setTime(n.getTime()+1e3*r):1===n&&(r=(n=new Date).getYear(),n.setYear(r+2+(1900>r?1900:0)))),e&&"NONE"!=o?(t.d.cookie=t.escape(e)+"="+t.escape(""!=i?i:"[[B]]")+"; path=/;"+(n&&"SESSION"!=o?" expires="+n.toUTCString()+";":"")+(a?" domain="+a+";":""),t.cookieRead(e)==i):0},t.Hb=function(){var e=t.Util.getIeVersion();"number"==typeof e&&10>e&&(t.unsupportedBrowser=!0,t.ub(t,(function(){})))},t.ub=function(e,t){for(var i in e)e.hasOwnProperty(i)&&"function"==typeof e[i]&&(e[i]=t)},t.K=[],t.ea=function(e,i,n){if(t.Ja)return 0;t.maxDelay||(t.maxDelay=250);var r=0,a=(new Date).getTime()+t.maxDelay,o=t.d.visibilityState,s=["webkitvisibilitychange","visibilitychange"];if(o||(o=t.d.webkitVisibilityState),o&&"prerender"==o){if(!t.fa)for(t.fa=1,n=0;n<s.length;n++)t.d.addEventListener(s[n],(function(){var e=t.d.visibilityState;e||(e=t.d.webkitVisibilityState),"visible"==e&&(t.fa=0,t.delayReady())}));r=1,a=0}else n||t.u("_d")&&(r=1);return r&&(t.K.push({m:e,a:i,t:a}),t.fa||setTimeout(t.delayReady,t.maxDelay)),r},t.delayReady=function(){var e,i=(new Date).getTime(),n=0;for(t.u("_d")?n=1:t.ya();0<t.K.length;){if(e=t.K.shift(),n&&!e.t&&e.t>i){t.K.unshift(e),setTimeout(t.delayReady,parseInt(t.maxDelay/2));break}t.Ja=1,t[e.m].apply(t,e.a),t.Ja=0}},t.setAccount=t.sa=function(e){var i,n;if(!t.ea("setAccount",arguments))if(t.account=e,t.allAccounts)for(i=t.allAccounts.concat(e.split(",")),t.allAccounts=[],i.sort(),n=0;n<i.length;n++)0!=n&&i[n-1]==i[n]||t.allAccounts.push(i[n]);else t.allAccounts=e.split(",")},t.foreachVar=function(e,i){var n,r,a,o,s="";for(a=r="",t.lightProfileID?(n=t.O,(s=t.lightTrackVars)&&(s=","+s+","+t.ka.join(",")+",")):(n=t.g,(t.pe||t.linkType)&&(s=t.linkTrackVars,r=t.linkTrackEvents,t.pe&&(a=t.pe.substring(0,1).toUpperCase()+t.pe.substring(1),t[a]&&(s=t[a].ac,r=t[a].$b))),s&&(s=","+s+","+t.F.join(",")+","),r&&s&&(s+=",events,")),i&&(i=","+i+","),r=0;r<n.length;r++)a=n[r],(o=t[a])&&(!s||0<=s.indexOf(","+a+","))&&(!i||0<=i.indexOf(","+a+","))&&e(a,o)},t.o=function(e,i,n,r,a){var o,s,l,c,u="",h=0;if("contextData"==e&&(e="c"),i){for(o in i)if(!(Object.prototype[o]||a&&o.substring(0,a.length)!=a)&&i[o]&&(!n||0<=n.indexOf(","+(r?r+".":"")+o+","))){if(l=!1,h)for(s=0;s<h.length;s++)if(o.substring(0,h[s].length)==h[s]){l=!0;break}if(!l&&(""==u&&(u+="&"+e+"."),s=i[o],a&&(o=o.substring(a.length)),0<o.length))if(0<(l=o.indexOf(".")))l=(a||"")+(s=o.substring(0,l))+".",h||(h=[]),h.push(l),u+=t.o(s,i,n,r,l);else if("boolean"==typeof s&&(s=s?"true":"false"),s){if("retrieveLightData"==r&&0>a.indexOf(".contextData."))switch(l=o.substring(0,4),c=o.substring(4),o){case"transactionID":o="xact";break;case"channel":o="ch";break;case"campaign":o="v0";break;default:t.Pa(c)&&("prop"==l?o="c"+c:"eVar"==l?o="v"+c:"list"==l?o="l"+c:"hier"==l&&(o="h"+c,s=s.substring(0,255)))}u+="&"+t.escape(o)+"="+t.escape(s)}}""!=u&&(u+="&."+e)}return u},t.usePostbacks=0,t.Nb=function(){var e,i,r,a,o,s,l,c,u="",h="",d="",p=a="",f=t.T();if(t.lightProfileID?(e=t.O,(h=t.lightTrackVars)&&(h=","+h+","+t.ka.join(",")+",")):(e=t.g,(t.pe||t.linkType)&&(h=t.linkTrackVars,d=t.linkTrackEvents,t.pe&&(a=t.pe.substring(0,1).toUpperCase()+t.pe.substring(1),t[a]&&(h=t[a].ac,d=t[a].$b))),h&&(h=","+h+","+t.F.join(",")+","),d&&(d=","+d+",",h&&(h+=",events,")),t.events2&&(p+=(""!=p?",":"")+t.events2)),f&&f.getCustomerIDs){if(a=n,o=f.getCustomerIDs())for(i in o)Object.prototype[i]||"object"==typeof(r=o[i])&&(a||(a={}),r.id&&(a[i+".id"]=r.id),r.authState&&(a[i+".as"]=r.authState));a&&(u+=t.o("cid",a))}for(t.AudienceManagement&&t.AudienceManagement.isReady()&&(u+=t.o("d",t.AudienceManagement.getEventCallConfigParams())),i=0;i<e.length;i++){if(a=e[i],o=t[a],r=a.substring(0,4),s=a.substring(4),o||("events"==a&&p?(o=p,p=""):"marketingCloudOrgID"==a&&f&&t.V("ECID")&&(o=f.marketingCloudOrgID)),o&&(!h||0<=h.indexOf(","+a+","))){switch(a){case"customerPerspective":a="cp";break;case"marketingCloudOrgID":a="mcorgid";break;case"supplementalDataID":a="sdid";break;case"timestamp":a="ts";break;case"dynamicVariablePrefix":a="D";break;case"visitorID":a="vid";break;case"marketingCloudVisitorID":a="mid";break;case"analyticsVisitorID":a="aid";break;case"audienceManagerLocationHint":a="aamlh";break;case"audienceManagerBlob":a="aamb";break;case"authState":a="as";break;case"pageURL":a="g",255<o.length&&(t.pageURLRest=o.substring(255),o=o.substring(0,255));break;case"pageURLRest":a="-g";break;case"referrer":a="r";break;case"vmk":case"visitorMigrationKey":a="vmt";break;case"visitorMigrationServer":a="vmf",t.ssl&&t.visitorMigrationServerSecure&&(o="");break;case"visitorMigrationServerSecure":a="vmf",!t.ssl&&t.visitorMigrationServer&&(o="");break;case"charSet":a="ce";break;case"visitorNamespace":a="ns";break;case"cookieDomainPeriods":a="cdp";break;case"cookieLifetime":a="cl";break;case"variableProvider":a="vvp";break;case"currencyCode":a="cc";break;case"channel":a="ch";break;case"transactionID":a="xact";break;case"campaign":a="v0";break;case"latitude":a="lat";break;case"longitude":a="lon";break;case"resolution":a="s";break;case"colorDepth":a="c";break;case"javascriptVersion":a="j";break;case"javaEnabled":a="v";break;case"cookiesEnabled":a="k";break;case"browserWidth":a="bw";break;case"browserHeight":a="bh";break;case"connectionType":a="ct";break;case"homepage":a="hp";break;case"events":if(p&&(o+=(""!=o?",":"")+p),d)for(s=o.split(","),o="",r=0;r<s.length;r++)0<=(c=(l=s[r]).indexOf("="))&&(l=l.substring(0,c)),0<=(c=l.indexOf(":"))&&(l=l.substring(0,c)),0<=d.indexOf(","+l+",")&&(o+=(o?",":"")+s[r]);break;case"events2":o="";break;case"contextData":u+=t.o("c",t[a],h,a),o="";break;case"lightProfileID":a="mtp";break;case"lightStoreForSeconds":a="mtss",t.lightProfileID||(o="");break;case"lightIncrementBy":a="mti",t.lightProfileID||(o="");break;case"retrieveLightProfiles":a="mtsr";break;case"deleteLightProfiles":a="mtsd";break;case"retrieveLightData":t.retrieveLightProfiles&&(u+=t.o("mts",t[a],h,a)),o="";break;default:t.Pa(s)&&("prop"==r?a="c"+s:"eVar"==r?a="v"+s:"list"==r?a="l"+s:"hier"==r&&(a="h"+s,o=o.substring(0,255)))}o&&(u+="&"+a+"="+("pev"!=a.substring(0,3)?t.escape(o):o))}"pev3"==a&&t.e&&(u+=t.e)}return t.ja&&(u+="&lrt="+t.ja,t.ja=null),u},t.B=function(e){var t=e.tagName;return"undefined"!=""+e.hc||"undefined"!=""+e.Wb&&"HTML"!=(""+e.Wb).toUpperCase()?"":("SHAPE"==(t=t&&t.toUpperCase?t.toUpperCase():"")&&(t=""),t&&(("INPUT"==t||"BUTTON"==t)&&e.type&&e.type.toUpperCase?t=e.type.toUpperCase():!t&&e.href&&(t="A")),t)},t.La=function(e){var t,n,r,a=i.location,o=e.href?e.href:"";return t=o.indexOf(":"),n=o.indexOf("?"),r=o.indexOf("/"),o&&(0>t||0<=n&&t>n||0<=r&&t>r)&&(n=e.protocol&&1<e.protocol.length?e.protocol:a.protocol?a.protocol:"",t=a.pathname.lastIndexOf("/"),o=(n?n+"//":"")+(e.host?e.host:a.host?a.host:"")+("/"!=o.substring(0,1)?a.pathname.substring(0,0>t?0:t)+"/":"")+o),o},t.L=function(e){var i,n,r=t.B(e),a="",o=0;return r&&(i=e.protocol,n=e.onclick,!e.href||"A"!=r&&"AREA"!=r||n&&i&&!(0>i.toLowerCase().indexOf("javascript"))?n?(a=t.replace(t.replace(t.replace(t.replace(""+n,"\r",""),"\n",""),"\t","")," ",""),o=2):"INPUT"==r||"SUBMIT"==r?(e.value?a=e.value:e.innerText?a=e.innerText:e.textContent&&(a=e.textContent),o=3):"IMAGE"==r&&e.src&&(a=e.src):a=t.La(e),a)?{id:a.substring(0,100),type:o}:0},t.fc=function(e){for(var i=t.B(e),n=t.L(e);e&&!n&&"BODY"!=i;)(e=e.parentElement?e.parentElement:e.parentNode)&&(i=t.B(e),n=t.L(e));return n&&"BODY"!=i||(e=0),e&&(0<=(i=e.onclick?""+e.onclick:"").indexOf(".tl(")||0<=i.indexOf(".trackLink("))&&(e=0),e},t.Vb=function(){var e,n,r,a,o=t.linkObject,s=t.linkType,l=t.linkURL;if(t.la=1,o||(t.la=0,o=t.clickObject),o){for(e=t.B(o),n=t.L(o);o&&!n&&"BODY"!=e;)(o=o.parentElement?o.parentElement:o.parentNode)&&(e=t.B(o),n=t.L(o));if(n&&"BODY"!=e||(o=0),o&&!t.linkObject){var c=o.onclick?""+o.onclick:"";(0<=c.indexOf(".tl(")||0<=c.indexOf(".trackLink("))&&(o=0)}}else t.la=1;if(!l&&o&&(l=t.La(o)),l&&!t.linkLeaveQueryString&&(0<=(r=l.indexOf("?"))&&(l=l.substring(0,r))),!s&&l){var u,h=0,d=0;if(t.trackDownloadLinks&&t.linkDownloadFileTypes)for(r=(c=l.toLowerCase()).indexOf("?"),a=c.indexOf("#"),0<=r?0<=a&&a<r&&(r=a):r=a,0<=r&&(c=c.substring(0,r)),r=t.linkDownloadFileTypes.toLowerCase().split(","),a=0;a<r.length;a++)(u=r[a])&&c.substring(c.length-(u.length+1))=="."+u&&(s="d");if(t.trackExternalLinks&&!s&&(c=l.toLowerCase(),t.Oa(c)&&(t.linkInternalFilters||(t.linkInternalFilters=i.location.hostname),r=0,t.linkExternalFilters?(r=t.linkExternalFilters.toLowerCase().split(","),h=1):t.linkInternalFilters&&(r=t.linkInternalFilters.toLowerCase().split(",")),r))){for(a=0;a<r.length;a++)u=r[a],0<=c.indexOf(u)&&(d=1);d?h&&(s="e"):h||(s="e")}}t.linkObject=o,t.linkURL=l,t.linkType=s,(t.trackClickMap||t.trackInlineStats)&&(t.e="",o&&(s=t.pageName,l=1,o=o.sourceIndex,s||(s=t.pageURL,l=0),i.s_objectID&&(n.id=i.s_objectID,o=n.type=1),s&&n&&n.id&&e&&(t.e="&pid="+t.escape(s.substring(0,255))+(l?"&pidt="+l:"")+"&oid="+t.escape(n.id.substring(0,100))+(n.type?"&oidt="+n.type:"")+"&ot="+e+(o?"&oi="+o:""))))},t.Ob=function(){var e=t.la,i=t.linkType,n=t.linkURL,r=t.linkName;if(i&&(n||r)&&("d"!=(i=i.toLowerCase())&&"e"!=i&&(i="o"),t.pe="lnk_"+i,t.pev1=n?t.escape(n):"",t.pev2=r?t.escape(r):"",e=1),t.abort&&(e=0),t.trackClickMap||t.trackInlineStats||t.Rb()){i={},n=0;var a,o,s,l=(c=t.pb())?c.split("&"):0,c=0;if(l)for(a=0;a<l.length;a++)o=l[a].split("="),r=t.unescape(o[0]).split(","),i[o=t.unescape(o[1])]=r;for(s in r=t.account.split(","),a={},t.contextData)s&&!Object.prototype[s]&&"a.activitymap."==s.substring(0,14)&&(a[s]=t.contextData[s],t.contextData[s]="");if(t.e=t.o("c",a)+(t.e?t.e:""),e||t.e){for(o in e&&!t.e&&(c=1),i)if(!Object.prototype[o])for(s=0;s<r.length;s++)for(c&&((l=i[o].join(","))==t.account&&(t.e+=("&"!=o.charAt(0)?"&":"")+o,i[o]=[],n=1)),a=0;a<i[o].length;a++)(l=i[o][a])==r[s]&&(c&&(t.e+="&u="+t.escape(l)+("&"!=o.charAt(0)?"&":"")+o+"&u=0"),i[o].splice(a,1),n=1);if(e||(n=1),n){for(o in c="",a=2,!e&&t.e&&(c=t.escape(r.join(","))+"="+t.escape(t.e),a=1),i)!Object.prototype[o]&&0<a&&0<i[o].length&&(c+=(c?"&":"")+t.escape(i[o].join(","))+"="+t.escape(o),a--);t.wb(c)}}}return e},t.pb=function(){return t.useLinkTrackSessionStorage?t.Ca()?i.sessionStorage.getItem(t.P):void 0:t.cookieRead(t.P)},t.Ca=function(){return!!i.sessionStorage},t.wb=function(e){t.useLinkTrackSessionStorage?t.Ca()&&i.sessionStorage.setItem(t.P,e):t.cookieWrite(t.P,e)},t.Pb=function(){if(!t.Zb){var e,i,n,r,a=new Date,o=s.location,l=i=e="",c="1.2",u=t.cookieWrite("s_cc","true",0)?"Y":"N",h="",d="";if(a.setUTCDate&&(c="1.3",(0).toPrecision&&(c="1.5",(a=[]).forEach))){c="1.6",i=0,e={};try{(i=new Iterator(e)).next&&(c="1.7",a.reduce&&((c="1.8").trim&&(c="1.8.1",Date.parse&&(c="1.8.2",Object.create&&(c="1.8.5")))))}catch(e){}}e=screen.width+"x"+screen.height,l=navigator.javaEnabled()?"Y":"N",i=screen.pixelDepth?screen.pixelDepth:screen.colorDepth,n=t.w.innerWidth?t.w.innerWidth:t.d.documentElement.offsetWidth,r=t.w.innerHeight?t.w.innerHeight:t.d.documentElement.offsetHeight;try{t.b.addBehavior("#default#homePage"),h=t.b.gc(o)?"Y":"N"}catch(e){}try{t.b.addBehavior("#default#clientCaps"),d=t.b.connectionType}catch(e){}t.resolution=e,t.colorDepth=i,t.javascriptVersion=c,t.javaEnabled=l,t.cookiesEnabled=u,t.browserWidth=n,t.browserHeight=r,t.connectionType=d,t.homepage=h,t.Zb=1}},t.Q={},t.loadModule=function(e,n){var r=t.Q[e];if(!r){r=i["AppMeasurement_Module_"+e]?new i["AppMeasurement_Module_"+e](t):{},t.Q[e]=t[e]=r,r.ib=function(){return r.sb},r.xb=function(i){(r.sb=i)&&(t[e+"_onLoad"]=i,t.ea(e+"_onLoad",[t,r],1)||i(t,r))};try{Object.defineProperty?Object.defineProperty(r,"onLoad",{get:r.ib,set:r.xb}):r._olc=1}catch(e){r._olc=1}}n&&(t[e+"_onLoad"]=n,t.ea(e+"_onLoad",[t,r],1)||n(t,r))},t.u=function(e){var i,n;for(i in t.Q)if(!Object.prototype[i]&&(n=t.Q[i])&&(n._olc&&n.onLoad&&(n._olc=0,n.onLoad(t,n)),n[e]&&n[e]()))return 1;return 0},t.Rb=function(){return!(!t.ActivityMap||!t.ActivityMap._c)},t.Sb=function(){var e=Math.floor(1e13*Math.random()),i=t.visitorSampling,n=t.visitorSamplingGroup,r=(n="s_vsn_"+(t.visitorNamespace?t.visitorNamespace:t.account)+(n?"_"+n:""),t.cookieRead(n));if(i){if(i*=100,r&&(r=parseInt(r)),!r){if(!t.cookieWrite(n,e))return 0;r=e}if(r%1e4>i)return 0}return 1},t.S=function(e,i){var n,r,a,o,s,l,c;for(c={},n=0;2>n;n++)for(r=0<n?t.Ea:t.g,a=0;a<r.length;a++)if((s=e[o=r[a]])||e["!"+o]){if(s&&!i&&("contextData"==o||"retrieveLightData"==o)&&t[o])for(l in t[o])s[l]||(s[l]=t[o][l]);t[o]||(c["!"+o]=1),c[o]=t[o],t[o]=s}return c},t.cc=function(e){var i,n,r,a;for(i=0;2>i;i++)for(n=0<i?t.Ea:t.g,r=0;r<n.length;r++)e[a=n[r]]=t[a],e[a]||"prop"!==a.substring(0,4)&&"eVar"!==a.substring(0,4)&&"hier"!==a.substring(0,4)&&"list"!==a.substring(0,4)&&"channel"!==a&&"events"!==a&&"eventList"!==a&&"products"!==a&&"productList"!==a&&"purchaseID"!==a&&"transactionID"!==a&&"state"!==a&&"zip"!==a&&"campaign"!==a&&"events2"!==a&&"latitude"!==a&&"longitude"!==a&&"ms_a"!==a&&"contextData"!==a&&"supplementalDataID"!==a&&"tnt"!==a&&"timestamp"!==a&&"abort"!==a&&"useBeacon"!==a&&"linkObject"!==a&&"clickObject"!==a&&"linkType"!==a&&"linkName"!==a&&"linkURL"!==a&&"bodyClickTarget"!==a&&"bodyClickFunction"!==a||(e["!"+a]=1)},t.Jb=function(e){var t,i,n,r,a,o,s=0,l="",c="";if(e&&255<e.length&&(0<(i=(t=""+e).indexOf("?"))&&(o=t.substring(i+1),n=0,"http://"==(r=(t=t.substring(0,i)).toLowerCase()).substring(0,7)?n+=7:"https://"==r.substring(0,8)&&(n+=8),0<(i=r.indexOf("/",n))&&(r=r.substring(n,i),a=t.substring(i),t=t.substring(0,i),0<=r.indexOf("google")?s=",q,ie,start,search_key,word,kw,cd,":0<=r.indexOf("yahoo.co")?s=",p,ei,":0<=r.indexOf("baidu.")&&(s=",wd,word,"),s&&o)))){if((e=o.split("&"))&&1<e.length){for(n=0;n<e.length;n++)0<(i=(r=e[n]).indexOf("="))&&0<=s.indexOf(","+r.substring(0,i)+",")?l+=(l?"&":"")+r:c+=(c?"&":"")+r;l&&c?o=l+"&"+c:c=""}e=t+(0<(i=253-(o.length-c.length)-t.length)?a.substring(0,i):"")+"?"+o}return e},t.bb=function(e){var i=t.d.visibilityState,n=["webkitvisibilitychange","visibilitychange"];if(i||(i=t.d.webkitVisibilityState),i&&"prerender"==i){if(e)for(i=0;i<n.length;i++)t.d.addEventListener(n[i],(function(){var i=t.d.visibilityState;i||(i=t.d.webkitVisibilityState),"visible"==i&&e()}));return!1}return!0},t.ba=!1,t.H=!1,t.zb=function(){t.H=!0,t.p()},t.I=!1,t.Ab=function(e){t.marketingCloudVisitorID=e.MCMID,t.visitorOptedOut=e.MCOPTOUT,t.analyticsVisitorID=e.MCAID,t.audienceManagerLocationHint=e.MCAAMLH,t.audienceManagerBlob=e.MCAAMB,t.I=!1,t.p()},t.ab=function(e){return t.maxDelay||(t.maxDelay=250),!t.u("_d")||(e&&setTimeout((function(){e()}),t.maxDelay),!1)},t.Z=!1,t.G=!1,t.ya=function(){t.G=!0,t.p()},t.isReadyToTrack=function(){var e=!0;return!(!t.mb()||!t.kb())&&(t.ob()||(e=!1),t.rb()||(e=!1),e)},t.mb=function(){return t.ba||t.H||(t.bb(t.zb)?t.H=!0:t.ba=!0),!(t.ba&&!t.H)},t.kb=function(){var e=t.va();if(e){if(!t.ra&&!t.aa)return e.fetchPermissions(t.tb,!0),t.aa=!0,!1;if(!t.ra)return!1;if(!e.isApproved(e.Categories.ANALYTICS))return!1}return!0},t.V=function(e){var i=t.va();return!(i&&!i.isApproved(i.Categories[e]))},t.va=function(){return i.adobe&&i.adobe.optIn?i.adobe.optIn:null},t.Y=!0,t.ob=function(){var e=t.T();return!e||!e.getVisitorValues||(t.Y&&(t.Y=!1,t.I||(t.I=!0,e.getVisitorValues(t.Ab))),!t.I)},t.T=function(){var e=t.visitor;return e&&!e.isAllowed()&&(e=null),e},t.rb=function(){return t.Z||t.G||(t.ab(t.ya)?t.G=!0:t.Z=!0),!(t.Z&&!t.G)},t.aa=!1,t.tb=function(){t.aa=!1,t.ra=!0},t.j=n,t.q=0,t.callbackWhenReadyToTrack=function(e,i,r){var a;(a={}).Eb=e,a.Db=i,a.Bb=r,t.j==n&&(t.j=[]),t.j.push(a),0==t.q&&(t.q=setInterval(t.p,100))},t.p=function(){var e;if(t.isReadyToTrack()&&(t.yb(),t.j!=n))for(;0<t.j.length;)(e=t.j.shift()).Db.apply(e.Eb,e.Bb)},t.yb=function(){t.q&&(clearInterval(t.q),t.q=0)},t.ta=function(e){var i,r={};if(t.cc(r),e!=n)for(i in e)r[i]=e[i];t.callbackWhenReadyToTrack(t,t.Da,[r]),t.Ba()},t.Lb=function(){var e,i=t.cookieRead("s_fid"),n="",r="";e=8;var a=4;if(!i||0>i.indexOf("-")){for(i=0;16>i;i++)e=Math.floor(Math.random()*e),n+="0123456789ABCDEF".substring(e,e+1),e=Math.floor(Math.random()*a),r+="0123456789ABCDEF".substring(e,e+1),e=a=16;i=n+"-"+r}return t.cookieWrite("s_fid",i,1)||(i=0),i},t.Da=function(e){var n,r=new Date,a="s"+Math.floor(r.getTime()/108e5)%10+Math.floor(1e13*Math.random()),o=r.getYear(),l=(o="t="+t.escape(r.getDate()+"/"+r.getMonth()+"/"+(1900>o?o+1900:o)+" "+r.getHours()+":"+r.getMinutes()+":"+r.getSeconds()+" "+r.getDay()+" "+r.getTimezoneOffset()),t.T());e&&(n=t.S(e,1)),t.Sb()&&!t.visitorOptedOut&&(t.wa()||(t.fid=t.Lb()),t.Vb(),t.usePlugins&&t.doPlugins&&t.doPlugins(t),t.account&&(t.abort||(t.trackOffline&&!t.timestamp&&(t.timestamp=Math.floor(r.getTime()/1e3)),e=i.location,t.pageURL||(t.pageURL=e.href?e.href:e),t.referrer||t.Za||(e=t.Util.getQueryParam("adobe_mc_ref",null,null,!0),t.referrer=e||void 0===e?void 0===e?"":e:s.document.referrer),t.Za=1,t.referrer=t.Jb(t.referrer),t.u("_g")),t.Ob()&&!t.abort&&(l&&t.V("TARGET")&&!t.supplementalDataID&&l.getSupplementalDataID&&(t.supplementalDataID=l.getSupplementalDataID("AppMeasurement:"+t._in,!t.expectSupplementalData)),t.V("AAM")||(t.contextData["cm.ssf"]=1),t.Pb(),o+=t.Nb(),t.qb(a,o),t.u("_t"),t.referrer=""))),t.Ba(),n&&t.S(n,1)},t.t=t.track=function(e,i){i&&t.S(i),t.Y=!0,t.isReadyToTrack()?null!=t.j&&0<t.j.length?(t.ta(e),t.p()):t.Da(e):t.ta(e)},t.Ba=function(){t.abort=t.supplementalDataID=t.timestamp=t.pageURLRest=t.linkObject=t.clickObject=t.linkURL=t.linkName=t.linkType=i.s_objectID=t.pe=t.pev1=t.pev2=t.pev3=t.e=t.lightProfileID=t.useBeacon=t.referrer=0},t.Aa=[],t.registerPreTrackCallback=function(e){for(var i=[],n=1;n<arguments.length;n++)i.push(arguments[n]);"function"==typeof e?t.Aa.push([e,i]):t.debugTracking&&t.C("DEBUG: Non function type passed to registerPreTrackCallback")},t.fb=function(e){t.ua(t.Aa,e)},t.za=[],t.registerPostTrackCallback=function(e){for(var i=[],n=1;n<arguments.length;n++)i.push(arguments[n]);"function"==typeof e?t.za.push([e,i]):t.debugTracking&&t.C("DEBUG: Non function type passed to registerPostTrackCallback")},t.eb=function(e){t.ua(t.za,e)},t.ua=function(e,i){if("object"==typeof e)for(var n=0;n<e.length;n++){var r=e[n][0],a=e[n][1].slice();if(a.unshift(i),"function"==typeof r)try{r.apply(null,a)}catch(e){t.debugTracking&&t.C(e.message)}}},t.tl=t.trackLink=function(e,i,n,r,a){return t.linkObject=e,t.linkType=i,t.linkName=n,a&&(t.bodyClickTarget=e,t.bodyClickFunction=a),t.track(r)},t.trackLight=function(e,i,n,r){return t.lightProfileID=e,t.lightStoreForSeconds=i,t.lightIncrementBy=n,t.track(r)},t.clearVars=function(){var e,i;for(e=0;e<t.g.length;e++)("prop"==(i=t.g[e]).substring(0,4)||"eVar"==i.substring(0,4)||"hier"==i.substring(0,4)||"list"==i.substring(0,4)||"channel"==i||"events"==i||"eventList"==i||"products"==i||"productList"==i||"purchaseID"==i||"transactionID"==i||"state"==i||"zip"==i||"campaign"==i)&&(t[i]=void 0)},t.tagContainerMarker="",t.qb=function(e,i){var n=t.gb()+"/"+e+"?AQB=1&ndh=1&pf=1&"+(t.xa()?"callback=s_c_il["+t._in+"].doPostbacks&et=1&":"")+i+"&AQE=1";t.fb(n),t.cb(n),t.U()},t.gb=function(){var e=t.hb();return"http"+(t.ssl?"s":"")+"://"+e+"/b/ss/"+t.account+"/"+(t.mobile?"5.":"")+(t.xa()?"10":"1")+"/JS-"+t.version+(t.Yb?"T":"")+(t.tagContainerMarker?"-"+t.tagContainerMarker:"")},t.xa=function(){return t.AudienceManagement&&t.AudienceManagement.isReady()||0!=t.usePostbacks},t.hb=function(){var e=t.dc,i=t.trackingServer;return i?t.trackingServerSecure&&t.ssl&&(i=t.trackingServerSecure):("d1"==(e=e?(""+e).toLowerCase():"d1")?e="112":"d2"==e&&(e="122"),i=t.jb()+"."+e+".2o7.net"),i},t.jb=function(){var e=t.visitorNamespace;return e||(e=(e=t.account.split(",")[0]).replace(/[^0-9a-z]/gi,"")),e},t.Ya=/{(%?)(.*?)(%?)}/,t.bc=RegExp(t.Ya.source,"g"),t.Ib=function(e){if("object"==typeof e.dests)for(var i=0;i<e.dests.length;++i){var n=e.dests[i];if("string"==typeof n.c&&"aa."==n.id.substr(0,3))for(var r=n.c.match(t.bc),a=0;a<r.length;++a){var o=r[a],s=o.match(t.Ya),l="";"%"==s[1]&&"timezone_offset"==s[2]?l=(new Date).getTimezoneOffset():"%"==s[1]&&"timestampz"==s[2]&&(l=t.Mb()),n.c=n.c.replace(o,t.escape(l))}}},t.Mb=function(){var e=new Date,i=new Date(6e4*Math.abs(e.getTimezoneOffset()));return t.k(4,e.getFullYear())+"-"+t.k(2,e.getMonth()+1)+"-"+t.k(2,e.getDate())+"T"+t.k(2,e.getHours())+":"+t.k(2,e.getMinutes())+":"+t.k(2,e.getSeconds())+(0<e.getTimezoneOffset()?"-":"+")+t.k(2,i.getUTCHours())+":"+t.k(2,i.getUTCMinutes())},t.k=function(e,t){return(Array(e+1).join(0)+t).slice(-e)},t.pa={},t.doPostbacks=function(e){if("object"==typeof e)if(t.Ib(e),"object"==typeof t.AudienceManagement&&"function"==typeof t.AudienceManagement.isReady&&t.AudienceManagement.isReady()&&"function"==typeof t.AudienceManagement.passData)t.AudienceManagement.passData(e);else if("object"==typeof e&&"object"==typeof e.dests)for(var i=0;i<e.dests.length;++i){var n=e.dests[i];"object"==typeof n&&"string"==typeof n.c&&"string"==typeof n.id&&"aa."==n.id.substr(0,3)&&(t.pa[n.id]=new Image,t.pa[n.id].alt="",t.pa[n.id].src=n.c)}},t.cb=function(e){t.i||t.Qb(),t.i.push(e),t.ia=t.A(),t.Wa()},t.Qb=function(){t.i=t.Tb(),t.i||(t.i=[])},t.Tb=function(){var e,n;if(t.oa()){try{(n=i.localStorage.getItem(t.ma()))&&(e=i.JSON.parse(n))}catch(e){}return e}},t.oa=function(){var e=!0;return t.trackOffline&&t.offlineFilename&&i.localStorage&&i.JSON||(e=!1),e},t.Ma=function(){var e=0;return t.i&&(e=t.i.length),t.l&&e++,e},t.U=function(){if(!t.l||(t.v&&t.v.complete&&t.v.D&&t.v.R(),!t.l))if(t.Na=n,t.na)t.ia>t.N&&t.Ua(t.i),t.qa(500);else{var e=t.Cb();0<e?t.qa(e):(e=t.Ka())&&(t.l=1,t.Ub(e),t.Xb(e))}},t.qa=function(e){t.Na||(e||(e=0),t.Na=setTimeout(t.U,e))},t.Cb=function(){var e;return!t.trackOffline||0>=t.offlineThrottleDelay?0:(e=t.A()-t.Sa,t.offlineThrottleDelay<e?0:t.offlineThrottleDelay-e)},t.Ka=function(){if(0<t.i.length)return t.i.shift()},t.Ub=function(e){if(t.debugTracking){var i,n="AppMeasurement Debug: "+e;for(e=e.split("&"),i=0;i<e.length;i++)n+="\n\t"+t.unescape(e[i]);t.C(n)}},t.wa=function(){return t.marketingCloudVisitorID||t.analyticsVisitorID},t.X=!1;try{o=JSON.parse('{"x":"y"}')}catch(e){o=null}for(o&&"y"==o.x?(t.X=!0,t.W=function(e){return JSON.parse(e)}):i.$&&i.$.parseJSON?(t.W=function(e){return i.$.parseJSON(e)},t.X=!0):t.W=function(){return null},t.Xb=function(e){var r,a,o;if(t.lb(e)&&(a=1,r={send:function(e){t.useBeacon=!1,navigator.sendBeacon(e)?r.R():r.ga()}}),!r&&t.wa()&&2047<e.length&&(t.$a()&&(a=2,r=new XMLHttpRequest),r&&(t.AudienceManagement&&t.AudienceManagement.isReady()||0!=t.usePostbacks)&&(t.X?r.Fa=!0:r=0)),!r&&t.Xa&&(e=e.substring(0,2047)),!r&&t.d.createElement&&(0!=t.usePostbacks||t.AudienceManagement&&t.AudienceManagement.isReady())&&(r=t.d.createElement("SCRIPT"))&&"async"in r&&((o=(o=t.d.getElementsByTagName("HEAD"))&&o[0]?o[0]:t.d.body)?(r.type="text/javascript",r.setAttribute("async","async"),a=3):r=0),r||((r=new Image).alt="",r.abort||void 0===i.InstallTrigger||(r.abort=function(){r.src=n})),r.Ta=Date.now(),r.Ha=function(){try{r.D&&(clearTimeout(r.D),r.D=0)}catch(e){}},r.onload=r.R=function(){if(r.Ta&&(t.ja=Date.now()-r.Ta),t.eb(e),r.Ha(),t.Gb(),t.ca(),t.l=0,t.U(),r.Fa){r.Fa=!1;try{t.doPostbacks(t.W(r.responseText))}catch(e){}}},r.onabort=r.onerror=r.ga=function(){r.Ha(),(t.trackOffline||t.na)&&t.l&&t.i.unshift(t.Fb),t.l=0,t.ia>t.N&&t.Ua(t.i),t.ca(),t.qa(500)},r.onreadystatechange=function(){4==r.readyState&&(200==r.status?r.R():r.ga())},t.Sa=t.A(),1===a)r.send(e);else if(2===a)o=e.indexOf("?"),a=e.substring(0,o),o=(o=e.substring(o+1)).replace(/&callback=[a-zA-Z0-9_.\[\]]+/,""),r.open("POST",a,!0),r.withCredentials=!0,r.send(o);else if(r.src=e,3===a){if(t.Qa)try{o.removeChild(t.Qa)}catch(e){}o.firstChild?o.insertBefore(r,o.firstChild):o.appendChild(r),t.Qa=t.v}r.D=setTimeout((function(){r.D&&(r.complete?r.R():(t.trackOffline&&r.abort&&r.abort(),r.ga()))}),5e3),t.Fb=e,t.v=i["s_i_"+t.replace(t.account,",","_")]=r,(t.useForcedLinkTracking&&t.J||t.bodyClickFunction)&&(t.forcedLinkTrackingTimeout||(t.forcedLinkTrackingTimeout=250),t.da=setTimeout(t.ca,t.forcedLinkTrackingTimeout))},t.lb=function(e){var i=!1;return navigator.sendBeacon&&(t.nb(e)||t.useBeacon)&&(i=!0),t.vb(e)&&(i=!1),i},t.nb=function(e){return!!(e&&0<e.indexOf("pe=lnk_e"))},t.vb=function(e){return 64e3<=e.length},t.$a=function(){return"undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest},t.Gb=function(){if(t.oa()&&!(t.Ra>t.N))try{i.localStorage.removeItem(t.ma()),t.Ra=t.A()}catch(e){}},t.Ua=function(e){if(t.oa()){t.Wa();try{i.localStorage.setItem(t.ma(),i.JSON.stringify(e)),t.N=t.A()}catch(e){}}},t.Wa=function(){if(t.trackOffline)for((!t.offlineLimit||0>=t.offlineLimit)&&(t.offlineLimit=10);t.i.length>t.offlineLimit;)t.Ka()},t.forceOffline=function(){t.na=!0},t.forceOnline=function(){t.na=!1},t.ma=function(){return t.offlineFilename+"-"+t.visitorNamespace+t.account},t.A=function(){return(new Date).getTime()},t.Oa=function(e){return 0!=(e=e.toLowerCase()).indexOf("#")&&0!=e.indexOf("about:")&&0!=e.indexOf("opera:")&&0!=e.indexOf("javascript:")},t.setTagContainer=function(e){var i,n,r;for(t.Yb=e,i=0;i<t._il.length;i++)if((n=t._il[i])&&"s_l"==n._c&&n.tagContainerName==e){if(t.S(n),n.lmq)for(i=0;i<n.lmq.length;i++)r=n.lmq[i],t.loadModule(r.n);if(n.ml)for(r in n.ml)if(t[r])for(i in e=t[r],r=n.ml[r])!Object.prototype[i]&&("function"!=typeof r[i]||0>(""+r[i]).indexOf("s_c_il"))&&(e[i]=r[i]);if(n.mmq)for(i=0;i<n.mmq.length;i++)r=n.mmq[i],t[r.m]&&((e=t[r.m])[r.f]&&"function"==typeof e[r.f]&&(r.a?e[r.f].apply(e,r.a):e[r.f].apply(e)));if(n.tq)for(i=0;i<n.tq.length;i++)t.track(n.tq[i]);n.s=t;break}},t.Util={urlEncode:t.escape,urlDecode:t.unescape,cookieRead:t.cookieRead,cookieWrite:t.cookieWrite,getQueryParam:function(e,n,r,a){var o,s="";return n||(n=t.pageURL?t.pageURL:i.location),r=r||"&",e&&n?0>(o=(n=""+n).indexOf("?"))?s:(n=r+n.substring(o+1)+r,a&&(0<=n.indexOf(r+e+r)||0<=n.indexOf(r+e+"="+r))?void 0:(0<=(o=n.indexOf("#"))&&(n=n.substr(0,o)+r),0>(o=n.indexOf(r+e+"="))||(0<=(o=(n=n.substring(o+r.length+e.length+1)).indexOf(r))&&(n=n.substring(0,o)),0<n.length&&(s=t.unescape(n))),s)):s},getIeVersion:function(){if(document.documentMode)return document.documentMode;for(var e=7;4<e;e--){var t=document.createElement("div");if(t.innerHTML="\x3c!--[if IE "+e+"]><span></span><![endif]--\x3e",t.getElementsByTagName("span").length)return e}return null}},t.F="supplementalDataID timestamp dynamicVariablePrefix visitorID marketingCloudVisitorID analyticsVisitorID audienceManagerLocationHint authState fid vmk visitorMigrationKey visitorMigrationServer visitorMigrationServerSecure charSet visitorNamespace cookieDomainPeriods fpCookieDomainPeriods cookieLifetime pageName pageURL customerPerspective referrer contextData currencyCode lightProfileID lightStoreForSeconds lightIncrementBy retrieveLightProfiles deleteLightProfiles retrieveLightData".split(" "),t.g=t.F.concat("purchaseID variableProvider channel server pageType transactionID campaign state zip events events2 products audienceManagerBlob tnt".split(" ")),t.ka="timestamp charSet visitorNamespace cookieDomainPeriods cookieLifetime contextData lightProfileID lightStoreForSeconds lightIncrementBy".split(" "),t.O=t.ka.slice(0),t.Ea="account allAccounts debugTracking visitor visitorOptedOut trackOffline offlineLimit offlineThrottleDelay offlineFilename usePlugins doPlugins configURL visitorSampling visitorSamplingGroup linkObject clickObject linkURL linkName linkType trackDownloadLinks trackExternalLinks trackClickMap trackInlineStats linkLeaveQueryString linkTrackVars linkTrackEvents linkDownloadFileTypes linkExternalFilters linkInternalFilters useForcedLinkTracking forcedLinkTrackingTimeout useLinkTrackSessionStorage trackingServer trackingServerSecure ssl abort mobile dc lightTrackVars maxDelay expectSupplementalData useBeacon usePostbacks registerPreTrackCallback registerPostTrackCallback bodyClickTarget bodyClickFunction AudienceManagement".split(" "),r=0;250>=r;r++)76>r&&(t.g.push("prop"+r),t.O.push("prop"+r)),t.g.push("eVar"+r),t.O.push("eVar"+r),6>r&&t.g.push("hier"+r),4>r&&t.g.push("list"+r);r="pe pev1 pev2 pev3 latitude longitude resolution colorDepth javascriptVersion javaEnabled cookiesEnabled browserWidth browserHeight connectionType homepage pageURLRest marketingCloudOrgID ms_a".split(" "),t.g=t.g.concat(r),t.F=t.F.concat(r),t.ssl=0<=i.location.protocol.toLowerCase().indexOf("https"),t.charSet="UTF-8",t.contextData={},t.offlineThrottleDelay=0,t.offlineFilename="AppMeasurement.offline",t.P="s_sq",t.Sa=0,t.ia=0,t.N=0,t.Ra=0,t.linkDownloadFileTypes="exe,zip,wav,mp3,mov,mpg,avi,wmv,pdf,doc,docx,xls,xlsx,ppt,pptx",t.w=i,t.d=i.document;try{if(t.Xa=!1,navigator){var l=navigator.userAgent;("Microsoft Internet Explorer"==navigator.appName||0<=l.indexOf("MSIE ")||0<=l.indexOf("Trident/")&&0<=l.indexOf("Windows NT 6"))&&(t.Xa=!0)}}catch(e){}t.ca=function(){t.da&&(i.clearTimeout(t.da),t.da=n),t.bodyClickTarget&&t.J&&t.bodyClickTarget.dispatchEvent(t.J),t.bodyClickFunction&&("function"==typeof t.bodyClickFunction?t.bodyClickFunction():t.bodyClickTarget&&t.bodyClickTarget.href&&(t.d.location=t.bodyClickTarget.href)),t.bodyClickTarget=t.J=t.bodyClickFunction=0},t.Va=function(){t.b=t.d.body,t.b?(t.r=function(e){var n,r,a,o,s;if(!(t.d&&t.d.getElementById("cppXYctnr")||e&&e["s_fe_"+t._in])){if(t.Ga){if(!t.useForcedLinkTracking)return t.b.removeEventListener("click",t.r,!0),void(t.Ga=t.useForcedLinkTracking=0);t.b.removeEventListener("click",t.r,!1)}else t.useForcedLinkTracking=0;t.clickObject=e.srcElement?e.srcElement:e.target;try{if(!t.clickObject||t.M&&t.M==t.clickObject||!(t.clickObject.tagName||t.clickObject.parentElement||t.clickObject.parentNode))t.clickObject=0;else{var l=t.M=t.clickObject;if(t.ha&&(clearTimeout(t.ha),t.ha=0),t.ha=setTimeout((function(){t.M==l&&(t.M=0)}),1e4),a=t.Ma(),t.track(),a<t.Ma()&&t.useForcedLinkTracking&&e.target){for(o=e.target;o&&o!=t.b&&"A"!=o.tagName.toUpperCase()&&"AREA"!=o.tagName.toUpperCase();)o=o.parentNode;if(o&&(s=o.href,t.Oa(s)||(s=0),r=o.target,e.target.dispatchEvent&&s&&(!r||"_self"==r||"_top"==r||"_parent"==r||i.name&&r==i.name))){try{n=t.d.createEvent("MouseEvents")}catch(e){n=new i.MouseEvent}if(n){try{n.initMouseEvent("click",e.bubbles,e.cancelable,e.view,e.detail,e.screenX,e.screenY,e.clientX,e.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.button,e.relatedTarget)}catch(e){n=0}n&&(n["s_fe_"+t._in]=n.s_fe=1,e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),e.preventDefault(),t.bodyClickTarget=e.target,t.J=n)}}}}}catch(e){t.clickObject=0}}},t.b&&t.b.attachEvent?t.b.attachEvent("onclick",t.r):t.b&&t.b.addEventListener&&(navigator&&(0<=navigator.userAgent.indexOf("WebKit")&&t.d.createEvent||0<=navigator.userAgent.indexOf("Firefox/2")&&i.MouseEvent)&&(t.Ga=1,t.useForcedLinkTracking=1,t.b.addEventListener("click",t.r,!0)),t.b.addEventListener("click",t.r,!1))):setTimeout(t.Va,30)},t.Hb(),t.ic||(e?t.setAccount(e):t.C("Error, missing Report Suite ID in AppMeasurement initialization"),t.Va(),t.loadModule("ActivityMap"))}function n(e){var t,n,r,a,o,s=window.s_c_il,l=e.split(","),c=0;if(s)for(n=0;!c&&n<s.length;){if("s_c"==(t=s[n])._c&&(t.account||t.oun))if(t.account&&t.account==e)c=1;else for(r=t.account?t.account:t.oun,r=t.allAccounts?t.allAccounts:r.split(","),a=0;a<l.length;a++)for(o=0;o<r.length;o++)l[a]==r[o]&&(c=1);n++}return c?t.setAccount&&t.setAccount(e):t=new i(e),t}i.getInstance=n,window.s_objectID||(window.s_objectID=0),function(){var e,t,i,r=window,a=r.s_giq;if(a)for(e=0;e<a.length;e++)(i=n((t=a[e]).oun)).setAccount(t.un),i.setTagContainer(t.tagContainerName);r.s_giq=0}(),window.AppMeasurement=i,e.exports={Visitor:Visitor,s_gi:n,AppMeasurement:i}}).call(this,i(9))},function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},function(e,t){e.exports.getRefsecKeyValue=function(){const e=document.createElement("a");if(e.href=document.referrer,e.hostname.indexOf("wsj.com")<0&&e.hostname.indexOf("barrons.com")<0)return"";let t=e.pathname;"/"===t[0]&&(t=t.substring(1));const i=t.replace(/\//g,",").split(",");return"articles"===i[0]?"":i.join(",")}},function(e,t,i){function n(){return(n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e}).apply(this,arguments)}const{h:r,render:a,Component:o,Fragment:s}=i(1),{Provider:l}=i(2),{emptyElement:c}=i(5),u=i(42),{MoreVideosSlide:h}=i(62),{Endscreen:d}=i(64),p=i(66),f=i(74),g=i(76),_=i(78),m=i(80),v=i(82),y=i(84);class b extends o{shouldComponentUpdate(){return!1}render(){const{videoId:e,videoProps:t,controlsProps:i,thumbProps:a,countdownProps:o,moreVideosSlideProps:l,endscreenProps:c,clickForSoundProps:b,disableTitle:S,liveButtonEnabled:E,saveToQueueEnabled:w}=this.props;return r(s,null,r(_,o),!S&&r(f,{videoId:e}),r("button",{id:"video-ad-skip-".concat(e),"aria-label":"Skip ad in 15 seconds",class:"adSkip"},r("div",{class:"skipTxt"},"Skip Ad"),r("div",{class:"videoSkipIcon",id:"videoSkipIcon-".concat(e)}),r("div",{class:"videoSkipCountdown",id:"video-ad-countdown-".concat(e)}," ","in 15")),l&&r(h,n({videoId:e},l)),c&&r(d,c),r("div",{class:"video-share",id:"video-share-".concat(e),tabIndex:"-1",role:"menu","aria-expanded":"false","aria-labelledby":"video-share-b-".concat(e)}),r("div",{id:"flashContainer-".concat(e),class:"flashVideo"}),r("video",n({src:"",id:"videoplayer-".concat(e),style:{width:"100%",height:"100%",position:"absolute"},preload:"none"},t,{crossorigin:"anonymous",controls:!0}),"Your browser does not support HTML5 video."),r("div",{class:"video-play-overlay",id:"video-play-overlay-".concat(e)}),r(y,null),r("div",{class:"video-adContainer",id:"adContainer-".concat(e)},r("div",{class:"ad-top-background"}),r("div",{class:"ad-circle",id:"ad-circle-".concat(e)}),r("div",{class:"ad-text"})),r("div",{id:"video-controls-container-".concat(e),class:"video-controls-container"},i&&r(u,n({videoId:e},i))),w&&r(g,null),r("div",{id:"vrWrapper_".concat(e),class:"vrWrapper"}),b&&r(m,n({videoId:e},b)),E&&!S&&r(v,{videoId:e}),r(p,n({videoId:e},a)),r("div",{class:"video-pause-slate",id:"video-pause-slate-".concat(e)}))}}e.exports={renderUI:function(e,t,i){c(e);const n=document.createElement("div");return n.classList.add("video-wrapper"),n.id="wrapper-".concat(i.videoId),e.appendChild(n),a(r(l,{store:t},r(b,i)),n)}}},function(e,t,i){e.exports=i(39)()},function(e,t,i){"use strict";var n=i(40);function r(){}function a(){}a.resetWarningCache=r,e.exports=function(){function e(e,t,i,r,a,o){if(o!==n){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var i={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:a,resetWarningCache:r};return i.PropTypes=i,i}},function(e,t,i){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(e,t,i){"use strict";
/** @license React v16.13.0
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n="function"==typeof Symbol&&Symbol.for,r=n?Symbol.for("react.element"):60103,a=n?Symbol.for("react.portal"):60106,o=n?Symbol.for("react.fragment"):60107,s=n?Symbol.for("react.strict_mode"):60108,l=n?Symbol.for("react.profiler"):60114,c=n?Symbol.for("react.provider"):60109,u=n?Symbol.for("react.context"):60110,h=n?Symbol.for("react.async_mode"):60111,d=n?Symbol.for("react.concurrent_mode"):60111,p=n?Symbol.for("react.forward_ref"):60112,f=n?Symbol.for("react.suspense"):60113,g=n?Symbol.for("react.suspense_list"):60120,_=n?Symbol.for("react.memo"):60115,m=n?Symbol.for("react.lazy"):60116,v=n?Symbol.for("react.block"):60121,y=n?Symbol.for("react.fundamental"):60117,b=n?Symbol.for("react.responder"):60118,S=n?Symbol.for("react.scope"):60119;function E(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case r:switch(e=e.type){case h:case d:case o:case l:case s:case f:return e;default:switch(e=e&&e.$$typeof){case u:case p:case m:case _:case c:return e;default:return t}}case a:return t}}}function w(e){return E(e)===d}t.AsyncMode=h,t.ConcurrentMode=d,t.ContextConsumer=u,t.ContextProvider=c,t.Element=r,t.ForwardRef=p,t.Fragment=o,t.Lazy=m,t.Memo=_,t.Portal=a,t.Profiler=l,t.StrictMode=s,t.Suspense=f,t.isAsyncMode=function(e){return w(e)||E(e)===h},t.isConcurrentMode=w,t.isContextConsumer=function(e){return E(e)===u},t.isContextProvider=function(e){return E(e)===c},t.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===r},t.isForwardRef=function(e){return E(e)===p},t.isFragment=function(e){return E(e)===o},t.isLazy=function(e){return E(e)===m},t.isMemo=function(e){return E(e)===_},t.isPortal=function(e){return E(e)===a},t.isProfiler=function(e){return E(e)===l},t.isStrictMode=function(e){return E(e)===s},t.isSuspense=function(e){return E(e)===f},t.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===o||e===d||e===l||e===s||e===f||e===g||"object"==typeof e&&null!==e&&(e.$$typeof===m||e.$$typeof===_||e.$$typeof===c||e.$$typeof===u||e.$$typeof===p||e.$$typeof===y||e.$$typeof===b||e.$$typeof===S||e.$$typeof===v)},t.typeOf=E},function(e,t,i){function n(){return(n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e}).apply(this,arguments)}const{h:r,Component:a}=i(1),{connect:o}=i(2),s=i(43),l=i(46),c=i(49),u=i(50),h=i(53),d=i(54),p=i(58),f=i(59),{displayName:g}=i(11);const _=o((function(e){return{isControlsVisible:e.isControlsVisible,videoData:e.videoData,isAdMode:e.isAdMode,isPlaying:e.isPlaying,isVolumeControlVisible:e.isVolumeControlVisible,isClickForSoundVisible:e.isClickForSoundVisible,isClosedCaptionsVisible:e.isClosedCaptionsVisible,isSharescreenVisible:e.isSharescreenVisible}}))(class extends a{componentDidMount(){document.getElementById("video-cc-".concat(this.props.videoId)).innerHTML=p,document.getElementById("video-share-b-".concat(this.props.videoId)).innerHTML=f}componentDidUpdate(){}render(){const{isMobile:e,videoData:t,isAdMode:i}=this.props,a="live"===t.state||"flive"===t.state||i,o={isMobile:e,videoId:this.props.videoId,onSeek:this.props.onSeek,showControls:this.props.showControls,enableScrubPreview:this.props.enableScrubPreview},p={onSaveChange:this.props.onSaveChange,saveApiPublication:this.props.saveApiPublication,saveApi:this.props.saveApi,guid:this.props.videoData.guid},f={videoId:this.props.videoId,onSetVolume:this.props.onSetVolume,onMuteUnMute:this.props.onMuteUnMute,onVolumeControlVisible:this.props.onVolumeControlVisible};return r("div",{className:"video-controls-background ".concat(this.props.isControlsVisible?"video-fade-in":"video-fade-out")},r("div",{className:"video-controls",id:"video-controls-".concat(this.props.videoId)},!a&&r(d,o),r(s,{onPlayPause:this.props.onPlayPause}),r(l,f),r(h,{videoId:this.props.videoId}),r("div",{class:"filler"}),r("div",{className:"captions-list",id:"captions-list-".concat(this.props.videoId),"data-space":"false"}),r("button",{className:"video-share-b f-r",id:"video-share-b-".concat(this.props.videoId),"data-space":"false","aria-label":"Sharing","aria-haspopup":"true","aria-controls":"video-share-".concat(this.props.videoId),type:"button"}),r("button",{className:"video-cc f-r",id:"video-cc-".concat(this.props.videoId),"data-space":"false","aria-label":"Captions","aria-pressed":this.props.isClosedCaptionsVisible,type:"button"}),this.props.saveToQueueEnabled&&r(u,n({},p,{"data-space":"false"})),r(c,{videoId:this.props.videoId,onToggleFullScreen:this.props.onToggleFullScreen,"data-space":"false"})))}});e.exports=_},function(e,t,i){const{h:n,Component:r,Fragment:a}=i(1),{connect:o}=i(2),{useRef:s}=i(3),l=i(10),c=i(6),u=i(44),h=i(45);const d=o((function(e){return{isPlaying:e.isPlaying,isAdPlaying:e.isAdPlaying,isAdMode:e.isAdMode,isPlaybackInitializing:e.isPlaybackInitializing,focusElement:e.focusElement,isBtnDisabled:e.isPlaybackInitializing||e.adInitState===c.STARTED||e.videoApiLoadState===c.STARTED||e.imaLoadState===c.STARTED||e.hlsJsLoadState===c.STARTED}}))(class extends r{constructor(e){super(e),this._pickIcon=this._pickIcon.bind(this),this._playButton=s(null)}componentDidUpdate(e,t){"play-button"==this.props.focusElement&&this.props.focusElement!==e.focusElement&&this._playButton&&this._playButton.current.focus()}_pickIcon(){const{isPlaying:e,isAdPlaying:t,isAdMode:i,isPlaybackInitializing:n}=this.props;return n?u:i?t?h:u:e?h:u}shouldComponentUpdate(e){return this.props.isPlaying!==e.isPlaying||this.props.isAdPlaying!==e.isAdPlaying||this.props.isAdMode!==e.isAdMode||this.props.isPlaybackInitializing!==e.isPlaybackInitializing||this.props.focusElement!==e.focusElement||this.props.isBtnDisabled!==e.isBtnDisabled}onClickEvent(e){this.props.isBtnDisabled||this.props.onPlayPause(e)}render(){const{onPlayPause:e,isBtnDisabled:t,focusElement:i,isPlaying:r}=this.props;return n(a,null,n("button",{ref:this._playButton,type:"button","aria-label":r?"Pause":"Play",onClick:e=>{this.onClickEvent(e)},className:l("f-l",{"disabled-btn":t}),dangerouslySetInnerHTML:{__html:this._pickIcon()}}),n("div",{class:"playback-status visually-hidden","aria-live":"polite"},r?"Playing":"Paused"))}});e.exports=d},function(e,t){e.exports='<svg width="16px" height="22px" viewBox="0 0 20 28" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>Play</title><desc>Created with sketchtool.</desc><g id="Icons" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="Icons/Play/Play" fill="#FFFFFF" fill-rule="nonzero"><polyline id="Play" points="0 2 0 26 20 13.4528 0 2"></polyline></g></g></svg>'},function(e,t){e.exports='<title>Pause</title><svg width="16px" height="22px" viewBox="0 0 20 28" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g id="Icons" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="Icons/Play/Pause" fill="#FFFFFF" fill-rule="nonzero"><path d="M0,25 L0,3 L6,3 L6,25 L0,25 Z M11,25 L11,3 L17,3 L17,25 L11,25 Z" id="Combined-Shape"></path></g></g></svg>'},function(e,t,i){const{h:n,Component:r}=i(1),{connect:a}=i(2),{useEffect:o,useState:s,useRef:l}=i(3),c=i(47),u=i(48),{StaticReadUsage:h}=i(17);const d=a((function(e){return{isMuted:e.isMuted,volume:e.volume}}))(e=>{const{videoId:t,isMuted:i,volume:r,onMuteUnMute:a,onSetVolume:h,onVolumeControlVisible:d}=e,p=i?u:c,[f,g]=s(0),_=l(null),m=e=>{d("focus"===e.type)},v=e=>{e.currentTarget.blur()};return o(()=>{var e=_.current.offsetWidth;0==e&&(e=80),g(Math.round(e*r))},[r]),n("div",{className:"video-volume f-l",id:"video-volume-".concat(t)},n("button",{className:"video-volume-g-videoplayer","aria-label":"Mute","aria-pressed":i,type:"button",id:"video-volume-g-".concat(t),"data-space":"false",dangerouslySetInnerHTML:{__html:p},onClick:a,onFocus:m,onBlur:m,onMouseLeave:v}),n("div",{className:"video-volume-slider",id:"video-volume-slider-".concat(t),ref:_,onMouseUp:e=>{let t=r,i=e.currentTarget.getBoundingClientRect();t=(e.pageX-i.left)/e.currentTarget.offsetWidth,h(t,!0)},onFocus:m,onBlur:m,onKeyDown:e=>{let t=r;"ArrowLeft"===e.key||"ArrowDown"===e.key?(e.stopPropagation(),t=e.shiftKey?r-.2:r-.1,h(t,!0)):"ArrowRight"!==e.key&&"ArrowUp"!==e.key||(e.stopPropagation(),t=e.shiftKey?r+.2:r+.1,h(t,!0))},onMouseLeave:v,"aria-label":"Volume up down","aria-valuenow":parseInt(100*r),"aria-valuetext":"Volume ".concat(parseInt(100*r),"%"),tabindex:"0",role:"slider","aria-valuemin":"0","aria-valuemax":"100"},n("div",{id:"video-volume-b-".concat(t),className:"video-volume-b"}),n("div",{id:"video-volume-v-".concat(t),style:{width:f+"px"},className:"video-volume-v"}),n("div",{id:"video-volume-h-".concat(t),style:{left:f+"px"},className:"video-volume-h"})))});e.exports=d},function(e,t){e.exports='<svg width="22px" height="22px" viewBox="0 0 28 28" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>Sound On</title><desc>Created with sketchtool.</desc><g id="Icons" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="Icons/Volume/Sound-On" fill="#FFFFFF" fill-rule="nonzero"><path d="M7.28905409,9.11111111 L14.0058039,3 L15.0900792,3 L15.0900792,25 L14.0058039,25 L7.28905409,18.8546667 L2.9711435,18.8546667 C2.70066473,18.8892622 2.43003539,18.7916893 2.24109317,18.5914537 C2.05215095,18.391218 1.96708083,18.1118307 2.01160781,17.8377778 L2.01160781,10.128 C1.96708083,9.85394708 2.05215095,9.57455976 2.24109317,9.37432412 C2.43003539,9.17408847 2.70066473,9.07651553 2.9711435,9.11111111 L7.28905409,9.11111111 Z M21.3784679,21.4376257 L21.6473569,21.0690761 C23.1764535,18.9732373 24,16.5399204 24,14 C24,11.4600796 23.1764535,9.02676274 21.6473569,6.93092392 L21.3784679,6.56237426 L22.8492845,5.26760137 L23.1738214,5.69974676 C25.0062579,8.1397748 26,11.0044256 26,14 C26,16.9955744 25.0062579,19.8602252 23.1738214,22.3002532 L22.8492845,22.7323986 L21.3784679,21.4376257 Z M17.704601,17.5721503 L17.9772048,17.1731776 C18.6483088,16.1909752 19,15.1126779 19,14 C19,12.8873221 18.6483088,11.8090248 17.9772048,10.8268224 L17.704601,10.4278497 L19.2389389,9.30076441 L19.5348499,9.70435344 C20.48979,11.0067833 21,12.4746927 21,14 C21,15.5253073 20.48979,16.9932167 19.5348499,18.2956466 L19.2389389,18.6992356 L17.704601,17.5721503 Z" id="Volume"></path></g></g></svg>'},function(e,t){e.exports='<svg width="22px" height="22px" viewBox="0 0 28 28" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>Mute</title><desc>Created with sketchtool.</desc><g id="Icons" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="Icons/Volume/Mute" fill="#FFFFFF" fill-rule="nonzero"><path d="M7.32880533,9.11111111 L14.0960366,3 L15.1884611,3 L15.1884611,25 L14.0960366,25 L7.32880533,18.8546667 L2.97844238,18.8546667 C2.70593076,18.8892622 2.43326743,18.7916893 2.24290517,18.5914537 C2.05254291,18.391218 1.96683342,18.1118307 2.01169505,17.8377778 L2.01169505,10.128 C1.96683342,9.85394708 2.05254291,9.57455976 2.24290517,9.37432412 C2.43326743,9.17408847 2.70593076,9.07651553 2.97844238,9.11111111 L7.32880533,9.11111111 Z M22.5676418,14 L25,16.4142136 L23.5751576,17.8284271 L21.1427994,15.4142136 L18.7104412,17.8284271 L17.2855987,16.4142136 L19.7179569,14 L17.2855987,11.5857864 L18.7104412,10.1715729 L21.1427994,12.5857864 L23.5751576,10.1715729 L25,11.5857864 L22.5676418,14 Z" id="Volume"></path></g></g></svg>'},function(e,t,i){const{h:n,Component:r}=i(1),{connect:a}=i(2);const o=a((function(e){return{isFullScreen:e.isFullScreen}}))(class extends r{shouldComponentUpdate(e){return this.props.isFullScreen!==e.isFullScreen}onKeyDown(e){" "===e.key&&(e.stopPropagation(),this.props.onToggleFullScreen())}render(){const{isFullScreen:e,onToggleFullScreen:t}=this.props,i=e?'<svg width="22px" height="22px" viewBox="0 0 28 28" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g id="Icons" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="Icons/Full-Screen/Active" fill="#FFFFFF" fill-rule="nonzero"><path d="M8.33333333,6.55555556 L11,3.88888889 L11,11 L3.88888889,11 L6.55555556,8.33333333 L3,4.77777778 L4.77777778,3 L8.33333333,6.55555556 Z M6.55555556,19.6666667 L3.88888889,17 L11,17 L11,24.1111111 L8.33333333,21.4444444 L4.77777778,25 L3,23.2222222 L6.55555556,19.6666667 Z M21.4444444,8.33333333 L24.1111111,11 L17,11 L17,3.88888889 L19.6666667,6.55555556 L23.2222222,3 L25,4.77777778 L21.4444444,8.33333333 Z M19.6666667,21.4444444 L17,24.1111111 L17,17 L24.1111111,17 L21.4444444,19.6666667 L25,23.2222222 L23.2222222,25 L19.6666667,21.4444444 Z" id="Full-Screen"></path></g></g></svg>':'<svg width="22px" height="22px" viewBox="0 0 28 28" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g id="Icons" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="Icons/Full-Screen/Inactive" fill="#FFFFFF" fill-rule="nonzero"><path d="M21.3333333,19.5555556 L24,16.8888889 L24,24 L16.8888889,24 L19.5555556,21.3333333 L16,17.7777778 L17.7777778,16 L21.3333333,19.5555556 Z M19.5555556,6.66666667 L16.8888889,4 L24,4 L24,11.1111111 L21.3333333,8.44444444 L17.7777778,12 L16,10.2222222 L19.5555556,6.66666667 Z M8.44444444,21.3333333 L11.1111111,24 L4,24 L4,16.8888889 L6.66666667,19.5555556 L10.2222222,16 L12,17.7777778 L8.44444444,21.3333333 Z M6.66666667,8.44444444 L4,11.1111111 L4,4 L11.1111111,4 L8.44444444,6.66666667 L12,10.2222222 L10.2222222,12 L6.66666667,8.44444444 Z" id="Full-Screen"></path></g></g></svg>';return n("button",{className:"video-fullscreen f-r",id:"video-fullscreen-".concat(this.props.videoId),"aria-pressed":e,"aria-label":"Fullscreen",dangerouslySetInnerHTML:{__html:i},onKeyDown:this.onKeyDown.bind(this),onClick:t})}});e.exports=o},function(e,t,i){const{h:n,Component:r}=i(1),{connect:a}=i(2),{isContentSaved:o,saveContent:s,deleteContent:l}=i(18),{showSavedModal:c,hideSavedModal:u}=i(7),h=i(51),d=i(52);const p=a((function(e){return{videoData:e.videoData,isPlaybackInitializing:e.isPlaybackInitializing}}),{showSavedModal:c})(class extends r{constructor(){super(),this.state={isSaved:null,isSaving:!1,isAvailable:!1,isLoaded:!1}}componentDidUpdate(e){e.videoData.guid!==this.props.videoData.guid&&this.setState({isAvailable:!1,isSaved:!1,isLoaded:!1,isSaved:!1}),this.props.isPlaybackInitializing&&!this.state.isLoaded&&(this.setState({isLoaded:!0}),o(this.props.videoData.guid,this.props.saveApiPublication).then(e=>{void 0===e?this.setState({isAvailable:!1,isSaved:!1}):this.setState({isAvailable:!0,isSaved:e})}).catch(e=>this.setState({isSaving:!1})))}saveToQueue(){this.state.isSaved||(this.setState({isSaved:!0,isSaving:!0}),s({contentId:this.props.videoData.guid,pub:this.props.saveApiPublication,contentType:"video"}).then(()=>{this.setState({isSaved:!0,isSaving:!1}),this.props.showSavedModal()}).catch(()=>this.setState({isSaving:!1})))}deleteFromQueue(){this.state.isSaved&&(this.setState({isSaved:!1,isSaving:!0}),l(this.props.videoData.guid,this.props.saveApiPublication).then(()=>this.setState({isSaved:!1,isSaving:!1})).catch(()=>this.setState({isSaving:!1})))}shouldComponentUpdate(e,t){return this.state.isSaved!==t.isSaved||this.props.isPlaybackInitializing!==e.isPlaybackInitializing||this.props.isAvailable!==e.isAvailable}handleClick(){this.state.isSaving||(this.props.onSaveChange(!this.state.isSaved),this.state.isSaved?this.deleteFromQueue():this.saveToQueue())}render(){return this.state.isAvailable?n("button",{className:"video-save-queue f-r",dangerouslySetInnerHTML:{__html:!0===this.state.isSaved?d:h},onClick:this.handleClick.bind(this)}):null}});e.exports=p},function(e,t){e.exports='<svg width="24" height="24" version="1.1" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:xlink="http://www.w3.org/1999/xlink"><metadata><rdf:RDF><cc:Work rdf:about><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"></dc><dc:title></dc></cc:Work></rdf:RDF></metadata><defs><path id="bookmark-stroke-medium-a" d="m16 2c1.1046 0 2 0.89543 2 2v18h-0.63893l-5.3518-3.7988-5.3391 3.7541h-0.67018v-17.955c0-1.1046 0.89543-2 2-2h8zm0 1h-8c-0.51284 0-0.93551 0.38604-0.99327 0.88338l-0.0067277 0.11662v16.5l5.012-3.5232 4.988 3.5402v-16.517c0-0.51284-0.38604-0.93551-0.88338-0.99327l-0.11662-0.0067277z"></path></defs><use fill="#ffffff" fill-rule="evenodd" xlink:href="#bookmark-stroke-medium-a"></use></svg>'},function(e,t){e.exports='<svg width="24" height="24" version="1.1" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:xlink="http://www.w3.org/1999/xlink"><metadata><rdf:RDF><cc:Work rdf:about><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"></dc><dc:title></dc></cc:Work></rdf:RDF></metadata><defs><path id="bookmark-filled-medium-a" d="m16 2c1.1046 0 2 0.89543 2 2v18h-0.63893l-5.3518-3.7988-5.3391 3.7541h-0.67018v-17.955c0-1.1046 0.89543-2 2-2h8z"></path></defs><use fill="#ffffff" fill-rule="evenodd" xlink:href="#bookmark-filled-medium-a"></use></svg>'},function(e,t,i){const{h:n}=i(1),{connect:r}=i(2),{gTimeFormat:a,removeZeros:o}=i(5);const s=r((function(e){return{currentPosition:e.currentPosition,duration:e.duration,isLive:"live"===e.videoData.state||"flive"===e.videoData.state,isVolumeControlVisible:e.isVolumeControlVisible}}))((function(e){let{videoId:t,currentPosition:i=0,duration:r=0,isLive:s,isVolumeControlVisible:l}=e;if(s)return n("div",{className:"video-time f-l",id:"video-time-".concat(t)},"LIVE");const c=o(a(i)),u=o(a(r)),h=l?"0":".8";return n("div",{className:"video-time f-l",id:"video-time-".concat(t),style:{opacity:h}},c,n("span",{style:{opacity:".5"}}," / "),u)}));e.exports=s},function(e,t,i){const{h:n,Fragment:r}=i(1),{useRef:a,useEffect:o,useReducer:s,useCallback:l,useState:c}=i(3),{useSelector:u}=i(2),{gTimeFormat:h,removeZeros:d}=i(5),p=i(10),f=i(55),g=i(57),_={isDragging:!1,showLoadedBar:!1,showPreview:!1,scrubBarWidth:0,mouseXCoord:0,loadedPercent:0},m="START_DRAG",v="END_DRAG",y="SHOW_LOADED_BAR",b="HIDE_LOADED_BAR",S="SHOW_PREVIEW",E="HIDE_PREVIEW",w="UPDATE_SCRUB_BAR_WIDTH",T="UPDATE_SCRUB_X_COORD",M=(e,t)=>Math.min(t/e*100,100);function A(e,t){switch(t.type){case m:return{...e,isDragging:!0};case v:return{...e,isDragging:!1};case y:return{...e,showLoadedBar:!0};case b:return{...e,showLoadedBar:!1};case S:return{...e,showPreview:!0};case E:return{...e,showPreview:!1};case w:return{...e,scrubBarWidth:t.width,loadedPercent:M(t.width,e.mouseXCoord)};case T:return{...e,mouseXCoord:Math.min(Math.max(t.xCoord,0),e.scrubBarWidth),loadedPercent:M(e.scrubBarWidth,t.xCoord)};default:return e}}e.exports=e=>{const t=u(e=>e.currentPosition),i=u(e=>e.duration),M=u(e=>e.width),[C,x]=s(A,_),[I,P]=c(!1),L=a(null),{isMobile:D,videoId:R,onSeek:k,showControls:O,enableScrubPreview:N}=e,F=l(e=>{var t;let{pageX:i,touches:n}=e;const r=null!=i?i:null==n||null===(t=n[0])||void 0===t?void 0:t.pageX;if(!r)return;const a=L.current,o=r-a.getBoundingClientRect().left;C.scrubBarWidth!==a.offsetWidth&&x({type:w,width:a.offsetWidth}),x({type:T,xCoord:o})},[C.scrubBarWidth]);o(()=>{const e=L.current,t=()=>{x({type:y}),x({type:S})};return e.addEventListener("mouseover",t),()=>e.removeEventListener("mouseover",t)},[]),o(()=>{const e=L.current,t=()=>{x({type:b}),x({type:E})};return e.addEventListener("mouseout",t),()=>e.removeEventListener("mouseout",t)},[]),o(()=>{const e=L.current,t=()=>x({type:m});return e.addEventListener("mousedown",t),D&&e.addEventListener("touchstart",t),()=>{e.removeEventListener("mousedown",t),D&&e.removeEventListener("touchstart",t)}},[D]),o(()=>{if(!D)return;const e=L.current,t=e=>{O(),C.isDragging||x({type:m}),F(e)};return e.addEventListener("touchmove",t),()=>e.removeEventListener("touchmove",t)},[D,C.isDragging,O,F]),o(()=>(window.addEventListener("mousemove",F),()=>window.removeEventListener("mousemove",F)),[F]),o(()=>{const e=L.current,t=()=>{C.isDragging&&k&&k(C.loadedPercent/100),x({type:v})};return window.addEventListener("mouseup",t),D&&e.addEventListener("touchend",t),()=>{window.removeEventListener("mouseup",t),D&&e.removeEventListener("touchend",t)}},[C.isDragging,C.loadedPercent,k,D]);const V=e=>{const n=d(h(t)),r=d(h(i));L.current.setAttribute("aria-valuetext",n+" / "+r),L.current.setAttribute("aria-valuenow",n)},B=C.isDragging?C.loadedPercent:t/i*100;return n(r,null,N&&!D&&M>=400&&n(f,{scrubBarWidth:C.scrubBarWidth,mouseXCoord:C.mouseXCoord,show:C.showPreview||C.isDragging}),n("div",{ref:L,className:p(g.scrubBar,{[g.mobile]:D}),"aria-valuetext":"",tabIndex:0,"aria-label":"video timeline",role:"slider","aria-valuemin":"0","aria-valuemax":i,onFocus:V,onMouseEnter:V},n("div",{className:g.adMarkerContainer,id:"video-ad-marker-container-".concat(R)}),n("div",{className:g.scrubPadding}),C.showLoadedBar&&n("div",{className:g.scrubLoaded,style:{width:"".concat(C.loadedPercent,"%")}}),n("div",{className:g.scrubBackground}),n("div",{className:g.scrubProgress,style:{width:"".concat(B,"%")}},n("span",{className:g.dot}))))}},function(e,t,i){const{h:n}=i(1),{useRef:r,useEffect:a,useState:o}=i(3),{useSelector:s}=i(2),l=i(10),{removeZeros:c,gTimeFormat:u}=i(5),h=i(56);e.exports=e=>{const t=s(e=>{var t;return null===(t=e.videoData)||void 0===t?void 0:t.thumbstripURL}),i=s(e=>e.duration),d=s(e=>e.width),p=s(e=>e.isAdMode),f=function(){const e=s(e=>{var t;return parseInt(null===(t=e.videoData)||void 0===t?void 0:t.doctypeID,10)});return 134===e?9/16:144===e?1:16/9}(),[g,_]=o(!1),m=r(null),v=r(null);if(a(()=>_(!1),[t]),!t)return null;const{mouseXCoord:y,scrubBarWidth:b,show:S}=e,E=function(e,t,i){if(!i)return 0;let n=t-i.offsetWidth/2+20;n=n<0?0:n;const r=e-i.offsetWidth;return n>r?r:n}(d,y,m.current),w=Math.min(y/b,1),T={left:"".concat(E,"px")},M={};if(g){const{naturalWidth:e,naturalHeight:t}=v.current,i=t/2,n=i*f;M.left="".concat(Math.round(100*w)*-n,"px"),M.width="".concat(e/2,"px"),M.height="".concat(i,"px"),T.width="".concat(n,"px"),T.height="".concat(i,"px")}const A=!g||!S||p;return n("div",{onselectstart:"return false;",ref:m,className:l(h.preview,{[h.hide]:A}),style:T},n("span",{className:h.time},c(u(w*i))),n("img",{ref:v,className:h.img,src:t,onLoad:()=>_(!0),style:M}))}},function(e,t,i){e.exports={preview:"styles__preview_2nS_r1y42rPCYXSm3Dk6qY",hide:"styles__hide_qzdw3-CF5x1fAAZNbJvVb",time:"styles__time_X3WOoR-A7hh34442Fwris",img:"styles__img_2rEDBJuX6st5F3hCxhZ_Og"}},function(e,t,i){e.exports={scrubBar:"styles__scrubBar_2SmbWUCzg3R7MnjhBWuFJ8",mobile:"styles__mobile_343QZe_YU0jEvjdFU8aWrD",scrubBackground:"styles__scrubBackground_39WBXpRiaOiOKB9Y6QGmuf",scrubPadding:"styles__scrubPadding_nJS-HnfwjM3JloRoiOPSB",scrubProgress:"styles__scrubProgress_3-29CANQyOYYdFkSGbGvkt",dot:"styles__dot_dUP_ksR6S-rypXCDfKE4F",scrubLoaded:"styles__scrubLoaded_Fnwh6GSDzGHJx2PcKL7Uk",adMarkerContainer:"styles__adMarkerContainer_NbCndWtAjjtP4dnbRGNo0"}},function(e,t){e.exports='<svg width="22px" height="22px" viewBox="0 0 28 28" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>Closed Captions Inactive</title><desc>Created with sketchtool.</desc><g id="Icons" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="Icons/CC/Inactive" fill="#FFFFFF" fill-rule="nonzero"><path d="M26,4 L2,4 L2,22 L7,22 L7,26 L12,22 L26,22 L26,4 Z M24,20 L4,20 L4,6 L24,6 L24,20 Z M20,17 C19.77858,17 19.4452467,17 19,17 C16,17 15,15 15,13 C15,11 16,9 19,9 C19.5054152,9 19.8387485,9 20,9 L20,11 C19,11 17,11 17,13 C17,15 19,15 20,15 L20,17 Z M13,17 C12.77858,17 12.4452467,17 12,17 C9,17 8,15 8,13 C8,11 9,9 12,9 C12.5054152,9 12.8387485,9 13,9 L13,11 C12,11 10,11 10,13 C10,15 12,15 13,15 L13,17 Z" id="CC"></path></g></g></svg>'},function(e,t){e.exports='<svg width="22px" height="22px" viewBox="0 0 28 28" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>Share</title><desc>Created with sketchtool.</desc><g id="Icons" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="Icons/Share" fill="#FFFFFF" fill-rule="nonzero"><path d="M16,4 L16,9 L13,9 C9,9 3,12.3958048 3,22 C3,22 4,22 4,22 C4,22 5.45666691,16 11,16 L16,16 L16,22 L26,13 L16,4 Z" id="Path"></path></g></g></svg>'},function(e,t,i){e.exports={modal:"styles__modal_2R1Yuwcs6Div8q2nH9vsGH",fadeOut:"styles__fadeOut_1hQV739Kjrr_eNk6KLGOPF",closeBtn:"styles__closeBtn_1Fyo4cC4u9TQu-8KxlZu6F"}},function(e,t){e.exports='<svg width="21px" height="21px" viewBox="0 0 21 21" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>Close</title><desc>Created with sketchtool.</desc><g id="Icons" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" fill-opacity="0.7"><g id="close" fill="#FFFFFF"><polygon id="Path" points="10.5 8.75 19.25 0 21 1.75 12.25 10.5 21 19.25 19.25 21 10.5 12.25 1.75 21 0 19.25 8.75 10.5 0 1.75 1.75 1.51121399e-15"></polygon></g></g></svg>'},function(e,t,i){const{h:n,Component:r}=i(1),{connect:a}=i(2),{showMoreVideosSlide:o,hideMoreVideosSlide:s}=i(7),l=i(5),c=i(11),u=i(63);class h extends r{constructor(e){super(e),this.state={recommendations:null},this._hasShown=!1,this._isLoading=!1,this._positionShown=null,this._setThumbnailRef=this._setThumbnailRef.bind(this),this._handleSlideClick=this._handleSlideClick.bind(this),this._hideSlide=this._hideSlide.bind(this)}_setThumbnailRef(e){this._thumbnailRef=e}_hideSlide(){this.props.hideMoreVideosSlide(),this._positionShown=null}_handleSlideClick(){this._hideSlide(),this.props.playVideo(this.state.recommendations.guid)}_fetchRecommendedVideo(){if(this.props.hasCMPConsent){let e="".concat(this.props.videoApiUrl,"find_all_videos.asp?type=recommended&count=1&userid=").concat(l.getCookie("vidoraUserId"),"&fields=guid,thumbnailList,name");return l.fetchFromApi(e).then(e=>e[0])}return url="".concat(this.props.videoApiUrl,"find_all_videos.asp?type=playlist&query=Most%20Viewed%20WSJ%20Videos&count=20&fields=guid,thumbnailList,name"),l.fetchFromApi(url).then(e=>e[Math.floor(Math.random()*e.length)])}_getThumbnail(){if(!this._thumbnailRef)return"";const e=this._thumbnailRef.offsetWidth;return l.pickBestThumbnail(this.state.recommendations.thumbnailList,e,.5625*e)}componentDidUpdate(e){var t,i;const{width:n,isMoreVideosSlideVisible:r,currentPosition:a,duration:o,showMoreVideosSlide:s,isEndscreenVisible:l,videoData:c}=this.props;if(n<485||"vod"!==(null==c?void 0:c.state)||"469"===(null==c?void 0:c.doctypeID)&&0===(null!==(t=null==c||null===(i=c.column)||void 0===i?void 0:i.length)&&void 0!==t?t:0)||isNaN(a)||isNaN(o)||0===o)return void(r&&this._hideSlide());const{guid:u}=this.props.videoData;if(e.videoData.guid!==u&&this._hasShown)return r&&this._hideSlide(),this._hasShown=!1,void(this._positionShown=null);if(!(a/o>=.6)||l||r||this._hasShown||this._isLoading)null!==this._positionShown&&(this._positionShown+7<=a||l)&&this._hideSlide();else{this._isLoading=!0;const{onSlideShowing:e}=this.props;this._fetchRecommendedVideo().then(t=>{this._hasShown=!0,this._isLoading=!1,t&&(this.setState({recommendations:t}),s(),e(),this._positionShown=a)}).catch(e=>{console.error("Failed to fetch recommendations",e),this._hasShown=!0,this._isLoading=!1})}}render(){var e,t,i,r;const{isMoreVideosSlideVisible:a}=this.props;let{recommendations:o}=this.state;o||(o={});const s=a&&this.props.width>=485&&"vod"===(null===(e=this.props.videoData)||void 0===e?void 0:e.state)&&("469"!==(null===(t=this.props.videoData)||void 0===t?void 0:t.doctypeID)||(null===(i=this.props.videoData)||void 0===i||null===(r=i.column)||void 0===r?void 0:r.length)>0),l=[u.slide];return s&&l.push(u.slideIn),n(c,{className:l.join(" "),isVisible:s,onClick:this._handleSlideClick,onClose:this._hideSlide},o.thumbnailList&&n("img",{className:u.thumbnail,src:this._getThumbnail(),ref:this._setThumbnailRef}),n("div",{className:u.textContainer},n("div",{className:u.headerText},"You may also like"),n("div",{className:u.videoTitle},o.name)))}}const d=a((function(e){return{currentPosition:e.currentPosition,videoData:e.videoData,duration:e.duration,isMoreVideosSlideVisible:e.isMoreVideosSlideVisible,width:e.width,isEndscreenVisible:e.isEndscreenVisible}}),{showMoreVideosSlide:o,hideMoreVideosSlide:s})(h);e.exports={MoreVideosSlide:d,UnconnectedMoreVideosSlide:h}},function(e,t,i){e.exports={slide:"styles__slide_3F5t-YABxZaZsuoa9SXzP1",slideIn:"styles__slideIn_yI9dRsGQl6Kqx9TQ4MZ0v",thumbnail:"styles__thumbnail_1jNdgKuyHijlqaWVZxfQ2l",textContainer:"styles__textContainer_1PIpaSWl4SBHiFamj1SUf-",headerText:"styles__headerText_3DlP-XHOkfVdJVOwSKvO7v",videoTitle:"styles__videoTitle_3IAORCFNrdSYW86-9lRxXX"}},function(e,t,i){function n(){return(n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e}).apply(this,arguments)}const{h:r,Component:a}=i(1),{connect:o}=i(2),{showEndscreen:s,hideEndscreen:l,replacePlaylist:c}=i(7),u=i(5),h=i(11),d=i(65),p=i(19);class f extends a{constructor(e){super(e),this.state={visiblePlaylist:[]},this._isLoading=!1,this._hasShown=!1,this._hadError=!1,this._hideTime=-1,this._handleFadeOut=this._handleFadeOut.bind(this)}_syncVisiblePlaylist(){this.state.visiblePlaylist!==this.props.playlist&&this.props.playlist.length>0&&this.setState({visiblePlaylist:this.props.playlist})}_handleFadeOut(){this._syncVisiblePlaylist()}componentDidUpdate(e){var t,i;const{currentPosition:n,duration:r,videoData:a}=this.props;if(isNaN(n)||isNaN(r)||0===r||"vod"!==(null==a?void 0:a.state)||"469"===(null==a?void 0:a.doctypeID)&&0===(null!==(t=null==a||null===(i=a.column)||void 0===i?void 0:i.length)&&void 0!==t?t:0))return;const{isEndscreenVisible:o,hideEndscreen:s}=this.props;if(e.videoData.guid!==a.guid)return o&&(this._hideTime=Date.now(),s()),void(this._hasShown=!1);const{showEndscreen:l,replacePlaylist:c,playlist:h,onEndsceenShown:d}=this.props;if(!o&&!this._isLoading&&0===h.length&&Math.floor(n)>Math.max(Math.floor(r)-20,0)&&!this._hadError){this._isLoading=!0;const{videoApiUrl:e,fields:t,playerSettings:i}=this.props;u.getNewPlaylist(e,i,a,t).then(e=>{var t;!e||1===e.length&&(null==e||null===(t=e[0])||void 0===t?void 0:t.guid)===a.guid?(this._hadError=!0,this._isLoading=!1):(c(e),this.setState({visiblePlaylist:e},()=>this._isLoading=!1))}).catch(e=>{console.error("Failed to load playlist for endscreen",e),this._isLoading=!1})}!o&&!this._isLoading&&h.length>0&&!this._hasShown&&Math.floor(n)>Math.max(Math.floor(r)-7,0)&&Date.now()-2e3>this._hideTime&&(d(),this._syncVisiblePlaylist(),this._hasShown=!0,l())}render(){var e;const t=[p.container],{isEndscreenVisible:i,isControlsVisible:a,width:o,videoData:s,duration:l}=this.props,c=i&&l>0&&"vod"===(null==s?void 0:s.state)&&("469"!==(null==s?void 0:s.doctypeID)||(null==s||null===(e=s.column)||void 0===e?void 0:e.length)>0);c&&t.push(p.fadeIn),a&&t.push(p.controlsVisible),o<440&&t.push(p.fullscreen);const u={className:t.join(" "),isVisible:c},{currentBreakpoint:f,currentPosition:g,playVideo:_}=this.props,m=this.state.visiblePlaylist;if(null===m)return;const v="16U"===f||"full"===f,y={currentBreakpoint:f};return r(h,n({tabIndex:i?0:-1,style:{display:i?"block":"none"}},u,{onFadeOut:this._handleFadeOut,onClose:this.props.hideEndscreen}),r("div",{className:p.headerText},"Up Next"),r(d,n({videoData:m[0],showCountdown:i,duration:l,currentPosition:g,onClick:()=>_(m[0]),tabIndex:0},y)),v&&r(d,n({videoData:m[1],onClick:()=>_(m[1])},y)))}}const g=o((function(e){return{width:e.width,currentPosition:e.currentPosition,videoData:e.videoData,duration:e.duration,isEndscreenVisible:e.isEndscreenVisible,currentBreakpoint:e.currentBreakpoint,isControlsVisible:e.isControlsVisible,playlist:e.playlist}}),{showEndscreen:s,hideEndscreen:l,replacePlaylist:c})(f);e.exports={Endscreen:g,UnconnectedEndscreen:f}},function(e,t,i){const{h:n,Component:r}=i(1),a=i(5),o=i(19);class s extends r{constructor(e){super(e)}_getThumbnail(){const{videoData:e,currentBreakpoint:t}=this.props;let i=220;return"8U"===t?i=150:"4U"===t?i=120:"tiny"===t&&(i=70),a.pickBestThumbnail(e.thumbnailList,i,.5625*i)}_renderCountdown(){const{duration:e,currentPosition:t}=this.props,i=Math.max(Math.floor(e)-Math.floor(t),0),r=1===i?"second":"seconds";return n("div",{className:o.countdownText},"Starting in ",n("strong",null,i)," ",r)}render(){const{videoData:e,showCountdown:t}=this.props;return e?n("div",{className:o.row,onClick:this.props.onClick,tabIndex:0,onKeyUp:e=>{"Enter"===e.key&&this.props.onClick()}},e.thumbnailList&&n("img",{className:o.thumbnail,src:this._getThumbnail(),alt:e.name}),n("div",{className:o.textContainer},n("div",{className:o.videoTitle},e.name),t&&this._renderCountdown())):null}}s.defaultProps={showCountdown:!1,onClick(){}},e.exports=s},function(e,t,i){const{h:n,Component:r}=i(1),{connect:a}=i(2),o=i(67),{gTimeFormat:s,createMark:l,pickBestThumbnail:c}=i(5),u=i(68),h=i(69),d=i(70),p=i(71),f=i(72),g=i(73),_=()=>l("playerDisplayed");const m=a((function(e){return{width:e.width,height:e.height,isThumbnailVisible:e.isThumbnailVisible,videoData:e.videoData}}))(class extends r{constructor(e){super(e);let t={};switch(e.layout){case"foe":t=h;break;case"wsj-article":t=d;break;case"mobile":t=p;break;case"barrons-next":t=g;break;case"barrons-video-center":t=f}this.theme=Object.assign({},u,t),this.state={thumbSrc:this._getThumbnail()},this._updateThumbSrc=o(()=>{this.setState({thumbSrc:this._getThumbnail()})},350)}componentDidUpdate(e,t){e.width===this.props.width&&e.height===this.props.height&&this.state.thumbSrc||this._updateThumbSrc()}_renderGradient(e){const{layout:t,suppressHeadline:i}=this.props;return"mobile"!==t&&"wsj-article"!==t&&"foe"!==t||"foe"===t&&i?null:n("div",{className:e?this.theme.gradientTop:this.theme.gradient})}_renderHeadline(){const{suppressHeadline:e,layout:t,width:i,videoId:r}=this.props;if(e||"mobile"===t||"wsj-article"===t)return null;const a={};i<=470&&(a.fontSize="15px",a.lineHeight="22px");const o="barrons-next"===t?"h4":"span";return n("div",{className:this.theme.videoThumbText,style:a},n(o,{className:this.theme.videoTitle,id:"video-thumb-text-".concat(r)},this.props.videoData.name),n("span",{id:"video-thumb-text-hidden-".concat(r),className:this.theme.visuallyHidden},"Play video: ".concat(this.props.videoData.name)))}_renderFlashLine(){const{layout:e,videoData:t,showFlashLine:i}=this.props;let r="";if("mobile"===e&&"string"==typeof t.seriesName)r=t.seriesName;else if("wsj-article"===e&&"string"==typeof t.name)r=t.name;else{if(!i||"string"!=typeof t.seriesName)return null;r="Video | ".concat(t.seriesName)}return n("div",{className:this.theme.videoThumbFlashLine},r)}_renderCTA(){const{layout:e,videoData:t}=this.props;if("wsj-article"===e){let e=null;return"live"!==t.state&&(e=n("span",null,"| ",s(t.duration))),n("div",{className:this.theme.videoThumbCta},"Play Video ",e)}return"mobile"===e?n("div",{className:this.theme.videoThumbCta},"Play Video"):"foe"===e&&"string"==typeof t.seriesName?n("div",{className:this.theme.videoThumbCta},t.seriesName):null}_getThumbnail(){if(this.props.thumbnailOverride)return this.props.thumbnailOverride;const{videoData:e,width:t,height:i}=this.props;return e.thumbnailImageManager?e.thumbnailImageManager+"?width="+t:e.thumbnailList?c(e.thumbnailList,t,i):e.thumbnailURL}render(){const{thumbSrc:e}=this.state;if(!this.props.isThumbnailVisible)return null;const{videoId:t,videoData:i,onClick:r,graphics:a}=this.props,o=this._renderFlashLine(),s=null!==o;return n("div",{class:"video-thumb",id:"video-thumb-".concat(t)},n("div",{className:this.theme.vidThumb},n("div",{className:this.theme.videoThumbContent,onKeyDown:e=>{" "===e.key&&(e.stopPropagation(),e.preventDefault(),r())},onClick:()=>{r()}},this._renderGradient(s),n("button",{"aria-label":"Play video",className:this.theme.videoHint,dangerouslySetInnerHTML:{__html:a["play-overlay"]}}),void 0!==e&&n("img",{className:this.theme.videoThumbImg,alt:i.name,src:e,onLoad:_}),this._renderHeadline(),o,this._renderCTA())))}});e.exports=m},function(e,t,i){(function(t){var i=/^\s+|\s+$/g,n=/^[-+]0x[0-9a-f]+$/i,r=/^0b[01]+$/i,a=/^0o[0-7]+$/i,o=parseInt,s="object"==typeof t&&t&&t.Object===Object&&t,l="object"==typeof self&&self&&self.Object===Object&&self,c=s||l||Function("return this")(),u=Object.prototype.toString,h=Math.max,d=Math.min,p=function(){return c.Date.now()};function f(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function g(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==u.call(e)}(e))return NaN;if(f(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=f(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(i,"");var s=r.test(e);return s||a.test(e)?o(e.slice(2),s?2:8):n.test(e)?NaN:+e}e.exports=function(e,t,i){var n,r,a,o,s,l,c=0,u=!1,_=!1,m=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function v(t){var i=n,a=r;return n=r=void 0,c=t,o=e.apply(a,i)}function y(e){return c=e,s=setTimeout(S,t),u?v(e):o}function b(e){var i=e-l;return void 0===l||i>=t||i<0||_&&e-c>=a}function S(){var e=p();if(b(e))return E(e);s=setTimeout(S,function(e){var i=t-(e-l);return _?d(i,a-(e-c)):i}(e))}function E(e){return s=void 0,m&&n?v(e):(n=r=void 0,o)}function w(){var e=p(),i=b(e);if(n=arguments,r=this,l=e,i){if(void 0===s)return y(l);if(_)return s=setTimeout(S,t),v(l)}return void 0===s&&(s=setTimeout(S,t)),o}return t=g(t)||0,f(i)&&(u=!!i.leading,a=(_="maxWait"in i)?h(g(i.maxWait)||0,t):a,m="trailing"in i?!!i.trailing:m),w.cancel=function(){void 0!==s&&clearTimeout(s),c=0,n=l=r=s=void 0},w.flush=function(){return void 0===s?o:E(p())},w}}).call(this,i(9))},function(e,t,i){e.exports={vidThumb:"base__vidThumb_1ClPgLDBgLr-7YsvMmn-sY",videoThumbContent:"base__videoThumbContent_3Kb4OYgEfuuLpg9LXT8b69",videoHint:"base__videoHint_Rz0yg9Tt-lxY16-R1Fxe5",videoThumbImg:"base__videoThumbImg_1clHXjbP_aRS55gpoYwjW2",videoThumbFlashLine:"base__videoThumbFlashLine_1U6xOGEqqoiEJu5jHM1hAQ",videoThumbText:"base__videoThumbText_1PRf5FdWQbSwLGFnet8uCa",videoTitle:"base__videoTitle_3REXSZqJQDsfabpaaSWGAf",visuallyHidden:"base__visuallyHidden_3CsNSwT_twvw15G9ehNQr4"}},function(e,t,i){e.exports={videoThumbContent:"foe__videoThumbContent_1nsyi53vKav96Y_EOWeCh6",videoHint:"foe__videoHint_1pWcN5AqwvaiuDjVp3WHny",gradient:"foe__gradient_3ecTM0uXyHmdCPRTWc8WqI",gradientTop:"foe__gradientTop_2qvfusi-Yvew7TBOGOJHIh",videoThumbText:"foe__videoThumbText_1nTI7-QQIE1mK-XLNH-vg5",videoTitle:"foe__videoTitle_2jEeQEkNXmVTj4HvVdvp-0",videoThumbCta:"foe__videoThumbCta_25WYND_l7g3TzAw7xW301m"}},function(e,t,i){e.exports={gradient:"wsj-article__gradient_CRbo3WFYc_EgONG4rBQgu mobile__gradient_3T-q4CQI-g0ojJ-QWlMsua",gradientTop:"wsj-article__gradientTop_3cj0JstF817A2AnHJuM-tg mobile__gradientTop_19Xt6M_W5rjnbjO8IINtz8",videoThumbContent:"wsj-article__videoThumbContent_YML1WOJl1YMu_KdQvoqh base__videoThumbContent_3Kb4OYgEfuuLpg9LXT8b69",videoHint:"wsj-article__videoHint_g5jkq8msD-toSrHk8KvsI mobile__videoHint_2B69kcP3mOOD7rnnxPL8YH",videoThumbFlashLine:"wsj-article__videoThumbFlashLine_31No8cYhZm2FHmS3cO0pNy",videoThumbCta:"wsj-article__videoThumbCta_wbOurVY-DRWfP7X86qieu mobile__videoThumbCta_3NPpbP_vRPxMIYRzd2YiJa"}},function(e,t,i){e.exports={gradient:"mobile__gradient_3T-q4CQI-g0ojJ-QWlMsua",gradientTop:"mobile__gradientTop_19Xt6M_W5rjnbjO8IINtz8",videoThumbContent:"mobile__videoThumbContent_3g5J0Hg4Oo3tQLJYvv3tTh base__videoThumbContent_3Kb4OYgEfuuLpg9LXT8b69",videoHint:"mobile__videoHint_2B69kcP3mOOD7rnnxPL8YH",videoThumbFlashLine:"mobile__videoThumbFlashLine_cbyksiYAy5t9QkuHg6MfR",videoThumbCta:"mobile__videoThumbCta_3NPpbP_vRPxMIYRzd2YiJa"}},function(e,t,i){},function(e,t,i){e.exports={videoTitle:"barrons-next__videoTitle_1h-3wF_UqUoLdbmVpHofrN"}},function(e,t,i){const{h:n,Component:r}=i(1),{connect:a}=i(2),o=i(75);const s=a((function(e){return{isControlsVisible:e.isControlsVisible,name:e.videoData.name,isCountdownVisible:e.isCountdownVisible,isAdMode:e.isAdMode,isLive:"live"==e.videoData.state}}))(class extends r{render(){const{isControlsVisible:e,isCountdownVisible:t,isAdMode:i,isLive:r}=this.props,a=[o.videoTitleContainer,!e||t||i?"video-fade-out":"video-fade-in"];return n("div",{id:"video-title-".concat(this.props.videoId),className:a.join(" ")},n("div",{className:o.videoTitle},this.props.name))}});e.exports=s},function(e,t,i){e.exports={videoTitleContainer:"styles__videoTitleContainer_2N-qWhjdmXNqdA0OpqWVr_",videoTitle:"styles__videoTitle_25kJSwCFvWN3BOOrBzhlDq"}},function(e,t,i){function n(){return(n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e}).apply(this,arguments)}const{h:r,Component:a}=i(1),o=i(11),{connect:s}=i(2),l=i(77),{hideSavedModal:c}=i(7);const u=s((function(e){return{width:e.width,isSavedQueueModalVisible:e.isSavedQueueModalVisible}}),{hideSavedModal:c})(class extends a{constructor(e){super(e),this._hasShown=!1,this._hideSavedModal=this._hideSavedModal.bind(this),this._savedContentPage="https://www.wsj.com/user/personalization/saved-content"}_hideSavedModal(){this.props.hideSavedModal()}shouldComponentUpdate(e){return this.props.isSavedQueueModalVisible!==e.isSavedQueueModalVisible}componentDidUpdate(e){const{hideSavedModal:t,isSavedQueueModalVisible:i}=this.props;!i&&!this._hasShown&&(this._hasShown=!0)}render(){if(!this.props.isSavedQueueModalVisible)return null;const{isSavedQueueModalVisible:e,width:t}=this.props,i=[l.videoTitleContainer,e?"video-fade-in":"video-fade-out"],a=e;a&&i.push(l.fadeIn);const s={className:l.videoSavedQueueModalContainer,hideCloseButton:!0,hideTimer:5e3,isVisible:a};return r(o,n({},s,{onClose:this._hideSavedModal}),r("div",{className:l.videoSavedQueueModalText},"Added ",t>450?"to your saved content":"to saved"),r("a",{target:"_blank",href:this._savedContentPage},r("button",{className:l.videoSavedQueueModalButton},"View saved content")))}});e.exports=u},function(e,t,i){e.exports={videoSavedQueueModalContainer:"styles__videoSavedQueueModalContainer_1gfJyAvga7sj0VMg26BPPw",videoSavedQueueModalText:"styles__videoSavedQueueModalText_qNgvU3syGaAOx5RYtAtXn",videoSavedQueueModalButton:"styles__videoSavedQueueModalButton_13toxT1j9KEX4PTEImAe6r"}},function(e,t,i){const{h:n,Component:r}=i(1),{connect:a}=i(2),{showCountdown:o,hideCountdown:s}=i(7),l=i(79),{pickBestThumbnail:c,fetchServerTime:u}=i(5),h=e=>e.toString().padStart(2,"0"),d=e=>n("div",{className:l.countdownSquare},n("div",{className:l.squareNumber},e.value),n("div",{className:l.squareTime},e.time));const p=a((function(e){var t;return{videoData:e.videoData,width:e.width,height:e.height,isQAEvent:null===(t=e.videoData)||void 0===t?void 0:t.isQAEvent,isCountdownVisible:e.isCountdownVisible}}),{showCountdown:o,hideCountdown:s})(class extends r{constructor(e){super(e),this.state={timerStarted:!1,secondsRemaining:null,endCountdown:!1,serverTime:null},this.interval=null}componentDidMount(){this.props.videoData&&u(this.props.videoApiUrl+"time").then(e=>{this.setState({serverTime:e.time})}).catch(e=>{console.error("Failed to fetch server time",e),this.setState({serverTime:Date.now()})})}componentDidUpdate(e){if(null!==this.state.serverTime&&!this.state.timerStarted&&this.props.videoData&&this.props.videoData.formattedCreationDate&&"future"===this.props.videoData.state){const e=new Date(this.state.serverTime),t=new Date(this.props.videoData.iso8601CreationDate),i=t.getTime()-e.getTime(),n=Date.now()-e.getTime();if(i>0){const e=()=>(t.getTime()-Date.now()+n)/1e3;this.setState({serverTime:null,secondsRemaining:e(),timerStarted:!0}),this.interval=setInterval(()=>this.setState({secondsRemaining:e()}),250),this.props.showCountdown()}}this.state.timerStarted&&this.state.secondsRemaining<1&&this.props.isCountdownVisible&&(clearInterval(this.interval),this.props.hideCountdown(),this.props.onCountdownComplete())}componentWillUnmount(){clearInterval(this.interval)}_getThumbnail(){if(this.props.thumbnailOverride)return this.props.thumbnailOverride;const{videoData:e,width:t,height:i}=this.props;return e.thumbnailImageManager?e.thumbnailImageManager+"?width="+t:e.thumbnailList?c(e.thumbnailList,t,i):e.thumbnailURL}render(){if(!this.props.isCountdownVisible||"future"!==this.props.videoData.state)return null;let e,t,i,r;return this.state.secondsRemaining&&(r=parseInt(this.state.secondsRemaining,10),e=Math.floor(r/86400),e>0&&(r-=3600*e*24),t=Math.floor(r/3600),r-=3600*t,i=Math.floor(r/60),r-=60*i),n("div",{className:l.countdownContainer},n("div",{style:{backgroundImage:"linear-gradient(-180deg, rgba(0, 0, 0, 0) 0%, rgba(0, 0, 0, 0.8) 100%), url(".concat(this._getThumbnail(),")")},className:l.thumbnail}),n("div",{className:l.countdown},n("div",{className:l.title},this.state.secondsRemaining?this.props.isQAEvent?"LIVE Q&A BEGINS IN":"LIVE STREAM BEGINS IN":""),null!==this.state.secondsRemaining&&null!==e&&n("div",null,e>0&&n(d,{value:h(e),time:1===e?"DAY":"DAYS"}),n(d,{value:h(t),time:1===t?"HOUR":"HOURS"}),n(d,{value:h(i),time:1===i?"MINUTE":"MINUTES"}),e<1&&n(d,{value:h(r),time:1===r?"SECOND":"SECONDS"}))))}});e.exports=p},function(e,t,i){e.exports={countdownContainer:"styles__countdownContainer_2pr34wbnvFCqOfp90Fp-cE",thumbnail:"styles__thumbnail_11r309-0jEMDC1tsf36Bcd",countdown:"styles__countdown_2trNv4b4zgOZb1uekjxqOE",countdownSquare:"styles__countdownSquare_1XPXuBXoiDB15D_POUOPZP",squareNumber:"styles__squareNumber_2nygUMI8HtGGPZpV5gP-XX",squareTime:"styles__squareTime_1JahuyWPVV4CxqoRyv9-GF",title:"styles__title_QmwLtBbjyErNbhH7qGUhp"}},function(e,t,i){const{h:n,Component:r}=i(1),{connect:a}=i(2),o=i(81),{hideClickForSound:s}=i(7);const l=a((function(e){return{isCountdownVisible:e.isCountdownVisible,isClickForSoundVisible:e.isClickForSoundVisible,isThumbnailVisible:e.isThumbnailVisible,isLive:"live"==e.videoData.state,isControlsVisible:e.isControlsVisible}}),{hideClickForSound:s})(class extends r{shouldComponentUpdate(e){return this.props.isCountdownVisible!==e.isCountdownVisible||this.props.isClickForSoundVisible!==e.isClickForSoundVisible||this.props.isThumbnailVisible!==e.isThumbnailVisible||this.props.isLive!==e.isLive}render(){const{onClicked:e,isCountdownVisible:t,isClickForSoundVisible:i,hideClickForSound:r,isThumbnailVisible:a,isLive:s,isControlsVisible:l,isLiveButtonVisible:c}=this.props;if(this.props.isCountdownVisible||!i||a)return null;const u=[o.clickForSoundWrapper];return this.props.isLive&&!this.props.isControlsVisible&&this.props.isLiveButtonVisible&&u.push(o.clickForSoundWrapperWithLive),n("button",{onClick:()=>{r(),e()},id:"video-sound-".concat(this.props.videoId),className:u.join(" "),"aria-label":"Click For Sound"},n("div",null,n("span",{className:o.cta,dangerouslySetInnerHTML:{__html:'<svg height="24px" version="1.1" viewBox="4 6 20 24" width="24px"><use class="ytp-svg-shadow" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#ytp-svg-13"></use><path class="ytp-svg-fill" d="M8,21 L12,21 L17,26 L17,10 L12,15 L8,15 L8,21 Z M19,14 L19,22 C20.48,21.32 21.5,19.77 21.5,18 C21.5,16.26 20.48,14.74 19,14 Z M19,11.29 C21.89,12.15 24,14.83 24,18 C24,21.17 21.89,23.85 19,24.71 L19,26.77 C23.01,25.86 26,22.28 26,18 C26,13.72 23.01,10.14 19,9.23 L19,11.29 Z" id="ytp-svg-13"></path><svg class="ytp-svg-sound-mute-group" style="opacity: 0;"><use class="ytp-svg-shadow" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#ytp-svg-14"></use><path class="ytp-svg-fill" d="M 26.11,15.73 24.85,14.5 22.52,16.76 20.20,14.5 18.94,15.73 21.26,18 18.94,20.26 20.20,21.5 22.52,19.23 24.85,21.5 26.11,20.26 23.79,18 l 2.32,-2.26 0,0 z" id="ytp-svg-14"></path></svg></svg><span> Tap For Sound</span>'}})))}});e.exports=l},function(e,t,i){e.exports={clickForSoundWrapper:"styles__clickForSoundWrapper_1GX2g3g0TxMstht6vN1xga",cta:"styles__cta_2Ze8pPggh35dr7QDOTQwup",clickForSoundWrapperWithLive:"styles__clickForSoundWrapperWithLive_31xCi2ZLYtcOfi1U365Eid"}},function(e,t,i){const{h:n,Component:r}=i(1),{connect:a}=i(2),o=i(83);const s=a((function(e){return{isCountdownVisible:e.isCountdownVisible,isClickForSoundVisible:e.isClickForSoundVisible,isThumbnailVisible:e.isThumbnailVisible,isLive:"live"==e.videoData.state,isControlsVisible:e.isControlsVisible,isAdMode:e.isAdMode}}))(class extends r{render(){const{isCountdownVisible:e,isClickForSoundVisible:t,isThumbnailVisible:i,isLive:r}=this.props;return this.props.isAdMode,!this.props.isLive||this.props.isCountdownVisible||this.props.isControlsVisible&&!this.props.isClickForSoundVisible?null:n("div",{id:"video-live-".concat(this.props.videoId),className:o.liveIndicatorWrapper},n("span",{className:o.liveButton},"LIVE"))}});e.exports=s},function(e,t,i){e.exports={liveIndicatorWrapper:"styles__liveIndicatorWrapper_3LqyrHPQyYyI-tNdm-bPST",liveButton:"styles__liveButton_1ns5XvEXwEg8MK2qEG0uaI"}},function(e,t,i){const{h:n}=i(1),{useSelector:r}=i(2),a=i(10),o=i(6),s=i(85),l=i(86),c={__html:"".concat(l," <div></div>")};function u(e){return!e.isThumbnailVisible&&(e.isBuffering||e.isAdBuffering||e.isPlaybackInitializing||e.isLoadingSpinnerVisible||e.adInitState===o.STARTED||e.videoApiLoadState===o.STARTED||e.imaLoadState===o.STARTED||e.hlsJsLoadState===o.STARTED)}e.exports=()=>r(u)?n("div",{className:a("video-loading",s.loader)},n("div",{className:s.loaderInner,dangerouslySetInnerHTML:c})):null},function(e,t,i){e.exports={loader:"styles__loader_2fMYXAAKUoWUtRfViLH466",hide:"styles__hide_26mxdO48gpuVbo3RsXGG8x",loaderInner:"styles__loaderInner_3TVMSN7m78Wly8qB_0U-qS",loadspin:"styles__loadspin_1GpaQPOz0YpaJBYqI5pk6b"}},function(e,t){e.exports='<svg x="0px" y="0px" viewBox="0 0 60 60"><mask id="loading-mask-top-l" maskUnits="userSpaceOnUse"><rect x="0" y="30" width="60" height="30" fill="white"></rect></mask><circle cx="30" cy="30" r="29" stroke="#0294E8" stroke-width="2" fill="transparent" mask="url(#loading-mask-top-l)"></circle><mask id="loading-mask-bottom-l" maskUnits="userSpaceOnUse"><rect x="0" y="0" width="60" height="30" fill="white"></rect></mask><circle cx="30" cy="30" r="29" stroke="#666666" stroke-width="2" fill="transparent" mask="url(#loading-mask-bottom-l)"></circle></svg>'},function(e,t,i){e.exports={Line:i(88),Circle:i(21),SemiCircle:i(90),Path:i(20),Shape:i(12),utils:i(8)}},function(e,t,i){var n=i(12),r=i(8),a=function(e,t){this._pathTemplate="M 0,{center} L 100,{center}",n.apply(this,arguments)};(a.prototype=new n).constructor=a,a.prototype._initializeSvg=function(e,t){e.setAttribute("viewBox","0 0 100 "+t.strokeWidth),e.setAttribute("preserveAspectRatio","none")},a.prototype._pathString=function(e){return r.render(this._pathTemplate,{center:e.strokeWidth/2})},a.prototype._trailString=function(e){return this._pathString(e)},e.exports=a},function(e,t,i){(function(){var t,i=this||Function("return this")(),n=function(){"use strict";var t,n,r,a,o,s,l=Date.now?Date.now:function(){return+new Date},c="undefined"!=typeof SHIFTY_DEBUG_NOW?SHIFTY_DEBUG_NOW:l;function u(){}function h(e,t){var i;for(i in e)Object.hasOwnProperty.call(e,i)&&t(i)}function d(e,t){return h(t,(function(i){e[i]=t[i]})),e}function p(e,t){h(t,(function(i){void 0===e[i]&&(e[i]=t[i])}))}function f(e,i,n,r,a,o,s){var l,c,u,h=e<o?0:(e-o)/a;for(l in i)i.hasOwnProperty(l)&&(u="function"==typeof(c=s[l])?c:t[c],i[l]=g(n[l],r[l],u,h));return i}function g(e,t,i,n){return e+(t-e)*i(n)}function _(e,t){var i=y.prototype.filter,n=e._filterArgs;h(i,(function(r){void 0!==i[r][t]&&i[r][t].apply(e,n)}))}function m(e,t,i,n,l,u,h,d,p,g,m){r=t+i+n,a=Math.min(m||c(),r),o=a>=r,s=n-(r-a),e.isPlaying()&&(o?(p(h,e._attachment,s),e.stop(!0)):(e._scheduleId=g(e._timeoutHandler,1e3/60),_(e,"beforeTween"),a<t+i?f(1,l,u,h,1,1,d):f(a,l,u,h,n,t+i,d),_(e,"afterTween"),p(l,e._attachment,s)))}function v(e,t){var i={},n=typeof t;return h(e,"string"===n||"function"===n?function(e){i[e]=t}:function(e){i[e]||(i[e]=t[e]||"linear")}),i}function y(e,t){this._currentState=e||{},this._configured=!1,this._scheduleFunction=n,void 0!==t&&this.setConfig(t)}return n="undefined"!=typeof window&&(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||window.mozCancelRequestAnimationFrame&&window.mozRequestAnimationFrame)||setTimeout,y.prototype.tween=function(e){return this._isTweening?this:(void 0===e&&this._configured||this.setConfig(e),this._timestamp=c(),this._start(this.get(),this._attachment),this.resume())},y.prototype.setConfig=function(e){e=e||{},this._configured=!0,this._attachment=e.attachment,this._pausedAtTime=null,this._scheduleId=null,this._delay=e.delay||0,this._start=e.start||u,this._step=e.step||u,this._finish=e.finish||u,this._duration=e.duration||500,this._currentState=d({},e.from||this.get()),this._originalState=this.get(),this._targetState=d({},e.to||this.get());var t=this;this._timeoutHandler=function(){m(t,t._timestamp,t._delay,t._duration,t._currentState,t._originalState,t._targetState,t._easing,t._step,t._scheduleFunction)};var i=this._currentState,n=this._targetState;return p(n,i),this._easing=v(i,e.easing||"linear"),this._filterArgs=[i,this._originalState,n,this._easing],_(this,"tweenCreated"),this},y.prototype.get=function(){return d({},this._currentState)},y.prototype.set=function(e){this._currentState=e},y.prototype.pause=function(){return this._pausedAtTime=c(),this._isPaused=!0,this},y.prototype.resume=function(){return this._isPaused&&(this._timestamp+=c()-this._pausedAtTime),this._isPaused=!1,this._isTweening=!0,this._timeoutHandler(),this},y.prototype.seek=function(e){e=Math.max(e,0);var t=c();return this._timestamp+e===0||(this._timestamp=t-e,this.isPlaying()||(this._isTweening=!0,this._isPaused=!1,m(this,this._timestamp,this._delay,this._duration,this._currentState,this._originalState,this._targetState,this._easing,this._step,this._scheduleFunction,t),this.pause())),this},y.prototype.stop=function(e){return this._isTweening=!1,this._isPaused=!1,this._timeoutHandler=u,(i.cancelAnimationFrame||i.webkitCancelAnimationFrame||i.oCancelAnimationFrame||i.msCancelAnimationFrame||i.mozCancelRequestAnimationFrame||i.clearTimeout)(this._scheduleId),e&&(_(this,"beforeTween"),f(1,this._currentState,this._originalState,this._targetState,1,0,this._easing),_(this,"afterTween"),_(this,"afterTweenEnd"),this._finish.call(this,this._currentState,this._attachment)),this},y.prototype.isPlaying=function(){return this._isTweening&&!this._isPaused},y.prototype.setScheduleFunction=function(e){this._scheduleFunction=e},y.prototype.dispose=function(){var e;for(e in this)this.hasOwnProperty(e)&&delete this[e]},y.prototype.filter={},y.prototype.formula={linear:function(e){return e}},t=y.prototype.formula,d(y,{now:c,each:h,tweenProps:f,tweenProp:g,applyFilter:_,shallowCopy:d,defaults:p,composeEasingObject:v}),"function"==typeof SHIFTY_DEBUG_NOW&&(i.timeoutHandler=m),e.exports=y,y}();n.shallowCopy(n.prototype.formula,{easeInQuad:function(e){return Math.pow(e,2)},easeOutQuad:function(e){return-(Math.pow(e-1,2)-1)},easeInOutQuad:function(e){return(e/=.5)<1?.5*Math.pow(e,2):-.5*((e-=2)*e-2)},easeInCubic:function(e){return Math.pow(e,3)},easeOutCubic:function(e){return Math.pow(e-1,3)+1},easeInOutCubic:function(e){return(e/=.5)<1?.5*Math.pow(e,3):.5*(Math.pow(e-2,3)+2)},easeInQuart:function(e){return Math.pow(e,4)},easeOutQuart:function(e){return-(Math.pow(e-1,4)-1)},easeInOutQuart:function(e){return(e/=.5)<1?.5*Math.pow(e,4):-.5*((e-=2)*Math.pow(e,3)-2)},easeInQuint:function(e){return Math.pow(e,5)},easeOutQuint:function(e){return Math.pow(e-1,5)+1},easeInOutQuint:function(e){return(e/=.5)<1?.5*Math.pow(e,5):.5*(Math.pow(e-2,5)+2)},easeInSine:function(e){return 1-Math.cos(e*(Math.PI/2))},easeOutSine:function(e){return Math.sin(e*(Math.PI/2))},easeInOutSine:function(e){return-.5*(Math.cos(Math.PI*e)-1)},easeInExpo:function(e){return 0===e?0:Math.pow(2,10*(e-1))},easeOutExpo:function(e){return 1===e?1:1-Math.pow(2,-10*e)},easeInOutExpo:function(e){return 0===e?0:1===e?1:(e/=.5)<1?.5*Math.pow(2,10*(e-1)):.5*(2-Math.pow(2,-10*--e))},easeInCirc:function(e){return-(Math.sqrt(1-e*e)-1)},easeOutCirc:function(e){return Math.sqrt(1-Math.pow(e-1,2))},easeInOutCirc:function(e){return(e/=.5)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)},easeOutBounce:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},easeInBack:function(e){var t=1.70158;return e*e*((t+1)*e-t)},easeOutBack:function(e){var t=1.70158;return(e-=1)*e*((t+1)*e+t)+1},easeInOutBack:function(e){var t=1.70158;return(e/=.5)<1?e*e*((1+(t*=1.525))*e-t)*.5:.5*((e-=2)*e*((1+(t*=1.525))*e+t)+2)},elastic:function(e){return-1*Math.pow(4,-8*e)*Math.sin((6*e-1)*(2*Math.PI)/2)+1},swingFromTo:function(e){var t=1.70158;return(e/=.5)<1?e*e*((1+(t*=1.525))*e-t)*.5:.5*((e-=2)*e*((1+(t*=1.525))*e+t)+2)},swingFrom:function(e){var t=1.70158;return e*e*((t+1)*e-t)},swingTo:function(e){var t=1.70158;return(e-=1)*e*((t+1)*e+t)+1},bounce:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},bouncePast:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?2-(7.5625*(e-=1.5/2.75)*e+.75):e<2.5/2.75?2-(7.5625*(e-=2.25/2.75)*e+.9375):2-(7.5625*(e-=2.625/2.75)*e+.984375)},easeFromTo:function(e){return(e/=.5)<1?.5*Math.pow(e,4):-.5*((e-=2)*Math.pow(e,3)-2)},easeFrom:function(e){return Math.pow(e,4)},easeTo:function(e){return Math.pow(e,.25)}}),function(){function e(e,t,i,n,r,a){var o,s,l=0,c=0,u=0,h=0,d=0,p=0;function f(e){return((l*e+c)*e+u)*e}function g(e){return(3*l*e+2*c)*e+u}function _(e){return e>=0?e:0-e}return l=1-(u=3*t)-(c=3*(n-t)-u),h=1-(p=3*i)-(d=3*(r-i)-p),o=e,s=function(e){return 1/(200*e)}(a),function(e){return((h*e+d)*e+p)*e}(function(e,t){var i,n,r,a,o,s;for(r=e,s=0;s<8;s++){if(_(a=f(r)-e)<t)return r;if(_(o=g(r))<1e-6)break;r-=a/o}if(n=1,(r=e)<(i=0))return i;if(r>n)return n;for(;i<n;){if(_((a=f(r))-e)<t)return r;e>a?i=r:n=r,r=.5*(n-i)+i}return r}(o,s))}n.setBezierFunction=function(t,i,r,a,o){var s=function(t,i,n,r){return function(a){return e(a,t,i,n,r,1)}}(i,r,a,o);return s.displayName=t,s.x1=i,s.y1=r,s.x2=a,s.y2=o,n.prototype.formula[t]=s},n.unsetBezierFunction=function(e){delete n.prototype.formula[e]}}(),(t=new n)._filterArgs=[],n.interpolate=function(e,i,r,a,o){var s=n.shallowCopy({},e),l=o||0,c=n.composeEasingObject(e,a||"linear");t.set({});var u=t._filterArgs;u.length=0,u[0]=s,u[1]=e,u[2]=i,u[3]=c,n.applyFilter(t,"tweenCreated"),n.applyFilter(t,"beforeTween");var h=function(e,t,i,r,a,o){return n.tweenProps(r,t,e,i,1,o,a)}(e,s,i,r,c,l);return n.applyFilter(t,"afterTween"),h},function(e){var t=/(\d|\-|\.)/,i=/([^\-0-9\.]+)/g,n=/[0-9.\-]+/g,r=new RegExp("rgb\\("+n.source+/,\s*/.source+n.source+/,\s*/.source+n.source+"\\)","g"),a=/^.*\(/,o=/#([0-9]|[a-f]){3,6}/gi;function s(e,t){var i,n=[],r=e.length;for(i=0;i<r;i++)n.push("_"+t+"_"+i);return n}function l(t){e.each(t,(function(e){var i=t[e];"string"==typeof i&&i.match(o)&&(t[e]=d(o,i,c))}))}function c(e){var t=function(e){3===(e=e.replace(/#/,"")).length&&(e=(e=e.split(""))[0]+e[0]+e[1]+e[1]+e[2]+e[2]);return u[0]=h(e.substr(0,2)),u[1]=h(e.substr(2,2)),u[2]=h(e.substr(4,2)),u}(e);return"rgb("+t[0]+","+t[1]+","+t[2]+")"}var u=[];function h(e){return parseInt(e,16)}function d(e,t,i){var n=t.match(e),r=t.replace(e,"VAL");if(n)for(var a,o=n.length,s=0;s<o;s++)a=n.shift(),r=r.replace("VAL",i(a));return r}function p(e){for(var t=e.match(n),i=t.length,r=e.match(a)[0],o=0;o<i;o++)r+=parseInt(t[o],10)+",";return r=r.slice(0,-1)+")"}function f(t,i){e.each(i,(function(e){for(var n=m(t[e]),r=n.length,a=0;a<r;a++)t[i[e].chunkNames[a]]=+n[a];delete t[e]}))}function g(t,i){e.each(i,(function(e){var n=t[e],a=function(e,t){_.length=0;for(var i=t.length,n=0;n<i;n++)_.push(e[t[n]]);return _}(function(e,t){for(var i,n={},r=t.length,a=0;a<r;a++)i=t[a],n[i]=e[i],delete e[i];return n}(t,i[e].chunkNames),i[e].chunkNames);n=function(e,t){for(var i=e,n=t.length,r=0;r<n;r++)i=i.replace("VAL",+t[r].toFixed(4));return i}(i[e].formatString,a),t[e]=d(r,n,p)}))}var _=[];function m(e){return e.match(n)}e.prototype.filter.token={tweenCreated:function(n,r,a,o){var c,u;l(n),l(r),l(a),this._tokenData=(c=n,u={},e.each(c,(function(e){var n,r,a=c[e];if("string"==typeof a){var o=m(a);u[e]={formatString:(n=a,r=n.match(i),r?(1===r.length||n.charAt(0).match(t))&&r.unshift(""):r=["",""],r.join("VAL")),chunkNames:s(o,e)}}})),u)},beforeTween:function(t,i,n,r){!function(t,i){e.each(i,(function(e){var n,r=i[e].chunkNames,a=r.length,o=t[e];if("string"==typeof o){var s=o.split(" "),l=s[s.length-1];for(n=0;n<a;n++)t[r[n]]=s[n]||l}else for(n=0;n<a;n++)t[r[n]]=o;delete t[e]}))}(r,this._tokenData),f(t,this._tokenData),f(i,this._tokenData),f(n,this._tokenData)},afterTween:function(t,i,n,r){g(t,this._tokenData),g(i,this._tokenData),g(n,this._tokenData),function(t,i){e.each(i,(function(e){var n=i[e].chunkNames,r=n.length,a=t[n[0]];if("string"===typeof a){for(var o="",s=0;s<r;s++)o+=" "+t[n[s]],delete t[n[s]];t[e]=o.substr(1)}else t[e]=a}))}(r,this._tokenData)}}}(n)}).call(null)},function(e,t,i){var n=i(12),r=i(21),a=i(8),o=function(e,t){this._pathTemplate="M 50,50 m -{radius},0 a {radius},{radius} 0 1 1 {2radius},0",this.containerAspectRatio=2,n.apply(this,arguments)};(o.prototype=new n).constructor=o,o.prototype._initializeSvg=function(e,t){e.setAttribute("viewBox","0 0 100 50")},o.prototype._initializeTextContainer=function(e,t,i){e.text.style&&(i.style.top="auto",i.style.bottom="0",e.text.alignToBottom?a.setStyle(i,"transform","translate(-50%, 0)"):a.setStyle(i,"transform","translate(-50%, 50%)"))},o.prototype._pathString=r.prototype._pathString,o.prototype._trailString=r.prototype._trailString,e.exports=o},function(e,t,i){"use strict";i.r(t),i.d(t,"createStore",(function(){return d}));var n=i(4),r=i(23),a=i(0),o=i(6),s=i(7);const l={width:0,height:0,adInitState:o.NONE,isControlsVisible:!1,isEndscreenVisible:!1,isSharescreenVisible:!1,hlsJsLoadState:o.NONE,imaAdErrorState:!1,imaLoadState:o.NONE,isLoadingSpinnerVisible:!1,videoApiLoadState:o.NONE,isMoreVideosSlideVisible:!1,isPlaying:!1,isThumbnailVisible:!1,isVolumeControlVisible:!1,isClosedCaptionsVisible:!1,currentPosition:0,currentAdPosition:0,duration:0,videoData:{secondsUntilStartTime:0},isMuted:!1,isFullScreen:!1,currentBreakpoint:"16U",playlist:[],isCountdownVisible:!1,isAdMode:!1,isAdPlaying:!1,isAdBuffering:!1,isAdsBlocked:!1,isClickForSoundVisible:!1,isPlaybackInitializing:!1,isBuffering:!1,isSavedQueueModalVisible:!1,loggingEnabled:!1,focusElement:null,volume:1};function c(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case a.j:return{...e,enableLogging:!0};case a.u:return{...e,width:t.width,height:t.height,currentBreakpoint:e.isFullScreen?"full":h(t.width)};case a.F:return{...e,isThumbnailVisible:!0};case a.E:return{...e,isThumbnailVisible:!1};case a.s:return{...e,isMoreVideosSlideVisible:!0};case a.r:return{...e,isMoreVideosSlideVisible:!1};case a.h:return{...e,isControlsVisible:!0};case a.g:return{...e,isControlsVisible:!1};case a.A:return{...e,isEndscreenVisible:!0};case a.n:return{...e,isEndscreenVisible:!1};case a.D:return{...e,isSharescreenVisible:!0};case a.q:return{...e,isSharescreenVisible:!1};case a.U:return{...e,isPlaying:!0};case a.T:return{...e,isPlaying:!1};case a.V:return{...e,currentPosition:t.currentPosition};case a.O:return{...e,duration:t.duration};case a.S:return{...e,isMuted:!0};case a.X:return{...e,isMuted:!1};case a.Y:return{...e,volume:t.volume};case a.w:return{...e,isVolumeControlVisible:t.isVolumeControlVisible};case a.Q:return{...e,isFullScreen:!0,currentBreakpoint:"full"};case a.R:return{...e,isFullScreen:!1,currentBreakpoint:h(e.width)};case a.C:return{...e,isSavedQueueModalVisible:!0};case a.p:return{...e,isSavedQueueModalVisible:!1};case a.L:return{...e,videoData:t.videoData,currentPosition:0,duration:t.videoData&&t.videoData.duration?parseInt(t.videoData.duration,10):l.duration,playlist:e.playlist.length>0?u(e.playlist,t.videoData.guid):e.playlist};case a.t:{if(!t.playlist||0===t.playlist.length)return e;const i=u(t.playlist,e.videoData.guid);return{...e,playlist:i}}case a.i:{const{playlist:t}=e;if(0===t.length)return e;const[,...i]=t;return{...e,playlist:i}}case a.v:return{...e,focusElement:t.payload};case a.z:return{...e,isCountdownVisible:!0,isControlsVisible:!1};case a.m:return{...e,isCountdownVisible:!1};case a.x:return{...e,isClickForSoundVisible:!0};case a.k:return{...e,isClickForSoundVisible:!1};case a.y:return{...e,isClosedCaptionsVisible:!0};case a.l:return{...e,isClosedCaptionsVisible:!1};case a.B:return{...e,isLoadingSpinnerVisible:!0};case a.o:return{...e,isLoadingSpinnerVisible:!1};case a.K:return{...e,videoApiLoadState:t.payload};case a.H:return{...e,adInitState:t.payload,isAdsBlocked:t.payload===o.FAILED};case a.J:return{...e,imaLoadState:t.payload,isAdsBlocked:t.payload===o.FAILED};case a.G:return{...e,imaAdErrorState:t.payload};case a.I:return{...e,hlsJsLoadState:t.payload};case a.W:return{...e,isPlaybackInitializing:!0,currentPosition:0};case a.P:return{...e,isPlaybackInitializing:!1};case a.M:return{...e,isBuffering:!0};case a.N:return{...e,isBuffering:!1};case a.f:return{...e,isAdMode:!0};case a.b:return{...e,isAdMode:!1,isPlaybackInitializing:!1,isAdBuffering:!1,isAdPlaying:!1,currentAdPosition:0};case a.e:return{...e,currentAdPosition:t.payload,isAdBuffering:!1};case a.d:return{...e,isAdPlaying:!0};case a.c:return{...e,isAdPlaying:!1};case a.a:return{...e,isAdBuffering:!0};default:return e}}function u(e,t){const i=[...e],n=i.findIndex(e=>e.guid===t);return-1!==n&&i.splice(n,1),i}function h(e){return e>=1260?"16U":e>=860?"12U":e>=620?"8U":e>350?"4U":"tiny"}function d(){if(window.location.search.includes("wsjVideoLogger")){const e=[a.V],t=Object(r.createLogger)({predicate:(t,i)=>-1===e.indexOf(i.type),diff:!0,collapsed:!0}),i=Object(n.createStore)(c,Object(n.applyMiddleware)(t));return i.dispatch(Object(s.enableLogging)()),i}return Object(n.createStore)(c)}},function(e,t,i){"use strict";i.r(t);t.default=class{constructor(e){let{adsManager:t,onAdDisconnect:i,reduxStore:n}=e;this._adsManager=t,this._onAdDisconnect=i,this._store=n,this._observing=!1,this._isHealthy=!0,this._clearAllTimeouts=this._clearAllTimeouts.bind(this),this._handleAdProgress=this._handleAdProgress.bind(this)}_isAdPlaying(){return this._store.getState().isAdMode}_isAdBuffering(){return this._store.getState().isAdBuffering}_clearAllTimeouts(){clearTimeout(this._adDelayTimeout),clearTimeout(this._adDestroyTimeout)}_handleAdProgress(){this._isAdPlaying()&&!this._isAdBuffering()&&(this._adRemainder=this._adsManager.getRemainingTime(),this._clearAllTimeouts(),this._adDelayTimeout=setTimeout(()=>{if(!this._isAdPlaying()||this._isAdBuffering())return;const e=1e3*Math.max(this._adRemainder-2,0);this._adDestroyTimeout=setTimeout(()=>{this._isHealthy=!1,this._onAdDisconnect()},e)},2e3))}isHealthy(){return this._isHealthy}observe(){this._observing||(this._adsManager.addEventListener(google.ima.AdEvent.Type.PAUSED,this._clearAllTimeouts),this._adsManager.addEventListener(google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,this._clearAllTimeouts),this._adsManager.addEventListener(google.ima.AdEvent.Type.AD_PROGRESS,this._handleAdProgress),this._observing=!0)}disconnect(){this._observing&&(this._clearAllTimeouts(),this._adsManager.removeEventListener(google.ima.AdEvent.Type.PAUSED,this._clearAllTimeouts),this._adsManager.removeEventListener(google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,this._clearAllTimeouts),this._adsManager.removeEventListener(google.ima.AdEvent.Type.AD_PROGRESS,this._handleAdProgress),this._observing=!1)}}},function(e,t){e.exports='<svg width="41px" height="41px" viewBox="0 0 41 41" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>Link</title><desc>Created with sketchtool.</desc><g id="Symbols" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="Share-Tools/Small" transform="translate(-19.000000, -3.000000)" fill="#FFFFFF"><g id="Group" transform="translate(0.000000, 3.000000)"><g id="link-2" transform="translate(19.000000, 0.000000)"><path d="M20.5,41 C31.8218374,41 41,31.8218374 41,20.5 C41,9.17816263 31.8218374,0 20.5,0 C9.17816263,0 0,9.17816263 0,20.5 C0,31.8218374 9.17816263,41 20.5,41 Z M29.1482244,10 L31,11.8517601 L23.8517756,19 L22,17.1482399 L29.1482244,10 Z M17.1482244,22 L19,23.8517601 L11.8517756,31 L10,29.1482399 L17.1482244,22 Z M11.6250344,24 L9.76878951,22.1436387 C8.74361379,21.1183986 8.74357389,19.4561959 9.76964768,18.4300578 L18.4304073,9.76875462 C19.456057,8.74304058 21.1206655,8.7447425 22.1437552,9.7678964 L24,11.6242577 L22.1437552,13.4806191 L20.905613,12.2423992 C20.5642443,11.9010091 20.0123957,11.8993896 19.6682227,12.2435842 L12.244322,19.6679508 C11.9022989,20.0099954 11.8989297,20.5611898 12.243137,20.9054188 L13.4812792,22.1436387 L11.6250344,24 Z M29.3749656,17 L31.2312105,18.8563613 C32.2563862,19.8816014 32.2564261,21.5438041 31.2303523,22.5699422 L22.5695927,31.2312454 C21.543943,32.2569594 19.8793345,32.2552575 18.8562448,31.2321036 L17,29.3757423 L18.8562448,27.5193809 L20.094387,28.7576008 C20.4357557,29.0989909 20.9876043,29.1006104 21.3317773,28.7564158 L28.755678,21.3320492 C29.0977011,20.9900046 29.1010703,20.4388102 28.756863,20.0945812 L27.5187208,18.8563613 L29.3749656,17 Z" id="link"></path></g></g></g></g></svg>'},function(e,t){e.exports='<svg width="41px" height="41px" viewBox="0 0 41 41" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>Embed</title><desc>Created with sketchtool.</desc><g id="Symbols" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="Share-Tools/Small" transform="translate(-106.000000, -3.000000)" fill="#FFFFFF" fill-rule="nonzero"><g id="Group-2" transform="translate(87.000000, 3.000000)"><g id="embed-2" transform="translate(19.000000, 0.000000)"><path d="M20.5,41 C31.8218374,41 41,31.8218374 41,20.5 C41,9.17816263 31.8218374,0 20.5,0 C9.17816263,0 0,9.17816263 0,20.5 C0,31.8218374 9.17816263,41 20.5,41 Z M15,25 L7,20.8333333 L7,19.1666667 L15,15 L15,17.5 L9.66666667,20 L15,22.5 L15,25 Z M26,15 L34,19.1666667 L34,20.8333333 L26,25 L26,22.5 L31.3333333,20 L26,17.5 L26,15 Z M25,9 L18.7,31 L16,31 L22.3,9 L25,9 Z" id="embed"></path></g></g></g></g></svg>'},function(e,t){e.exports='<svg width="41px" height="41px" viewBox="0 0 41 41" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>Facebook</title><desc>Created with sketchtool.</desc><g id="Symbols" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="Share-Tools/Small" transform="translate(-193.000000, -3.000000)" fill="#FFFFFF" fill-rule="nonzero"><g id="Group-3" transform="translate(174.000000, 3.000000)"><g id="facebook-2" transform="translate(19.000000, 0.000000)"><path d="M20.5,41 C31.8218374,41 41,31.8218374 41,20.5 C41,9.17816263 31.8218374,0 20.5,0 C9.17816263,0 0,9.17816263 0,20.5 C0,31.8218374 9.17816263,41 20.5,41 Z M24.6293176,20.0039078 L21.6133109,20.0039078 L21.6133109,31 L17.1314238,31 L17.1314238,20.0039078 L15,20.0039078 L15,16.4790934 L17.1314238,16.4790934 L17.1314238,14.1891364 C17.1314238,12.5556858 17.9738837,10 21.6470093,10 L24.9663016,10 L24.9663016,13.4388433 L22.5400168,13.4388433 C22.2678957,13.4246304 22.0032383,13.5243373 21.8188466,13.7105368 C21.6344549,13.8967363 21.5497517,14.1498151 21.5880371,14.4001563 L21.5880371,16.4790934 L25,16.4790934 L24.6293176,20.0039078 Z" id="facebook"></path></g></g></g></g></svg>'},function(e,t){e.exports='<svg width="41px" height="41px" viewBox="0 0 41 41" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>Twitter</title><desc>Created with sketchtool.</desc><g id="Symbols" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="Share-Tools/Small" transform="translate(-280.000000, -3.000000)" fill="#FFFFFF" fill-rule="nonzero"><g id="Group-4" transform="translate(261.000000, 3.000000)"><g id="twitter-2" transform="translate(19.000000, 0.000000)"><path d="M20.5,41 C31.8218374,41 41,31.8218374 41,20.5 C41,9.17816263 31.8218374,0 20.5,0 C9.17816263,0 0,9.17816263 0,20.5 C0,31.8218374 9.17816263,41 20.5,41 Z M28.8878177,16.9914714 L28.8878177,17.5117273 C28.8878177,22.8507464 24.7773883,29 17.266433,29 C15.0406158,28.9997821 12.8630788,28.3685169 11,27.1833689 C11.3229742,27.2188708 11.647806,27.2359576 11.9728309,27.2345416 C13.8142019,27.2426377 15.6036642,26.6411222 17.0473269,25.5287847 C15.3014982,25.4648489 13.7888941,24.3317766 13.2787029,22.7057571 C13.5331575,22.7510116 13.791287,22.7738475 14.0499562,22.7739873 C14.4143875,22.7735026 14.7770536,22.7247247 15.1279579,22.628998 C13.2095189,22.2327674 11.8406388,20.5801033 11.8501315,18.671642 L11.8501315,18.6289981 C12.4152302,18.940806 13.0500517,19.1135464 13.6993865,19.1321964 C11.8998965,17.9298176 11.350723,15.5843096 12.4373357,13.7420046 C14.4948277,16.2558532 17.5616482,17.7899922 20.8597721,17.9552241 C20.7888495,17.6530764 20.7535646,17.3440438 20.7546012,17.0341154 C20.7400195,14.8235531 22.5671829,13.0187685 24.8387379,13.0000003 C25.9709047,12.9995619 27.0515495,13.4604156 27.8185802,14.2707892 C28.7470872,14.0956075 29.6369313,13.7636647 30.4478528,13.289979 C30.1460477,14.2215957 29.5078215,15.015366 28.6511832,15.5245205 C29.4628438,15.4280487 30.2547824,15.2123781 31,14.8848617 C30.432782,15.7056959 29.7171122,16.4194776 28.8878177,16.9914714 Z" id="twitter"></path></g></g></g></g></svg>'},function(e,t,i){"use strict";i.r(t),i.d(t,"ResizeObserver",(function(){return U})),i.d(t,"ResizeObserverEntry",(function(){return S}));var n,r=[],a="ResizeObserver loop completed with undelivered notifications.";!function(e){e.BORDER_BOX="border-box",e.CONTENT_BOX="content-box",e.DEVICE_PIXEL_CONTENT_BOX="device-pixel-content-box"}(n||(n={}));var o,s=function(){function e(e,t,i,n){return this.x=e,this.y=t,this.width=i,this.height=n,this.top=this.y,this.left=this.x,this.bottom=this.top+this.height,this.right=this.left+this.width,Object.freeze(this)}return e.prototype.toJSON=function(){var e=this;return{x:e.x,y:e.y,top:e.top,right:e.right,bottom:e.bottom,left:e.left,width:e.width,height:e.height}},e.fromRect=function(t){return new e(t.x,t.y,t.width,t.height)},e}(),l=function(e){return e instanceof SVGElement&&"getBBox"in e},c=function(e){if(l(e)){var t=e.getBBox(),i=t.width,n=t.height;return!i&&!n}var r=e,a=r.offsetWidth,o=r.offsetHeight;return!(a||o||e.getClientRects().length)},u=function(e){var t,i,n=null===(i=null===(t=e)||void 0===t?void 0:t.ownerDocument)||void 0===i?void 0:i.defaultView;return!!(n&&e instanceof n.Element)},h="undefined"!=typeof window?window:{},d=new WeakMap,p=/auto|scroll/,f=/^tb|vertical/,g=/msie|trident/i.test(h.navigator&&h.navigator.userAgent),_=function(e){return parseFloat(e||"0")},m=function(e,t,i){return void 0===e&&(e=0),void 0===t&&(t=0),void 0===i&&(i=!1),Object.freeze({inlineSize:(i?t:e)||0,blockSize:(i?e:t)||0})},v=Object.freeze({devicePixelContentBoxSize:m(),borderBoxSize:m(),contentBoxSize:m(),contentRect:new s(0,0,0,0)}),y=function(e,t){if(void 0===t&&(t=!1),d.has(e)&&!t)return d.get(e);if(c(e))return d.set(e,v),v;var i=getComputedStyle(e),n=l(e)&&e.ownerSVGElement&&e.getBBox(),r=!g&&"border-box"===i.boxSizing,a=f.test(i.writingMode||""),o=!n&&p.test(i.overflowY||""),u=!n&&p.test(i.overflowX||""),h=n?0:_(i.paddingTop),y=n?0:_(i.paddingRight),b=n?0:_(i.paddingBottom),S=n?0:_(i.paddingLeft),E=n?0:_(i.borderTopWidth),w=n?0:_(i.borderRightWidth),T=n?0:_(i.borderBottomWidth),M=S+y,A=h+b,C=(n?0:_(i.borderLeftWidth))+w,x=E+T,I=u?e.offsetHeight-x-e.clientHeight:0,P=o?e.offsetWidth-C-e.clientWidth:0,L=r?M+C:0,D=r?A+x:0,R=n?n.width:_(i.width)-L-P,k=n?n.height:_(i.height)-D-I,O=R+M+P+C,N=k+A+I+x,F=Object.freeze({devicePixelContentBoxSize:m(Math.round(R*devicePixelRatio),Math.round(k*devicePixelRatio),a),borderBoxSize:m(O,N,a),contentBoxSize:m(R,k,a),contentRect:new s(S,h,R,k)});return d.set(e,F),F},b=function(e,t,i){var r=y(e,i),a=r.borderBoxSize,o=r.contentBoxSize,s=r.devicePixelContentBoxSize;switch(t){case n.DEVICE_PIXEL_CONTENT_BOX:return s;case n.BORDER_BOX:return a;default:return o}},S=function(e){var t=y(e);this.target=e,this.contentRect=t.contentRect,this.borderBoxSize=[t.borderBoxSize],this.contentBoxSize=[t.contentBoxSize],this.devicePixelContentBoxSize=[t.devicePixelContentBoxSize]},E=function(e){if(c(e))return 1/0;for(var t=0,i=e.parentNode;i;)t+=1,i=i.parentNode;return t},w=function(){var e=1/0,t=[];r.forEach((function(i){if(0!==i.activeTargets.length){var n=[];i.activeTargets.forEach((function(t){var i=new S(t.target),r=E(t.target);n.push(i),t.lastReportedSize=b(t.target,t.observedBox),r<e&&(e=r)})),t.push((function(){i.callback.call(i.observer,n,i.observer)})),i.activeTargets.splice(0,i.activeTargets.length)}}));for(var i=0,n=t;i<n.length;i++){(0,n[i])()}return e},T=function(e){r.forEach((function(t){t.activeTargets.splice(0,t.activeTargets.length),t.skippedTargets.splice(0,t.skippedTargets.length),t.observationTargets.forEach((function(i){i.isActive()&&(E(i.target)>e?t.activeTargets.push(i):t.skippedTargets.push(i))}))}))},M=function(){var e,t=0;for(T(t);r.some((function(e){return e.activeTargets.length>0}));)t=w(),T(t);return r.some((function(e){return e.skippedTargets.length>0}))&&("function"==typeof ErrorEvent?e=new ErrorEvent("error",{message:a}):((e=document.createEvent("Event")).initEvent("error",!1,!1),e.message=a),window.dispatchEvent(e)),t>0},A=[],C=function(e){if(!o){var t=0,i=document.createTextNode("");new MutationObserver((function(){return A.splice(0).forEach((function(e){return e()}))})).observe(i,{characterData:!0}),o=function(){i.textContent=""+(t?t--:t++)}}A.push(e),o()},x=0,I={attributes:!0,characterData:!0,childList:!0,subtree:!0},P=["resize","load","transitionend","animationend","animationstart","animationiteration","keyup","keydown","mouseup","mousedown","mouseover","mouseout","blur","focus"],L=function(e){return void 0===e&&(e=0),Date.now()+e},D=!1,R=new(function(){function e(){var e=this;this.stopped=!0,this.listener=function(){return e.schedule()}}return e.prototype.run=function(e){var t=this;if(void 0===e&&(e=250),!D){D=!0;var i,n=L(e);i=function(){var i=!1;try{i=M()}finally{if(D=!1,e=n-L(),!x)return;i?t.run(1e3):e>0?t.run(e):t.start()}},C((function(){requestAnimationFrame(i)}))}},e.prototype.schedule=function(){this.stop(),this.run()},e.prototype.observe=function(){var e=this,t=function(){return e.observer&&e.observer.observe(document.body,I)};document.body?t():h.addEventListener("DOMContentLoaded",t)},e.prototype.start=function(){var e=this;this.stopped&&(this.stopped=!1,this.observer=new MutationObserver(this.listener),this.observe(),P.forEach((function(t){return h.addEventListener(t,e.listener,!0)})))},e.prototype.stop=function(){var e=this;this.stopped||(this.observer&&this.observer.disconnect(),P.forEach((function(t){return h.removeEventListener(t,e.listener,!0)})),this.stopped=!0)},e}()),k=function(e){!x&&e>0&&R.start(),!(x+=e)&&R.stop()},O=function(){function e(e,t){this.target=e,this.observedBox=t||n.CONTENT_BOX,this.lastReportedSize={inlineSize:0,blockSize:0}}return e.prototype.isActive=function(){var e,t=b(this.target,this.observedBox,!0);return e=this.target,l(e)||function(e){switch(e.tagName){case"INPUT":if("image"!==e.type)break;case"VIDEO":case"AUDIO":case"EMBED":case"OBJECT":case"CANVAS":case"IFRAME":case"IMG":return!0}return!1}(e)||"inline"!==getComputedStyle(e).display||(this.lastReportedSize=t),this.lastReportedSize.inlineSize!==t.inlineSize||this.lastReportedSize.blockSize!==t.blockSize},e}(),N=function(e,t){this.activeTargets=[],this.skippedTargets=[],this.observationTargets=[],this.observer=e,this.callback=t},F=new WeakMap,V=function(e,t){for(var i=0;i<e.length;i+=1)if(e[i].target===t)return i;return-1},B=function(){function e(){}return e.connect=function(e,t){var i=new N(e,t);F.set(e,i)},e.observe=function(e,t,i){var n=F.get(e),a=0===n.observationTargets.length;V(n.observationTargets,t)<0&&(a&&r.push(n),n.observationTargets.push(new O(t,i&&i.box)),k(1),R.schedule())},e.unobserve=function(e,t){var i=F.get(e),n=V(i.observationTargets,t),a=1===i.observationTargets.length;n>=0&&(a&&r.splice(r.indexOf(i),1),i.observationTargets.splice(n,1),k(-1))},e.disconnect=function(e){var t=this,i=F.get(e);i.observationTargets.slice().forEach((function(i){return t.unobserve(e,i.target)})),i.activeTargets.splice(0,i.activeTargets.length)},e}(),U=function(){function e(e){if(0===arguments.length)throw new TypeError("Failed to construct 'ResizeObserver': 1 argument required, but only 0 present.");if("function"!=typeof e)throw new TypeError("Failed to construct 'ResizeObserver': The callback provided as parameter 1 is not a function.");B.connect(this,e)}return e.prototype.observe=function(e,t){if(0===arguments.length)throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!u(e))throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': parameter 1 is not of type 'Element");B.observe(this,e,t)},e.prototype.unobserve=function(e){if(0===arguments.length)throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!u(e))throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': parameter 1 is not of type 'Element");B.unobserve(this,e)},e.prototype.disconnect=function(){B.disconnect(this)},e.toString=function(){return"function ResizeObserver () { [polyfill code] }"},e}()}]);
//# sourceMappingURL=video.min.js.map